/*! fielddb - v5.5.29 - 2017-07-03
* https://github.com/FieldDB/FieldDB/issues/milestones?state=closed
* Copyright (c) 2017 
	cesine <cesine@yahoo.com>
	trisapeace <trisapeace@gmail.com>
	hisakonog <hisakonog@gmail.com>
	Emmy Cathcart <maryellencathcart@gmail.com>
	Tobin Skinner <tobin.skinner@gmail.com>
	Yuliya Manyakina <yulia.manyakina@gmail.com>
	Elise <elise.mcclay@gmail.com>
	Josh Horner <josh.horner@gmail.com>
	gretchenmcc <gretchen.mcculloch@gmail.com>
	jrwdunham <jrwdunham@gmail.com>
	ghazan <gay.hazan@gmail.com>
	Fieldlinguist <info@fieldlinguist.com>
	zazoo <kimdan.ng@gmail.com>
	louisa-bielig <louisa.bielig@gmail.com>
	lingllama <lingllama@lingsync.org>
	geekrax <rakshit@thetechtime.com>
	Yogurt1206 <sunx4@miamioh.edu>
	Pablo Duboue <pablo.duboue@gmail.com>
	Oriana <oriana.kilbourn-ceron@mail.mcgill.ca>
 Licensed  */
!function a(b,c,d){function e(g,h){if(!c[g]){if(!b[g]){var i="function"==typeof require&&require;if(!h&&i)return i(g,!0);if(f)return f(g,!0);var j=new Error("Cannot find module '"+g+"'");throw j.code="MODULE_NOT_FOUND",j}var k=c[g]={exports:{}};b[g][0].call(k.exports,function(a){var c=b[g][1][a];return e(c?c:a)},k,k.exports,a,b,c,d)}return c[g].exports}for(var f="function"==typeof require&&require,g=0;g<d.length;g++)e(d[g]);return e}({1:[function(a,b,c){"use strict";var d;try{d=document.Q||FieldDB.Q}catch(e){d||(d=a("q"))}var f={OFFLINE:{CODE:600,MESSAGE:"Unable to contact URL, you appear to be offline."},CLIENT_TIMEOUT:{CODE:500,MESSAGE:"The request to URL timed out, please try again. If this happens again, please report this."},CONNECTION_ABORTED:{CODE:500,MESSAGE:"The request to URL was aborted by the server, please report this."},CONNECTION_ERRORED:{CODE:500,MESSAGE:"Server is not responding for URL, please report this."},INTERNAL_SERVER_ERROR:{CODE:500},CLIENT_ERROR:{CODE:400},fieldDBtype:"CORS",timeout:3e4,debugMode:!1,debug:function(a,b,c){this.debugMode&&(a&&console.log("CORS-DEBUG: "+a),b&&console.log(b),c&&console.log(c))},warn:function(a,b,c){this.warnMessage&&this.warnMessage.indexOf("message")>-1||(this.warnMessage=this.warnMessage+a,console.warn("CORS-WARN: "+a),b&&console.log(b),c&&console.log(c))},bug:function(a){console.warn("CORS-BUG: "+a)},render:function(){this.debug("Render requested for CORS, but it doesnt know how to render itself.")},clearCookies:function(a){this.warn("TODO clear cookies requested for "+a)},preprocess:function(a){this.debug("\n\n\npreprocess "+a.url+" "+a.complete),a.complete=!1,a.percentComplete=0,a.method||(a.method=a.type||"GET"),a.url||this.bug("There was an error. Please report this."),a.data||(a.data=""),"GET"===a.method&&a.data&&(a.dataToSend=JSON.stringify(a.data).replace(/,/g,"&").replace(/:/g,"=").replace(/"/g,"").replace(/[}{]/g,""),a.url=a.url+"?"+a.dataToSend)},handleResponse:function(a,b){if(!a.complete){this.debug(a.url+" "+a.complete+":   handleResponse "+a.url);var c,d,e,f=a.xhr.responseJSON||a.xhr.responseText||a.xhr.response;try{f=JSON.parse(f)}catch(g){}if(f||(f={}),f.reason&&(f.message=f.reason,delete f.reason),d=f.status||a.xhr.status,400>d)return this.debug("done "+a.url+" "+a.complete+"\n\n\n"),a.complete=!0,a.percentComplete=100,void b.resolve(f);"object"!=typeof f&&(f={message:f}),c=new Error(f.userFriendlyErrors?f.userFriendlyErrors[0]:f.message);for(e in f)f.hasOwnProperty(e)&&(c[e]=f[e]);c.status=d,this.handleError(a,c,b)}},handleError:function(a,b,c){if(!a.complete){this.debug(a.url+" "+a.complete+":   handleError "+a.url);var d;this.debug(b.stack);var e="node";try{e=window.location.href}catch(b){}if(d={userFriendlyErrors:b.userFriendlyErrors||[b.message||"There was an error contacting URL from "+e+" the app will not function normally. Please report this."],status:b.status||610,error:b},"missing"===d.userFriendlyErrors[0]?d.userFriendlyErrors.unshift("The server replied that "+a.url.replace(/\/[^:]+:.+@/i,"/_:_@")+" is missing, please report this."):"no_db_file"===d.userFriendlyErrors[0]&&d.userFriendlyErrors.unshift("That database doesn't exist. Are you sure this is the database you wanted to open: "+a.url.replace(/\/[^:]+:.+@/i,"/_:_@")),401===d.status&&f.application&&f.application.authentication&&f.application.authentication.dispatchEvent&&f.application.authentication.dispatchEvent("unauthorized"),d.status>=500)try{window&&window.navigator&&!window.navigator.onLine?(d.userFriendlyErrors.unshift(f.OFFLINE.MESSAGE),d.status=f.OFFLINE.CODE):b&&b.srcElement&&void 0!==b.srcElement.status&&(d.status=b.srcElement.status)}catch(g){}d.userFriendlyErrors[0]=d.userFriendlyErrors[0].replace("URL",a.url.replace(/\/[^:]+:.+@/i,"/_:_@")),this.bug(d.userFriendlyErrors[0]),d.details=a,d.details.url=a.url.replace(/\/[^:]+:.+@/i,"/_:_@"),d.details&&d.details.xhr&&(this.debug(a.url+" "+a.complete+":  cleaning up ",a.url),a.status=a.status||a.xhr.status,delete a.xhr),this.debug(a.url+" "+a.complete+": done "+a.url+"\n\n\n"),a.complete=!0,c.reject(d)}},setHeader:function(a,b,c){a.setRequestHeader(b,c)},ontimeout:function(a,b,c){var d=new Error(this.CLIENT_TIMEOUT.MESSAGE);this.debug(a.url+" "+a.complete+": timed out."),d.status=this.CLIENT_TIMEOUT.CODE,this.handleError(a,d,c)},onabort:function(a,b,c){var d=new Error(this.CONNECTION_ABORTED.MESSAGE);this.debug(a.url+" "+a.complete+": was aborted."),d.status=this.CONNECTION_ABORTED.CODE,this.handleError(a,d,c)},onerror:function(a,b,c){var d=new Error(this.CONNECTION_ERRORED.MESSAGE);this.debug(a.url+" "+a.complete+": errored."),a.xhr&&a.xhr.status?d.status=a.xhr.status:a.status?d.status=a.status:d.status=this.CONNECTION_ERRORED.CODE,this.handleError(a,d,c)},onload:function(a,b,c){this.handleResponse(a,c)},onprogress:function(a,b){if(this.debug(a.url+" "+a.complete+":  onprogress "+a.url+" "+a.complete,b),b.lengthComputable){var c=b.loaded/b.total*100;this.debug(a.url+" "+a.complete+":  percentComplete "+a.url,c),console.log("Percent complete "+a.url.replace(/\/[^:]+:.+@/i,"/_:_@")+" : "+c),a.complete||(a.percentComplete=c)}a.onprogress&&"function"==typeof a.onprogress&&a.onprogress(b)}};f.buildXhr=function(a){var b;try{b=new XMLHttpRequest}catch(c){return this.warn("XMLHttpRequest is not defined, nothing will happen.",c),null}if("withCredentials"in b)try{b.open(a.method,a.url,!0)}catch(d){return console.log("CORS exception",d),this.error=d.message,null}else"undefined"!=typeof XDomainRequest?(b=new XDomainRequest,b.open(a.method,a.url)):b=null;if(b)return this.setHeader(b,"Content-type","application/json"),a.withCredentials!==!1&&(b.withCredentials=!0,a.url.lastIndexOf(".")>a.url.lastIndexOf("/")&&0!==a.url.substring(a.url.lastIndexOf(".")).indexOf("htm")&&(b.withCredentials=!1)),(a.timeout||this.timeout)&&(b.timeout=a.timeout||this.timeout),b},f.makeCORSRequest=function(a){var b,c,e=this,f=d.defer();if(!a||!a.url)return d.nextTick(function(){f.reject({status:400,details:a,userFriendlyErrors:["Url must be defined"]})}),f.promise;if(this.preprocess(a,f),a.url=a.url.replace("corpusdev","corpus"),c=this.buildXhr(a),!c){var g=this.error||"CORS not supported, your device will be unable to contact "+a.url;return this.bug(g),d.nextTick(function(){f.reject({status:620,details:a,userFriendlyErrors:[g]})}),f.promise}if(a&&a.data&&a.data.files){console.log("converting to formdata ",a.data),b=new FormData;for(var h in a.data)a.data.hasOwnProperty(h)&&b.append(h,a.data[h]);b=b,this.setHeader(c,"Content-Type","multipart/form-data")}else a.data&&(b=JSON.stringify(a.data));c.onprogress=function(b){e.onprogress(a,b,f)},c.onload=function(b){e.onload(a,b,f)},c.onerror=function(b){e.onerror(a,b,f)},c.onabort=function(b){e.onabort(a,b,f)},c.ontimeout=function(b){e.ontimeout(a,b,f)},a.xhr=c;try{b?(e.debug(a.url+" "+a.complete+": sending ",b),c.send(b)):c.send()}catch(i){e.warn("Caught an exception when calling send on xhr",i),i.details=a,f.reject(i)}return f.promise};try{c.CORS=f}catch(g){}try{!document}catch(g){var h=a("./CORSNode").CORS;console.warn("REST requests: enabled"),c.CORS=h||f}},{"./CORSNode":2,q:223}],2:[function(a,b,c){var d=a("q"),e=a("http"),f=a("https"),g=a("url"),h=a("./CORS").CORS;h.buildXhr=function(){},h.setHeader=function(a,b,c){a.setHeader(b,c)};var i={};h.clearCookies=function(a){a&&(this.warn("clearing cookies on "+a),delete i[a])},h.makeCORSRequest=function(a){var b,c=this,h=d.defer(),j="";if(!a||!a.url)return d.nextTick(function(){h.reject({status:400,details:a,userFriendlyErrors:["Url must be defined"]})}),h.promise;this.preprocess(a,h);var k=g.parse(a.url),l=e;"https:"===k.protocol&&(l=f,k.port=k.port||443),delete k.protocol,k.method=a.method||"GET",b=l.request(k,function(d){var e="";d.setEncoding("utf8"),c.debug(a.url+" "+a.complete+":  requesting "),d.on("data",function(b){e+=b,c.debug(a.url+" "+a.complete+":  ondata "),c.onprogress.apply(c,[a,{lengthComputable:!0,loaded:e.length-b.length,total:e.length},h])}),d.on("end",function(){b.responseText=e,b.status=d.statusCode,d.headers&&d.headers["set-cookie"]&&(i[k.host]=d.headers["set-cookie"],c.debug(a.url+" "+a.complete+": cookies",i)),c.debug(a.url+" "+a.complete+":  response headers "+a.url,d.headers),"DELETE"===a.method&&"/_session"===k.path&&c.clearCookies(k.host),c.onprogress.apply(c,[a,{lengthComputable:!0,loaded:e.length,total:e.length},h]),c.onload.apply(c,[a,{},h])})}),i[k.host]&&b.setHeader("Cookie",i[k.host].join(";")),c.debug(a.url+" "+a.complete+": request cookies "+b.getHeader("cookie")),b.setHeader("Content-type","application/json"),b.setTimeout(a.timeout||this.timeout),a&&a.data&&a.data.files||a.data&&(j=JSON.stringify(a.data)),b.on("error",function(b){c.onerror.apply(c,[a,b,h])}),b.on("timeout",function(d){c.ontimeout.apply(c,[a,d,h]),b.abort()}),a.xhr=b;try{j?(c.debug(a.url+" "+a.complete+": sending ",j),b.write(j)):b.write(""),b.end()}catch(m){c.warn("Caught an exception when calling send on xhr",m.stack),m.details=a,h.reject(m)}return h.promise},c&&(c.CORS=h)},{"./CORS":1,http:174,https:193,q:223,url:178}],3:[function(a,b,c){var d=a("./FieldDBObject").FieldDBObject,e=a("q"),f=function(a){this._fieldDBtype||(this._fieldDBtype="Collection"),this.debug("Constructing a collection"),a||(a={}),"[object Array]"===Object.prototype.toString.call(a)&&(a={collection:a});for(var b in a)a.hasOwnProperty(b)&&"collection"!==b&&(this[b]=a[b]);if(!this.primaryKey){var c="id";this.debug("  Using default primary key of "+c),this.primaryKey=c}a.collection&&(this.collection=a.collection),this.debug("  array of length "+this.collection.length),Object.apply(this,arguments)};f.notWorthSortingSize=100,f.prototype=Object.create(Object.prototype,{constructor:{value:f},fieldDBtype:{get:function(){return this._fieldDBtype},set:function(a){a!==this.fieldDBtype&&this.warn("Using type "+this.fieldDBtype+" when the incoming object was "+a)}},debugMode:{get:function(){return void 0===this.perObjectDebugMode?!1:this.perObjectDebugMode},set:function(a){return a!==this.perObjectDebugMode?null===a||void 0===a?void delete this.perObjectDebugMode:void(this.perObjectDebugMode=a):void 0}},debug:{value:function(){return d.prototype.debug.apply(this,arguments)}},verboseMode:{get:function(){return void 0===this.perObjectVerboseMode?!1:this.perObjectVerboseMode},set:function(a){return a!==this.perObjectVerboseMode?null===a||void 0===a?void delete this.perObjectVerboseMode:void(this.perObjectVerboseMode=a):void 0}},verbose:{value:function(){return d.prototype.verbose.apply(this,arguments)}},bug:{value:function(){return d.prototype.bug.apply(this,arguments)}},confirm:{value:function(){return d.prototype.confirm.apply(this,arguments)}},warn:{value:function(){return d.prototype.warn.apply(this,arguments)}},todo:{value:function(){return d.prototype.todo.apply(this,arguments)}},render:{value:function(){return d.prototype.render.apply(this,arguments)}},ensureSetViaAppropriateType:{value:function(){return d.prototype.ensureSetViaAppropriateType.apply(this,arguments)}},application:{get:function(){return d.application}},collection:{get:function(){return this._collection||(this._collection=[]),this._collection},set:function(a){if(a!==this._collection&&(a!==[]||this._collection!==[])){if(!a||0===a.length)return void(this._collection=[]);if("[object Array]"!==Object.prototype.toString.call(a))return void this.bug("Cannot set collection to an object, only an array",a);for(var b=0;b<a.length;b++){var c=a[b];c?this.add(c):this.warn("item "+b+"is  ("+c+") undefined or empty, not adding it to the collection "+this.fieldDBtype,c)}return this._collection}}},getKeys:{value:function(){var a=this;return this.collection.map(function(b){return a.getSanitizedDotNotationKey(b)})}},sorted:{get:function(){return this.length&&this.length<f.notWorthSortingSize&&this._sorted?!0:void 0},set:function(a){this._sorted=a}},find:{value:function(a,b,c){var e,f,g,h=[];if(a&&b?(e=b,f=a):a&&!b&&(e=a),f=f||this.primaryKey||"id",!e)return h;if("[object Array]"===Object.prototype.toString.call(e)&&(this.bug("User is using find on an array... ths is best re-coded to use search or something else.",e),this.todo("User is using find on an array... ths is best re-coded to use search or something else. Instead running find only on the first item in the array."),e=e[0]),"object"==typeof e&&!(e instanceof RegExp)){if(0===Object.keys(e).length)return h;var i=e[this.primaryKey];i||!this.INTERNAL_MODELS||!this.INTERNAL_MODELS.item||"function"!=typeof this.INTERNAL_MODELS.item||e instanceof this.INTERNAL_MODELS.item?i||e instanceof d?i||this.bug("This searchingFor is a object, and has no key. this is a problem. ",e):e=new d(e):e=new this.INTERNAL_MODELS.item(e),i=e[this.primaryKey],e=i}this[e]&&"function"!=typeof this[e]&&h.push(this[e]),c&&(g=new RegExp(".*"+this.sanitizeStringForPrimaryKey(e)+".*","i"),e=new RegExp(".*"+e+".*","i"),this.debug("fuzzy ",e,g)),e&&e.test&&"function"==typeof e.test||(e&&e.indexOf&&0!==e.indexOf("/")&&(e=d.regExpEscape(e)),e=new RegExp("^"+e+"$")),this.debug("searchingFor",e);for(var j=0;j<this.collection.length;j++)e.test(this.collection[j][f])?(h[0]&&h[0]===this.collection[j]||h.push(this.collection[j]),this.debug("Found a match ",h)):c&&g.test(this.collection[j][f])&&(h[0]&&h[0]===this.collection[j]||h.push(this.collection[j]));if(this.debug("Found total matches ",h.length),h&&h.length>1&&c){this.debug("lets look for the best result where "+f+" = "+b,h.length);for(var k=h.length-1;k>=0;k--)if(0!==k&&h[k]&&h[k][f]===b){var l=h.splice(k);this.debug("a pefect match  ",l),h.unshift(l[0])}}return h}},fuzzyFind:{value:function(a,b){return this.find(a,b,!0)}},set:{value:function(a,b,c,e){if(c=c||this.primaryKey||"id",(null===e||void 0===e)&&(e=this.inverted),!a&&b){if(this.debug("  the constructor of this before casting it "),b=d.convertDocIntoItsType(b),this.debug(" checking the constructor of this after casting it "),!(b&&this.INTERNAL_MODELS&&this.INTERNAL_MODELS.item&&"function"==typeof this.INTERNAL_MODELS.item)||b instanceof this.INTERNAL_MODELS.item||b.constructor.toString()===this.INTERNAL_MODELS.item.toString()||this.INTERNAL_MODELS.item.compatibleWithSimpleStrings&&"string"==typeof b?this.debug("  item to set was already of the right type for "+this.fieldDBtype,b):(this.debug("casting an item to match the internal model which this collection requires ",this.INTERNAL_MODELS.item,b.constructor.toString()),"function"==typeof b.toJSON&&this.debug(" why defereincing this?"),b=new this.INTERNAL_MODELS.item(b)),a=this.getSanitizedDotNotationKey(b),!a)return void this.bug("The primary key `"+this.primaryKey+"` is undefined on this object, it cannot be added! ",b);this.debug("adding "+a)}if(b&&this[a]&&(b===this[a]||"function"==typeof this[a].equals&&this[a].equals(b)))return this.debug("Not setting "+a+", it  was already the same in the collection"),this[a];(null===b||void 0===b)&&this.remove(a,c);for(var f in this.collection)if(this.collection.hasOwnProperty(f)&&this.collection[f][c]===a)return this.debug("found a match in the _collection, ",this.collection[f].equals),(this.collection[f]!==b||"function"==typeof this.collection[f].equals&&!this.collection[f].equals(b))&&("function"==typeof this.collection[f].merge?(this.warn("Merging an existing _collection member "+a+" at index "+f+" (they have the same key but are not equal, nor the same object) "),this.collection[f].merge("self",b)):(this.warn("Overwriting an existing _collection member "+a+" at index "+f+" (they have the same key but are not equal, nor the same object) "),this.warn("Overwriting ",this.collection[f],"->",b),this.collection[f]=b)),this.collection[f];return-1===["collection","primaryKey","find","set","add","inverted","toJSON","length","encrypted","confidential","decryptedMode"].indexOf(a)?(this[a]=b,a&&"function"==typeof a.toLowerCase&&(this[a.toLowerCase().replace(/_/g,"")]=b)):this.warn("An item was added to the collection which has a reserved word for its key... dot notation will not work to retreive this object, but find() will work. ",b),b&&"object"==typeof b&&(b.parent=this),e?this.collection.unshift(b):this.collection.push(b),this[a]}},length:{get:function(){return this.collection?this.collection.length:0}},primaryKey:{get:function(){return this.debug(this.id+"  getting collection prmary key "+this._primaryKey),this._primaryKey||"id"},set:function(a){this.debug(this.id+"setting collection prmary key "+this._primaryKey),a&&(this._primaryKey=a)}},getSanitizedDotNotationKey:{value:function(a){if(!this.primaryKey)return void this.bug("The primary key of this collection "+this.id+" is undefined, nothing can be added!",this);var b=a[this.primaryKey];if(!b)return this.warn("This object is missing a value for the primary key "+this.primaryKey+"...not adding it because it will be hard to find in the collection."),void this.debug("  not adding: ",a);"function"==typeof b.trim&&(b=b.trim());var c=b;return b=this.sanitizeStringForPrimaryKey(b),b!==c&&"DatumStates"!==this.fieldDBtype&&this.debug("The sanitized the dot notation key of this object is not the same as its primaryKey: "+c+" -> "+b),b}},add:{value:function(a){if(a&&"[object Array]"===Object.prototype.toString.call(a)){for(var b=0;b<a.length;b++)a[b]=this.add(a[b]);return a}return this.set(null,a)}},concat:{value:function(a){return a&&a._collection?this.add(a._collection):a?(this.add(a),this):this}},push:{value:function(a){return this.set(null,a,null,!1)}},unshift:{value:function(a){return this.set(null,a,null,!0)}},pop:{value:function(){if(this._collection&&!(this._collection.length<1)){var a=this._collection.pop();if(a){var b=this.getSanitizedDotNotationKey(a);return b||this.warn("This item had no primary key, it will only be removed from the collection. ",a),this[b]&&(this.debug("removed dot notation for ",b),delete this[b]),b+="",this[b.toLowerCase().replace(/_/g,"")]&&(this.debug("removed dot notation for ",b.toLowerCase().replace(/_/g,"")),delete this[b.toLowerCase().replace(/_/g,"")]),a}}}},shift:{value:function(){if(this._collection&&!(this._collection.length<1)){var a=this._collection.shift();if(a){var b=this.getSanitizedDotNotationKey(a);return b||this.warn("This item had no primary key, it will only be removed from the collection. ",a),this[b]&&(this.debug("removed dot notation for ",b),delete this[b]),b+="",this[b.toLowerCase().replace(/_/g,"")]&&(this.debug("removed dot notation for ",b.toLowerCase().replace(/_/g,"")),delete this[b.toLowerCase().replace(/_/g,"")]),a}}}},remove:{value:function(a,b){b&&this.todo("remove optionalKeyToIdentifyItem "+b);var c,d,e=[],f=[],g=this;if("[object Array]"!==Object.prototype.toString.call(a)&&(a=[a]),a.map(function(a){f=f.concat(g.find(a))}),this.debug("requested remove of ",f),0===f.length)return this.warn("Didn't need to remove object(s) which were not in the collection."),e;for(c=0;c<f.length;c++)f[c]&&f[c]!=={}?(d=this.getSanitizedDotNotationKey(f[c]),d||this.warn("This item had no primary key, it will only be removed from the collection. ",f[c]),this[d]&&(this.debug("removed dot notation for ",d),delete this[d]),d+="",this[d.toLowerCase().replace(/_/g,"")]&&(this.debug("removed dot notation for ",d.toLowerCase().replace(/_/g,"")),delete this[d.toLowerCase().replace(/_/g,"")])):this.debug("skipping ",f[c]);for(c=this.collection.length-1;c>=0;c--)if(f.indexOf(this.collection[c])>-1&&-1===e.indexOf(this.collection[c])){var h=this.collection.splice(c,1);e=e.concat(h);for(var i=0;i<h.length;i++)if("object"==typeof a[0]&&"function"==typeof h[i].equals){for(var j=!1,k=0;k<a.length;k++)h[i].equals(a[k])&&(j=!0);j||(this.warn("One of the requested removal items doesnt match exactly what was removed "),this.debug("One of the requested removal items doesnt match exactly ",a,"-> ",h[i]))}}return 0===e.length&&this.warn("Didn't remove object(s) which were not in the collection.",f),this.removedCollection=this.removedCollection||[],this.removedCollection=this.removedCollection.concat(e),e}},indexOf:{value:function(a){if(!this._collection||0===this.collection.length)return-1;for(var b=0;b<this._collection.length;b++){var c=a[this.primaryKey];if(!c){if(a=this.find(a),!(a&&a.length>0))return-1;a=a[0],c=a[this.primaryKey]}if(this._collection[b][this.primaryKey]===c)return b}return-1}},get:{value:function(a){return void 0!==a&&null!==a&&this._collection?this._collection[a]:void 0}},reorder:{value:function(a,b){if("object"==typeof a&&(a=this.indexOf(a)),b>=this._collection.length)for(var c=b-this._collection.length;c--+1;)this._collection.push(void 0);this._collection.splice(b,0,this._collection.splice(a,1)[0])}},unsaved:{get:function(){for(var a=this._collection.length-1;a>=0;a--)if(this._collection[a].unsaved)return this._unsaved=!0,this._unsaved;return this._unsaved=!1,this._unsaved},set:function(a){this._unsaved=!!a}},save:{value:function(a,b,c){var d=e.defer(),f=this,g=[];return this.saving=!0,this.whenReady=d.promise,this.map(function(d){f.debug("saving ",d),d?g.push(d.save(a,b,c)):console.log("not saving this item",d)}),this.warn("Saving "+g.length+" items out of a collection with  "+this.length+" items."),e.allSettled(g).done(function(a){return f.warn("Saved a collection",a.length),f.saving=!1,d.resolve(f),f}),d.promise}},toJSON:{value:function(a,b){var c=this,d=this._collection.map(function(d){return"function"==typeof d.toJSON?(c.debug("This item has a toJSON, which we will call instead"),d.toJSON(a,b)):d});return d}},clone:{value:function(a){var b=this,c=this._collection.map(function(c){return"function"==typeof c.clone?(b.debug("This item has a clone, which we will call instead"),c.clone(a)):JSON.parse(JSON.stringify(c))}),d={primaryKey:this.primaryKey,collection:c,capitalizeFirstCharacterOfPrimaryKeys:this.capitalizeFirstCharacterOfPrimaryKeys},e=new this.constructor(d);return e.corpus=this.corpus,e}},forEach:{get:function(){if(this._collection&&"function"==typeof this._collection.forEach){var a=this;return function(b){return this._collection.forEach.apply(a._collection,[b])}}return void 0}},map:{get:function(){if(this._collection&&"function"==typeof this._collection.map){var a=this;return function(b){return this._collection.map.apply(a._collection,[b])}}return void 0}},sanitizeStringForPrimaryKey:{value:function(a){return this.debug("sanitizeStringForPrimaryKey "+a),a?(a=d.prototype.sanitizeStringForFileSystem.apply(this,arguments),a&&a.trim&&(a=this.camelCased(a)),a):null}},capitalizeFirstCharacterOfPrimaryKeys:{value:{get:function(){return void 0===this._capitalizeFirstCharacterOfPrimaryKeys?!1:this._capitalizeFirstCharacterOfPrimaryKeys},set:function(a){this._capitalizeFirstCharacterOfPrimaryKeys=a}}},camelCased:{value:function(a){return a?(a.replace&&(a=a.replace(/_([a-zA-Z])/g,function(a){return a[1].toUpperCase()}),a=this.capitalizeFirstCharacterOfPrimaryKeys?a[0].toUpperCase()+a.substring(1,a.length):a[0].toLowerCase()+a.substring(1,a.length)),a):null}},equals:{value:function(a){if(!a)return!1;if(!this._collection&&!a._collection)return!0;if(!this._collection||!a._collection)return!1;if(this._collection.length!==a._collection.length)return!1;for(var b=this._collection.length-1;b>=0;b--){var c=this._collection[b],d=a.find(c[a.primaryKey])[0];if(this.debug("Are these equal ",c,d),!c.equals(d))return!1}return!0}},merge:{value:function(a,b,c){var e,f,g,h,i=this;return"self"===a?(this.debug("Merging into myself. "),e=this):e=a,f=this,c||(c=""),b&&0!==b.length?(b instanceof e.constructor&&b.constructor.toString()===e.constructor.toString()?this.debug("The anotherCollection  is  the same type as aCollection ",e.constructor,b.constructor):(this.debug("The anotherCollection  isnt of the same type as aCollection ",e.constructor,b.constructor),b=new e.constructor(b)),e._collection.map(function(j){var k=j[e.primaryKey].toLowerCase(),l=b[k],m=f[k];if(!m&&"function"==typeof j.constructor){i.debug("Cloning into anItem into a fielddbObjects ifits not one already");var n=j.toJSON?j.toJSON():j;m=d.convertDocIntoItsType(n);var o=f.find(m);0===o.length?(i.debug("This item wasnt in the result collection yet, adding it.",m),m=f.add(m)):(m=o[0],i.debug("resultItem was already in the resultCollection  ",o,m))}if(j!==e[k]&&i.debug(" Looking at an an Item that doesnt match the aCollection's member of "+k,j,e[k]),void 0===l)i.debug(k+" was missing in new collection");else if(m===l||"function"==typeof m.equals&&m.equals(l))i.debug(k+" were equal.",j,l);else if(j&&j!==[]&&0!==j.length&&j!=={})if("[object Array]"===Object.prototype.toString.call(j)&&"[object Array]"===Object.prototype.toString.call(l))i.debug(k+" was an array, concatinating with the new value",j," ->",l),m=j.concat(l),i.debug("  ",m);else if("function"==typeof m.merge){h="self"===a?a:j,i.debug("Requesting merge of internal property "+k+" using method: "+h);var p=m.merge(h,l,c);i.debug("after internal merge ",p),i.debug("after internal merge ",m)}else g=c,-1===c.indexOf("overwrite")?i.confirm(this.id+" I found a conflict for "+k+", Do you want to overwrite it from "+JSON.stringify(j)+" -> "+JSON.stringify(l)).then(function(){i.debug("Overwriting contents of "+k+" (this may cause disconnection in listeners)"),i.debug("Overwriting  ",j," ->",l),f[k]=l},function(){i.debug("Not Overwriting  ",j," ->",l),f[k]=j}).fail(function(a){console.error(a.stack,i)}):(i.debug("Overwriting contents of "+k+" (this may cause disconnection in listeners)"),i.debug("Overwriting  ",j," ->",l),f[k]=l);else i.debug(k+" was previously empty, taking the new value"),f[k]=l}),b._collection&&"function"==typeof b._collection.map&&b._collection.map(function(a){var c=a[e.primaryKey],d=e[c];if(a!==b[c]&&i.debug(" Looking at an anItem that doesnt match the anotherCollection's member of "+c,a,b[c]),void 0===d){i.debug(c+" was missing in target, adding it");var g=f.find(a);0===g.length?f.add(a):(a=g[0],i.debug("anotherItem was already in the resultCollection ",g,a))}else void 0===a?(i.debug(c+" was oddly undefined"),f[c]=d):d===a||"function"==typeof d.equals&&d.equals(a)?f[c]=d:a&&a!==[]&&0!==a.length&&a!=={}?i.debug(c+" existed in both and are not equal, and so have already been merged above."):(i.warn(c+" was empty in the new collection, so it was replaced with an empty anItem."),f[c]=a)}),f):(this.debug("The new collection was empty, not merging.",b),f)}},encrypted:{get:function(){},set:function(a){this._collection&&(void 0===this._collection.map&&this.warn("This collection isn't an array, this is odd",this),this._collection.map(function(b){b.encrypted=a}))}},confidential:{get:function(){},set:function(a){this._collection&&(void 0===this._collection.map&&this.warn("This collection isn't an array, this is odd",this),this._collection.map(function(b){b.confidential=a}))}},decryptedMode:{get:function(){return this.application?this.application.decryptedMode:this._decryptedMode},set:function(a){this.application?this.application.decryptedMode=a:(this._decryptedMode=a,this._collection.map(function(b){b.decryptedMode=a}))}},corpus:{get:function(){var a=null;if(this._corpus)a=this._corpus,this.debug("this "+this._id+" has a _corpus hard coded inside it, using it.",a);else if(d.application&&d.application._corpus)a=d.application._corpus,this.debug("this "+this._id+" is running in the context where FieldDBObject.application._corpus is defined, using it.",a);else try{FieldDB&&FieldDB.Database&&(this.debug("  using the Database.prototype to run db calls for "+this._id+", this could be problematic "+this._id+" ."),this.debug(" the database",a))}catch(b){var c=b?b.message:" unknown error in getting the corpus";"FieldDB is not defined"!==c&&(this.warn(this._id+"Cant get the corpus, cant find the Database class.",b),b&&this.warn("  stack trace"+b.stack))}return a||this.warn("Operations that need a corpus/database wont work for the "+this._id+" object"),a},set:function(a){return a&&a.dbname&&this.dbname&&a.dbname!==this.dbname?void this.warn("The corpus "+a.db+" cant be set on this item, its db is different"+this.dbname):(this.debug("setting corpus ",a),void(this._corpus=a))}},dbname:{get:function(){},set:function(a){this._collection&&(void 0===this._collection.map&&this.warn("This collection isn't an array, this is odd",this),this._collection.map(function(b){b.dbname=a}))}},INTERNAL_MODELS:{value:{item:d}}}),c.Collection=f},{"./FieldDBObject":4,q:223}],4:[function(a,b,c){(function(b){"use strict";var d,e=a("diacritics"),f=a("q");try{d=a("./../package.json")}catch(g){console.log("failed to load package.json",g),d={version:"x.x.x"}}var h=function(a){if(a&&(a instanceof this.constructor||a.constructor.toString()===this.constructor.toString()))return a.debug("This was already the right type, not converting it."),a;a&&a.id&&(this.useIdNotUnderscore=!0),a&&a.api&&this.api&&(a.api!==this.api&&console.log("Using "+this.api+" when the api of the incoming model was "+a.api),delete a.api),this.verbose("In parent an json",a),a&&a.confidential&&this.INTERNAL_MODELS.confidential&&(this.confidential=new this.INTERNAL_MODELS.confidential(a.confidential)),a&&a.fields&&this.INTERNAL_MODELS.fields&&(this.fields=new this.INTERNAL_MODELS.fields(a.fields)),this.INTERNAL_MODELS&&this.debug("parsing with ",this.INTERNAL_MODELS);var b=[];for(var c in a)if(a.hasOwnProperty(c)){this.debug("JSON: "+c),!(a[c]&&this.INTERNAL_MODELS&&this.INTERNAL_MODELS[c]&&"function"==typeof this.INTERNAL_MODELS[c])||a[c]instanceof this.INTERNAL_MODELS[c]||this.INTERNAL_MODELS[c].compatibleWithSimpleStrings&&"string"==typeof a[c]?b.push(c):a[c]=new this.INTERNAL_MODELS[c](a[c]);try{this[c]=a[c]}catch(d){this.warn(d.stack)}}b.length>0&&this.debug("simpleModels",b.join(", ")),Object.apply(this,arguments),this.id||this._dateCreated||(this.dateCreated=Date.now())};h.internalAttributesToNotJSONify=["$$hashKey","application","bugMessage","confirmMessage","confirmMergePromises","contextualizer","corpus","currentDoc","currentSession","datalist","database","db","debugMessages","decryptedMode","dontRecurse","fetching","fieldsInColumns","fossil","loaded","loading","newDatum","parent","perObjectAlwaysConfirmOkay","perObjectDebugMode","promptMessage","saved","saving","selected","temp","unsaved","useIdNotUnderscore","warnMessage","whenReady"],h.internalAttributesToAutoMerge=h.internalAttributesToNotJSONify.concat(["appVersionWhenCreated","authServerVersionWhenCreated","created_at","dateCreated","dateModified","fieldDBtype","modifiedByUser","rev","roles","updated_at","version"]),h.ignore=function(a,b){if(!b)throw new Error("missing the list of ignores");return b.indexOf(a)>-1||b.indexOf(a.replace(/^_/,""))>-1?!0:void 0},h.software={},h.hardware={},h.DEFAULT_STRING="",h.DEFAULT_OBJECT={},h.DEFAULT_ARRAY=[],h.DEFAULT_COLLECTION=[],h.DEFAULT_VERSION="v"+d.version,h.DEFAULT_DATE=0,h.render=function(a){this.debug("Rendering, but the render was not injected for this "+this.fieldDBtype,a)},h.verbose=function(a,b,c,d){try{if(navigator&&"Microsoft Internet Explorer"===navigator.appName)return}catch(e){}if(this.verboseMode){var f=this.fieldDBtype||this._id||"UNKNOWNTYPE";console.log(f.toUpperCase()+" VERBOSE: "+a),b&&console.log(b),c&&console.log(c),d&&console.log(d)}},h.debugMode=!1,h.debug=function(a,b,c,d){try{if(navigator&&"Microsoft Internet Explorer"===navigator.appName)return}catch(e){}if(this.debugMode){var f=this.fieldDBtype||this._id||"UNKNOWNTYPE";console.log(f.toUpperCase()+" DEBUG: "+a),b&&console.log(b),c&&console.log(c),d&&console.log(d)}},h.todo=function(a,b,c,d){var e=this.fieldDBtype||this._id||"UNKNOWNTYPE";console.warn(e.toUpperCase()+" TODO: "+a),b&&console.warn(b),c&&console.warn(c),d&&console.warn(d)},h.popup=function(a){try{alert(a)}catch(b){this.warn(" Couldn't tell user about a popup: "+a)}var c=this.fieldDBtype||this._id||"UNKNOWNTYPE";console.log(c.toUpperCase()+" POPUP: "+a)},h.bug=function(a){try{alert(a)}catch(b){this.warn(" Couldn't tell user about a bug: "+a)}var c=this.fieldDBtype||this._id||"UNKNOWNTYPE";console.error(c.toUpperCase()+" BUG: "+a)},h.warn=function(a,b,c,d){var e=this.fieldDBtype||this._id||"UNKNOWNTYPE";console.warn(e.toUpperCase()+" WARN: "+a),
b&&console.warn(b),c&&console.warn(c),d&&console.warn(d)},h.prompt=function(a,b,c){var d=f.defer(),e=this;return f.nextTick(function(){var f;if(void 0!==e.alwaysReplyToPrompt)f=c||e.alwaysReplyToPrompt,console.warn(e.fieldDBtype.toUpperCase()+" NOT PROMPTING USER: "+a+" \nThe code decided that they would probably reply `"+f+"` and it wasnt worth prompting.");else try{if(f=prompt(a,c),"yes"===f)f=c;else if(null!==f&&"string"!=typeof c&&"number"!=typeof c)try{var g=JSON.parse(f);f=g}catch(h){FieldDB.FieldDBObject.bug("There was a problem parsing your input.").then(function(){FieldDB.FieldDBObject.prompt(a,b,c)})}}catch(h){f=null,console.warn(e.fieldDBtype.toUpperCase()+" UNABLE TO PROMPT USER: "+a+" pretending they said `"+f+"`")}null!==f&&void 0!==f&&"function"==typeof f.trim&&(f=f.trim()),f?d.resolve({message:a,optionalLocale:b,response:f}):d.reject({message:a,optionalLocale:b,response:f})}),d.promise},h.confirm=function(a,b){var c=f.defer(),d=this;return f.nextTick(function(){var e;if(d.alwaysConfirmOkay)console.warn(d.fieldDBtype.toUpperCase()+" NOT ASKING USER: "+a+" \nThe code decided that they would probably yes and it wasnt worth asking."),e=d.alwaysConfirmOkay;else try{e=confirm(a)}catch(f){console.warn(d.fieldDBtype.toUpperCase()+" UNABLE TO ASK USER: "+a+" pretending they said "+d.alwaysConfirmOkay),e=d.alwaysConfirmOkay}e?c.resolve({message:a,optionalLocale:b,response:e}):c.reject({message:a,optionalLocale:b,response:e})}),c.promise},h.uuidGenerator=function(){var a=function(){return(65536*(1+Math.random())|0).toString(16).substring(1)};return Date.now()+(a()+a()+a()+a()+a()+a()+a()+a())},h.regExpEscape=function(a){return String(a).replace(/([-()\[\]{}+?*.$\^|,:#<!\\])/g,"\\$1").replace(/\x08/g,"\\x08")},h.getHumanReadableTimestamp=function(){var a=new Date,b=a.getFullYear(),c=a.getMonth()+1,d=a.getDate(),e=a.getHours(),f=a.getMinutes();return 10>c&&(c="0"+c),10>d&&(d="0"+d),10>e&&(e="0"+e),10>f&&(f="0"+f),b+"-"+c+"-"+d+"_"+e+"."+f},h.guessType=function(a){if(!a||JSON.stringify(a)==={})return"FieldDBObject";h.debug("Guessing type "+a._id);var b=a.previousFieldDBtype||a.jsonType||a.collection||"FieldDBObject";return a.api&&a.api.length>0&&(h.debug("using api"+a.api),b=a.api[0].toUpperCase()+a.api.substring(1,a.api.length)),b=b.replace(/s$/,""),b=b[0].toUpperCase()+b.substring(1,b.length),"Datalist"===b&&(b="DataList"),"FieldDBObject"===b&&(a.session?(b="Datum",a.fields&&"judgement"===a.fields[0]&&(b="LanguageDatum")):a.datumFields&&a.sessionFields?b="Corpus":"sessions"===a.collection&&a.sessionFields?b="Session":a.text&&a.username&&a.timestamp&&a.gravatar?b="Comment":a.symbol&&void 0!==a.tipa&&(b="UnicodeSymbol")),h.debug("Guessed type "+a._id+" is a "+b),b},h.convertDocIntoItsType=function(a,b){var c,d=Object.prototype.toString.call(a);if(b){var e;if("function"==typeof a.clone)e=a.clone(),a=new a.constructor(e);else{if("[object Boolean]"===d)return!!a;if("[object String]"===d)return a+"";if("[object Number]"===d)return a+0;if("[object Date]"===d)return new Date(a);if("[object Array]"===d)return a.concat([]);b=a.toJSON?a.toJSON():a,a=new a.constructor(b)}}else{if("[object Boolean]"===d)return a;if("[object String]"===d)return a;if("[object Number]"===d)return a;if("[object Date]"===d)return a;if("[object Array]"===d)return a}if("function"==typeof a.debug&&a.constructor!==h)return a;try{if(c=a.fieldDBtype,c&&"FieldDBObject"!==c||(h.debug(" requesting guess type "),c=h.guessType(a),h.debug("request complete")),h.debug("Converting doc into type "+c),FieldDB&&FieldDB[c]){if(a instanceof FieldDB[c])return a;a=new FieldDB[c](a)}else a=new h(a),h.debug("This doc does not have a type than is known to the FieldDB system. It might display oddly ",a)}catch(f){h.debug("Couldn't convert this doc to its type "+c+", it will be a base FieldDBObject: "+JSON.stringify(a)),h.debug(" error: ",f);var g=a.previousFieldDBtype?a.previousFieldDBtype.replace(/s$/,""):"";"FieldDBObject"!==c&&c!==g&&(a.previousFieldDBtype=a.previousFieldDBtype||"",a.previousFieldDBtype=a.previousFieldDBtype+c),a=new h(a)}return a},h.prototype=Object.create(Object.prototype,{constructor:{value:h},fieldDBtype:{configurable:!0,get:function(){return this._fieldDBtype||"FieldDBObject"},set:function(a){a!==this.fieldDBtype&&this.debug("Using type "+this.fieldDBtype+" when the incoming object was "+a)}},debugMode:{get:function(){return void 0===this.perObjectDebugMode?!1:this.perObjectDebugMode},set:function(a){return a!==this.perObjectDebugMode?null===a||void 0===a?void delete this.perObjectDebugMode:void(this.perObjectDebugMode=a):void 0}},debug:{value:function(){this.debugMode&&h.debug.apply(this,arguments)}},verboseMode:{get:function(){return void 0===this.perObjectVerboseMode?!1:this.perObjectVerboseMode},set:function(a){return a!==this.perObjectVerboseMode?null===a||void 0===a?void delete this.perObjectVerboseMode:void(this.perObjectVerboseMode=a):void 0}},verbose:{value:function(){this.verboseMode&&h.verbose.apply(this,arguments)}},bug:{value:function(a){if(this.bugMessage){if(this.bugMessage.indexOf(a)>-1)return void this.warn("Not repeating bug message: "+a);this.bugMessage+=";;; "}else this.bugMessage="";this.bugMessage=this.bugMessage+a,h.bug.apply(this,arguments)}},popup:{value:function(a){if(this.popupMessage){if(this.popupMessage.indexOf(a)>-1)return void this.warn("Not repeating popup message: "+a);this.popupMessage+=";;; "}else this.popupMessage="";this.popupMessage=this.popupMessage+a,h.popup.apply(this,arguments)}},alwaysConfirmOkay:{get:function(){return void 0===this.perObjectAlwaysConfirmOkay?!1:this.perObjectAlwaysConfirmOkay},set:function(a){return a!==this.perObjectAlwaysConfirmOkay?null===a||void 0===a?void delete this.perObjectAlwaysConfirmOkay:void(this.perObjectAlwaysConfirmOkay=a):void 0}},prompt:{value:function(a){return this.promptMessage?this.promptMessage+="\n":this.promptMessage="",this.promptMessage=this.promptMessage+a,h.prompt.apply(this,arguments)}},confirm:{value:function(a){return this.confirmMessage?this.confirmMessage+="\n":this.confirmMessage="",this.confirmMessage=this.confirmMessage+a,h.confirm.apply(this,arguments)}},warn:{value:function(a){this.warnMessage?this.warnMessage+=";;; ":this.warnMessage="",this.warnMessage=this.warnMessage+a,h.warn.apply(this,arguments)}},todo:{value:function(){h.todo.apply(this,arguments)}},decryptedMode:{get:function(){return this.application?this.application.decryptedMode:this._decryptedMode},set:function(a){this.application?this.application.decryptedMode=a:this._decryptedMode=a}},render:{configurable:!0,writable:!0,value:function(a){this.debug("Calling render with options",a),h.render.apply(this,arguments)}},ensureSetViaAppropriateType:{value:function(a,b,c){if(this.debug("ensureSetViaAppropriateType on "+a,this.INTERNAL_MODELS),!a)throw console.error("Invalid call to ensureSetViaAppropriateType",b),new Error("Invalid call to ensureSetViaAppropriateType");return c=c||"_"+a,b===this[c]?this[c]:b?(!this.INTERNAL_MODELS||!this.INTERNAL_MODELS[a]||"function"!=typeof this.INTERNAL_MODELS[a]||b instanceof this.INTERNAL_MODELS[a]||this.INTERNAL_MODELS[a].compatibleWithSimpleStrings&&"string"==typeof b||(this.debug("Converting this into  type for "+a,b.constructor.toString()),b=new this.INTERNAL_MODELS[a](b)),"function"==typeof b.trim&&(b=b.trim()),this[c]=b,this[c]):void delete this[c]}},unsaved:{get:function(){return this._unsaved},set:function(a){this._unsaved=!!a}},calculateUnsaved:{value:function(){if(!this.fossil)return void(this._unsaved=!0);var a=new this.constructor(this.fossil),b=new this.constructor(this.toJSON());return b.debugMode=this.debugMode,a.equals(b)?(this.warn("The "+this.id+" didnt actually change. Not marking as edited"),this._unsaved=!1):this._unsaved=!0,this._unsaved}},createSaveSnapshot:{value:function(c,d){var e=this;c=this,this.debug("    Running snapshot..."),c.version=h.DEFAULT_VERSION;try{h.software=h.software||{},h.software.appCodeName=navigator.appCodeName,h.software.appName=navigator.appName,h.software.appVersion=navigator.appVersion,h.software.cookieEnabled=navigator.cookieEnabled,h.software.doNotTrack=navigator.doNotTrack,h.software.hardwareConcurrency=navigator.hardwareConcurrency,h.software.language=navigator.language,h.software.languages=navigator.languages,h.software.maxTouchPoints=navigator.maxTouchPoints,h.software.onLine=navigator.onLine,h.software.platform=navigator.platform,h.software.product=navigator.product,h.software.productSub=navigator.productSub,h.software.userAgent=navigator.userAgent,h.software.vendor=navigator.vendor,h.software.vendorSub=navigator.vendorSub,navigator&&navigator.geolocation&&"function"==typeof navigator.geolocation.getCurrentPosition&&navigator.geolocation.getCurrentPosition(function(a){e.debug("recieved position information"),h.software.location=a.coords})}catch(f){this.debug("Error loading software ",f),h.software=h.software||{},h.software.version=b.version,h.software.appVersion="PhantomJS unknown";try{var g=a,i=g("os");h.hardware=h.hardware||{},h.hardware.endianness=i.endianness(),h.hardware.platform=i.platform(),h.hardware.hostname=i.hostname(),h.hardware.type=i.type(),h.hardware.arch=i.arch(),h.hardware.release=i.release(),h.hardware.totalmem=i.totalmem(),h.hardware.cpus=i.cpus().length}catch(f){this.debug(" hardware is unknown.",f),h.hardware=h.hardware||{},h.software.appVersion="Device unknown"}}if(!d){d={name:"",username:"unknown"};try{this.corpus&&this.corpus.connectionInfo&&this.corpus.connectionInfo.userCtx?d.username=this.corpus.connectionInfo.userCtx.name:h.application&&h.application.user&&h.application.user.username&&(d.username=d.username||h.application.user.username,d.gravatar=d.gravatar||h.application.user.gravatar)}catch(f){this.warn("Can't get the corpus connection info to guess who saved this.",f)}}if("function"==typeof d.toJSON){var j=d.toJSON();j.name=d.name,d=j}else d.name=d.name;this.debug("    Calculating userWhoSaved...");var k={username:d.username,name:d.name,lastname:d.lastname,firstname:d.firstname,gravatar:d.gravatar};if(c._rev){c._dateModified=Date.now();var l=c.modifiedByUser||{};c.fields&&c.fields.modifiedbyuser?l=c.fields.modifiedbyuser:c.modifiedByUser||(c.modifiedByUser=l),c.modifiedByUsers&&(l={json:{users:c.modifiedByUsers}},delete c.modifiedByUsers),l.value=l.value?l.value+", ":"",l.value+=k.name||k.username,l.json=l.json||{},l.users&&(l.json.users=l.users,delete l.users),l.json.users=l.json.users||[],k.software=h.software,k.hardware=h.hardware,l.json.users.push(k)}else{c._dateCreated=Date.now();var m=c.enteredByUser||{};c.fields&&c.fields.enteredbyuser?m=c.fields.enteredbyuser:c.enteredByUser||(c.enteredByUser=m),m.value=k.name||k.username,m.json=m.json||{},m.json.user=k,m.json.software=h.software;try{m.json.hardware=Android?Android.deviceDetails:h.hardware}catch(f){this.debug("Cannot detect the hardware used for selfOrSnapshot save.",f),m.json.hardware=h.hardware}}if(h.software&&h.software.location){var n;c.location?n=c.location:c.fields&&c.fields.location&&(n=c.fields.location),n&&(n.json=n.json||{},n.json.previousLocations=n.json.previousLocations||[],n.json&&n.json.location&&n.json.location.latitude&&n.json.previousLocations.push(n.json.location),this.debug("overwriting location ",n),n.json.location=h.software.location,n.value=n.json.location.latitude+","+n.json.location.longitude)}return this.debug("    Serializing to send object to selfOrSnapshotbase..."),c.toJSON()}},save:{value:function(a,b,c){var d=f.defer(),e=this;if(this.fetching)return e.warn("Fetching is in process, can't save right now..."),f.nextTick(function(){d.reject("Fetching is in process, can't save right now...")}),d.promise;if(this.saving)return e.warn("Save was already in process..."),f.nextTick(function(){d.reject("Fetching is in process, can't save right now...")}),d.promise;if(b)this.debug("Not calculating if this object has changed, assuming it needs to be saved anyway.");else if(e.debug("    Checking to see if item needs to be saved.",b,this.unsaved),!this.unsaved&&!this.calculateUnsaved())return e.warn("Item hasn't really changed, no need to save..."),f.nextTick(function(){return d.resolve(e),e}),d.promise;if(!this.corpus||"function"!=typeof this.corpus.set)return e.warn("The corpus for this doc isnt acessible, this is probably a bug.",this),f.nextTick(function(){e.saving=!1,d.reject({status:406,userFriendlyErrors:["This application has errored. Please notify its developers: Cannot save data, database is not currently opened."]})}),d.promise;if(this.corpus.dbname!==this.dbname)return this.warn("This item belongs in the "+this.dbname+"database, not in the "+this.corpus.dbname+" database."),f.nextTick(function(){e.saving=!1,d.reject({status:406,userFriendlyErrors:["This item belongs in the "+e.dbname+"database, not in the "+e.corpus.dbname+" database."]})}),d.promise;c&&this.todo("Url for save was specified, but it is not being used. optionalUrl",c);var g=this.createSaveSnapshot();return g?(e.debug("    Requesting corpus to run save..."),this.saving=!0,this.whenReady=d.promise,this.corpus.set(g).then(function(a){return e.saving=!1,e.debug("    Save completed..."),e.debug("saved ",a),a?a.id?(e.unsaved=!1,e.id=a.id,e.rev=a.rev,e.debug("    Updating fossil..."),e.fossil=e.toJSON(),e.debug("    Resolving promise...",e),d.resolve(e),e):(e.debug("    Rejecting promise, the id was not set by the database .."),d.reject({status:500,userFriendlyErrors:["This application has errored. Please notify its developers: Save operation returned abnormal results."],details:a}),e):(d.reject({status:400,userFriendlyErrors:["This application has errored. Please notify its developers: Cannot save data."]}),"self")},function(a){return e.debug(a),e.saving=!1,d.reject(a),e}).fail(function(a){console.error(a.stack,e),d.reject(a)}),d.promise):(this.warn(" Can't save "+this.id+" right now. The JSON isnt ready."),f.nextTick(function(){e.saving=!1,d.reject({status:406,userFriendlyErrors:["Can't save "+this.id+" right now. Please wait."]})}),d.promise)}},"delete":{value:function(a){return this.trash(a)}},trash:{value:function(a){return this.trashed="deleted",a?this.trashedReason=a:this.todo("consider using a confirm to ask for a reason for deleting the item"),this.save(null,"forcesavesinceweneedtopersistthischange")}},undelete:{value:function(a){return this.trashed="restored",a?this.untrashedReason=a:this.todo("consider using a confirm to ask for a reason for undeleting the item"),this.save(null,"forcesavesinceweneedtopersistthischange")}},saveToGit:{value:function(a,b){var c=f.defer(),d=this;return f.nextTick(function(){d.todo("If in nodejs, write to file and do a git commit with optional user's email who modified the file and push ot a branch with that user's username",b),d.debug("Commit to be used: ",a),c.resolve(d)}),c.promise}},equals:{value:function(a){for(var b in this)if(this.hasOwnProperty(b)&&"function"!=typeof this[b]&&!h.ignore(b,h.internalAttributesToAutoMerge)){if(!a)return!1;if(this[b]&&"function"==typeof this[b].equals){if(!this[b].equals(a[b]))return this.debug("  "+b+": ",this[b]," not equalivalent to ",a[b]),this.debugMode&&console.error("objects are not equal stactrace"),!1}else if(this[b]===a[b])this.debug(b+": "+this[b]+" equals "+a[b]);else if(JSON.stringify(this[b])===JSON.stringify(a[b]))this.debug(b+": "+this[b]+" equals "+a[b]);else{if(void 0===a[b]&&"_dateCreated"!==b&&"perObjectDebugMode"!==b)return this.debug(b+" is missing "+this[b]+" on anotherObject "+a[b]),this.debugMode&&console.error("objects are not equal stactrace"),!1;if("_dateCreated"!==b&&"perObjectDebugMode"!==b)return this.debug(b+": ",this[b]," not equal ",a[b]),this.debugMode&&console.error("objects are not equal stactrace"),!1}}else this.debug("skipping equality of "+b);return"function"!=typeof a.equals||void 0!==this.dontRecurse||(this.dontRecurse=!0,a.dontRecurse=!0,a.equals(this))?(delete this.dontRecurse,delete a.dontRecurse,!0):(this.debugMode&&console.error("objects are not equal stactrace"),!1)}},merge:{value:function(a,b,c){var d,e,g,i,j,k,l,m={};if(0===arguments.length)return this.warn("Invalid call to merge, there was no object provided to merge"),null;if(b||c)if("self"===a)this.debug("Merging properties into myself. "),d=this,e=d;else{if(!a||!b)return this.warn("Invalid call to merge, invalid arguments were provided to merge",arguments),null;d=h.convertDocIntoItsType(a),b=h.convertDocIntoItsType(b),e=this}else e=d=this,b=h.convertDocIntoItsType(a);if(c?c===!0&&(c="overwrite"):c="",d.id&&b.id&&d.id!==b.id)return this.warn("Refusing to merge these objects, they have different ids: "+d.id+"  and "+b.id),this.debug("Refusing to merge"+d.id+"  and "+b.id,d,b),null;if(d.dbname&&b.dbname&&d.dbname!==b.dbname)if(c.indexOf("keepDBname")>-1)this.warn("Permitting a merge of objects from different databases: "+d.dbname+"  and "+b.dbname),this.debug("Merging ",d,b);else if(-1===c.indexOf("changeDBname"))return this.warn("Refusing to merge these objects, they come from different databases: "+d.dbname+"  and "+b.dbname),this.debug("Refusing to merge"+d.dbname+"  and "+b.dbname,d,b),null;for(g in d)d.hasOwnProperty(g)&&"function"!=typeof d[g]&&!h.ignore(g,h.internalAttributesToNotJSONify)?m[g]=!0:this.debug("Not merging "+g,"parent ",d.parent?d.parent.length:"");for(g in b)b.hasOwnProperty(g)&&"function"!=typeof b[g]&&!h.ignore(g,h.internalAttributesToNotJSONify)?m[g]=!0:this.debug("Not merging "+g,"parent ",d.parent?d.parent.length:"");this.debug(" Merging properties: "+this.id,m);var n=function(a,g){var h=f.defer(),i=b[g];"object"==typeof i&&(i=JSON.stringify(b[g]));var j=a.id||a._id||"";a.prompt(j+" I found a conflict for "+g+", Do you want to overwrite it from "+JSON.stringify(d[g])+" -> "+i,null,i).then(function(b){"_dbname"===g&&c.indexOf("keepDBname")>-1?a.warn(" Keeping _dbname of "+e.dbname):(a.debug("Async Overwriting contents of "+g+" (this may cause disconnection in listeners)"),a.debug("Async Overwriting  ",d[g]," ->",b.response),e[g]=b.response),h.resolve(b)},function(a){e[g]=d[g],h.reject(a)}).fail(function(b){console.error(b.stack,a),h.reject(b)}),a.confirmMergePromises=a.confirmMergePromises||[],a.confirmMergePromises.push(h.promise)};for(g in m)if("function"!=typeof d[g]&&"function"!=typeof b[g])if(this.debug("  Merging ---"+g+"--- \n   :::"+JSON.stringify(e[g])+":::\n   :::"+JSON.stringify(d[g])+":::\n   :::"+JSON.stringify(b[g])+":::"),(void 0===e[g]||null===e[g])&&(void 0!==d[g]&&null!==d[g]?"string"!=typeof d[g]&&"function"==typeof d[g].constructor?(l=d[g].toJSON?d[g].toJSON():d[g],e[g]=new d[g].constructor(l),this.debug(" "+g+" resultObject will have anObject's Cloned contents because it was empty")):(e[g]!=d[g]&&(e[g]=d[g]),this.debug(" "+g+" resultObject will have anObject's contents because it was empty")):void 0!==b[g]&&null!==b[g]&&(this.debug("Using a constructor"),"self"===a?e[g]=h.convertDocIntoItsType(b[g]):(this.debug("use clone only if not merging self."),e[g]=h.convertDocIntoItsType(b[g],"clone")))),this.debugMode&&this.debug("  Merging ---"+g+"--- \n   :::"+JSON.stringify(e[g])+":::\n   :::"+JSON.stringify(d[g])+":::\n   :::"+JSON.stringify(b[g])+":::"),d[g]!=b[g])if(void 0!==b[g]&&null!==b[g]||e[g]==d[g])if(!b[g]||void 0!==d[g]&&null!==d[g]&&d[g]!==[]&&0!==d[g].length&&d[g]!=={})if(void 0===d[g]&&null===d[g]||void 0!==b[g]&&null!==b[g]&&b[g]!==[]&&0!==b[g].length&&b[g]!=={})if("[object Array]"!==Object.prototype.toString.call(d[g])||"[object Array]"!==Object.prototype.toString.call(b[g]))if(e[g]&&"function"==typeof e[g].merge){k="self"===a?a:d[g],this.debug("Requesting recursive merge of internal property "+g+" using method: "+k);try{var o=e[g].merge(k,b[g],c);this.debug("after internal merge ",o),this.debug("after internal merge ",e[g])}catch(p){console.warn("problem merging this "+g,p.stack)}}else j=c,this.debug("Found conflict for "+g+" Requested with "+c+" "+c.indexOf("overwrite")),-1!==c.indexOf("overwrite")||h.ignore(g,h.internalAttributesToAutoMerge)||n(this,g),j||h.ignore(g,h.internalAttributesToAutoMerge)?"_dbname"===g&&c.indexOf("keepDBname")>-1?this.warn(" Keeping _dbname of "+e.dbname):(h.ignore(g,h.internalAttributesToAutoMerge)||this.debug("Overwriting contents of "+g+" (this may cause disconnection in listeners)"),this.debug("Overwriting  ",d[g]," ->",b[g]),e[g]=b[g]):e[g]!=d[g]&&(e[g]=d[g]);else{this.debug(g+" was an array, concatinating with the new value",d[g]," ->",b[g]),e[g]=d[g].concat([]);try{b[g].map(function(a){-1===e[g].indexOf(a)&&e[g].push(a)})}catch(p){console.warn("problem merging this array "+g,p)}this.debug("  added members of anotherObject "+g+" to anObject ",e[g])}else i=!0,this.debug(g+" target is empty, taking the old value"),e[g]!=d[g]&&(e[g]=d[g]);else i=!0,this.debug(g+" was previously empty, taking the new value"),e[g]=b[g];else this.debug(g+" was missing in new object, using the original"),e[g]!=d[g]&&(e[g]=d[g]);else this.debug(g+" were equal or had no conflict."),e[g]!=d[g]&&(e[g]=d[g]);else this.debug("  Ignoring ---"+g+"----");return e}},fetchRevisions:{value:function(a){var b=f.defer(),c=this;return this._id?this.corpus&&"function"==typeof this.corpus.fetchRevisions?(c.corpus.fetchRevisions(this.id,a).then(function(a){c._revisions?a.map(function(a){-1===c._revisions.indexOf(a)&&c._revisions.push(a)}):c._revisions=a,c.debug("This "+c.id+" has "+c._revisions.length+" previous revisions"),b.resolve(c._revisions)},function(a){return c.warn("Unable to update list of revisions currently."),c.debug(a),b.reject(a),c}).fail(function(a){console.error(a.stack,c),b.reject(a)}),b.promise):(f.nextTick(function(){b.reject({status:406,userFriendlyErrors:["This application has errored. Please notify its developers: Cannot fetch data if the database is not currently opened."]})}),b.promise):(f.nextTick(function(){c.warn("This hasn't been saved before, so there are no previous revisisons to show you."),b.resolve(c._revisions)}),b.promise)}},fetch:{value:function(a){var b=f.defer(),c=this;if(this.fetching&&this.whenReady)return c.warn("Fetching is in process, don't need to fetch right now..."),this.whenReady;if(!this.corpus||"function"!=typeof this.corpus.get||!this._id)return f.nextTick(function(){c.fetching=c.loading=!1,b.reject({status:406,userFriendlyErrors:["This application has errored. Please notify its developers: Cannot fetch data which has no id, or the if database is not currently opened."]})}),b.promise;this.todo("Should probably call save before fetch to create a snapshot of the item regardless of whether the save is completeable, ");var d=this.rev;return this.fetching=this.loading=!0,this.whenReady=b.promise,c.corpus.get(c.id,a).then(function(a){return c.fetching=c.loading=!1,a?(c.loaded=!0,d||!a._rev&&!a.rev?(c.warn("Cant tell if this was a placeholder, calling merge and asking user if there are merge conflicts.",a),c.merge("self",a),c.debug("After merge ",c.modifiedByUser)):(c.warn(c.id+" was probabbly a placeholder (didnt have .rev before fetch, but now it does) which is now filled in, calling merge with overwrite from server."),c.merge("self",h.convertDocIntoItsType(a),"overwrite"),c.fossil=c.toJSON(),c.unsaved=!1),b.resolve(c),c):(b.reject({status:400,userFriendlyErrors:["This application has errored. Please notify its developers: Cannot fetch data url."]}),c)},function(a){return c.fetching=c.loading=!1,c.loaded=!1,c.debug("failed to fetch",a),b.reject(a),c}).fail(function(a){console.error(a.stack,c),b.reject(a)}),b.promise}},INTERNAL_MODELS:{value:{_id:h.DEFAULT_STRING,_rev:h.DEFAULT_STRING,dbname:h.DEFAULT_STRING,version:h.DEFAULT_STRING,dateCreated:h.DEFAULT_DATE,dateModified:h.DEFAULT_DATE,comments:h.DEFAULT_COLLECTION}},application:{get:function(){return h.application},set:function(){}},corpus:{get:function(){var a=null;if(this.resumeAuthenticationSession&&"function"==typeof this.resumeAuthenticationSession)a=this,this.debug("this "+this._id+" has the functions of a corpus, using it.",a);else if(this._corpus)a=this._corpus,this.debug("this "+this._id+" has a _corpus hard coded inside it, using it.",a);else if(h.application&&h.application._corpus)a=h.application._corpus,this.debug("this "+this._id+" is running in the context where FieldDBObject.application._corpus is defined, using it.",a);else try{FieldDB&&FieldDB.Database&&(this.debug("  using the Database.prototype to run db calls for "+this._id+", this could be problematic "+this._id+" ."),this.debug(" the database",a))}catch(b){var c=b?b.message:" unknown error in getting the corpus";"FieldDB is not defined"!==c&&(this.warn(this._id+"Cant get the corpus, cant find the Database class.",b),b&&this.warn("  stack trace"+b.stack))}return a||this.warn("Operations that need a corpus/database wont work for the "+this._id+" object"),a},set:function(a){return a&&a.dbname&&this.dbname&&a.dbname!==this.dbname?void this.warn("The corpus "+a.db+" cant be set on this item, its db is different"+this.dbname):(this.debug("setting corpus ",a),void(this._corpus=a))}},id:{get:function(){return this._id||h.DEFAULT_STRING},set:function(a){if(a!==this._id){if(!a)return void delete this._id;a.trim&&(a=a.trim()),this._id=a}}},rev:{get:function(){return this._rev||h.DEFAULT_STRING},set:function(a){if(a!==this._rev){if(!a)return void delete this._rev;a.trim&&(a=a.trim()),this._rev=a}}},dbname:{get:function(){return this._dbname||h.DEFAULT_STRING},set:function(a){if(a!==this._dbname){if(this._dbname&&"default"!==this._dbname&&this.rev)throw new Error("This is the "+this._dbname+". You cannot change the dbname of an object in this corpus to "+a+", you must create a clone of the object first.");if(!a)return void delete this._dbname;a.trim&&(a=a.trim()),this._dbname=a}}},pouchname:{get:function(){return this.debug("Pouchname is deprecated, use dbname instead."),this.dbname},set:function(a){this.debug("Pouchname is deprecated, please use dbname instead."),this.dbname=a}},couchConnection:{get:function(){return console.error("CouchConnection is deprecated, use connection instead "+this.id),this.connection},set:function(a){this.connection=a}},version:{get:function(){return this._version||h.DEFAULT_VERSION},set:function(a){a!==this._version&&(a||(a=h.DEFAULT_VERSION),a.trim&&(a=a.trim()),this._version=a)}},timestamp:{get:function(){return this._timestamp||this._dateCreated},set:function(a){if(a!==this._timestamp&&a){if(a.replace)try{a=a.replace(/["\\]/g,""),a=new Date(a),a=a.getTime()}catch(b){this.warn("Upgraded timestamp"+a)}this._timestamp=a,(!this._dateCreated||this._dateCreated>a)&&(this.debug("Timestmap was older than dateCreated",this._dateCreated),this._dateCreated=a)}}},created_at:{get:function(){return this.warn("created_at is deprecated use dateCreated instead"),this._created_at},set:function(a){this._created_at=a,this.dateCreated=a}},dateCreated:{get:function(){return this._dateCreated||h.DEFAULT_DATE},set:function(a){if(a!==this._dateCreated&&a){if(a.replace)try{a=a.replace(/["\\]/g,""),a=new Date(a),a=a.getTime()}catch(b){this.warn("Upgraded dateCreated"+a)}return this._dateCreated||this._dateCreated<a?void this.warn("not setting _dateCreated, the new value is more recent",this._dateCreated,a):void(this._dateCreated=a)}}},updated_at:{get:function(){return this.warn("updated_at is deprecated use dateModified instead"),this._updated_at},set:function(a){this._updated_at=a,this.dateModified=a}},dateModified:{get:function(){return this._dateModified||h.DEFAULT_DATE},set:function(a){if(a!==this._dateModified){if(!a)return void delete this._dateModified;if(a.replace)try{a=a.replace(/["\\]/g,""),a=new Date(a),a=a.getTime()}catch(b){this.warn("Upgraded dateModified"+a)}this._dateModified=a}}},showDiffs:{value:function(a,b){this.todo("We haven't implemented the 'diff' tool yet (ie, showing the changes, letting you undo changes etc). We will do it eventually, when it becomes a priority. <a target='blank'  href='https://github.com/FieldDB/FieldDB/issues/124'>You can vote for it in our issue tracker</a>.  We use the <a target='blank' href='"+this.url+"/"+a+"?rev="+b+"'>Futon User Interface</a> directly to track revisions in the data, you can too (if your a power user type).","alert","Track Changes:")}},comments:{get:function(){return this._comments||h.DEFAULT_COLLECTION},set:function(a){if(a!==this._comments){if(!a)return void delete this._comments;"function"==typeof this.INTERNAL_MODELS.comments&&"[object Array]"===Object.prototype.toString.call(a)&&(a=new this.INTERNAL_MODELS.comments(a)),this._comments=a}}},isEmpty:{value:function(a){var b=!this[a]||this[a]===h.DEFAULT_COLLECTION||this[a]===h.DEFAULT_ARRAY||this[a]===h.DEFAULT_OBJECT||this[a]===h.DEFAULT_STRING||this[a]===h.DEFAULT_DATE||void 0!==this[a].length&&0===this[a].length||this[a]==={};return b}},toJSON:{value:function(a,b,c){try{var d,e,f={fieldDBtype:this.fieldDBtype};this.fetching&&(this.warn("Cannot get json while "+this.id+" is fetching itself"),this.debug(" this is the object",this)),this.version=this.version,this.useIdNotUnderscore?f.id=this.id:f._id=this.id,c||(c=[]),c=c.concat(h.internalAttributesToNotJSONify),this.debug("Ignoring for json ",c);for(d in this)this.hasOwnProperty(d)&&"function"!=typeof this[d]&&!h.ignore(d,c)&&(e=d.replace(/^_/,""),("id"===e||"rev"===e)&&(e="_"+e),(!b||b&&!this.isEmpty(d))&&(this[d]&&"function"==typeof this[d].toJSON?f[e]=this[d].toJSON(a,b):f[e]=this[d]));if(a)for(d in this.INTERNAL_MODELS)!f[d]&&this.INTERNAL_MODELS&&(this.INTERNAL_MODELS[d]&&"function"==typeof this.INTERNAL_MODELS[d]&&"function"==typeof(new this.INTERNAL_MODELS[d]).toJSON?f[d]=(new this.INTERNAL_MODELS[d]).toJSON(a,b,c):f[d]=this.INTERNAL_MODELS[d]);f._id||delete f._id,this.useIdNotUnderscore&&delete f._id,f._rev||delete f._rev,f.dbname&&(f.pouchname=f.dbname,this.debug("Serializing Pouchname for backward compatability until prototype can handle dbname"));for(var g in h.internalAttributesToNotJSONify)h.internalAttributesToNotJSONify.hasOwnProperty(g)&&(delete f[h.internalAttributesToNotJSONify[g]],delete f[h.internalAttributesToNotJSONify[g].replace(/^_/,"")]);return"private_corpora"!==this.collection||"private_corpora"!==this.api?(delete f.confidential,delete f.confidentialEncrypter):this.warn("serializing confidential in this object "+this._collection),this.api&&(f.api=this.api),f.fieldDBtype=this.fieldDBtype,f.previousFieldDBtype&&f.fieldDBtype&&f.previousFieldDBtype===f.fieldDBtype&&delete f.previousFieldDBtype,c.indexOf("fieldDBtype")>-1&&delete f.fieldDBtype,f}catch(i){return console.warn(i),console.error(i.stack),this.bug("Unable to serialze "+this.id+". Please report this."),null}}},addRelatedData:{value:function(a){var b;this.fields&&this.fields.relatedData?b=this.fields.relatedData.json.relatedData||[]:this.relatedData?b=this.relatedData:this.relatedData=b=[],a.relation="associated file",b.push(a)}},clone:{value:function(a){var b,c,d={};try{d=JSON.parse(JSON.stringify(this.toJSON(a)))}catch(e){e&&(console.warn(e),console.warn(e.stack),console.warn(e.message),console.warn(this))}for(b in d)c=b.replace(/^_/,""),this[b]&&"function"==typeof this[b].clone&&(d[c]=JSON.parse(JSON.stringify(this[b].clone(a))));var f=this.id;if(this.id&&this.rev){var g;d.fields&&d.fields.relatedData?g=d.fields.relatedData.json.relatedData||[]:d.relatedData?g=d.relatedData:d.relatedData=g=[],this.rev?f=f+"?rev="+this.rev:this.parent&&this.parent._rev&&(f="parent"+this.parent._id+"?rev="+this.parent._rev),g.push({relation:"clonedFrom",URI:f})}return delete d._id,delete d._rev,delete d.parent,delete d.dbname,delete d.pouchname,new this.constructor(d)}},contextualizer:{get:function(){return this.application&&this.application.contextualizer?this.application.contextualizer:void 0},set:function(){}},sanitizeStringForFileSystem:{value:function(a,b){return this.debug("sanitizeStringForPrimaryKey "+a),a?((void 0===b||"-"===b)&&(b="_"),a.trim?(a=e.remove(a),this.debug("sanitizeStringForPrimaryKey "+a),a=a.trim().replace(/[^-a-zA-Z0-9]+/g,b).replace(/^_/,"").replace(/_$/,""),this.debug("sanitizeStringForPrimaryKey "+a),a):"number"==typeof a?parseFloat(a,10):null):null;
}},sanitizeStringForPrimaryKey:{value:function(a,b){return this.debug("sanitizeStringForPrimaryKey "+a),a?(a.replace&&(a=a.replace(/-/g,"_")),a=this.sanitizeStringForFileSystem(a,b),a&&"number"!=typeof a?this.camelCased(a):void 0):null}},camelCased:{value:function(a){return a?(a.replace&&(a=a.replace(/_([a-zA-Z])/g,function(a){return a[1].toUpperCase()}),a=a[0].toLowerCase()+a.substring(1,a.length)),a):null}}}),c.FieldDBObject=h,c.Document=h}).call(this,a("_process"))},{"./../package.json":260,_process:215,diacritics:149,q:223}],5:[function(a,b,c){var d=d||{};d.routes=d.routes||[],d.routes.push({path:"/faq",angularRoute:{templateUrl:"app/components/help/faq.html",controller:"OverrideYourControllerHere"}}),d.routes.push({path:"/:team/:corpusidentifier/import/:importType",angularRoute:{templateUrl:"app/components/import/import-page.html",controller:"OverrideYourControllerHere"}}),d.routes.push({path:"/:team/:corpusidentifier/import",angularRoute:{redirectTo:"/:team/:corpusidentifier/import/data"}}),d.routes.push({path:"/:team/:corpusidentifier/reports/:reportType",angularRoute:{templateUrl:"app/components/experiment/reports-page.html",controller:"OverrideYourControllerHere"}}),d.routes.push({path:"/:team/:corpusidentifier/speakers/:speakerType",angularRoute:{templateUrl:"app/components/user/speakers-page.html",controller:"OverrideYourControllerHere"}}),d.routes.push({path:"/:team/:corpusidentifier/participants",angularRoute:{templateUrl:"app/components/user/participants-page.html",controller:"OverrideYourControllerHere"}}),d.routes.push({path:"/:team/:corpusidentifier/consultants",angularRoute:{templateUrl:"app/components/user/consultants-page.html",controller:"OverrideYourControllerHere"}}),d.routes.push({path:"/:team/:corpusidentifier/sessions",angularRoute:{templateUrl:"app/components/session/sessions-page.html",controller:"OverrideYourControllerHere"}}),d.routes.push({path:"/:team/:corpusidentifier/activityfeed",angularRoute:{templateUrl:"app/components/activity/activityfeed-page.html",controller:"OverrideYourControllerHere"}}),d.routes.push({path:"/:team/:corpusidentifier/activityfeed/:activityTypeOrItem",angularRoute:{templateUrl:"app/components/activity/activity-list-item.html",controller:"OverrideYourControllerHere"}}),d.routes.push({path:"/:team/:corpusidentifier/datalists",angularRoute:{templateUrl:"app/components/datalist/datalists-page.html",controller:"OverrideYourControllerHere"}}),d.routes.push({path:"/:team/:corpusidentifier/data",angularRoute:{templateUrl:"app/components/datalist/all-data-page.html",controller:"OverrideYourControllerHere"}}),d.routes.push({path:"/:team/:corpusidentifier/search/:searchQuery",angularRoute:{templateUrl:"app/components/search/search-page.html",controller:"OverrideYourControllerHere"}}),d.routes.push({path:"/:team/:corpusidentifier/:docid",angularRoute:{templateUrl:"app/components/doc/data-page.html",controller:"OverrideYourControllerHere"}}),d.routes.push({path:"/:team/:corpusidentifier",angularRoute:{templateUrl:"app/components/corpus/corpus-page.html",controller:"OverrideYourControllerHere"}}),d.routes.push({path:"/:team",angularRoute:{templateUrl:"app/components/user/team-page.html",controller:"OverrideYourControllerHere"}}),d.otherwise={redirectTo:"/"},c&&(c.Router=d)},{}],6:[function(a,b,c){var d=a("./../confidentiality_encryption/Confidential").Confidential,e=a("./../data_list/DataList").DataList,f=a("./Activity").Activity,g=a("./../corpus/Connection").Connection,h=a("./../comment/Comments").Comments,i=a("./../datum/DocumentCollection").DocumentCollection,j=a("./../corpus/Database").Database,k=a("./../locales/ContextualizableObject").ContextualizableObject,l=a("q"),m=function(){this._fieldDBtype||(this._fieldDBtype="ActivityCollection"),i.apply(this,arguments)};m.prototype=Object.create(i.prototype,{constructor:{value:m},primaryKey:{value:"whenWhatWho"},INTERNAL_MODELS:{value:{item:f}}}),c.ActivityCollection=m;var n=function(a){this._fieldDBtype||(this._fieldDBtype="Activities"),a&&a.port&&(a={connection:a}),this.debug("Constructing Activities ",a),e.apply(this,arguments)};n.prototype=Object.create(e.prototype,{constructor:{value:n},INTERNAL_MODELS:{value:{connection:g,comments:h,docs:m,title:k,description:k,database:j,confidential:d,item:f}},api:{get:function(){return"activities"},set:function(){}},primaryKey:{get:function(){return"whenWhatWho"},set:function(){}},teamOrPersonal:{get:function(){if(this._teamOrPersonal)return this._teamOrPersonal;if(this.parent&&this.parent.fieldDBtype){var a=this.parent.fieldDBtype||"";if(a=a.toLowerCase(),a.indexOf("user")>-1)return this._teamOrPersonal="personal",this._teamOrPersonal;if(a.indexOf("corpus")>-1)return this._teamOrPersonal="team",this._teamOrPersonal}if(this._connection&&"function"==typeof this._connection.guessDbType){var b=this._connection.guessDbType(this._connection.dbname);if(this.debug(" acitivyt feed guessed the db type "+b),"user_activity_feed"===b)return this._teamOrPersonal="personal",this._teamOrPersonal;if("corpus_activity_feed"===b)return this._teamOrPersonal="team",this._teamOrPersonal}},set:function(){}},connection:{get:function(){return this.debug("getting connection"),this.parent&&this.parent.connection&&"function"==typeof this.parent.connection.toJSON&&(this.connection=this.parent.connection.toJSON()),this._connection},set:function(a){this.ensureSetViaAppropriateType("connection",a),this.title=this._connection.title||"Activity feed",this.description=this._connection.description||""}},url:{get:function(){return this.connection&&this.connection.corpusUrl?this.connection.corpusUrl:void 0},set:function(a){this.connection?this.connection.corpusUrl=a:this.warn("not setting hte url",a)}},parent:{get:function(){return this._parent},set:function(a){return a!==this._parent?this.dbname&&"personal"===this.teamOrPersonal&&this.dbname!==a.username+"-activity_feed"?void this.bug("Cannot change the "+this.dbname+" activity feed to "+a.username+"-activity_feed"):this.dbname&&"team"===this.teamOrPersonal&&this.dbname!==a.dbname+"-activity_feed"?void this.bug("Cannot change the "+this.dbname+" activity feed to "+a.dbname+"-activity_feed"):void(a&&(this._parent=a,a&&a.set&&a.get&&"team"===this.teamOrPersonal&&(this._database=a))):void 0}},confidential:{get:function(){return this.debug("getting confidential"),this.parent&&this.parent.confidential?this.parent.confidential:void this.warn("Activites can only be viewed in masked form in this app. The parent of the activity feed is not defined.")},set:function(){}},database:{get:function(){return this.debug("getting database"),this._database},set:function(a){this.ensureSetViaAppropriateType("database",a)}},dbname:{get:function(){return this.parent&&"personal"===this.teamOrPersonal?this.parent.username+"-activity_feed":this.parent&&"team"===this.teamOrPersonal?this.parent.dbname+"-activity_feed":this._connection&&this._connection.dbname?this._connection.dbname:this._dbname?this._dbname:void 0},set:function(a){return a!==this._dbname?this.parent&&"personal"===this.teamOrPersonal&&a!==this.parent.dbname+"-activity_feed"?void this.bug("Cannot change the "+this.parent.dbname+"-activity_feed to "+a):void(a&&(this._dbname=a)):void 0}},add:{value:function(a,b){if(a.url&&a.url!==this.url)return void this.bug("Cannot add "+a.url+" activity to "+this.url+" server, please report this. ");if(a.dbname&&a.dbname!==this.dbname)return void this.bug("Cannot add "+a.dbname+" activity to "+this.dbname+" activity feed, please report this. ");if(!a.parent&&this.parent&&(a.parent=this.parent),a.dbname=this.dbname,a.fieldDBtype="Activity",this.debug("adding activity",a),a.timestamp=Date.now(),!a.user){if(!b){b={name:"",username:"unknown"};try{this.corpus&&this.corpus.connectionInfo&&this.corpus.connectionInfo.userCtx?b.username=this.corpus.connectionInfo.userCtx.name:this.application&&this.application.user&&this.application.user.username&&(b.username=b.username||this.application.user.username,b.gravatar=b.gravatar||this.application.user.gravatar)}catch(c){this.warn("Can't get the corpus connection info to guess who saved this.",c)}}if("function"==typeof b.toJSON){var d=b.toJSON();d.name=b.name,b=d}else b.name=b.name;a.user={username:b.username,name:b.name,lastname:b.lastname,firstname:b.firstname,gravatar:b.gravatar}}a.parent=this;var f;try{f=e.prototype.add.apply(this,[a])}catch(c){this.warn("Error adding this activity",c);var g=c?c.message:" Error adding this activity.";c&&console.error(c.stack),this.warn(g),a.errorMessage=g}return f?(this._database&&(f.corpus=this._database),f.rev||(f.debug("This activity "+f.directobject+" has no evidence of having been saved before, makeing its fossil empty to trigger save."),f.unsaved=!0,f.fossil={},f.debug("This activity",f)),f):f?void 0:(this.incompleteActivitesStockPile=this.incompleteActivitesStockPile||[],delete a.parent,void this.incompleteActivitesStockPile.push({activity:a,errorMessage:a.errorMessage||"Activity was not added."}))}},save:{value:function(){var a=l.defer(),b=this;if(this.whenReady=a.promise,this.saving=!0,!this._docs||0===this._docs.length)return this.warn("Save was unncessary, the activity feed was empty..."),l.nextTick(function(){return b.saving=!1,a.resolve(b),b}),a.promise;try{this._docs.save(null,null,this.url).done(function(){return b.saving=!1,a.resolve(b),b}),this.warn("Requested save of activity feed",this.whenReady)}catch(c){console.log("problem saving activity feed"),console.error(c)}return a.promise}},toJSON:{value:function(a,b){this.debug("Customizing toJSON ",a,b);var c;return this.connection&&"function"==typeof this.connection.toJSON?(c=this.connection.toJSON.apply(this.connection,arguments),c.dbname=this.dbname):c=(new g).toJSON(a,b),this.debug(c),c}}}),c.Activities=n},{"./../comment/Comments":17,"./../confidentiality_encryption/Confidential":18,"./../corpus/Connection":21,"./../corpus/Database":25,"./../data_list/DataList":30,"./../datum/DocumentCollection":41,"./../locales/ContextualizableObject":58,"./Activity":7,q:223}],7:[function(a,b,c){var d=a("./../FieldDBObject").FieldDBObject,e=a("./../user/UserMask").UserMask,f=a("./../CORS").CORS,g=a("q"),h=function(a){this._fieldDBtype||(this._fieldDBtype="Activity"),this.debug("Constructing Activity ",a),d.apply(this,arguments),this.timestamp||(this.timestamp=Date.now()),this.verbicon||(this.verbicon=this.verbicon)};h.uuidGenerator=d.uuidGenerator,h.prototype=Object.create(d.prototype,{constructor:{value:h},build:{value:function(a){this.timestamp=Date.now(),this.user={gravatar:a.gravatar,username:a.username}}},api:{value:"activities"},whenWhatWho:{get:function(){if(this.id)return this.id;var a="";if(this.timestamp&&(a+=this.timestamp,this.verb))return a+=this.verb,this.directobject&&(a+=this.directobject),this.user&&this.user.username&&(a+=this.user.username),a}},defaults:{value:{verb:{create:{verb:"added",verbmask:"did something",verbicon:"icon-plus",directobject:"something",directobjecturl:"",directobjectmask:"to something",directobjecticon:"icon-circle-o",indirectobject:"in something",indirectobjecturl:"",indirectobjectmask:"in something",indirectobjecticon:"icon-square-o"},record:{verb:"recorded",verbmask:"did something",verbicon:"icon-microphone",directobject:"something",directobjecturl:"",directobjectmask:"to something",directobjecticon:"icon-circle-o",indirectobject:"in something",indirectobjecturl:"",indirectobjectmask:"in something",indirectobjecticon:"icon-square-o"},video:{verb:"videoed",verbmask:"did something",verbicon:"icon-video-camera",directobject:"something",directobjecturl:"",directobjectmask:"to something",directobjecticon:"icon-circle-o",indirectobject:"in something",indirectobjecturl:"",indirectobjectmask:"in something",indirectobjecticon:"icon-square-o"},photo:{verb:"photographed",verbmask:"did something",verbicon:"icon-camera",directobject:"something",directobjecturl:"",directobjectmask:"to something",directobjecticon:"icon-circle-o",indirectobject:"in something",indirectobjecturl:"",indirectobjectmask:"in something",indirectobjecticon:"icon-square-o"},requestedRecognition:{verb:"used speech recognier",verbmask:"did something",verbicon:"icon-microphone",directobject:"something",directobjecturl:"",directobjectmask:"to something",directobjecticon:"icon-circle-o",indirectobject:"in something",indirectobjecturl:"",indirectobjectmask:"in something",indirectobjecticon:"icon-square-o"},recievedRecognition:{verb:"recieved an ASR result",verbmask:"did something",verbicon:"icon-refresh",directobject:"something",directobjecturl:"",directobjectmask:"to something",directobjecticon:"icon-circle-o",indirectobject:"in something",indirectobjecturl:"",indirectobjectmask:"in something",indirectobjecticon:"icon-square-o"},share:{verb:"added",verbmask:"added",verbicon:"icon-key",directobject:"someone",directobjecturl:"",directobjectmask:"someone",directobjecticon:"icon-user",indirectobject:"as a role",indirectobjecturl:"#team",indirectobjectmask:"as a role",indirectobjecticon:"icon-cloud"},"import":{verb:"imported",verbmask:"did something",verbicon:"icon-folder-open",directobject:"something",directobjecturl:"",directobjectmask:"to something",directobjecticon:"icon-circle-o",indirectobject:"in something",indirectobjecturl:"",indirectobjectmask:"in something",indirectobjecticon:"icon-square-o"},view:{verb:"viewed",verbmask:"did something",verbicon:"icon-eye",directobject:"something",directobjecturl:"",directobjectmask:"to something",directobjecticon:"icon-circle-o",indirectobject:"in something",indirectobjecturl:"",indirectobjectmask:"in something",indirectobjecticon:"icon-square-o"},download:{verb:"downloaded",verbmask:"did something",verbicon:"icon-download",directobject:"something",directobjecturl:"",directobjectmask:"to something",directobjecticon:"icon-circle-o",indirectobject:"in something",indirectobjecturl:"",indirectobjectmask:"in something",indirectobjecticon:"icon-square-o"},modify:{verb:"modified",verbmask:"did something",verbRevisionBefore:"itemrevbefore",verbRevisionAfter:"itemrevafter",verbicon:"icon-pencil",directobject:"something",directobjectId:"",directobjectmask:"to something",directobjecticon:"icon-circle-o",indirectobject:"in something",indirectobjectId:"",indirectobjectmask:"in something",indirectobjecticon:"icon-square-o"},remove:{verb:"removed",verbmask:"did something",verbicon:"icon-times-circle",directobject:"something",directobjecturl:"",directobjectmask:"to something",directobjecticon:"icon-circle-o",indirectobject:"in something",indirectobjecturl:"",indirectobjectmask:"in something",indirectobjecticon:"icon-square-o"},"delete":{verb:"deleted",verbmask:"did something",verbicon:"icon-plus",directobject:"something",directobjecturl:"",directobjectmask:"to something",directobjecticon:"icon-circle-o",indirectobject:"in something",indirectobjecturl:"",indirectobjectmask:"in something",indirectobjecticon:"icon-square-o"},login:{verb:"logged in",verbmask:"did something",verbicon:"icon-check",directobject:"something",indirectobject:"to something",indirectobjecturl:"",indirectobjectmask:"in something",indirectobjecticon:"icon-cloud"}},context:{prototype:"via Offline App",spreadsheet:"via Spreadsheet App",learnx:"via LearnX App",speechrecognitiontrainer:"via Kartuli Speech Recognizer",bot:"via Futon Bot"}}},INTERNAL_MODELS:{value:{user:e}},getDefaultForVerb:{value:function(a){return a?(a.replace&&a.replace(/ed$/,""),this.defaults.verb[a]?this.defaults.verb[a]:a.indexOf("log")>-1&&a.indexOf("in")>-1?this.defaults.verb.login:a.indexOf("dele")>-1?this.defaults.verb["delete"]:a.indexOf("remov")>-1?this.defaults.verb.remove:a.indexOf("modif")>-1?this.defaults.verb.modify:a.indexOf("downloa")>-1?this.defaults.verb.download:a.indexOf("view")>-1?this.defaults.verb.view:a.indexOf("import")>-1?this.defaults.verb["import"]:a.indexOf("shar")>-1?this.defaults.verb.share:a.indexOf("ASR result")>-1?this.defaults.verb.recievedRecognition:a.indexOf("used speech recognier")>-1?this.defaults.verb.requestedRecognition:a.indexOf("phot")>-1?this.defaults.verb.photo:a.indexOf("video")>-1?this.defaults.verb.video:a.indexOf("recor")>-1?this.defaults.verb.record:a.indexOf("add")>-1&&a.indexOf("creat")>-1?this.defaults.verb.create:{verb:"did something",verbmask:"did something",verbicon:"icon-bell",directobject:"something",directobjecturl:"",directobjectmask:"to something",directobjecticon:"icon-circle-o",indirectobject:"in something",indirectobjecturl:"",indirectobjectmask:"in something",indirectobjecticon:"icon-square-o"}):{}}},verb:{get:function(){return this._verb},set:function(a){a!==this._verb&&(a=this.makeLinksOpenNewWindows(a),a&&(this._verb=a))}},verbicon:{get:function(){return this._verbicon?this._verbicon:this.getDefaultForVerb(this.verb).verbicon},set:function(a){a!==this._verbicon&&(a=this.makeLinksOpenNewWindows(a),a&&(this._verbicon=a))}},directobject:{get:function(){return this._directobject},set:function(a){a!==this._directobject&&(a=this.makeLinksOpenNewWindows(a),a&&(this._directobject=a))}},indirectobject:{get:function(){return this._indirectobject},set:function(a){a!==this._indirectobject&&(a=this.makeLinksOpenNewWindows(a),a&&(this._indirectobject=a))}},context:{get:function(){return this._context},set:function(a){a!==this._context&&(a=this.makeLinksOpenNewWindows(a),a&&(this._context=a))}},makeLinksOpenNewWindows:{value:function(a){return a.replace&&(a=a.replace("href=","target='_blank' href=")),a}},timestamp:{get:function(){return this._timestamp},set:function(a){if(a!==this._timestamp){if(!a)return void delete this._timestamp;(""+a).indexOf("Z")>-1&&(a=new Date(a).getTime()),this._timestamp=a}}},corpus:{get:function(){return this._database},set:function(a){this._database=a}},createSaveSnapshot:{value:function(a,b){if(a=this,!a.user){if(!b){b={name:"",username:"unknown"};try{this.corpus&&this.corpus.connectionInfo&&this.corpus.connectionInfo.userCtx?b.username=this.corpus.connectionInfo.userCtx.name:this.application&&this.application.user&&this.application.user.username&&(b.username=b.username||this.application.user.username,b.gravatar=b.gravatar||this.application.user.gravatar)}catch(c){this.warn("Can't get the corpus connection info to guess who saved this.",c)}}if("function"==typeof b.toJSON){var e=b.toJSON();e.name=b.name,b=e}else b.name=b.name;a.user={username:b.username,name:b.name,lastname:b.lastname,firstname:b.firstname,gravatar:b.gravatar}}return a.version=d.DEFAULT_VERSION,a.toJSON()}},saveDoesntNeedCustomziation:{value:function(a,b,c){this.debug("Customizing activity save ",a);var e=g.defer(),h=this;if(this.fetching)return h.warn("Fetching is in process, can't save right now..."),g.nextTick(function(){e.reject("Fetching is in process, can't save right now...")}),e.promise;if(this.saving)return h.warn("Save was already in process..."),g.nextTick(function(){e.reject("Fetching is in process, can't save right now...")}),e.promise;if(b)this.debug("Not calculating if this object has changed, assuming it needs to be saved anyway.");else if(this.debug("    Checking to see if item needs to be saved.",b,this.unsaved),!this.unsaved&&!this.calculateUnsaved())return h.warn("Item hasn't really changed, no need to save..."),g.nextTick(function(){return e.resolve(h),h}),e.promise;if(!c&&this.parent&&this.parent.url&&(c=this.parent.url),!c)return g.nextTick(function(){h.saving=!1,e.reject({status:406,userFriendlyErrors:["This application has errored. Please notify its developers: Cannot save activity the  activity"+this.dbname+" database is not currently opened."]})}),e.promise;if(h.debug("    Calculating userWhoSaved..."),!this.user){if(!a){a={name:"",username:"unknown"};try{this.corpus&&this.corpus.connectionInfo&&this.corpus.connectionInfo.userCtx?a.username=this.corpus.connectionInfo.userCtx.name:this.application&&this.application.user&&this.application.user.username&&(a.username=a.username||this.application.user.username,a.gravatar=a.gravatar||this.application.user.gravatar)}catch(i){console.error(i),this.warn("Can't get the corpus connection info to guess who saved this.",i)}}if("function"==typeof a.toJSON){var j=a.toJSON();j.name=a.name,a=j}else a.name=a.name;this.user={username:a.username,name:a.name,lastname:a.lastname,firstname:a.firstname,gravatar:a.gravatar}}this.version=d.DEFAULT_VERSION,this.debug("saving   ",this);var k=this.toJSON();return this.saving=!0,this.whenReady=f.makeCORSRequest({type:this.id?"PUT":"POST",dataType:"json",url:c,data:k}).then(function(a){h.debug("saved ",a),h.saving=!1,a.id?(h.id=a.id,h.rev=a.rev,e.resolve(h)):e.reject(a)},function(a){h.debug(a),h.saving=!1,e.reject(a)}).fail(function(a){console.error(a.stack,h),h.saving=!1,e.reject(a)}),e.promise}},toJSON:{value:function(a,b){this.debug("Customizing activity toJSON ",a,b),this.verb=this.verb,this.directobject=this.directobject,this.indirectobject=this.indirectobject,this.context=this.context;var c=d.prototype.toJSON.apply(this,arguments);return c&&delete c.dateCreated,this.user&&(c.user={username:this.user.username,gravatar:this.user.gravatar,name:this.user.name}),this.debug(c),c}}}),c.Activity=h},{"./../CORS":1,"./../FieldDBObject":4,"./../user/UserMask":75,q:223}],8:[function(a,b,c){var d=a("./../FieldDBObject").FieldDBObject,e=a("./../activity/Activity").Activity,f=a("./../authentication/Authentication").Authentication,g=a("./../corpus/Corpus").Corpus,h=a("./../corpus/CorpusMask").CorpusMask,i=a("./../corpus/Database").Database,j=a("./../corpus/Connection").Connection,k=a("./../corpus/Corpora").Corpora,l=a("./../data_list/DataList").DataList,m=a("./../import/Import").Import,n=a("./../search/Search").Search,o=a("./../datum/Session").Session,p=a("./../Router").Router,q=a("./../locales/Contextualizer").Contextualizer,r=a("q"),s=function t(a){if(this._fieldDBtype||(this._fieldDBtype="App"),this.debug("Constructing App ",a),d.application&&d.application instanceof t&&(this.warn("You shouldn't declare two apps at one time. Overwriting previous app."),this.debug("previous app",d.application)),d.application=this,d.apply(this,arguments),!this.knownConnections||!this.knownConnections.length){this.knownConnections=new k({primaryKey:"userFriendlyServerName"});for(var b in j.knownConnections)(!b||j.knownConnections.hasOwnProperty(b))&&(this.debug("  Adding connection ",b),this.knownConnections.add(j.knownConnections[b]));this.debug("Set up knownConnections"+this.knownConnections.length)}this.selectedConnection||(this.debug("Setting up the app's selectedConnection"),i.prototype.BASE_AUTH_URL?(this.debug("Looking for a selectedConnection for "+i.prototype.BASE_AUTH_URL),this.selectedConnection=j.defaultConnection(i.prototype.BASE_AUTH_URL,"passByReference")):(this.debug("Looking for a selectedConnection based on where this is running "),this.selectedConnection=j.defaultConnection(null,"passByReference")),this.debug("Found a selectedConnection ",this.selectedConnection.corpusUrls),i.prototype.BASE_DB_URL&&-1===this.selectedConnection.corpusUrls.indexOf(i.prototype.BASE_DB_URL)&&(this.warn("Making a custom selectedConnection because the selectedConnection ",this.selectedConnection.corpusUrls," doesnt fit with the database url "+i.prototype.BASE_DB_URL),this.selectedConnection=this.selectedConnection.clone(),this.selectedConnection.corpusUrl=i.prototype.BASE_DB_URL,this.selectedConnection.userFriendlyServerName="Custom"),this.knownConnections.find(this.selectedConnection).length||(this.warn("Adding the selectedConnection to the list of knownConnections ",this.selectedConnection),this.knownConnections.unshift(this.selectedConnection))),this.speakersList=this.speakersList||new l({title:{"default":"locale_All_Speakers"},description:{"default":"This list was automatically generated by looking in the corpus."},api:"Speaker"}),this.consultantsList=this.consultantsList||new l({title:{"default":"locale_All_Language_Consultants"},description:{"default":"This list was automatically generated by looking in the corpus."},api:"Consultant"}),this.participantsList=this.participantsList||new l({title:{"default":"locale_All_Participants"},description:{"default":"This list was automatically generated by looking in the corpus."},api:"Participant"}),this.usersList=this.usersList||new l({title:{"default":"locale_All_Users"},description:{"default":"This list was automatically generated by looking in the corpus."},api:"User"}),this.sessionsList=this.sessionsList||new l({title:{"default":"locale_All_Elicitation_Sessions"},description:{"default":"This list was automatically generated by looking in the corpus."},api:"Session"}),this.datalistsList=this.datalistsList||new l({title:{"default":"locale_All_Datalists"},description:{"default":"This list was automatically generated by looking in the corpus."},api:"Datalist"}),this.datumsList=this.datumsList||new l({title:{"default":"locale_All_Data"},description:{"default":"This list was automatically generated by looking in the corpus."},api:"LanguageDatum"}),this.commentsList=this.commentsList||new l({title:{"default":"All Comments"},description:{"default":"This list was automatically generated by looking in the corpus."},api:"Comment"}),this.responsesList=this.responsesList||new l({title:{"default":"List of Responses"},description:{"default":"This list was automatically generated by looking in the corpus."},api:"Response"}),this.experimentsList=this.experimentsList||new l({title:{"default":"List of Experiment Results"},description:{"default":"This list was automatically generated by looking in the corpus."},api:"Experiment"}),this.reportsList=this.reportsList||new l({title:{"default":"List of Reports"},description:{"default":"This list was automatically generated by looking in the corpus."},api:"Report"}),this.importer=this.importer||null,this.search=this.search||null,this.currentDoc=this.currentDoc||null,this._corpus=this._corpus||null,this.thisyear=(new Date).getFullYear(),this.whiteListCORS=this.whiteListCORS||["self"];var c=this;r.nextTick(function(){c.warn("An app of type "+c.fieldDBtype+" has become automagically available to all fielddb objects")})};s.prototype=Object.create(d.prototype,{constructor:{value:s},authentication:{get:function(){return this._authentication||d.DEFAULT_OBJECT},set:function(a){this.ensureSetViaAppropriateType("authentication",a)}},application:{get:function(){return this},set:function(a){this.warn("This is the application, the application cant be set on it.",a)}},corpus:{get:function(){return this._corpus?this._corpus:i.prototype},set:function(a){this._corpus=a}},contextualizer:{get:function(){return this._contextualizer},set:function(a){this.ensureSetViaAppropriateType("contextualizer",a),this._contextualizer&&"function"==typeof this._contextualizer.loadDefaults&&this._contextualizer.loadDefaults()}},contextualize:{value:function(a){return this._contextualizer?this._contextualizer.contextualize(a):"object"==typeof a||a["default"]?a["default"]:a}},prefs:{get:function(){return this.corpus&&this.corpus.prefs?this.corpus.prefs:this.authentication&&this.authentication.user&&this.authentication.user.prefs?this.authentication.user.prefs:void 0}},brand:{get:function(){return this.connection?this.connection.brand:this._brand},set:function(a){return this.connection?void(this.connection.brand=a):void(this._brand=a)}},brandLowerCase:{get:function(){return this.connection?this.connection.brandLowerCase:this._brandLowerCase},set:function(a){return this.connection?void(this.connection.brandLowerCase=a):void(this._brandLowerCase=a)}},website:{get:function(){return this.connection?this.connection.website:this._website},set:function(a){return this.connection?void(this.connection.website=a):void(this._website=a)}},connection:{get:function(){return this._connection},set:function(a){this.ensureSetViaAppropriateType("connection",a)}},enterDecryptedMode:{value:function(){var a,b=r.defer(),c=this;return this.authentication&&this.authentication.user&&this.authentication.user.username?(a=this.authentication.user.username,this.whenDecryptionReady=b.promise,this.prompt("Some data which you are about to view is encrypted. You can only view encrypted data if you confirm your identity. If you would like to edit or view the data we need to make sure that you are "+a).then(function(a){c.application&&c.application.authentication&&"function"==typeof c.application.authentication.confirmIdentity?c.application.authentication.confirmIdentity({password:a.response}).then(function(a){c.debug("Confirmed the user's identity",a),c._decryptedMode=!0,b.resolve(!0)},function(a){c.debug("Unable to confirm the user's identity",a),c._decryptedMode=!1,b.reject(!1)}).fail(function(a){c.debug("Error while confirming the user's identity",a),c._decryptedMode=!1,b.reject(!1)}):(c.warn("Not running in an application, but was able to simuli-prompt the user."),c._decryptedMode=!0,b.resolve(!0))},function(a){c.debug("Unable to prompt the user, the data will always be encrypted",a),c._decryptedMode=!1,b.reject(!1)}).fail(function(a){c.debug("Error while prompting the user, the data will always be encrypted",a),c._decryptedMode=!1,b.reject(!1)}),this.whenDecryptionReady):void 0}},decryptedMode:{get:function(){return void 0!==this._decryptedMode?this._decryptedMode:void(this.whenDecryptionReady||this.authentication.loggingIn||this.enterDecryptedMode())},set:function(a){return a!==this._decryptedMode?a?(this.warn("Cant set decryptedMode manually to true. "),void(this.whenDecryptionReady||this.enterDecryptedMode())):void(this._decryptedMode=a):void 0}},fetch:{value:function(){this.todo("use same logic as the user from localStorage")}},INTERNAL_MODELS:{value:{connection:j,corpus:g,contextualizer:q,authentication:f,currentSession:o,currentDataList:l,search:n}},startApp:{value:function(a){this.render(),"function"==typeof this.router&&(this.router=new p,this.router.renderDashboardOrNot(!0),d.history.start(),"function"==typeof a&&(this.debug("Calling back the startApps callback"),a()))}},loading:{get:function(){return this._loading||this.fetching||!1},set:function(a){a!==this._loading&&(a=!!a,a===!0&&(this.status="Loading dashboard"),this.loading=a)}},processRouteParams:{value:function(a){var b=this;if(!a)return void this.warn("Route params are undefined, not loading anything");if(this.routeParams=a,a.importType?(b.debug("Creating an importer"),this.importer=this.importer||new m({importType:a.importType})):a.reportType?this.reportsList.filter=function(b){return a.reportType.match(b.fieldDBtype.toLowerCase())?!0:!1}:a.speakerType?this.speakersList.filter=function(b){return a.speakerType.match(b.fieldDBtype.toLowerCase())?!0:!1}:a.searchQuery?(this.search=this.search||new n({searchQuery:a.searchQuery}),this.search.search(a.searchQuery)):a.docid&&(this.currentDoc&&this.currentDoc.save&&this.currentDoc.bug("Switching to another document without saving..."),new d({id:a.docid}).fetch().then(function(a){b.currentDoc=d.convertDocIntoItsType(a),b.render()},function(a){console.log("Unable to display this document.",a)})),a.team)if(a.team=j.validateUsername(a.team).identifier,a.corpusidentifier){a.corpusidentifier=j.validateIdentifier(a.corpusidentifier).identifier,this.currentCorpusDashboard=a.team+"/"+a.corpusidentifier;var c;this.authentication&&this.authentication.user&&this.authentication.user.username&&this.authentication.user.corpora&&this.authentication.user.corpora.length>0&&"function"==typeof this.authentication.user.corpora.findCorpusConnectionFromTitleAsUrl&&(c=this.authentication.user.corpora.findCorpusConnectionFromTitleAsUrl(a.corpusidentifier,a.team),c&&(this.corpus&&this.corpus.save&&this.corpus.dbname!==c.dbname&&this.corpus.bug("Switching to another corpus without saving..."),this.corpus=new g({connection:c,dbname:c.dbname}))),c||(c=j.defaultConnection(),c.dbname=a.team+"-"+a.corpusidentifier,this.corpus=new h({connection:c,dbname:c.dbname})),this.application.connection=c}else this.todo("load the user's profile..."+a.team);return this.corpus&&this.corpus.dbname&&!this.corpus.title?(this.corpus.status="Loading corpus details.",this.corpus.fetch().then(function(a){return b.debug("Suceeded to download corpus details.",a),
b.corpus.status+="\n Loaded corpus details.",b.status="Loaded corpus details.",b.application.importer&&(b.application.importer.corpus=b.corpus),b},function(a){return b.debug("Failed to download corpus details.",a),b.corpus.error=a.userFriendlyErrors.join(" "),b.status=b.corpus.status="Failed to download corpus details. Are you sure this is the corpus you wanted to see: "+b.corpus.dbname,b}).fail(function(a){console.error(a.stack,b)})):void this.debug("Not fetching corpus ",this.corpus)}},router:{get:function(){return this._router},set:function(a){this.ensureSetViaAppropriateType("router",a)}},showHelpOrNot:{value:function(){var a=this,b=this.authentication.user.username;if("public"!==b){var c=localStorage.getItem(b+"helpShownCount")||0,d=localStorage.getItem(b+"helpShownTimestamp")||0;if(0===d)return a.helpCountReason="Just in case you were wondering what all those buttons are for, check out Gretchen's Illustrated Guide to your dashboard! ",a.helpCount=3-c,localStorage.setItem(b+"helpShownCount",++c),localStorage.setItem(b+"helpShownTimestamp",Date.now()),void a.timeout(function(){a.router.navigate("help/illustratedguide",{trigger:!0})},6e4);var e=Date.now()-d;e>432e6&&0!==d&&(c=0,a.helpCountReason="Welcome back! It's been more than 5 days since you opened the app. "),c>3||(a.helpCount=3-c,localStorage.setItem(b+"helpShownCount",++c),localStorage.setItem(b+"helpShownTimestamp",Date.now()),a.router.navigate("help/illustratedguide",{trigger:!0}))}}},renderHelp:function(a){this.render(a)},warnUserAboutSavedSyncedStateBeforeUserLeaves:{value:function(a){this.debug("warnUserAboutSavedSyncedStateBeforeUserLeaves",a),this.save();var b="";return this.view&&(this.view.totalUnsaved.length>=1&&(b="You have unsaved changes, click cancel to save them. \n\n"),this.view.totalUnsaved.length>=1&&(b+="You have unsynced changes, click cancel and then click the sync button to sync them. This is only important if you want to back up your data or if you are sharing your data with a team. \n\n")),""===b?void 0:"Either you haven't been using the app and Chrome wants some of its memory back, or you want to leave the app.\n\n"+b}},addActivity:{value:function(a){var b=this;a.verb=a.verb.replace("href=","target='_blank' href="),a.directobject=a.directobject.replace("href=","target='_blank' href="),a.indirectobject=a.indirectobject.replace("href=","target='_blank' href="),a.context=a.context.replace("href=","target='_blank' href="),b.debug("Saving activity: ",a);var c=new e(a),d=this.connection,f=d.dbname+"-activity_feed";"team"!==a.teamOrPersonal&&(f=this.authentication.user.username+"-activity_feed",c.attributes.user.set("gravatar",this.authentication.user.gravatar)),"team"===a.teamOrPersonal?b.currentCorpusTeamActivityFeed.addActivity(a):b.currentUserActivityFeed.addActivity(a)}},save:{value:function(){var a=[];this.authentication.dispatchEvent("saveyourselfnow"),a.push(this.currentSession.save()),a.push(this.currentDataList.save()),a.push(this.corpus.save()),a.push(this.authentication.save()),this.authentication.staleAuthentication=!0}},subscribers:{value:{any:[]}},subscribe:{value:function(a,b,c){a=a||"any",b="function"==typeof b?b:c[b],"undefined"==typeof this.subscribers[a]&&(this.subscribers[a]=[]),this.subscribers[a].push({fn:b,context:c||this})}},unsubscribe:{value:function(a,b,c){this.visitSubscribers("unsubscribe",a,b,c)}},publish:{value:function(a,b){this.visitSubscribers("publish",a,b)}},visitSubscribers:{value:function(a,b,c,d){var e=b||"any",f=this.subscribers[e];if(!f||0===f.length)return void this.debug(e+": There were no subscribers.");var g,h=f?f.length-1:0,i=f?f.length:0;if("publish"===a){for(g=0;i>g;g++)f[g]&&f[g].fn.call(f[g].context,c);this.debug("Visited "+f.length+" subscribers.")}else for(g=h;g>=0;g--)try{if(f[g].context||this.debug("This subscriber has no context. should we remove it? "+g),f[g].context===d){var j=f.splice(g,1);this.debug("Removed subscriber "+g+" from "+b,j)}else this.debug(b+" keeping subscriber "+g,f[g].context)}catch(k){this.debug("problem visiting Subscriber "+g,f)}}},isAndroidApp:{get:function(){try{return navigator.userAgent.indexOf("OfflineAndroidApp")>-1}catch(a){return this.debug("Cant determine app type isAndroidApp, "+a),!1}}},isAndroid4:{get:function(){try{return navigator.userAgent.indexOf("Android 4")>-1}catch(a){return this.debug("Cant determine app type isAndroid4, "+a),!1}}},isChromeApp:{get:function(){try{return window.location.href.indexOf("chrome-extension")>-1}catch(a){return this.debug("Cant determine app type isChromeApp, "+a),!1}}},isCouchApp:{get:function(){try{return window.location.href.indexOf("_design/")>-1}catch(a){return this.debug("Cant determine app type isCouchApp, "+a),!1}}},isTouchDBApp:{get:function(){try{return window.location.href.indexOf("localhost:8128")>-1}catch(a){return this.debug("Cant determine app type isTouchDBApp, "+a),!1}}},isNodeJSApp:{get:function(){try{return void 0!==window.location.href}catch(a){return this.debug("Cant access window, app type isNodeJSApp, ",a),!0}}},isBackboneCouchDBApp:{get:function(){return!1}},isOnlineOnly:{get:function(){return!this.isAndroidApp&&!this.isChromeApp}},toJSON:{value:function(a,b){this.debug("Customizing toJSON ",a,b);var c=["corpus","authentication"],e=d.prototype.toJSON.apply(this,[a,b,c]);return this.debug(e),e}}}),c.App=s},{"./../FieldDBObject":4,"./../Router":5,"./../activity/Activity":7,"./../authentication/Authentication":15,"./../corpus/Connection":21,"./../corpus/Corpora":22,"./../corpus/Corpus":23,"./../corpus/CorpusMask":24,"./../corpus/Database":25,"./../data_list/DataList":30,"./../datum/Session":44,"./../import/Import":54,"./../locales/Contextualizer":59,"./../search/Search":67,q:223}],9:[function(a,b,c){var d=a("./App").App,e=function(a){this._fieldDBtype||(this._fieldDBtype="PsycholinguisticsApp"),this.debug("Constructing PsycholinguisticsApp ",a),d.apply(this,arguments)};e.prototype=Object.create(d.prototype,{constructor:{value:e},hasParticipants:{get:function(){return this.participantsList&&this.participantsList.docs&&this.participantsList.docs.length?this.participantsList.docs.length>0:!1}}}),c.PsycholinguisticsApp=e},{"./App":8}],10:[function(a,b,c){var d=a("./HTML5Audio").HTML5Audio,e=a("./HTML5Audio").HTML5Audio,f=function(a){this._fieldDBtype||(this._fieldDBtype="AudioPlayer"),this.options&&console.warn("AudioPlayer was created with options but it doesnt accept options",a),this.mediaController=new d,Object.apply(this,arguments)};f.prototype=Object.create(Object.prototype,{constructor:{value:f},isPlaying:{configurable:!0,get:function(){return this.mediaController.isPlaying}},isPaused:{configurable:!0,get:function(){return this.mediaController.isPaused}},audioPlayStartTime:{configurable:!0,get:function(){return this.mediaController.audioPlayStarted?this.mediaController.audioPlayStarted:0}},isCordova:{configurable:!0,get:function(){try{return Media||console.log("We are most likely in Cordova, using Cordova instead of HTML5 audio"),!0}catch(a){return console.log("We are most likely not in Cordova, using HTML5 audio"),!1}}},getDuration:{configurable:!0,value:function(a){return a&&this.src.indexOf(a)>-1&&this.mediaController.src.indexOf(a)>-1?this.mediaController.duration||0:(console.log("Duration wasn't clear, so returning 0"),0)}},src:{configurable:!0,get:function(){return this._src},set:function(a){if(!a||!a.trim()||a.trim()!==this._src){if(console.log("Changed audio source: "+a),this.isCordova&&"Cordova"!==this.mediaController.library)this._src=a,this.mediaController=e;else try{if(a.match(/^[^:]+:\/\//)?this._src=a:this._src=document.location.href.replace(document.location.pathname,"/"+a),!this.mediaController._audioElement)if(document.getElementById(this._src))this.mediaController._audioElement=document.getElementById(this._src);else{var b=document.createElement("audio");b.setAttribute("id",this._src),document.body.appendChild(b),this.mediaController._audioElement=b}}catch(c){this.warn("There is no DOM, cant set audio src"),this.debug(c)}this.mediaController.src=this._src,console.log("Set the src in core/audio-player "+this._src)}}},play:{configurable:!0,value:function(a,b){a&&(this.src=a),this.mediaController?(console.log("this.mediaController.play "+this._src),this.mediaController.play(this._src,b)):console.log("couldnt play "+this._src)}},pause:{configurable:!0,value:function(){this.mediaController&&this.mediaController.pause()}},togglePause:{configurable:!0,value:function(){console.log("togglePause"),this.mediaController&&(this.mediaController.isPaused?(console.log("   playing"),this.mediaController.play()):(console.log("   paused"),this.mediaController.pause()))}},stop:{configurable:!0,value:function(){this.mediaController&&this.mediaController.stop()}},addEvent:{configurable:!0,value:function(a,b,c){this.mediaController&&this.mediaController.addAudioEventAtTimePeriod(a,b,c)}}}),c.AudioPlayer=f},{"./HTML5Audio":14}],11:[function(a,b,c){var d=a("./../FieldDBObject").FieldDBObject,e=a("./AudioPlayer").AudioPlayer,f=a("browserify-mime"),g=function(a){this._fieldDBtype||(this._fieldDBtype="AudioVideo"),this.debug("Constructing AudioVideo length: ",a),d.apply(this,arguments)},h="https://localhost:3184";g.prototype=Object.create(d.prototype,{constructor:{value:g},BASE_SPEECH_URL:{get:function(){return h},set:function(a){h=a}},api:{value:"speech"},id:{get:function(){return this._URL||d.DEFAULT_STRING},set:function(a){if(a!==this._URL){if(!a)return void delete this._URL;a.trim&&(a=a.trim()),this._URL=a}}},URL:{get:function(){if(!this._URL&&this.filename){var a=this.url?this.url:this.BASE_SPEECH_URL;return a+"/"+this.dbname+"/"+this.filename}return this._URL||d.DEFAULT_STRING},set:function(a){if(a!==this._URL){if(!a)return void delete this._URL;a.trim&&(a=a.trim()),this._URL=a,this.audioPlayer&&(this.audioPlayer.src=a)}}},play:{value:function(a,b,c){this.warn("playing",this,a,b,c),this.audioPlayer=this.audioPlayer||new e,this.audioPlayer.play(this.URL)}},guessType:{value:function(a){var b=f.lookup(a);return b}},type:{get:function(){return!this._type&&this.filename&&(this._type=this.guessType(this.filename)),this._type||d.DEFAULT_STRING},set:function(a){a!==this._type&&(this.filename&&!this.checksum&&(this.warn("type cannot be set, it is automatically determined from the filename. Not using: "+a),a=this.guessType(this.filename)),this._type=a)}},toJSON:{value:function(a,b){this.debug("Customizing toJSON ",a,b);var c=d.prototype.toJSON.apply(this,arguments);return delete c.audioPlayer,c.type=this.type,c}}}),c.AudioVideo=g},{"./../FieldDBObject":4,"./AudioPlayer":10,"browserify-mime":120}],12:[function(a,b,c){var d=a("./../FieldDBObject").FieldDBObject,e=a("q"),f=a("recordmp3js/js/recordmp3"),g=function(a){this._fieldDBtype||(this._fieldDBtype="AudioVideoRecorder"),this.options&&console.log("AudioVideoRecorder was created with options but it doesnt accept options",a),a&&a.element&&(this.element=a.element),Object.apply(this,arguments)};g.Recorder=f.Recorder,g.prototype=Object.create(Object.prototype,{constructor:{value:g},isRecording:{configurable:!0,get:function(){return this._isRecording}},element:{get:function(){return this.recorder?this.recorder.element:null},set:function(a){if(!a)return void console.warn("Cannot create an audio recorder, element was not passed in.");try{this.recorder=new f.Recorder({element:a})}catch(b){console.warn("Cannot create an audio recorder.",b)}}},parent:{get:function(){return this.recorder?this.recorder.parent:null},set:function(a){return a&&this.recorder?void(this.recorder.parent=f.parent=a):void console.warn("Cannot set parent on a missing audio recorder, parent was not passed in.")}},isPaused:{configurable:!0,get:function(){return this._isPaused}},recorderStartTime:{configurable:!0,get:function(){return this._recordingStartTime?this._recordingStartTime:0}},isCordova:{configurable:!0,get:function(){try{return Media||console.log("We are most likely in Cordova, using Cordova instead of HTML5 audio"),!0}catch(a){return console.log("We are most likely not in Cordova, using HTML5 audio",a),!1}}},getDuration:{configurable:!0,value:function(){return 0}},microphoneCheck:{value:function(){this.peripheralsCheck(!1)}},videoCheck:{value:function(){this.peripheralsCheck(!0)}},peripheralsCheck:{value:function(a,b){var c={},g=e.defer(),h=this;d.application&&(c=d.application);var i=function(a){c.videoRecordingVerified=!1,c.audioRecordingVerified=!1,g.reject(a)};return e.nextTick(function(){if(h.peripheralsCheckRunning)return void g.reject("Already running");h.peripheralsCheckRunning=!0;var e=function(){if(!b)try{b={image:document.getElementById("video-snapshot"),video:document.getElementById("video-preview"),audio:document.getElementById("audio-preview"),canvas:document.getElementById("video-snapshot-canvas")}}catch(e){this.warn("There is no DOM, cant run peripheralsCheck unless the elements are supplied "),this.debug(e)}if(!b.canvas)return void i("video-snapshot-canvas is not present, cant verify peripheralsCheck");b.canvas.width=640,b.canvas.height=360;var j=b.canvas.getContext("2d"),k=function(e){e&&(f.audio_context=new f.AudioContext,f.audio_source=f.audio_context.createMediaStreamSource(e)),a?(b.video.removeAttribute("hidden"),b.image.removeAttribute("hidden"),b.video.removeAttribute("class"),b.image.removeAttribute("class"),h.type="video",b.video.src=window.URL.createObjectURL(e)):(h.type="audio",b.audio.src=window.URL.createObjectURL(e));var i=function(){e&&(j.drawImage(b.video,0,0),b.image.src=b.canvas.toDataURL("image/webp"))};b.video.addEventListener("click",i,!1);var k=function(a){console.log("Video preview is working, take note of this in application so user can continue to the game.",a),c.videoRecordingVerified=!0,c.audioRecordingVerified=!0,console.log("Turning of audio feedback since confirmed that the audio works."),b.audio.muted=!0,b.video.muted=!0,navigator.geolocation.getCurrentPosition(function(a){console.warn("recieved position information"),d&&(d.software=d.software||{},d.software.location=a.coords)}),g.resolve("user clicked okay")};b.audio.onloadeddata=k,b.audio.onloadedmetadata=k,b.video.onloadeddata=k,b.video.onloadedmetadata=k};if(c.videoRecordingVerified)return k(),void g.resolve();if(navigator.getUserMedia=navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia||navigator.msGetUserMedia,!navigator.getUserMedia)return void i("The Microphone/Camera is not supported in your browser.");var l=function(a){console.warn("Error in peripheralsCheck",a),i("User refused access to camera and microphone!",a)};navigator.getUserMedia({video:{mandatory:{maxWidth:b.canvas.width,maxHeight:b.canvas.height}},audio:!0,geolocation:!0},k,l)};b.video?e():(console.warn("waiting for the video preview to get rendered, did you forget to declare it somewhere? "),setTimeout(e,2e3))}),g.promise}},record:{configurable:!0,value:function(a,b){console.log("todo record "+this._src+" optionalSource "+a+" optionalDelay "+b)}},pause:{configurable:!0,value:function(){console.log("todo pause recording")}},togglePause:{configurable:!0,value:function(){console.log("todo toogle pause recording")}},stop:{configurable:!0,value:function(a){var b=e.defer();return e.nextTick(function(){console.log("todo stop recording",a)}),b.promise}},exportRecording:{configurable:!0,value:function(a){var b=e.defer();return e.nextTick(function(){console.log("todo export recording",a)}),b.promise}},showFile:{configurable:!0,value:function(a,b,c){var d=e.defer(),f=this;return console.log("showing file on ",c),e.nextTick(function(){var d=new FileReader;d.onload=function(b){var d="audio_recording_"+(new Date).getTime()+".mp3",e=b.target.result;try{var g=document.createElement("p"),h=document.createElement("audio");h.classList=["fielddb-audio-temp-play-audio"];var i=document.createElement("a");i.classList=["fielddb-audio-temp-save-link"],i.innerText="Save to this device",h.controls=!0,h.src=e,i.href=e,i.download=d,i.innerHTML=d,g.appendChild(h),h.play(),g.appendChild(i),console.log("todo dont need to append this audio after upload"),c.appendChild(g),f.parent.addFile({filename:d,description:"Recorded using spreadsheet app",data:e})}catch(j){this.warn("There is no DOM, cant show audio player"),this.debug(j)}a.clear()},d.readAsDataURL(b)}),d.promise}}}),f.workerPath="bower_components/recordmp3js/",f.showFile=g.prototype.showFile;try{f.AudioContext=window.AudioContext,f.URL=window.URL}catch(h){console.warn("Audio recorder won't work, AudioContext is not defined",h)}c.AudioVideoRecorder=g},{"./../FieldDBObject":4,q:223,"recordmp3js/js/recordmp3":243}],13:[function(a,b,c){var d=a("./../Collection").Collection,e=a("./AudioVideo").AudioVideo,f=function(a){this._fieldDBtype||(this._fieldDBtype="AudioVideos"),this.debug("Constructing AudioVideos length: ",a),d.apply(this,arguments)};f.prototype=Object.create(d.prototype,{constructor:{value:f},primaryKey:{value:"URL"},INTERNAL_MODELS:{value:{item:e}},play:{value:function(a){this.debug("playing collection"),a||(a=0),this._collection&&this._collection[a]&&this._collection[a].play()}}}),c.AudioVideos=f},{"./../Collection":3,"./AudioVideo":11}],14:[function(a,b,c){var d=function(a){this._fieldDBtype||(this._fieldDBtype="HTML5Audio"),this.options&&console.log("HTML5Audio was created with options but it doesnt accept options",a),Object.apply(this,arguments)};d.prototype=Object.create(Object.prototype,{constructor:{value:d},src:{configurable:!0,get:function(){return this._src},set:function(a){a&&a.trim()&&a.trim()===this._src||(this._src=a,console.log("Changed audio source"+a))}},matchesSource:{value:function(a){return this._src.indexOf(a)>-1}},handleSrcChange:{value:function(a,b){console.log("Handle audio source change ",a,b)}},duration:{configurable:!0,get:function(){return this._audioElement&&this._audioElement.duration?this._audioElement.duration:0}},play:{value:function(a,b){if(a&&(this.src=a),console.log("Requesting play of audio file "+a),this._audioElement){var c;if(c=this._audioElement.children&&this._audioElement.children[0]&&this._audioElement.children[0].src?this._audioElement.children[0]:this._audioElement,c.src===this.src&&this.isPaused)return this._audioElement.play(),this.isPaused=!1,void(this.isPlaying=!0);c.src&&c.src===this.src||(c.src=this.src);var d=this,e=Date.now(),f=this._audioElement;f.removeEventListener("ended",window.audioEndListener),f.removeEventListener("canplaythrough",window.actuallyPlayAudio);var g=this.src;window.audioEndListener=function(){f.removeEventListener("ended",window.audioEndListener),console.log("audiourl is done "+g),d.isPlaying=!1,d.isPaused=!1;for(var a=0;a<d.endAudioEvents.length;a++){var b=d.endAudioEvents[a].whatShouldHappen;d.matchesSource(d.endAudioEvents[a].audioFile)&&console.log("Dispatching "+b)}},window.actuallyPlayAudio=function(){if(f.removeEventListener("canplaythrough",window.actuallyPlayAudio),b){var a=Date.now()-e,c=b-a;c>0?setTimeout(function(){d._audioElement.play(),d.isPlaying=!0,d.isPaused=!1,d.audioPlayStarted=Date.now()},c):(console.warn("Audio was "+c+" late."),d._audioElement.play(),d.isPlaying=!0,d.isPaused=!1,d.audioPlayStarted=Date.now())}else d._audioElement.play(),d.isPlaying=!0,d.isPaused=!1,d.audioPlayStarted=Date.now()},console.log("Requested play of audio file when canplaythrough "+c),f.addEventListener("ended",window.audioEndListener),f.addEventListener("canplaythrough",window.actuallyPlayAudio),4===f.readyState&&window.actuallyPlayAudio.apply(f,[])}else console.warn("there was no audio element to play")}},pause:{value:function(){this._audioElement&&(this._audioElement.pause(),this.isPaused=!0)}},stop:{value:function(){this._audioElement&&(this._audioElement.pause(),this._audioElement.currentTime=0)}},audioEvents:{configurable:!0,value:[]},endAudioEvents:{configurable:!0,value:[]},audioTimeUpdateFunction:{configurable:!0,value:function(){if(console.log("Audio position: "+this.currentTime),this.audioEvents)for(var a=0;a<this.audioEvents.length;a++)this.currentTime>this.audioEvents[a].startTime-.15&&this.currentTime<this.audioEvents[a].endTime&&this.audioEvents[a].whatShouldHappen.call()}},addAudioEventAtTimePeriod:{value:function(a,b,c){this._audioElement&&this._audioElement.removeEventListener("timeupdate",this.audioTimeUpdateFunction),c||(c=b+1e3);var d=a.substring(a.indexOf(":::")).replace(":::","");a=a.replace(":::"+d,""),"end"===b?this.endAudioEvents.push({whatShouldHappen:a,audioFile:d}):this.audioEvents.push({startTime:b,endTime:c,whatShouldHappen:a,audioFile:d}),this._audioElement&&this._audioElement.addEventListener("timeupdate",this.audioTimeUpdateFunction)}}}),c.HTML5Audio=d},{}],15:[function(a,b,c){var d=a("./../FieldDBObject").FieldDBObject,e=a("./../corpus/Database").Database,f=e.CORS,g=a("./../user/User").User,h=a("./../confidentiality_encryption/Confidential").Confidential,i=a("q"),j=a("./../corpus/Connection").Connection,k=a("bcryptjs"),l=function(a){this._fieldDBtype||(this._fieldDBtype="Authentication"),this.debug("Constructing a Authentication "+a);var b=this;this.loading=!0;var c=new i.defer;this.resumingSessionPromise=c.promise,e.prototype.resumeAuthenticationSession().then(function(a){return f.application=d.application,b.loading=!1,b.debug(a),b.user=a,b.user.fetch(),b.user._rev?(b.user.authenticated=!0,b.dispatchEvent("authenticateSuccess"),c.resolve(b.user)):(b.user.authenticated=!1,b.dispatchEvent("authenticateMustConfirmIdentity"),c.reject({status:401,userFriendlyErrors:["Please login."]})),b.user},function(a){return i.nextTick(function(){return b.loggingIn?void c.resolve(b.user):(b.loading=!1,b.warn("Unable to resume login "+a.userFriendlyErrors.join(" ")),401===a.status?b.dispatchEvent("authenticateMustConfirmIdentity"):b.error=a.userFriendlyErrors.join(" "),b.render(),void c.reject(a))}),a}).fail(function(a){return console.error(a.stack,b),c.reject(a),a}),d.apply(this,arguments)};l.prototype=Object.create(d.prototype,{constructor:{value:l},INTERNAL_MODELS:{value:{user:g,confidential:h}},dispatchEvent:{value:function(a,b){try{if(this.eventDispatcher&&"function"==typeof this.eventDispatcher.trigger)this.eventDispatcher.trigger(a,b);else{this.eventDispatcher=this.eventDispatcher||document;var c=this.eventDispatcher.createEvent("Event");c.initEvent(a,!0,!0),this.eventDispatcher.dispatchEvent(c)}}catch(d){this.warn("Cant dispatch event "+a+" the document element isn't available."),this.debug(" error ",d)}}},login:{value:function(a){var b=i.defer(),c=this;if(this.whenLoggedIn)return this.whenLoggedIn;this.whenLoggedIn=b.promise;var d={};if(d.username=a.username,d.password=a.password,d.authUrl=a.authUrl,d.connection=a.connection,!a.syncUserDetails){var f=new g(a);f.fetch(),f._rev&&"public"!==f.username&&!f.fetching&&!f.loading&&f.lastSyncWithServer&&(d.syncDetails="true",d.syncUserDetails=f.toJSON(),f.warn("Backing up tempUser details",d.syncUserDetails),delete d.syncUserDetails._rev)}this.error="",this.status="",this.loading=this.loggingIn=!0;var h=function(d){c.loading=!1,c.user&&(c.user.authenticated=!1),d&&d.userFriendlyErrors?c.dispatchEvent("authenticateFail",d):(d.userFriendlyErrors=["Unknown error. Please report this 2456."],c.dispatchEvent("authenticateMustConfirmIdentity")),d.details=a,c.warn("Logging in failed: "+d.status,d.userFriendlyErrors),c.error=d.userFriendlyErrors.join(" "),b.reject(d),delete c.whenLoggedIn,delete c.loggingIn};return c.resumingSessionPromise=b.promise,e.prototype.login(d).then(function(d){if(!d)return c.loading=!1,c.dispatchEvent("authenticateMustConfirmIdentity"),void b.reject({details:a,status:500,userFriendlyErrors:["Unknown error. Please report this 2391."]});try{c.user=d,c.user.lastSyncWithServer=Date.now()}catch(e){console.warn("There was a problem assigning the user. ",e)}c.authenticateWithAllCorpusServers(a).then(function(){c.loading=!1,c.user.authenticated=!0,c.dispatchEvent("authenticateSuccess"),b.resolve(c.user)},function(){c.loading=!1,b.resolve(c.user)}).fail(function(a){c.loading=!1,console.error(a.stack,c),b.resolve(c.user)}),delete c.loggingIn},h).fail(function(a){delete c.loggingIn,console.error(a.stack,c),h(a)}),this.whenLoggedIn}},confirmIdentity:{value:function(a){var b=i.defer(),c=this;if(!a||!a.password)return i.nextTick(function(){b.reject({userFriendlyErrors:["You must enter your password to confirm your identity."]})}),b.promise;if(!(this.user.username&&this.user.authenticated&&this.user.lastSyncWithServer&&this.user.hash&&this.user.salt))return i.nextTick(function(){b.reject({userFriendlyErrors:"You must login first."})}),b.promise;try{a.password=(a.password+"").trim(),k.compare(a.password,c.user.hash,function(c,d){d?(a.info=["Verified offline."],b.resolve(a)):(c?(a.error=c,a.userFriendlyErrors=["This app has errored while trying to confirm your identity. Please report this 2892346."]):a.userFriendlyErrors=["Sorry, this doesn't appear to be you."],b.reject(a))})}catch(d){a.userFriendlyErrors=["This app has errored while trying to confirm your identity. Please report this 289234."],b.reject(a)}return b.promise}},authenticateWithAllCorpusServers:{value:function(a){var b=i.defer(),c=this,d=[],f=[];if(!(this.user.corpora&&0!==this.user.corpora.length||a.connection))return i.nextTick(function(){c.bug("You don't have access to any corpora. This is strange."),b.resolve(c.user)}),b.promise;a.connection&&d.push(a.connection.corpusUrl),c.debug("loginDetails.connection",a.connection),this.user.corpora.map(function(a){var b=function(b){var c=b.replace(a.dbname,"_session");-1===d.indexOf(c)&&d.push(c)};a.corpusUrls?a.corpusUrls.map(b):b(a.corpusUrl)}),d.length<1&&this.bug("You don't have access to any corpora. This is strange."),this.debug("Requesting session token for all corpora user has access to."),this.user.roles=[];for(var g=0;g<d.length;g++)f.push(e.prototype.login({authUrl:d[g],name:this.user.username,password:a.password}));return i.allSettled(f).then(function(a){var d=!1,e={},f=[];a.map(function(a){c.debug("some roles",a),"fulfilled"===a.state&&a.value&&a.value.roles?(f=f.concat(a.value.roles),d=!0):(c.debug("Failed to login to one of the users's corpus servers ",a),a.reason&&void 0!==a.reason.status&&(e.status=a.reason.status),a.reason&&a.reason.userFriendlyErrors&&(e.userFriendlyErrors=a.reason.userFriendlyErrors),a.reason&&a.reason.details&&(e.details=a.reason.details)),c.debug("some roles",f)});var g={};c.user.roles=[],f.map(function(a){a&&!g[a]&&(g[a]=1,c.user.roles.push(a))}),d?b.resolve(c.user):(e.all=a,b.reject(e))}),b.promise}},register:{value:function(a){var b=this,c=i.defer();return this.loading=!0,e.prototype.register(a).then(function(d){b.debug("registration succeeeded, waiting to login ",d);var e=1e3,f=function(a){b.login(a).then(function(a){b.debug("    login after registration is complete "+e,a),c.resolve(a)},function(d){e=2*e,d.details=a,e>6e4?c.reject(d):(b.debug("    waiting to login "+e,d),b.loading=!0,setTimeout(function(){f(a)},e))}).fail(function(a){console.error(a.stack,b),c.reject(a)})};f(a)},function(a){b.loading=!1,b.debug("registration failed ",a),c.reject(a)}),c.promise}},logout:{value:function(a){var b=this;return this.loading=!0,this.save(),a=a||{},e.prototype.logout(a.url).then(function(){if(b.dispatchEvent("logout"),b.loading=!1,a&&!a.letClientHandleCleanUp){b.warn("Reloading the page");try{window.location.reload()}catch(c){b.debug("Window is undefined",c)}}})}},user:{get:function(){return this._user},set:function(a){if(a){var b;this.debug("setting user"),this._user&&this._user.username===a.username?(this._user.rev||(this.debug("Fetching the user's full details"),this._user.fetch()),this.debug("Merging the user",this._user,a),a instanceof g||(a=new g(a)),this._user._rev||(b="overwrite"),this._user.merge("self",a,b)):(a instanceof g||(a=new g(a)),this.debug("Setting the user"),this._user=a);var c=this;this._user.save().then(function(){c.debug("Saved user ")}),this._user.render()}}},save:{value:function(){return this.user.save()}},syncUserWithServer:{value:function(){var a=this;return this.todo("will this return a promise."),this.renderQuickAuthentication().then(function(b){a.login(b)}).fail(function(b){console.error(b.stack,a)})}},newCorpus:{value:function(a){var b=i.defer(),c=this;return i.nextTick(function(){if(!a)return void b.reject({details:a,userFriendlyErrors:["This application has errored, please contact us."],status:412});if(a.authUrl=e.prototype.deduceAuthUrl(a.authUrl),!a.username)return void b.reject({details:a,userFriendlyErrors:["Please supply a username."],status:412});if(!a.password)return void b.reject({details:a,userFriendlyErrors:["You must enter your password to prove that that this is you."],status:412});if(a.title=a.title||a.newCorpusTitle,a.newCorpusTitle=a.title,!a.title)return void b.reject({details:a,userFriendlyErrors:["Please supply a title for your new corpus."],status:412});var d=j.validateUsername(a.username);return d.changes.length>0?(a.username=d.identifier,c.warn(" Invalid username ",d.changes.join("\n ")),void b.reject({error:d,userFriendlyErrors:d.changes,status:412})):void f.makeCORSRequest({type:"POST",dataType:"json",url:a.authUrl+"/newcorpus",data:a}).then(function(d){c.debug(d),d.corpus?(c.user.corpora.shift(d.corpus),c.save()):d.status>0&&d.status<400&&c.user.corpora&&"function"==typeof c.user.corpora.find&&(d.corpus=c.user.corpora.find("dbname",j.validateIdentifier(a.newCorpusTitle).identifier,"fuzzy"),d.corpus&&d.corpus.length>0&&(d.corpus=d.corpus[0])),b.resolve(d.corpus)},function(d){d=d||{},d.details=a,d.userFriendlyErrors=d.userFriendlyErrors||["Unknown error, please report this."],c.debug(d),b.reject(d)}).fail(function(a){console.error(a.stack,c),b.reject(a)})}),b.promise}},toJSON:{value:function(a,b){this.debug("Customizing toJSON ",a,b);var c=["resumingSessionPromise","eventDispatcher"],e=d.prototype.toJSON.apply(this,[a,b,c]);return this.debug(e),e}}}),c.Authentication=l},{"./../FieldDBObject":4,"./../confidentiality_encryption/Confidential":18,"./../corpus/Connection":21,"./../corpus/Database":25,"./../user/User":74,bcryptjs:98,q:223}],16:[function(a,b,c){var d=a("./../FieldDBObject").FieldDBObject,e=function(a){this._fieldDBtype||(this._fieldDBtype="Comment"),this.debug("Constructing Comment ",a),d.apply(this,arguments)};e.prototype=Object.create(d.prototype,{constructor:{value:e},build:{value:function(a){this.timestamp=Date.now(),this.gravatar=a.gravatar,this.username=a.username}},edit:{value:function(a){this.text=a,this.timestampModified=Date.now()}},commentCreatedActivity:{value:function(a){var b=this.text;return[{verb:"commented",verbicon:"icon-comment",directobjecticon:"",directobject:"'"+b+"'",indirectobject:a,teamOrPersonal:"team",context:" via Offline App."},{verb:"commented",verbicon:"icon-comment",directobjecticon:"",directobject:"'"+b+"'",indirectobject:a,teamOrPersonal:"personal",context:" via Offline App."}]}}}),c.Comment=e},{"./../FieldDBObject":4}],17:[function(a,b,c){var d=a("./../Collection").Collection,e=a("./Comment").Comment,f=function(a){this._fieldDBtype||(this._fieldDBtype="Comments"),this.debug("Constructing Comments ",a),d.apply(this,arguments)};f.prototype=Object.create(d.prototype,{constructor:{value:f},primaryKey:{value:"timestamp"},INTERNAL_MODELS:{value:{item:e}},insertNewCommentFromObject:{value:function(a){a.timestamp=Date.now(),this.add(new e(a))}}}),c.Comments=f},{"./../Collection":3,"./Comment":16}],18:[function(a,b,c){var d,e,f=a("./../FieldDBObject").FieldDBObject,g=a("./Crypto_AES").CryptoJS,h=g.enc.Utf8;try{window.atob||console.log("ATOB is not defined, loading from npm"),d=window.atob,e=window.btoa}catch(i){d=a("atob"),e=a("btoa")}var j=function(a){this._fieldDBtype||(this._fieldDBtype="Confidential"),this.debug("Constructing Confidential: ",a),a&&a.filledWithDefaults&&(this.fillWithDefaults(),delete a.filledWithDefaults),f.apply(this,arguments)};j.secretKeyGenerator=f.uuidGenerator,j.prototype=Object.create(f.prototype,{constructor:{value:j},encrypt:{value:function(a){if(!a)return a;if("object"==typeof a&&(a=JSON.stringify(a),this.debug("Converted object to string before encryption")),
"number"==typeof a&&(a+="",this.debug("Converted object to string before encryption")),!this.secretkey)throw new Error("This confidential wasnt set up properly, cant encrypt.");this.debug("encrypting "+a);var b=g.AES.encrypt(a,this.secretkey.toString("base64"));return this.verbose(this.secretkey,b.toString(),e(b.toString())),"confidential:"+e(b.toString())}},decrypt:{value:function(a){var b=a;a=a.replace("confidential:",""),a=d(a),this.verbose("Decrypting "+a,this.secretkey.toString("base64")),b=g.AES.decrypt(a,this.secretkey.toString("base64")).toString(h);try{("{"===b[0]&&"}"===b[b.length-1]||"["===b[0]&&"]"===b[b.length-1])&&(b=JSON.parse(b),this.debug("Decrypting an object"))}catch(c){this.verbose("Decrypting a non-object")}return b}},secretkey:{get:function(){return this._secretkey||(this._secretkey=""),this._secretkey},set:function(a){if(a!==this._secretkey){if(this._secretkey&&this._secretkey.length>2)throw new Error("Confidential key cant be changed once it was created. Please create another Confidential encrypter if you wish to change the key.");a||(a=""),this._secretkey=a.trim()}}},fillWithDefaults:{value:function(){return this.secretkey||(this.secretkey=j.secretKeyGenerator()),this}}}),c.Confidential=j},{"./../FieldDBObject":4,"./Crypto_AES":19,atob:96,btoa:128}],19:[function(a,b,c){var d=d||function(a,b){var c={},d=c.lib={},e=d.Base=function(){function a(){}return{extend:function(b){a.prototype=this;var c=new a;return b&&c.mixIn(b),c.$super=this,c},create:function(){var a=this.extend();return a.init.apply(a,arguments),a},init:function(){},mixIn:function(a){for(var b in a)a.hasOwnProperty(b)&&(this[b]=a[b]);a.hasOwnProperty("toString")&&(this.toString=a.toString)},clone:function(){return this.$super.extend(this)}}}(),f=d.WordArray=e.extend({init:function(a,c){a=this.words=a||[],this.sigBytes=c!=b?c:4*a.length},toString:function(a){return(a||h).stringify(this)},concat:function(a){var b=this.words,c=a.words,d=this.sigBytes,a=a.sigBytes;if(this.clamp(),d%4)for(var e=0;a>e;e++)b[d+e>>>2]|=(c[e>>>2]>>>24-8*(e%4)&255)<<24-8*((d+e)%4);else if(65535<c.length)for(e=0;a>e;e+=4)b[d+e>>>2]=c[e>>>2];else b.push.apply(b,c);return this.sigBytes+=a,this},clamp:function(){var b=this.words,c=this.sigBytes;b[c>>>2]&=4294967295<<32-8*(c%4),b.length=a.ceil(c/4)},clone:function(){var a=e.clone.call(this);return a.words=this.words.slice(0),a},random:function(b){for(var c=[],d=0;b>d;d+=4)c.push(4294967296*a.random()|0);return f.create(c,b)}}),g=c.enc={},h=g.Hex={stringify:function(a){for(var b=a.words,a=a.sigBytes,c=[],d=0;a>d;d++){var e=b[d>>>2]>>>24-8*(d%4)&255;c.push((e>>>4).toString(16)),c.push((15&e).toString(16))}return c.join("")},parse:function(a){for(var b=a.length,c=[],d=0;b>d;d+=2)c[d>>>3]|=parseInt(a.substr(d,2),16)<<24-4*(d%8);return f.create(c,b/2)}},i=g.Latin1={stringify:function(a){for(var b=a.words,a=a.sigBytes,c=[],d=0;a>d;d++)c.push(String.fromCharCode(b[d>>>2]>>>24-8*(d%4)&255));return c.join("")},parse:function(a){for(var b=a.length,c=[],d=0;b>d;d++)c[d>>>2]|=(255&a.charCodeAt(d))<<24-8*(d%4);return f.create(c,b)}},j=g.Utf8={stringify:function(a){try{return decodeURIComponent(escape(i.stringify(a)))}catch(b){throw Error("Malformed UTF-8 data")}},parse:function(a){return i.parse(unescape(encodeURIComponent(a)))}},k=d.BufferedBlockAlgorithm=e.extend({reset:function(){this._data=f.create(),this._nDataBytes=0},_append:function(a){"string"==typeof a&&(a=j.parse(a)),this._data.concat(a),this._nDataBytes+=a.sigBytes},_process:function(b){var c=this._data,d=c.words,e=c.sigBytes,g=this.blockSize,h=e/(4*g),h=b?a.ceil(h):a.max((0|h)-this._minBufferSize,0),b=h*g,e=a.min(4*b,e);if(b){for(var i=0;b>i;i+=g)this._doProcessBlock(d,i);i=d.splice(0,b),c.sigBytes-=e}return f.create(i,e)},clone:function(){var a=e.clone.call(this);return a._data=this._data.clone(),a},_minBufferSize:0});d.Hasher=k.extend({init:function(){this.reset()},reset:function(){k.reset.call(this),this._doReset()},update:function(a){return this._append(a),this._process(),this},finalize:function(a){return a&&this._append(a),this._doFinalize(),this._hash},clone:function(){var a=k.clone.call(this);return a._hash=this._hash.clone(),a},blockSize:16,_createHelper:function(a){return function(b,c){return a.create(c).finalize(b)}},_createHmacHelper:function(a){return function(b,c){return l.HMAC.create(a,c).finalize(b)}}});var l=c.algo={};return c}(Math);!function(){var a=d,b=a.lib.WordArray;a.enc.Base64={stringify:function(a){var b=a.words,c=a.sigBytes,d=this._map;a.clamp();for(var a=[],e=0;c>e;e+=3)for(var f=(b[e>>>2]>>>24-8*(e%4)&255)<<16|(b[e+1>>>2]>>>24-8*((e+1)%4)&255)<<8|b[e+2>>>2]>>>24-8*((e+2)%4)&255,g=0;4>g&&c>e+.75*g;g++)a.push(d.charAt(f>>>6*(3-g)&63));if(b=d.charAt(64))for(;a.length%4;)a.push(b);return a.join("")},parse:function(a){var c=a.length,d=this._map,e=d.charAt(64);e&&(e=a.indexOf(e),-1!=e&&(c=e));for(var e=[],f=0,g=0;c>g;g++)if(g%4){var h=d.indexOf(a.charAt(g-1))<<2*(g%4),i=d.indexOf(a.charAt(g))>>>6-2*(g%4);e[f>>>2]|=(h|i)<<24-8*(f%4),f++}return b.create(e,f)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="}}(),function(a){function b(a,b,c,d,e,f,g){return a=a+(b&c|~b&d)+e+g,(a<<f|a>>>32-f)+b}function c(a,b,c,d,e,f,g){return a=a+(b&d|c&~d)+e+g,(a<<f|a>>>32-f)+b}function e(a,b,c,d,e,f,g){return a=a+(b^c^d)+e+g,(a<<f|a>>>32-f)+b}function f(a,b,c,d,e,f,g){return a=a+(c^(b|~d))+e+g,(a<<f|a>>>32-f)+b}var g=d,h=g.lib,i=h.WordArray,h=h.Hasher,j=g.algo,k=[];!function(){for(var b=0;64>b;b++)k[b]=4294967296*a.abs(a.sin(b+1))|0}(),j=j.MD5=h.extend({_doReset:function(){this._hash=i.create([1732584193,4023233417,2562383102,271733878])},_doProcessBlock:function(a,d){for(var g=0;16>g;g++){var h=d+g,i=a[h];a[h]=16711935&(i<<8|i>>>24)|4278255360&(i<<24|i>>>8)}for(var h=this._hash.words,i=h[0],j=h[1],l=h[2],m=h[3],g=0;64>g;g+=4)16>g?(i=b(i,j,l,m,a[d+g],7,k[g]),m=b(m,i,j,l,a[d+g+1],12,k[g+1]),l=b(l,m,i,j,a[d+g+2],17,k[g+2]),j=b(j,l,m,i,a[d+g+3],22,k[g+3])):32>g?(i=c(i,j,l,m,a[d+(g+1)%16],5,k[g]),m=c(m,i,j,l,a[d+(g+6)%16],9,k[g+1]),l=c(l,m,i,j,a[d+(g+11)%16],14,k[g+2]),j=c(j,l,m,i,a[d+g%16],20,k[g+3])):48>g?(i=e(i,j,l,m,a[d+(3*g+5)%16],4,k[g]),m=e(m,i,j,l,a[d+(3*g+8)%16],11,k[g+1]),l=e(l,m,i,j,a[d+(3*g+11)%16],16,k[g+2]),j=e(j,l,m,i,a[d+(3*g+14)%16],23,k[g+3])):(i=f(i,j,l,m,a[d+3*g%16],6,k[g]),m=f(m,i,j,l,a[d+(3*g+7)%16],10,k[g+1]),l=f(l,m,i,j,a[d+(3*g+14)%16],15,k[g+2]),j=f(j,l,m,i,a[d+(3*g+5)%16],21,k[g+3]));h[0]=h[0]+i|0,h[1]=h[1]+j|0,h[2]=h[2]+l|0,h[3]=h[3]+m|0},_doFinalize:function(){var a=this._data,b=a.words,c=8*this._nDataBytes,d=8*a.sigBytes;for(b[d>>>5]|=128<<24-d%32,b[(d+64>>>9<<4)+14]=16711935&(c<<8|c>>>24)|4278255360&(c<<24|c>>>8),a.sigBytes=4*(b.length+1),this._process(),a=this._hash.words,b=0;4>b;b++)c=a[b],a[b]=16711935&(c<<8|c>>>24)|4278255360&(c<<24|c>>>8)}}),g.MD5=h._createHelper(j),g.HmacMD5=h._createHmacHelper(j)}(Math),function(){var a=d,b=a.lib,c=b.Base,e=b.WordArray,b=a.algo,f=b.EvpKDF=c.extend({cfg:c.extend({keySize:4,hasher:b.MD5,iterations:1}),init:function(a){this.cfg=this.cfg.extend(a)},compute:function(a,b){for(var c=this.cfg,d=c.hasher.create(),f=e.create(),g=f.words,h=c.keySize,c=c.iterations;g.length<h;){i&&d.update(i);var i=d.update(a).finalize(b);d.reset();for(var j=1;c>j;j++)i=d.finalize(i),d.reset();f.concat(i)}return f.sigBytes=4*h,f}});a.EvpKDF=function(a,b,c){return f.create(c).compute(a,b)}}(),d.lib.Cipher||function(a){var b=d,c=b.lib,e=c.Base,f=c.WordArray,g=c.BufferedBlockAlgorithm,h=b.enc.Base64,i=b.algo.EvpKDF,j=c.Cipher=g.extend({cfg:e.extend(),createEncryptor:function(a,b){return this.create(this._ENC_XFORM_MODE,a,b)},createDecryptor:function(a,b){return this.create(this._DEC_XFORM_MODE,a,b)},init:function(a,b,c){this.cfg=this.cfg.extend(c),this._xformMode=a,this._key=b,this.reset()},reset:function(){g.reset.call(this),this._doReset()},process:function(a){return this._append(a),this._process()},finalize:function(a){return a&&this._append(a),this._doFinalize()},keySize:4,ivSize:4,_ENC_XFORM_MODE:1,_DEC_XFORM_MODE:2,_createHelper:function(){return function(a){return{encrypt:function(b,c,d){return("string"==typeof c?p:o).encrypt(a,b,c,d)},decrypt:function(b,c,d){return("string"==typeof c?p:o).decrypt(a,b,c,d)}}}}()});c.StreamCipher=j.extend({_doFinalize:function(){return this._process(!0)},blockSize:1});var k=b.mode={},l=c.BlockCipherMode=e.extend({createEncryptor:function(a,b){return this.Encryptor.create(a,b)},createDecryptor:function(a,b){return this.Decryptor.create(a,b)},init:function(a,b){this._cipher=a,this._iv=b}}),k=k.CBC=function(){function b(b,c,d){var e=this._iv;e?this._iv=a:e=this._prevBlock;for(var f=0;d>f;f++)b[c+f]^=e[f]}var c=l.extend();return c.Encryptor=c.extend({processBlock:function(a,c){var d=this._cipher,e=d.blockSize;b.call(this,a,c,e),d.encryptBlock(a,c),this._prevBlock=a.slice(c,c+e)}}),c.Decryptor=c.extend({processBlock:function(a,c){var d=this._cipher,e=d.blockSize,f=a.slice(c,c+e);d.decryptBlock(a,c),b.call(this,a,c,e),this._prevBlock=f}}),c}(),m=(b.pad={}).Pkcs7={pad:function(a,b){for(var c=4*b,c=c-a.sigBytes%c,d=c<<24|c<<16|c<<8|c,e=[],g=0;c>g;g+=4)e.push(d);c=f.create(e,c),a.concat(c)},unpad:function(a){a.sigBytes-=255&a.words[a.sigBytes-1>>>2]}};c.BlockCipher=j.extend({cfg:j.cfg.extend({mode:k,padding:m}),reset:function(){j.reset.call(this);var a=this.cfg,b=a.iv,a=a.mode;if(this._xformMode==this._ENC_XFORM_MODE)var c=a.createEncryptor;else c=a.createDecryptor,this._minBufferSize=1;this._mode=c.call(a,this,b&&b.words)},_doProcessBlock:function(a,b){this._mode.processBlock(a,b)},_doFinalize:function(){var a=this.cfg.padding;if(this._xformMode==this._ENC_XFORM_MODE){a.pad(this._data,this.blockSize);var b=this._process(!0)}else b=this._process(!0),a.unpad(b);return b},blockSize:4});var n=c.CipherParams=e.extend({init:function(a){this.mixIn(a)},toString:function(a){return(a||this.formatter).stringify(this)}}),k=(b.format={}).OpenSSL={stringify:function(a){var b=a.ciphertext,a=a.salt;return(a?f.create([1398893684,1701076831]).concat(a).concat(b):b).toString(h)},parse:function(a){var a=h.parse(a),b=a.words;if(1398893684==b[0]&&1701076831==b[1]){var c=f.create(b.slice(2,4));b.splice(0,4),a.sigBytes-=16}return n.create({ciphertext:a,salt:c})}},o=c.SerializableCipher=e.extend({cfg:e.extend({format:k}),encrypt:function(a,b,c,d){var d=this.cfg.extend(d),e=a.createEncryptor(c,d),b=e.finalize(b),e=e.cfg;return n.create({ciphertext:b,key:c,iv:e.iv,algorithm:a,mode:e.mode,padding:e.padding,blockSize:a.blockSize,formatter:d.format})},decrypt:function(a,b,c,d){return d=this.cfg.extend(d),b=this._parse(b,d.format),a.createDecryptor(c,d).finalize(b.ciphertext)},_parse:function(a,b){return"string"==typeof a?b.parse(a,this):a}}),b=(b.kdf={}).OpenSSL={execute:function(a,b,c,d){return d||(d=f.random(8)),a=i.create({keySize:b+c}).compute(a,d),c=f.create(a.words.slice(b),4*c),a.sigBytes=4*b,n.create({key:a,iv:c,salt:d})}},p=c.PasswordBasedCipher=o.extend({cfg:o.cfg.extend({kdf:b}),encrypt:function(a,b,c,d){return d=this.cfg.extend(d),c=d.kdf.execute(c,a.keySize,a.ivSize),d.iv=c.iv,a=o.encrypt.call(this,a,b,c.key,d),a.mixIn(c),a},decrypt:function(a,b,c,d){return d=this.cfg.extend(d),b=this._parse(b,d.format),c=d.kdf.execute(c,a.keySize,a.ivSize,b.salt),d.iv=c.iv,o.decrypt.call(this,a,b,c.key,d)}})}(),function(){var a=d,b=a.lib.BlockCipher,c=a.algo,e=[],f=[],g=[],h=[],i=[],j=[],k=[],l=[],m=[],n=[];!function(){for(var a=[],b=0;256>b;b++)a[b]=128>b?b<<1:b<<1^283;for(var c=0,d=0,b=0;256>b;b++){var o=d^d<<1^d<<2^d<<3^d<<4,o=o>>>8^255&o^99;e[c]=o,f[o]=c;var p=a[c],q=a[p],r=a[q],s=257*a[o]^16843008*o;g[c]=s<<24|s>>>8,h[c]=s<<16|s>>>16,i[c]=s<<8|s>>>24,j[c]=s,s=16843009*r^65537*q^257*p^16843008*c,k[o]=s<<24|s>>>8,l[o]=s<<16|s>>>16,m[o]=s<<8|s>>>24,n[o]=s,c?(c=p^a[a[a[r^p]]],d^=a[a[d]]):c=d=1}}();var o=[0,1,2,4,8,16,32,64,128,27,54],c=c.AES=b.extend({_doReset:function(){for(var a=this._key,b=a.words,c=a.sigBytes/4,a=4*((this._nRounds=c+6)+1),d=this._keySchedule=[],f=0;a>f;f++)if(c>f)d[f]=b[f];else{var g=d[f-1];f%c?c>6&&4==f%c&&(g=e[g>>>24]<<24|e[g>>>16&255]<<16|e[g>>>8&255]<<8|e[255&g]):(g=g<<8|g>>>24,g=e[g>>>24]<<24|e[g>>>16&255]<<16|e[g>>>8&255]<<8|e[255&g],g^=o[f/c|0]<<24),d[f]=d[f-c]^g}for(b=this._invKeySchedule=[],c=0;a>c;c++)f=a-c,g=c%4?d[f]:d[f-4],b[c]=4>c||4>=f?g:k[e[g>>>24]]^l[e[g>>>16&255]]^m[e[g>>>8&255]]^n[e[255&g]]},encryptBlock:function(a,b){this._doCryptBlock(a,b,this._keySchedule,g,h,i,j,e)},decryptBlock:function(a,b){var c=a[b+1];a[b+1]=a[b+3],a[b+3]=c,this._doCryptBlock(a,b,this._invKeySchedule,k,l,m,n,f),c=a[b+1],a[b+1]=a[b+3],a[b+3]=c},_doCryptBlock:function(a,b,c,d,e,f,g,h){for(var i=this._nRounds,j=a[b]^c[0],k=a[b+1]^c[1],l=a[b+2]^c[2],m=a[b+3]^c[3],n=4,o=1;i>o;o++)var p=d[j>>>24]^e[k>>>16&255]^f[l>>>8&255]^g[255&m]^c[n++],q=d[k>>>24]^e[l>>>16&255]^f[m>>>8&255]^g[255&j]^c[n++],r=d[l>>>24]^e[m>>>16&255]^f[j>>>8&255]^g[255&k]^c[n++],m=d[m>>>24]^e[j>>>16&255]^f[k>>>8&255]^g[255&l]^c[n++],j=p,k=q,l=r;p=(h[j>>>24]<<24|h[k>>>16&255]<<16|h[l>>>8&255]<<8|h[255&m])^c[n++],q=(h[k>>>24]<<24|h[l>>>16&255]<<16|h[m>>>8&255]<<8|h[255&j])^c[n++],r=(h[l>>>24]<<24|h[m>>>16&255]<<16|h[j>>>8&255]<<8|h[255&k])^c[n++],m=(h[m>>>24]<<24|h[j>>>16&255]<<16|h[k>>>8&255]<<8|h[255&l])^c[n++],a[b]=p,a[b+1]=q,a[b+2]=r,a[b+3]=m},keySize:8});a.AES=b._createHelper(c)}(),c.CryptoJS=d},{}],20:[function(a,b,c){var d=a("./Corpus").Corpus,e=a("./../datum/ComputationalLinguisticsDatum").ComputationalLinguisticsDatum,f=function(a){this._fieldDBtype||(this._fieldDBtype="ComputationalLinguisticsCorpus"),this.debug("In ComputationalLinguisticsCorpus ",a),d.DEFAULT_DATUM=e,d.apply(this,arguments)};f.DEFAULT_DATUM=e,f.prototype=Object.create(d.prototype,{constructor:{value:f},extractStats:{value:function(a){if(!a||!a.docs)return this.warn("datalist was empty",a),a;var b,c={characters:{unigrams:{},bigrams:{}},words:{unigrams:{},bigrams:{}},tokens:{characters:{unigrams:0,bigrams:0},words:{unigrams:0,bigrams:0}},types:{characters:{unigrams:0,bigrams:0},words:{unigrams:0,bigrams:0}},ttr:{characters:{unigrams:1,bigrams:1},words:{unigrams:1,bigrams:1}}},d=this;return a.docs.map(function(a){if(a.stats||"function"!=typeof a.extractStats||a.extractStats(),a.stats.characters)for(b in a.stats.characters.unigrams)a.stats.characters.unigrams.hasOwnProperty(b)&&(c.tokens.characters.unigrams=c.tokens.characters.unigrams+a.stats.characters.unigrams[b],c.characters.unigrams[b]?c.characters.unigrams[b]=c.characters.unigrams[b]+a.stats.characters.unigrams[b]:(c.types.characters.unigrams=c.types.characters.unigrams+1,c.characters.unigrams[b]=a.stats.characters.unigrams[b]));if(a.stats.words)for(b in a.stats.words.unigrams)a.stats.words.unigrams.hasOwnProperty(b)&&(c.tokens.words.unigrams=c.tokens.words.unigrams+a.stats.words.unigrams[b],c.words.unigrams[b]?c.words.unigrams[b]=c.words.unigrams[b]+a.stats.words.unigrams[b]:(c.types.words.unigrams=c.types.words.unigrams+1,c.words.unigrams[b]=a.stats.words.unigrams[b]))}),c.types.characters.unigrams&&(d.debug("dividing "+c.tokens.characters.unigrams+" / "+c.types.characters.unigrams),c.ttr.characters.unigrams=c.tokens.characters.unigrams/c.types.characters.unigrams,d.debug("= "+c.ttr.characters.unigrams)),c.types.words.unigrams&&(d.debug("dividing "+c.tokens.words.unigrams+" / "+c.types.words.unigrams),c.ttr.words.unigrams=c.tokens.words.unigrams/c.types.words.unigrams,d.debug("= "+c.ttr.words.unigrams)),d.debug("done with stats",c),c}}}),c.ComputationalLinguisticsCorpus=f},{"./../datum/ComputationalLinguisticsDatum":33,"./Corpus":23}],21:[function(a,b,c){(function(b){var d=a("./../FieldDBObject").FieldDBObject,e=a("diacritics"),f=function(a){if(this._fieldDBtype||(this._fieldDBtype="Connection"),this.debug("Constructing Connection ",a),a){var b=["dbname","pouchname","title","titleAsUrl"];b.map(function(b){"default"===a[b]&&(a[b]="")})}d.apply(this,arguments)};f.DEFAULT_LOCALHOST_CONNECTION=function(a){return{corpusid:"TBA",dbname:a.dbname,protocol:"https://",domain:"localhost",port:"3183",path:"",userFriendlyServerName:"Localhost",authUrls:["https://localhost:3182"],clientUrls:[{userFriendlyClientName:"Spreadsheet",url:"chrome-extension://pcflbgejbbgijjbmaodhhbibegdfecjc/index.html"},{userFriendlyClientName:"Prototype Online",url:"https://localhost:6984/"+a.dbname+"/_design/data/corpus.html"},{userFriendlyClientName:"Localhost Chrome App",url:"chrome-extension://kaaemcdklbfiiaihlnkmknkgbnkamcbh/user.html#corpus/"+a.dbname},{userFriendlyClientName:"Public Url",url:"https://localhost:3182/"+a.username+"/"+a.corpusidentifier+"/"+a.dbname},{userFriendlyClientName:"Activity Feed",url:"https://localhost:6984/"+a.dbname+"-activity_feed/_design/activity/activity_feed.html"}],corpusUrls:["https://localhost:6984/"+a.dbname],lexiconUrls:["https://localhost:3185/train/lexicon/"+a.dbname],searchUrls:["https://localhost:3195/search/"+a.dbname],audioUrls:["https://localhost:3184/"+a.dbname+"/utterances"],activityUrls:["https://localhost:6984/"+a.dbname+"-activity_feed"]}},f.prototype=Object.create(d.prototype,{constructor:{value:f},INTERNAL_MODELS:{value:{corpusid:d.DEFAULT_STRING,titleAsUrl:d.DEFAULT_STRING,dbname:d.DEFAULT_STRING,pouchname:d.DEFAULT_STRING,protocol:d.DEFAULT_STRING,domain:d.DEFAULT_STRING,port:d.DEFAULT_STRING,path:d.DEFAULT_STRING,userFriendlyServerName:d.DEFAULT_STRING,authUrls:d.DEFAULT_ARRAY,clientUrls:d.DEFAULT_ARRAY,corpusUrls:d.DEFAULT_ARRAY,lexiconUrls:d.DEFAULT_ARRAY,searchUrls:d.DEFAULT_ARRAY,audioUrls:d.DEFAULT_ARRAY,websiteUrls:d.DEFAULT_ARRAY,activityUrls:d.DEFAULT_ARRAY}},guessDbType:{value:function(a){if(a){var b;return b=a.indexOf("activity_feed")>-1?a.split("-").length>=3?"corpus_activity_feed":"user_activity_feed":"corpus"}}},dbname:{get:function(){return this.parent&&this.parent.dbname?this.parent.dbname:this._dbname},set:function(a){if(a!==this._dbname){if(!a)return void delete this._dbname;if("function"==typeof a.trim){if(a=a.trim(),"default"!==a){var b=a.split("-"),c=b.shift(),d=b.join("-");c=f.validateUsername(c),d=f.validateIdentifier(d),c.changes&&c.changes.length>0&&this.warn(c.changes.join("; "),c.originalIdentifier),d.changes&&d.changes.length>0&&this.warn(d.changes.join("; "),d.originalIdentifier),a=c.identifier+"-"+d.identifier}this._dbname=a}}}},owner:{get:function(){if(this.dbname){var a=this.dbname.split("-"),b=a[0];return b}}},gravatar:{get:function(){return this.parent&&this.parent.gravatar?this._gravatar=this.parent.gravatar:!this._gravatar&&this.dbname&&this.parent&&this.parent.team&&"function"==typeof this.parent.team.buildGravatar&&(this._gravatar=this.parent.team.buildGravatar(this.dbname)),this._gravatar},set:function(a){if(a!==this._gravatar){if(!a)return void delete this._gravatar;"function"==typeof a.trim&&(a=a.trim()),this._gravatar=a}}},corpusid:{get:function(){return!this._corpusid&&this.parent&&this.parent.id&&this.parent.rev&&"function"==typeof this.parent.normalizeFieldWithExistingCorpusFields&&(this._corpusid=this.parent.id),this._corpusid},set:function(a){if(a!==this._corpusid){if(!a)return void delete this._corpusid;"function"==typeof a.trim&&(a=a.trim()),this._corpusid=a}}},description:{get:function(){return this.parent&&this.parent.description&&(this._description=this.parent.description,this._description.length>220&&(this._description=this._description.substring(0,200)+"..."),this.debug("returned this.parent.description",this.parent.id)),this._description},set:function(a){if(a!==this._description){if(!a)return void delete this._description;"function"==typeof a.trim&&(a=a.trim()),this._description=a}}},title:{get:function(){return this.parent&&this.parent.title&&(this._title=this.parent.title,this.debug("returned this.parent.title",this.parent.id)),!this._title&&this.dbname&&(this._title=this.dbname.replace(this.owner+"-","")),this._title},set:function(a){if(a!==this._title){if(!a)return void delete this._title;"function"==typeof a.trim&&(a=a.trim()),this._title=a,this._titleAsUrl=""}}},titleAsUrl:{get:function(){return this.parent&&this.parent.titleAsUrl&&(this._titleAsUrl=this.parent.titleAsUrl),this._titleAsUrl||(this.title?this._titleAsUrl=this.sanitizeStringForFileSystem(this.title,"_").toLowerCase():this.dbname&&(this._title=this._titleAsUrl=this.dbname.replace(this.owner+"-",""))),this._titleAsUrl},set:function(a){if(a!==this._titleAsUrl){if(!a)return void delete this._titleAsUrl;"function"==typeof a.trim&&(a=a.trim()),this._titleAsUrl=a}}},authUrl:{get:function(){return this.authUrls&&this.authUrls[0]?this.authUrls[0]:""},set:function(a){if((!this.authUrls||a!==this.authUrls[0])&&a)if("function"==typeof a.trim&&(a=a.trim()),a=a.replace(/[^.\/]*.fieldlinguist.com:3183/g,"auth.lingsync.org"),this.authUrls)if(0===this.authUrls.length)this.authUrls.unshift(a);else{var b=this.authUrls.indexOf(a);b>-1&&this.authUrls.splice(b,1),this.authUrls.unshift(a)}else this.authUrls=[a]}},domain:{get:function(){return this._domain||""},set:function(a){if(a!==this._domain){if(!a)return void delete this._domain;"function"==typeof a.trim&&(a=a.trim(),a=a.replace(/ifielddevs.iriscouch.com/g,"corpus.lingsync.org")),this._domain=a}}},corpusUrl:{get:function(){var a;if(this.corpusUrls&&this.corpusUrls[0])return this.debug("getting corpusUrl",this.dbname,this.corpusUrls),a=this.corpusUrls[0],this.dbname&&-1===a.indexOf(this.dbname)&&(this.debug(" corpusUrl should have had the dbname",a),(a.indexOf("984")>-1||a.indexOf("https://corpusdev.")>-1||a.indexOf("https://corpus.")>-1)&&(a=a+"/"+this.dbname),this.debug(" corpusUrl is",a),this.corpusUrls[0]=a),a;if(!this.domain||!this.dbname)return"";a=this.protocol+this.domain,this.port&&"443"!==this.port&&"80"!==this.port&&(a=a+":"+this.port);var b=this.path||"";return b&&(b="/"+b),a+=b,a=a+"/"+this.dbname,a=a.replace("http://localhost:5984","https://localhost:6984"),this.corpusUrls=[a],a},set:function(a){if((!this.corpusUrls||a!==this.corpusUrls[0])&&a)if("function"==typeof a.trim&&(a=a.trim(),a=a.replace("http://localhost:5984","https://localhost:6984")),this.corpusUrls)if(0===this.corpusUrls.length)this.corpusUrls.unshift(a);else{this.corpusUrls=f.cleanCorpusUrls(this.corpusUrls);var b=this.corpusUrls.indexOf(a);b>-1&&this.corpusUrls.splice(b,1),this.corpusUrls.unshift(a)}else this.corpusUrls=[a]}},websiteUrl:{get:function(){return this.websiteUrls&&this.websiteUrls[0]?this.websiteUrls[0]:void 0},set:function(a){if((!this.websiteUrls||a!==this.websiteUrls[0])&&a)if("function"==typeof a.trim&&(a=a.trim()),this.websiteUrls)if(0===this.websiteUrls.length)this.websiteUrls.unshift(a);else{var b=this.websiteUrls.indexOf(a);b>-1&&this.websiteUrls.splice(b,1),this.websiteUrls.unshift(a)}else this.websiteUrls=[a]}},website:{get:function(){return this.websiteUrl},set:function(a){this.websiteUrl=a}},brand:{get:function(){return this.userFriendlyServerName},set:function(a){this.userFriendlyServerName=a}},brandLowerCase:{get:function(){return this._brandLowerCase||this._serverLabel||""},set:function(a){this._brandLowerCase=a}},serverLabel:{get:function(){if(this._serverLabel)return this._serverLabel;if(this.brand){var a=this.brand.toLowerCase().split(".")[0],b=f.knownConnections[a];return b?b.serverLabel:a}return""},set:function(a){this._serverLabel=a}},replicatedCorpusUrls:{get:function(){return this._replicatedCorpusUrls||d.DEFAULT_COLLECTION},set:function(a){return a!==this._replicatedCorpusUrls?a?void(this._replicatedCorpusUrls=a):void delete this._replicatedCorpusUrls:void 0}},olacExportConnections:{get:function(){return this._olacExportConnections||d.DEFAULT_COLLECTION},set:function(a){return a!==this._olacExportConnections?a?void(this._olacExportConnections=a):void delete this._olacExportConnections:void 0}},toJSON:{value:function(a,b){this.debug("Customizing toJSON ",a,b),a=!0,this.debug(" forcing corpusUrls to be defined ",this.corpusUrl,this.corpusUrls),this.brandLowerCase=this.brandLowerCase;var c=d.prototype.toJSON.apply(this,arguments);return delete c.dateCreated,delete c.dateModified,delete c.database,c.pouchname=c.dbname=this.dbname||"",c.title=this.title||c.dbname,c.titleAsUrl=this.titleAsUrl||c.dbname,c.website=this.website||"",c.fieldDBtype=this.fieldDBtype,delete c._type,this.debug(c),c}}}),f.knownConnections={localhost:new f({protocol:"https://",domain:"localhost",port:"6984",dbname:"default",path:"",serverLabel:"localhost",authUrls:["https://localhost:3183"],websiteUrls:["https://localhost:3182"],corpusUrls:["https://localhost:6984"],userFriendlyServerName:"Localhost"}),beta:new f({protocol:"https://",domain:"corpusdev.lingsync.org",port:"443",dbname:"default",path:"",serverLabel:"beta",brandLowerCase:"lingsync_beta",authUrls:["https://authdev.lingsync.org"],websiteUrls:["http://lingsync.org"],corpusUrls:["https://corpusdev.lingsync.org"],userFriendlyServerName:"LingSync Beta"}),lingsync:new f({protocol:"https://",domain:"corpus.lingsync.org",port:"443",dbname:"default",path:"",serverLabel:"production",brandLowerCase:"lingsync",authUrls:["https://auth.lingsync.org"],websiteUrls:["http://lingsync.org"],corpusUrls:["https://corpus.lingsync.org"],userFriendlyServerName:"LingSync.org"}),mcgill:new f({protocol:"https://",domain:"corpus.lingsync.org",port:"443",dbname:"default",path:"",serverLabel:"mcgill",authUrls:["https://auth.lingsync.org"],websiteUrls:["http://lingsync.org"],corpusUrls:["https://corpus.lingsync.org"],userFriendlyServerName:"McGill ProsodyLab"}),concordia:new f({protocol:"https://",domain:"corpus.lingsync.org",port:"443",dbname:"default",path:"",serverLabel:"concordia",authUrls:["https://auth.lingsync.org"],websiteUrls:["http://lingsync.org"],corpusUrls:["https://corpus.lingsync.org"],userFriendlyServerName:"Concordia Linguistics"})},f.knownConnections.production=f.knownConnections.lingsync,f.knownConnections.development=f.knownConnections.beta,f.otherwise=null,f.defaultConnection=function(a,c){var e,g;try{g=b.env.NODE_ENV}catch(h){}if(!g)try{g=localStorage.getItem("serverLabel")}catch(h){}if(d.application&&d.application.serverLabel&&(g=d.application.serverLabel),g=g||f.otherwise||"beta",!f.knownConnections[g])throw d.bug("I dont know how to connect to "+g+" please report this."),new Error("I dont know how to connect to "+g+" please report this.");if(f.knownConnections||(f.knownConnections={}),f.knownConnections.localhost||(f.knownConnections.localhost=new f({protocol:"https://",domain:"localhost",port:"6984",dbname:"default",path:"",serverLabel:"localhost",brandLowerCase:"localhost",authUrls:["https://localhost:3183"],corpusUrls:["https://localhost:6984"],userFriendlyServerName:"Localhost"})),!a&&d.application&&d.application.connection&&(e=d.application.connection,a=e.serverLabel),!a)try{window&&window.location?a=window.location.href:(e=f.knownConnections[g],a=e.authUrls[0])}catch(h){if(e=f.knownConnections[g],!e)throw d.bug("I dont know how to connect to "+g+" please report this."),new Error("I dont know how to connect to "+g+" please report this.");a=e.authUrls[0]}if(f.knownConnections[a]?e=f.knownConnections[a]:a.indexOf("_design/")>-1?a.indexOf("corpusdev.lingsync.org")>=0?e=f.knownConnections.beta:a.indexOf("lingsync.org")>=0?e=f.knownConnections.production:a.indexOf("prosody.linguistics.mcgill")>=0?e=f.knownConnections.mcgill:a.indexOf("localhost")>=0&&(e=f.knownConnections.localhost):a.indexOf("jlbnogfhkigoniojfngfcglhphldldgi")>=0?e=f.knownConnections.mcgill:"LingSync Beta"===a?e=f.knownConnections.beta:"LingSync Testing"===a?e=f.knownConnections.beta:"LingSync"===a?e=f.knownConnections.production:"Localhost"===a?e=f.knownConnections.localhost:"McGill ProsodyLab"===a?e=f.knownConnections.mcgill:"Concordia"===a?e=f.knownConnections.concordia:a.indexOf("eeipnabdeimobhlkfaiohienhibfcfpa")>=0?e=f.knownConnections.beta:a.indexOf("ocmdknddgpmjngkhcbcofoogkommjfoj")>=0?e=f.knownConnections.production:a.indexOf("dev.lingsync.org")>=0?e=f.knownConnections.beta:a.indexOf("lingsync.org")>=0?e=f.knownConnections.production:a.indexOf("prosody.linguistics.mcgill")>=0?e=f.knownConnections.mcgill:a.indexOf("linguistics.concordia")>=0?e=f.knownConnections.concordia:a.indexOf("lingsync")>=0?e=f.knownConnections.production:a.indexOf("localhost")>=0?e=f.knownConnections.localhost:0===a.indexOf("chrome-extension")?e=f.knownConnections[g]:0===a.indexOf("file")&&(e=f.knownConnections[g]),!e){console.warn("The user is trying to use a server which is unknown to the system. Attempting to construct its connection. ",a);var i;try{f.URLParser||(f.URLParser=URL)}catch(h){console.log("Cant figure out what the URL parser is"),f.URLParser={parse:function(a){return console.warn("Not parsing this url",a),{}}}}try{i=new f.URLParser(a)}catch(h){-1===h.message.indexOf("Invalid URL")&&(i=f.URLParser.parse(a))}if(i&&i.hostname){for(var j=i.hostname.split(".");j.length>2;)j.shift();j=j.join("."),e=new f({protocol:i.protocol+"//",domain:i.hostname,port:i.port,dbname:"default",path:i.pathname.replace("/",""),serverLabel:j.substring(0,j.lastIndexOf(".")),brandLowerCase:j.substring(0,j.lastIndexOf(".")),authUrls:[a],userFriendlyServerName:j}),f.knownConnections[e.serverLabel]=e}else console.warn("There was no way to deduce the HREF, probably we are in Node or loading from a file://. Using "+g+" instead. ",a),e=f.knownConnections[g]}return c?e:e.clone()},f.validateIdentifier=function(a,b){if(!a)return{changes:["Identifier was empty"],equivalent:function(){return!1}};var c=a.toString(),d=[];return c.toLowerCase()!==c&&(d.push("The identifier has to be lowercase so that it can be used in your CouchDB database names."),c=c.toLowerCase()),c.split("-").length>1&&b&&(c=c.replace(/-/g,""),d.push("We are using - as a reserved symbol in database URIs (Uniform Resource Identifiers), so you can't use it in your username.")),e.remove(c)!==c&&(d.push("You have to use ascii characters in your identifiers because your identifier is used in your in web urls, so its better if you can use something more web friendly."),c=e.remove(c)),c.replace(/[^a-z0-9_-]/g,"_")!==c&&(d.push("You have some characters which web servers wouldn't trust in your identifier."),c=b?c.replace(/[^a-z0-9_-]/g,""):c.replace(/[^a-z0-9_-]/g,"_")),c.length<2&&d.push("Your identifier is really too short."),d.length>0&&d.unshift("You asked to use "+a+" but we would reccomend using this instead: "+c+" the following are a list of reason's why."),{identifier:c,original:a,changes:d,equivalent:function(){return this.original&&"function"==typeof this.original.toLowerCase?this.original.toLowerCase()===this.identifier:void 0}}},f.validateUsername=function(a){return f.validateIdentifier(a,"username")},f.cleanCorpusUrls=function(a){if(!a||!a.length)return a;var b=[];for(var c in f.knownConnections)f.knownConnections.hasOwnProperty(c)&&(b=b.concat(f.knownConnections[c].corpusUrls));for(;a.length&&b.indexOf(a[0])>-1;)a.shift();return a},f.baseSchema={id:"Connection",properties:{corpusid:{type:"string"},dbname:{type:"string"},pouchname:{type:"string"},protocol:{type:"string"},domain:{type:"string"},port:{type:"string"},path:{type:"string"},authUrl:{items:{$ref:"string"},type:"Array"},clientUrls:{items:{$ref:"ClientApp"},type:"Array"},corpusUrls:{items:{$ref:"string"},type:"Array"},lexiconUrls:{items:{$ref:"string"},type:"Array"},searchUrls:{items:{$ref:"string"},type:"Array"},audioUrls:{items:{$ref:"string"},type:"Array"}}},c.Connection=f}).call(this,a("_process"))},{"./../FieldDBObject":4,_process:215,diacritics:149}],22:[function(a,b,c){var d=a("./../Collection").Collection,e=a("./Connection").Connection,f=function(a){this._fieldDBtype||(this._fieldDBtype="Corpora"),this.debug("Constructing Corpora ",a),d.apply(this,arguments)};f.prototype=Object.create(d.prototype,{constructor:{value:f},primaryKey:{get:function(){return this._primaryKey||"dbname"},set:function(a){this._primaryKey=a}},INTERNAL_MODELS:{value:{item:e}},findCorpusConnectionFromTitleAsUrl:{value:function(a,b){var c=this.find(a);return c.length>0?(this.debug("Found a corpus connection using the dbname: "+a,c),c[0]):(c=this.find(b+"-"+a),c.length>0?(this.debug("Found a corpus connection using the owner's username: "+b+" and the dbname: "+a,c),c[0]):(c=this.find("title",a,"fuzzy"),c.length>0?(this.debug("Found a corpus connection using the title: "+a,c),
c[0]):(c=this.find("titleAsUrl",a,"fuzzy"),c.length>0?(this.debug("Found a corpus connection using the titleAsUrl: "+a,c),c[0]):void 0)))}},sanitizeStringForPrimaryKey:{value:function(a){return a}}}),c.Corpora=f,c.Connections=f},{"./../Collection":3,"./Connection":21}],23:[function(a,b,c){var d=a("./../confidentiality_encryption/Confidential").Confidential,e=a("./CorpusMask").CorpusMask,f=a("./../datum/LanguageDatum").LanguageDatum,g=a("./../datum/DatumField").DatumField,h=a("./../datum/DatumFields").DatumFields,i=a("./../datum/Session").Session,j=a("./../user/Speaker").Speaker,k=a("./../FieldDBObject").FieldDBObject,l=a("q"),m=a("./corpus.json"),n=a("./psycholinguistics-corpus.json"),o=function(a){this._fieldDBtype||(this._fieldDBtype="Corpus"),this.debug("Constructing corpus",a),e.apply(this,arguments)};o.DEFAULT_DATUM=f,o.prototype=Object.create(e.prototype,{constructor:{value:o},id:{get:function(){return this._id||k.DEFAULT_STRING},set:function(a){if(a!==this._id){if(!a)return void delete this._id;a.trim&&(a=a.trim()),this._id=a}}},dateOfLastDatumModifiedToCheckForOldSession:{get:function(){var a=0;if(this.sessions&&this.sessions.length>0){var b=this.sessions[this.sessions.length-1];b.dateModified&&(a=b.dateModified)}return new Date(a)},set:function(){}},confidential:{get:function(){return this._confidential||k.DEFAULT_OBJECT},set:function(a){return this.ensureSetViaAppropriateType("confidential",a),this._confidential}},publicCorpus:{get:function(){return this._publicCorpus||k.DEFAULT_STRING},set:function(a){a!==this._publicCorpus&&((!a||"Public"!==a&&"Private"!==a)&&(this.warn("Corpora can be either Public or Private, if you make your corpus Public you can customize which fields are visible to public visitors."),a="Private"),this._publicCorpus=a)}},corpusMask:{get:function(){return this._corpusMask||(this.corpusMask={id:"corpus"}),this._corpusMask},set:function(a){this.ensureSetViaAppropriateType("corpusMask",a)}},corpus:{get:function(){return this},set:function(){}},publicSelf:{get:function(){return console.error("publicSelf is deprecated, use corpusMask instead"),this.corpusMask},set:function(a){this.corpusMask=a}},validationStati:{get:function(){return this._validationStati||k.DEFAULT_COLLECTION},set:function(a){this.ensureSetViaAppropriateType("validationStati",a)}},tags:{get:function(){return this._tags||k.DEFAULT_COLLECTION},set:function(a){this.ensureSetViaAppropriateType("tags",a)}},fetch:{value:function(a){return!this.id&&this.dbname?this.loadCorpusByDBname(this.dbname):(a&&this.warn("Using a custom url to fetch this Corpus."+a),e.prototype.fetch.apply(this,arguments))}},loadCorpusByDBname:{value:function(a){if(!a)throw new Error("Cannot load corpus, its dbname was undefined");var b=this.loadCorpusByDBnameDeferred||l.defer(),c=this;return a=a.trim(),this.dbname=a,this.loading=!0,l.nextTick(function(){var d=function(d){return c.debug(d),c.runningloadCorpusByDBname?(c.warn("Error finding a corpus in "+c.dbname+" database. This database will not function normally. Please report this."),c.bug("Error finding corpus details in "+c.dbname+" database. This database will not function normally. Please report this."),void b.reject(d)):(c.runningloadCorpusByDBname=!0,c.loadCorpusByDBnameDeferred=b,c.debug("Wating 1000ms to try to load again."),void setTimeout(function(){c.loadCorpusByDBname(a)},1e3))};c.fetchCollection(c.api).then(function(a){c.debug(a);var e=function(a){c.runningloadCorpusByDBname=!1,delete c.loadCorpusByDBnameDeferred,c.id=a,c.fetch().then(function(a){c.debug("Finished fetch of corpus ",a),c.loading=!1,b.resolve(a)},function(a){c.loading=!1,b.reject(a)}).fail(function(a){console.error(a.stack,c),b.reject(a)})};1===a.length?e(a[0]._id):a.length>1?(c.warn("Impossible to have more than one corpus for this dbname, marking irrelevant corpora as trashed"),a.map(function(a){a.value.dbname===c.dbname||a.value.pouchname===c.dbname?e(a.value._id):(c.warn("There were multiple corpora details in this database, it is probaly one of the old offline databases prior to v1.30 or the result of merged corpora. This is not really a problem, the correct details will be used, and this corpus details will be marked as deleted. "+a.value),a.value.trashed="deleted",c.set(a.value).then(function(a){c.debug("flag as deleted succedded",a)},function(b){c.warn("flag as deleted failed",b,a.value)}).fail(function(a){console.error(a.stack,c),b.reject(a)}))})):d(a)},function(a){c.debug(JSON.stringify(a)),a&&a.userFriendlyErrors&&a.userFriendlyErrors[0].indexOf("device will be unable to contact")>-1?b.reject(a):d(a)})}),b.promise}},fetchMask:{value:function(){if(this.todo("test fetchMask"),!this.dbname)throw new Error("Cannot load corpus's public self, its dbname was undefined");var a=l.defer(),b=this;return l.nextTick(function(){return b.corpusMask&&b.corpusMask.rev?void a.resolve(b.corpusMask):(b.corpusMask=new e({dbname:b.dbname}),void b.corpusMask.fetch().then(a.resolve,a.reject).fail(function(c){console.error(c.stack,b),a.reject(c)}))}),a.promise}},api:{value:"private_corpora"},defaults:{get:function(){var a=JSON.parse(JSON.stringify(m));return a.confidential.secretkey=k.uuidGenerator(),a},set:function(){}},defaults_psycholinguistics:{get:function(){var a=this.defaults;if(n){for(var b in n)n.hasOwnProperty(b)&&(a[b]=n[b]);a.participantFields=this.defaults.speakerFields.concat(a.participantFields)}return JSON.parse(JSON.stringify(a))},set:function(){}},putInTrash:{value:function(){OPrime.bug("Sorry deleting corpora is not available right now. Too risky... ")}},newComment:{value:function(a){var b={text:a};return this.comments.add(b),this.unsavedChanges=!0,window.app.addActivity({verb:"commented",verbicon:"icon-comment",directobjecticon:"",directobject:"'"+a+"'",indirectobject:"on <i class='icon-cloud'></i><a href='#corpus/"+this.id+"'>this corpus</a>",teamOrPersonal:"team",context:" via Offline App."}),window.app.addActivity({verb:"commented",verbicon:"icon-comment",directobjecticon:"",directobject:"'"+a+"'",indirectobject:"on <i class='icon-cloud'></i><a href='#corpus/"+this.id+"'>"+this.get("title")+"</a>",teamOrPersonal:"personal",context:" via Offline App."}),b}},currentSession:{get:function(){return this._currentSession},set:function(a){this._currentSession=a}},newSession:{value:function(a){var b;b=this.currentSession&&this.currentSession.sessionFields?this.currentSession.sessionFields.clone():this.sessionFields.clone();var c=new i({dbname:this.dbname,fields:b,confidential:this.confidential});for(var d in a)a.hasOwnProperty(d)&&(c.fields[d]?(this.debug("  this option appears to be a sessionField "+d),c.fields[d].value=a[d]):c[d]=a[d]);return c}},newDoc:{value:function(a){return this.newDatum(a)}},newDatum:{value:function(a){if(this.debug("Creating a datum for this corpus"),!this.datumFields||!this.datumFields.clone)throw new Error("This corpus has no default datum fields... It is unable to create a datum.");var b;a instanceof o.DEFAULT_DATUM?(b=a,b.dbname=this.dbname,b.confidential=this.confidential,b=this.updateDatumToCorpusFields(b)):b=new o.DEFAULT_DATUM({fields:new h(this.datumFields.cloneStructure()),dbname:this.dbname,confidential:this.confidential});for(var c in a)a.hasOwnProperty(c)&&(b.fields[c]?(this.debug("  this option appears to be a datumField "+c),b.fields[c].value=a[c]):b[c]=a[c]);return b.fossil=b.toJSON(),b}},newDatumAsync:{value:function(a){var b=l.defer(),c=this;return l.nextTick(function(){var d=c.newDatum(a);b.resolve(d)}),b.promise}},newField:{value:function(a){return a=a||{},a instanceof g||(a=new g(a)),a}},addDatumField:{value:function(a){!a.id&&a.label&&(a.id=a.label),a instanceof g||(a=new g(a)),this.datumFields.add(a)}},newSpeaker:{value:function(a){var b=l.defer(),c=this;return l.nextTick(function(){if(c.debug("Creating a datum for this corpus"),!c.speakerFields||!c.speakerFields.clone)throw new Error("This corpus has no default datum fields... It is unable to create a datum.");var d=new j({speakerFields:new h(c.speakerFields.clone()),confidential:c.confidential});for(var e in a)a.hasOwnProperty(e)&&(d.speakerFields[e]?(c.debug("  this option appears to be a datumField "+e),d.speakerFields[e].value=a[e]):d[e]=a[e]);b.resolve(d)}),b.promise}},updateDatumToCorpusFields:{value:function(a){return this.datumFields?a.fields?(a.fields=(new h).merge(this.datumFields,a.fields),a):(a.fields=this.datumFields.clone(),a):a}},updateSpeakerToCorpusFields:{value:function(a){return this.speakerFields||(this.speakerFields=this.defaults_psycholinguistics.speakerFields),a.fields?(a.fields=(new h).merge(this.speakerFields,a.fields),a):(a.fields=this.speakerFields.clone(),a)}},updateParticipantToCorpusFields:{value:function(a){return this.participantFields||(this.participantFields=this.defaults_psycholinguistics.participantFields),a.fields?(a.fields=(new h).merge(this.participantFields,a.fields,"overwrite"),a):(a.fields=this.participantFields.clone(),a)}},newCorpus:{value:function(a){var b,c=this;if(this.dbname&&this.dbname.indexOf("firstcorpus")>-1)b=new o(o.prototype.defaults);else{b=this.clone(),b.comments=[],b.confidential=(new d).fillWithDefaults();var e=["datumFields","sessionFields","conversationFields","participantFields","speakerFields"],f=this.defaults;e.map(function(a){c[a]?(c.debug("Cloning structure only of fieldsType: ",a),b[a]=c[a].cloneStructure()):(c.debug("fieldsType "+a+" was missing on this corpus, it's copy will have the fields. ",c),b[a]=f[a])}),this.dbname&&(b.dbname=this.dbname+"_copy"),b.title=b.title+" copy",b.titleAsUrl=b.titleAsUrl+"Copy",b.description="Copy of: "+b.description}for(var g in a)a.hasOwnProperty(g)&&(b[g]=a[g]);return b}},cloneStructure:{value:function(){return this.newCorpus()}},glosser:{get:function(){return this.glosserExternalObject},set:function(a){a!==this.glosserExternalObject&&(this.glosserExternalObject=a)}},lexicon:{get:function(){return this.lexiconExternalObject},set:function(a){a!==this.lexiconExternalObject&&(this.lexiconExternalObject=a)}},find:{value:function(a){var b=l.defer();return a?this.get(a)["catch"](function(){return[]}):(b.reject(new Error("Uri must be specified ")),b.promise)}},normalizeFieldWithExistingCorpusFields:{value:function(a,b){if(a&&"function"==typeof a.trim&&(a=a.trim()),void 0!==a&&null!==a&&""!==a){"object"!=typeof a&&(a={id:a});var c=a.id||a.label;if(void 0!==c&&null!==c&&""!==c){var d=c.toLowerCase().replace(/[^a-z]/g,"");b||(b=new h,this.datumFields&&this.datumFields.length>0?b.add(this.datumFields.toJSON()):b.add(m.datumFields),this.participantFields&&this.participantFields.length>0&&this.participantFields.toJSON?b.add(this.participantFields.toJSON()):b.add(n.participantFields),this.speakerFields&&this.speakerFields.length>0&&this.speakerFields.toJSON?b.add(this.speakerFields.toJSON()):b.add(m.speakerFields),this.conversationFields&&this.conversationFields.length>0&&this.conversationFields.toJSON?b.add(this.conversationFields.toJSON()):b.add(m.conversationFields),this.debug("Using a clone of the corpus fields. ",b));var e=b.find(a,null,!0);return e&&0!==e.length||(d.indexOf("checkedwith")>-1||d.indexOf("checkedby")>-1||d.indexOf("publishedin")>-1?(e=b.find("validationStatus"),e.length>0&&(this.debug("This header matches an existing corpus field. ",e),e[0].labelFieldLinguists=a.labelFieldLinguists||c,e[0].labelExperimenters=a.labelExperimenters||c)):d.indexOf("codepermanent")>-1?(e=b.find("anonymouscode"),e.length>0&&(this.debug("This header matches an existing corpus field. ",e),e[0].labelFieldLinguists=a.labelFieldLinguists||c,e[0].labelExperimenters=a.labelExperimenters||c)):d.indexOf("nsection")>-1?(e=b.find("courseNumber"),e.length>0&&(this.debug("This header matches an existing corpus field. ",e),e[0].labelFieldLinguists=a.labelFieldLinguists||c,e[0].labelExperimenters=a.labelExperimenters||c)):d.indexOf("prenom")>-1||d.indexOf("prnom")>-1?(e=b.find("firstname"),e.length>0&&(this.debug("This header matches an existing corpus field. ",e),e[0].labelFieldLinguists=a.labelFieldLinguists||c,e[0].labelExperimenters=a.labelExperimenters||c)):d.indexOf("nomdefamille")>-1?(e=b.find("lastname"),e.length>0&&(this.debug("This header matches an existing corpus field. ",e),e[0].labelFieldLinguists=a.labelFieldLinguists||c,e[0].labelExperimenters=a.labelExperimenters||c)):d.indexOf("datedenaissance")>-1&&(e=b.find("dateofbirth"),e.length>0&&(this.debug("This header matches an existing corpus field. ",e),e[0].labelFieldLinguists=a.labelFieldLinguists||c,e[0].labelExperimenters=a.labelExperimenters||c))),e&&0!==e.length||(e=[new g(g.prototype.defaults)],e[0].id=c,e[0].labelFieldLinguists=c,b.add(e[0])),e&&e[0]&&(e=e[0]),this.debug("correspondingDatumField ",e),e instanceof g?e:new g(e)}}}},prepareANewOfflinePouch:{value:function(){throw new Error("I dont know how to prepareANewOfflinePouch")}},saveCorpus:{value:function(){var a=l.defer(),b=this,c=!1;this.id?b.debug("Existing corpus"):(b.debug("New corpus"),c=!0);var d=this.get("_rev");return this.timestamp=Date.now(),b.unsavedChanges=!1,b.save().then(function(e){var f=e.title,g="#diff/oldrev/"+d+"/newrev/"+e._rev,h="modified",i="icon-pencil";c&&(h="added",i="icon-plus");var j=b.dbname.split("-")[0];window.app.addActivity({verb:"<a href='"+g+"'>"+h+"</a> ",verbmask:h,verbicon:i,directobject:"<a href='#corpus/"+e.id+"'>"+f+"</a>",directobjectmask:"a corpus",directobjecticon:"icon-cloud",indirectobject:"created by <a href='#user/"+j+"'>"+j+"</a>",context:" via Offline App.",contextmask:"",teamOrPersonal:"personal"}),window.app.addActivity({verb:"<a href='"+g+"'>"+h+"</a> ",verbmask:h,verbicon:i,directobject:"<a href='#corpus/"+e.id+"'>"+f+"</a>",directobjectmask:"a corpus",directobjecticon:"icon-cloud",indirectobject:"created by <a href='#user/"+j+"'>this team</a>",context:" via Offline App.",contextmask:"",teamOrPersonal:"team"}),a.resolve(b)},a.reject).fail(function(c){console.error(c.stack,b),a.reject(c)}),a.promise}},validDBQueries:{value:function(){return{}}},validate:{value:function(a){return a=a||this,a.publicCorpus&&"Public"!==a.publicCorpus&&"Private"!==a.publicCorpus?"Corpus must be either Public or Private":void 0}},buildMorphologicalAnalyzerFromTeamServer:{value:function(a,b){a||(a=this.dbname),this.glosser.downloadPrecedenceRules(a,this.glosserURL,b)}},buildLexiconFromTeamServer:{value:function(a,b){a||(a=this.dbname),this.lexicon.buildLexiconFromCouch(a,b)}},getFrequentDatumFields:{value:function(){return this.getFrequentValues("fields",["judgement","utterance","morphemes","gloss","translation"])}},getFrequentDatumValidationStates:{value:function(){return this.getFrequentValues("validationStatus",["Checked","Deleted","ToBeCheckedByAnna","ToBeCheckedByBill","ToBeCheckedByClaude"])}},getCorpusSpecificLocalizations:{value:function(a){var b=this;return a?(this.todo("Test the loading of an optionalLocaleCode"),this.get(a+"/messages.json").then(function(a){return a?void b.application.contextualizer.addMessagesToContextualizedStrings("null",a):void b.warn("the requested locale was empty.")},function(a){b.warn("The requested locale wasn't loaded"),b.debug("locale loading error",a)}).fail(function(a){console.error(a.stack,b)})):this.fetchCollection("locales").then(function(a){for(var c=0;c<a.length;c++)a[c]?b.application.contextualizer.addMessagesToContextualizedStrings(null,a[c]):b.warn("the requested locale was empty.")},function(a){b.warn("The locales didn't loaded"),b.debug("locale loading error",a)}).fail(function(a){console.error(a.stack,b)}),this}},getFrequentValues:{value:function(a,b){var c,d=l.defer();return b||(b=c["defaultFrequentDatum"+a]),c["frequentDatum"+a]?(l.nextTick(function(){d.resolve(c["frequentDatum"+a])}),d.promise):(this.fetchCollection("frequentDatum"+a,0,0,100,!0).then(function(b){c["frequentDatum"+a]=b,d.resolve(b)},function(e){c.debug("resolving defaults for frequentDatum"+a,e),d.resolve(b)}),d.promise)}},getFrequentDatumTags:{value:function(){return this.getFrequentValues("tags",["Passive","WH","Indefinte","Generic","Agent-y","Causative","Pro-drop","Ambigous"])}},toJSON:{value:function(a,b){this.debug("Customizing toJSON ",a,b);var c=["gravatar","OLAC_export_connections","url"],d=k.prototype.toJSON.apply(this,[a,b,c]);return d?(this.team&&"function"==typeof this.team.toJSON&&(d.team=this.team.toJSON()),this.confidential&&"function"==typeof this.confidential.toJSON&&(d.confidential=this.confidential.toJSON()),this.activityConnection&&"function"==typeof this.activityConnection.toJSON&&(d.activityConnection=this.activityConnection.toJSON()),this.debug(d),d):void this.warn("Not returning json right now.")}}}),c.Corpus=o,c.FieldDatabase=o},{"./../FieldDBObject":4,"./../confidentiality_encryption/Confidential":18,"./../datum/DatumField":35,"./../datum/DatumFields":36,"./../datum/LanguageDatum":42,"./../datum/Session":44,"./../user/Speaker":72,"./CorpusMask":24,"./corpus.json":27,"./psycholinguistics-corpus.json":29,q:223}],24:[function(a,b,c){var d=a("./../confidentiality_encryption/Confidential").Confidential,e=a("./../activity/Activities").Activities,f=a("./Database").Database,g=a("./Connection").Connection,h=a("./../datum/DatumFields").DatumFields,i=a("./../datum/DatumStates").DatumStates,j=a("./../datum/DatumTags").DatumTags,k=a("./../comment/Comments").Comments,l=a("./../FieldDBObject").FieldDBObject,m=a("./../datum/DocumentCollection").DocumentCollection,n=a("./../datum/DocumentCollection").DocumentCollection,o=a("./../user/UserPreference").UserPreference,p=a("./../user/Team").Team,q=a("./../permission/Permissions").Permissions,r=a("q"),s=a("./corpus_mask.json"),t=function(a){this._fieldDBtype||(this._fieldDBtype="CorpusMask"),this.debug(a),f.apply(this,arguments)};t.prototype=Object.create(f.prototype,{constructor:{value:t},id:{get:function(){return this._id="corpus",this._id},set:function(a){a!==this._id&&(this.warn('CorpusMask id cannot be set, it is "corpus" by default.'+a),a="corpus",this._id=a)}},api:{value:"corpora"},defaults:{get:function(){var a=JSON.parse(JSON.stringify(s));return a}},INTERNAL_MODELS:{value:{_id:l.DEFAULT_STRING,_rev:l.DEFAULT_STRING,dbname:l.DEFAULT_STRING,version:l.DEFAULT_STRING,dateCreated:l.DEFAULT_DATE,dateModified:l.DEFAULT_DATE,comments:k,sessions:m,datalists:n,titleAsUrl:l.DEFAULT_STRING,connection:g,activityConnection:e,publicCorpus:l.DEFAULT_STRING,confidential:d,validationStati:i,tags:j,fields:h,datumFields:h,speakerFields:h,participantFields:h,conversationFields:h,sessionFields:h,prefs:o,team:p,permissions:q}},addField:{value:function(a){if(this.fields||(this.fields=[]),"string"==typeof a){if(this.fields[a])return this.fields[a];a={id:a}}return this.debug("adding field",a),this.fields.add(a)}},titleAsUrl:{get:function(){return!this._titleAsUrl&&this.title&&(this._titleAsUrl=this.sanitizeStringForFileSystem(this.title,"_").toLowerCase()),this._titleAsUrl},set:function(a){a!==this._titleAsUrl&&this._titleAsUrl&&this.warn("titleAsUrl cannot be set directly, setting the title will cause it to be set.")}},title:{configurable:!0,get:function(){return this.fields&&this.fields.title?this.fields.title.value:l.DEFAULT_STRING},set:function(a){this.fields&&this.fields.title||this.addField("title"),this.fields.title.value=a,a?this._titleAsUrl=this.sanitizeStringForFileSystem(a,"_").toLowerCase():this._titleAsUrl=this.dbname}},description:{configurable:!0,get:function(){return this.fields&&this.fields.description?this.fields.description.value:l.DEFAULT_STRING},set:function(a){this.fields&&this.fields.description||this.addField("description"),this.fields.description.value=a}},keywords:{configurable:!0,get:function(){return this.fields&&this.fields.keywords?this.fields.keywords.value:l.DEFAULT_STRING},set:function(a){this.fields&&this.fields.keywords||this.addField("keywords"),this.fields.keywords.value=a}},team:{get:function(){return this._team||(this.team={gravatar:"",username:"",_id:"team"},this.dbname&&(this._team.gravatar=this._team.gravatar||this.gravatar||this._team.buildGravatar(this.dbname),this._team.username=this._team.username||this.dbname.split("-")[0]),this.id&&this.rev&&this._team.fetch()),this._team},set:function(a){this.ensureSetViaAppropriateType("team",a)}},activityConnection:{get:function(){if(this.debug("getting activityConnection"),!this._activityConnection&&this.rev&&this._connection){this.warn("This corpus is missing its activity connection for some reason.");var a=this._connection.toJSON();a.dbname=a.dbname+"-activity_feed",this.activityConnection=a}return this._activityConnection&&this._activityConnection.parent!==this&&(this._activityConnection.parent=this),this._activityConnection},set:function(a){a&&(a.parent=this,!a.confidential&&this.confidential&&(a.confidential=this.confidential)),this.ensureSetViaAppropriateType("activityConnection",a)}},replicatedCorpusUrls:{get:function(){return this._connection&&this._connection.replicatedCorpusUrls?this._connection.replicatedCorpusUrls:l.DEFAULT_COLLECTION},set:function(a){this._connection&&(this._connection.replicatedCorpusUrls=a)}},olacExportConnections:{get:function(){return this._connection&&this._connection.olacExportConnections?this._connection.olacExportConnections:l.DEFAULT_COLLECTION},set:function(a){this._connection&&(this._connection.olacExportConnections=a)}},terms:{get:function(){this.warn("terms is deprecated, use termsOfUse instead.")},set:function(a){this.warn("terms is deprecated, use termsOfUse instead."),this.termsOfUse||(this.termsOfUse=a)}},termsOfUse:{configurable:!0,get:function(){return this.fields&&this.fields.rights?this.fields.rights.value:l.DEFAULT_STRING},set:function(a){this.fields&&this.fields.rights||this.addField("rights"),a.humanReadable&&(a=a.humanReadable),this.fields.rights.value=a}},license:{configurable:!0,get:function(){return this.fields&&this.fields.rights&&this.fields.rights.json&&this.fields.rights.json.license?this.fields.rights.json.license:l.DEFAULT_OBJECT},set:function(a){this.fields&&this.fields.rights||(this.addField("rights"),this.fields.rights.json={}),"string"==typeof a&&(a={humanReadable:a}),this.fields.rights.json.license=a}},copyright:{configurable:!0,get:function(){return this.fields&&this.fields.rightsHolder?this.fields.rightsHolder.value:l.DEFAULT_STRING},set:function(a){this.fields&&this.fields.rightsHolder||this.addField("rightsHolder"),this.fields.rightsHolder.value=a}},startYear:{get:function(){if(this.parent&&this.parent.dateCreated&&this.parent._rev&&"Corpus"===this.parent._fieldDBtype&&(this.dateCreated=this.parent.dateCreated),this.dateCreated){var a=new Date(this.dateCreated).getFullYear();a<(new Date).getFullYear()&&(this._startYear=a)}return this._startYear},set:function(a){a!==this._startYear&&a&&(this._startYear=a)}},fetch:{value:function(a){var b=this,c=r.defer();this.debug("Customizing fetch ",a);var d=f.prototype.fetch.apply(this,arguments);return d.then(c.resolve),d.fail(function(a){if(b.debug("Fetching CorpusMask failed",a),404===a.status&&/deleted|missing/.test(a.userFriendlyErrors[0])){b.warn("Repairing corpus which is missing its corpus doc: "+a.userFriendlyErrors.join(" ")),b.loaded=!0;var d=l.convertDocIntoItsType(b.defaults);return d.dbname=b.dbname,b.merge("self",d,"overwrite"),c.resolve(b)}c.reject(a)}),c.promise}},sessions:{get:function(){return this.unserializedSessions||l.DEFAULT_COLLECTION},set:function(a){this.ensureSetViaAppropriateType("sessions",a,"unserializedSessions")}},datalists:{get:function(){return this.unserializedDatalists||l.DEFAULT_COLLECTION},set:function(a){this.ensureSetViaAppropriateType("datalists",a,"unserializedDatalists")}},permissions:{get:function(){return this._permissions||(this.permissions={dbname:this.dbname,parent:this}),this._permissions||l.DEFAULT_COLLECTION},set:function(a){this.ensureSetViaAppropriateType("permissions",a)}},loadPermissions:{value:function(a){var b=r.defer(),c=this;return r.nextTick(function(){c.permissions&&c.permissions instanceof q||(c.permissions=new q(c.permissions)),c.permissions.dbname||(c.permissions.dbname=c.dbname),c.permissions.parent=c,c.permissions.fetch(a).then(b.resolve,b.reject).fail(function(a){console.error(a.stack,c),b.reject(a)})}),b.promise}},datumFields:{get:function(){return this.debug("getting datumFields"),this._datumFields},set:function(a){a&&!a.confidential&&this.confidential&&(a.confidential=this.confidential),this.ensureSetViaAppropriateType("datumFields",a)}},sessionFields:{get:function(){return this.debug("getting sessionFields"),this._sessionFields},set:function(a){a&&!a.confidential&&this.confidential&&(a.confidential=this.confidential),this.ensureSetViaAppropriateType("sessionFields",a)}},speakerFields:{get:function(){return this.debug("getting speakerFields"),this._speakerFields},set:function(a){a&&!a.confidential&&this.confidential&&(a.confidential=this.confidential),this.ensureSetViaAppropriateType("speakerFields",a)}},participantFields:{get:function(){return this.debug("getting participantFields"),this._participantFields},set:function(a){a&&!a.confidential&&this.confidential&&(a.confidential=this.confidential),this.ensureSetViaAppropriateType("participantFields",a)}},conversationFields:{get:function(){return this.debug("getting conversationFields"),this._conversationFields},set:function(a){a&&!a.confidential&&this.confidential&&(a.confidential=this.confidential),this.ensureSetViaAppropriateType("conversationFields",a)}},fields:{get:function(){return this.debug("getting fields"),this._fields},set:function(a){a&&!a.confidential&&this.confidential&&(a.confidential=this.confidential),this.ensureSetViaAppropriateType("fields",a)}},prefs:{get:function(){return!this._prefs&&this.INTERNAL_MODELS&&this.INTERNAL_MODELS.prefs&&this.INTERNAL_MODELS.prefs.prototype&&this.INTERNAL_MODELS.prefs.prototype.defaults&&(this.prefs=this.INTERNAL_MODELS.prefs.prototype.defaults),this._prefs},set:function(a){this.ensureSetViaAppropriateType("prefs",a)}},preferredDatumTemplate:{get:function(){if(this.prefs&&this.prefs.preferredDatumTemplate){var a=this.upgradeCorpusFieldsToMatchDatumTemplate(this.prefs.preferredDatumTemplate);if(!a)return this.prefs.preferredDatumTemplate;this.warn("preferredDatumTemplate is no longer needed")}},set:function(a){if(!this.prefs||!this.prefs.preferredDatumTemplate||a!==this.prefs.preferredDatumTemplate){if(!a||"default"===a)return void(this.prefs&&this.prefs.preferredDatumTemplate&&delete this.prefs.preferredDatumTemplate);this.prefs=this.prefs||{};var b=this.upgradeCorpusFieldsToMatchDatumTemplate(a.trim());b?this.warn("preferredDatumTemplate is no longer needed"):this.prefs.preferredDatumTemplate=a.trim()}}},upgradeCorpusFieldsToMatchDatumTemplate:{value:function(a){if(this.preferredDatumTemplateAtVersion)return!0;if(!this.datumFields.reorder)return this.warn("could not upgrade corpus fields order to match data entry template for the spreadsheet app "),!1;this.preferredDatumTemplateAtVersion=this.version,this.preferredDatumTemplate=null,this.prefs=this.prefs||{},this.prefs.debug(" this.prefs.preferredSpreadsheetShape.rows ",this.prefs.preferredSpreadsheetShape.rows);var b=["judgement","utterance","morphemes","gloss","translation","context","documentation"];"compacttemplate"===a?b=["judgement","utterance","morphemes","gloss","translation"]:"fulltemplate"===a?b=["judgement","utterance","morphemes","gloss","translation","context","documentation"]:"mcgillfieldmethodsspring2014template"===a?b=["judgement","utterance","morphemes","gloss","translation","validationStatus","tags"]:"mcgillfieldmethodsfall2014template"===a?b=["judgement","utterance","morphemes","gloss","translation","phonetic","notes"]:"yalefieldmethodsspring2014template"===a&&(b=["judgement","orthography","utterance","morphemes","gloss","translation","spanish","Housekeeping","tags"],this.prefs.debug("setting to yalefieldmethodsspring2014template"),this.prefs.preferredSpreadsheetShape=this.prefs.preferredSpreadsheetShape,this.prefs.preferredSpreadsheetShape.rows=4);for(var c={label:"",shouldBeEncrypted:!1,showToUserTypes:"all",defaultfield:!1,value:"",mask:"",json:{},help:"You can add help/conventions here which explain what this data entry field is for your teammates."},d=0;d<b.length;d++){var e=this.datumFields.indexOf(b[d]);if(-1===e){var f=JSON.parse(JSON.stringify(c));f.label=b[d],this.datumFields.add(f),e=this.datumFields.length-1}e===d?this.debug(b[d]+" Field was in the correct order. "):(this.debug(e+" moving to"+d),this.datumFields.reorder(e,d))}var g=this.datumFields.map(function(a){return a.id});return this.warn("reordered fields to "+g),!0}},preferredLocale:{get:function(){return this.prefs&&this.prefs.preferredLocale?this.prefs.preferredLocale:void 0},set:function(a){if(!this.prefs||!this.prefs.preferredLocale||a!==this.prefs.preferredLocale){if(!a||"default"===a)return void(this.prefs&&this.prefs.preferredLocale&&delete this.prefs.preferredLocale);this.prefs=this.prefs||{},this.prefs.preferredLocale=a.trim()}}},preferredDashboardLayout:{get:function(){return this.prefs&&this.prefs.preferredDashboardLayout?this.prefs.preferredDashboardLayout:void 0},set:function(a){if(!this.prefs||!this.prefs.preferredDashboardLayout||a!==this.prefs.preferredDashboardLayout){if(!a||"default"===a)return void(this.prefs&&this.prefs.preferredDashboardLayout&&delete this.prefs.preferredDashboardLayout);this.prefs=this.prefs||{},this.prefs.preferredDashboardLayout=a.trim()}}},preferredTemplate:{get:function(){return this.warn("preferredTemplate is deprecated, use preferredDatumTemplate instead."),this.preferredDatumTemplate},set:function(a){this.warn("preferredTemplate is deprecated, please use preferredDatumTemplate instead."),this.preferredDatumTemplate=a}},toJSON:{value:function(a,b){this.debug("Customizing toJSON ",a,b);var c=f.prototype.toJSON.apply(this,arguments);return c?(this.debug("saving description, title, termsOfUse, license  as the deprecated attribute"),c.title=this.title,c.description=this.description,c.termsOfUse=this.termsOfUse,c.license=this.license,c.copyright=this.copyright,this.debug(c),c):void this.warn("Not returning json right now.")}}}),c.CorpusMask=t},{"./../FieldDBObject":4,"./../activity/Activities":6,"./../comment/Comments":17,"./../confidentiality_encryption/Confidential":18,"./../datum/DatumFields":36,"./../datum/DatumStates":38,"./../datum/DatumTags":40,"./../datum/DocumentCollection":41,"./../permission/Permissions":66,"./../user/Team":73,"./../user/UserPreference":76,"./Connection":21,"./Database":25,"./corpus_mask.json":28,q:223}],25:[function(a,b,c){"use strict";var d=a("q"),e=a("../CORS").CORS,f=a("../FieldDBObject").FieldDBObject,g=a("./../confidentiality_encryption/Confidential").Confidential,h=a("./Connection").Connection,i=function m(a){m.URLParser&&!h.URLParser&&(h.URLParser=m.URLParser),this._fieldDBtype||(this._fieldDBtype="Database"),this.debug("In Database ",a),f.apply(this,arguments)},j='/_design/data/_view/by_type?key="COLLECTION"&descending=true&limit=LIMIT',k="https://localhost:3183",l="https://localhost:6984";i.defaultConnection=h.defaultConnection,i.CORS=e,i.Connection=h,i.DEFAULT_DOCUMENT_LIMIT=1e3,i.prototype=Object.create(f.prototype,{constructor:{value:i},fieldDBtype:{get:function(){return this._fieldDBtype||"Database"},set:function(a){a!==this.fieldDBtype&&this.debug("Using type "+this.fieldDBtype+" when the incoming object was "+a)}},INTERNAL_MODELS:{value:{connection:h}},DEFAULT_COLLECTION_MAPREDUCE:{value:j},BASE_AUTH_URL:{get:function(){return k},set:function(a){k=a}},BASE_DB_URL:{get:function(){return l},set:function(a){l=a}},connection:{get:function(){return this.debug("getting connection"),this._connection&&this._connection.parent!==this&&(this._connection.parent=this),this._connection},set:function(a){a&&(a.parent=this),this.ensureSetViaAppropriateType("connection",a),this._connection&&this._connection.dbname&&"default"!==this._connection.dbname&&!this.dbname&&(this.dbname=this._connection.dbname),this.connection.corpusUrls=h.cleanCorpusUrls(this.connection.corpusUrls)}},url:{get:function(){return this.connection&&this.connection.corpusUrl?this.connection.corpusUrl:this.dbname?this.BASE_DB_URL+"/"+this.dbname:(this.debug("Using an unlikely url, as if this app was running in a website where the databse is."),
"")},set:function(a){this.debug("Setting url  ",a),this.connection||(this.connection=h.defaultConnection(a)),this.dbname&&-1===a.indexOf(this.dbname)&&(this.warn("the url didnt contain this database identifier, that is strange. Adding it to the end",a),a=a+"/"+this.dbname),this.connection.corpusUrl=a}},get:{value:function(a,b){return b=b||this.url,b||this.bug("The url could not be extrapolated for this database, that is strange. The app will likely behave abnormally."),i.CORS.makeCORSRequest({method:"GET",url:b+"/"+a})}},set:{value:function(a,b,c){if(!this.dbname)throw this.bug("Cannot get something if the dbname is not defined ",a,b),new Error("Cannot get something if the dbname is not defined ");var e,f,g=d.defer(),h=this;return b?(e=a,f=b,f.id=e):f=a,this.url||(this.bug("the url could not be extrapolated for this database, that is strange. The app will likely behave abnormally."),this.todo("Consider letting users/apps use the optionalUrl in individual save of docs",c)),i.CORS.makeCORSRequest({method:"POST",data:f,url:this.url}).then(function(a){return a&&a.ok?(a.rev&&(f.rev=f._rev=a.rev),a.id&&(f.id=f._id=a.id),void g.resolve(f)):(a.userFriendlyErrors=a.userFriendlyErrors||["This application has errored. Please notify its developers: Cannot save data. If you keep your browser open, you will not loose your work."],void g.reject(a))},function(a){a||(a={status:400,userFriendlyErrors:["This application has errored. Please notify its developers: Cannot save data. If you keep your browser open, you will not loose your work."]}),a.details=f,h.debug(a),g.reject(a)}).fail(function(a){console.error(a.stack,h),g.reject(a)}),g.promise}},fetchRevisions:{value:function(a,b){var c=d.defer(),e=this;return a?(b=b||this.url,i.CORS.makeCORSRequest({method:"GET",url:b+"/"+a+"?revs_info=true"}).then(function(d){var e=[];d._revs_info.map(function(c){"available"===c.status&&e.push(b+"/"+a+'?rev="'+c.rev+'"')}),c.resolve(e)},function(a){a||(a={status:400,userFriendlyErrors:["This application has errored. Please notify its developers: Cannot save data. If you keep your browser open, you will not loose your work."]}),e.debug(a),c.reject(a)}).fail(function(a){console.error(a.stack,e),c.reject(a)}),c.promise):(d.nextTick(function(){c.resolve(e._revisions||[])}),c.promise)}},"delete":{value:function(a){return this.remove(a)}},remove:{value:function(a){throw this.bug("Deleting data is not permitted.",a),new Error("Deleting data is not permitted.")}},fetchAllDocuments:{value:function(){return this.fetchCollection("datums")}},fetchCollection:{value:function(a,b,c,e,f,g){var h=d.defer(),j=this;if(!a)return d.nextTick(function(){h.reject({status:406,userFriendlyErrors:["This application has errored. Please notify its developers: Cannot fetch data url."]})}),h.promise;g=g?'&key="'+g+'"':"",e=e||1e3;var k=a,l=function(b){j.debug(b),404===b.status&&(k===a?b.userFriendlyErrors=["The server didn't know about the collection "+a+"you requested. Please try another url."]:b.userFriendlyErrors=["The application was unable to request the "+a+" collection. Please report this 290323."]),h.reject(b)};if("[object Array]"===Object.prototype.toString.call(a)){var m=[];a.map(function(a){m.push(i.CORS.makeCORSRequest({type:"GET",dataType:"json",url:j.url+"/"+a}))}),d.allSettled(m).then(function(a){j.debug(a),a.length?h.resolve(a.map(function(a){return"fulfilled"===a.state?a.value:{}})):h.resolve([])},l).fail(function(a){console.error(a.stack,j),h.reject(a)})}else-1===a.indexOf("/")?a=j.url+j.DEFAULT_COLLECTION_MAPREDUCE.replace("COLLECTION",a).replace("LIMIT",e)+g:-1===a.indexOf("://")?a=j.url+a:this.warn("Fetching data from a user supplied url",a),i.CORS.makeCORSRequest({type:"GET",dataType:"json",url:a}).then(function(a){if(!a.rows||!a.rows.length){var b=[];for(var c in a)a.hasOwnProperty(c)&&a[c].collection&&"datalists"===a[c].collection&&b.push(a[c]);return b&&1===b.length?(h.resolve(b[0]),b[0]):(h.resolve(b),b)}h.resolve(a.rows.map(function(a){return a.value}))},l).fail(function(a){console.error(a.stack,j),h.reject(a)});return h.promise}},couchSessionUrl:{get:function(){var a=this.url,b=this.dbname;return a||(a=this.application&&this.application.connection&&this.application.connection.corpusUrl?this.application.connection.corpusUrl:this.connection&&this.connection.corpusUrl?this.connection.corpusUrl:this.BASE_DB_URL),!b&&this.application&&this.application.connection&&this.application.connection.dbname&&(b=this.application.connection.dbname),b&&a.indexOf(b)>0?a=a.replace(b,"_session"):this.connection&&this.connection.dbname&&a.indexOf(this.connection.dbname)>0?a=a.replace(this.connection.dbname,"_session"):a+="/_session",a}},resumeAuthenticationSession:{value:function(){var a=d.defer(),b=this;return i.CORS.makeCORSRequest({type:"GET",dataType:"json",url:this.couchSessionUrl}).then(function(c){b.debug(c),b.connectionInfo=c,c.userCtx.name?a.resolve({username:c.userCtx.name,roles:c.userCtx.roles}):a.reject({error:c,userFriendlyErrors:["Please login."],status:401})},function(b){a.reject(b)}).fail(function(c){console.error(c.stack,b),a.reject(c)}),a.promise}},connectionInfo:{get:function(){var a;try{a=localStorage.getItem("_connectionInfo")}catch(b){this.debug("Localstorage is not available, using the object there will be no persistance across loads",b,this._connectionInfo),a=this._connectionInfo}if(a){try{a=new g({secretkey:"connectionInfo"}).decrypt(a)}catch(b){this.warn("unable to read the connectionInfo info, ",b,this._connectionInfo),a=void 0}return a}},set:function(a){if(a)try{localStorage.setItem("_connectionInfo",new g({secretkey:"connectionInfo"}).encrypt(a))}catch(b){this._connectionInfo=new g({secretkey:"connectionInfo"}).encrypt(a),this.debug("Localstorage is not available, using the object there will be no persistance across loads",b,this._connectionInfo)}else try{localStorage.removeItem("_connectionInfo")}catch(b){this.debug("Localstorage is not available, using the object there will be no persistance across loads",b,this._connectionInfo),delete this._connectionInfo}}},getCouchUrl:{value:function(){return this.corpusUrl}},login:{value:function(a){var b=d.defer(),c=this;return d.nextTick(function(){if(!a)return void b.reject({details:a,userFriendlyErrors:["This application has errored, please contact us."],status:412});var d="name";if(!a.authUrl&&a.name&&(a.authUrl=c.BASE_DB_URL+"/_session"),a.authUrl=c.deduceAuthUrl(a.authUrl),-1===a.authUrl.indexOf("/_session")&&-1===a.authUrl.indexOf("/login")&&(a.authUrl=a.authUrl+"/login",d="username"),!a[d])return void b.reject({details:a,userFriendlyErrors:["Please supply a username."],status:412});if(!a.name&&a.authUrl.indexOf("/_session")>-1)return void b.reject({details:a,userFriendlyErrors:["Please supply a username."],status:412});if(!a.password)return void b.reject({details:a,userFriendlyErrors:["Please supply a password."],status:412});var e=h.validateUsername(a[d]);return e.changes.length>0?(a[d]=e.identifier,c.debug(" Invalid username ",e.changes.join("\n ")),void b.reject({error:e,userFriendlyErrors:e.changes,status:412})):void i.CORS.makeCORSRequest({type:"POST",dataType:"json",url:a.authUrl,data:a}).then(function(d){d&&d.user?(d.info&&"Preferences saved."===d.info[0]&&c.application.authentication&&(c.application.authentication="Welcome back "+d.user.username),b.resolve(d.user)):d&&d.roles?(d.url=a.authUrl,d.roles=d.roles.map(function(b){return a.authUrl+"/"+b}),c.connectionInfo=d,b.resolve(d)):(d=d||{},d.userFriendlyErrors=d.userFriendlyErrors||[" Unknown response from server, please report this."],b.reject(d))},function(d){d.details=a,c.debug(d),b.reject(d)}).fail(function(a){c.debug(a),b.reject(a)})}),b.promise}},logout:{value:function(a){var b=d.defer(),c=this;return a||(a=this.couchSessionUrl),a&&-1!==a.indexOf("/_session")&&a.lastIndexOf("/_session")===a.length-"/_session".length?(i.CORS.makeCORSRequest({type:"DELETE",dataType:"json",url:a}).then(function(a){a.ok?(c.connectionInfo=null,b.resolve(a)):b.reject(a)},function(a){a=a||{},c.debug(a),b.reject(a)}).fail(function(a){console.error(a.stack,c),a.status=a.status||400,a.userFriendlyErrors=a.userFriendlyErrors||["Unknown error, please report this 8912."],b.reject(a)}),b.promise):(d.nextTick(function(){b.reject({userFriendlyErrors:["You cannot log out of "+a+" using this application."],status:412})}),b.promise)}},deduceAuthUrl:{value:function(a){return a||(a=this.authUrl?this.authUrl:this.application&&this.application.connection&&this.application.connection.authUrl?this.application.connection.authUrl:this.BASE_AUTH_URL),a.indexOf("984")>-1&&-1===a.indexOf("_session")&&(a+="/_session"),a}},register:{value:function(a){var b=d.defer(),c=this;return d.nextTick(function(){if(!a&&c.dbname&&2===c.dbname.split("-").length&&(a={username:c.dbname.split("-")[0],password:"testtest",confirmPassword:"testtest",connection:h.defaultConnection()}),!a)return void b.reject({details:a,userFriendlyErrors:["This application has errored, please contact us."],status:412});if(!a.username)return void b.reject({details:a,userFriendlyErrors:["Please supply a username."],status:412});if(!a.password)return void b.reject({details:a,userFriendlyErrors:["Please supply a password."],status:412});if(!a.confirmPassword)return void b.reject({details:a,userFriendlyErrors:["Please confirm your password."],status:412});if(a.confirmPassword!==a.password)return void b.reject({details:a,userFriendlyErrors:["Passwords don't match, please double check your password."],status:412});var d=h.validateUsername(a.username);return d.changes.length>0?(a.username=d.identifier,c.warn(" Invalid username ",d.changes.join("\n ")),void b.reject({error:d,details:a,userFriendlyErrors:d.changes,status:412})):(a.connection?c.debug("Not setting connection"):(c.application&&c.application.connection&&c.application.connection.authUrl?a.connection=c.application.connection:a.connection=h.defaultConnection(a.authUrl),c.debug("Setting connection ",a.connection),delete a.connection.dbname,delete a.connection.pouchname,delete a.connection.title,delete a.connection.titleAsUrl,delete a.connection.corpusUrl),!a.appbrand&&c.application&&c.application.brandLowerCase&&(a.appbrand=c.application.brandLowerCase),a.appVersionWhenCreated=c.version,a.authUrl=a.connection.authUrl,a.authUrl=c.deduceAuthUrl(a.authUrl),void i.CORS.makeCORSRequest({type:"POST",dataType:"json",url:a.authUrl+"/register",data:a}).then(function(d){return c.debug("registration results",d),d.user?void b.resolve(d.user):void b.reject({error:d,status:500,details:a,userFriendlyErrors:d.userFriendlyErrors||["Unknown error. Please report this 2391."]})},function(d){d=d||{},c.debug("after cors connection ",d),d.details=a,c.debug(d),b.reject(d)}).fail(function(d){console.error(d.stack,c),d.status=d.status||400,d.details=a,d.userFriendlyErrors=d.userFriendlyErrors||["Unknown error, please report this 1289128."],b.reject(d)}))}),b.promise}},replicateContinuouslyWithCouch:{value:function(a,b){var c=this;return c.pouch?void c.pouch(function(d,e){var f=c.connection.couchUrl;d?(c.debug("Opening db error",d),"function"==typeof b?b():(this.bug("Opening DB error"+JSON.stringify(d)),c.debug("Opening DB error"+JSON.stringify(d)))):(c.debug("Opening db success",e),c.bug("TODO check to see if  needs a slash if replicating with pouch on "+f),c.replicateFromCorpus(e,f,function(){c.replicateToCorpus(e,f)},function(){c.replicateToCorpus(e,f)}).fail(function(a){console.error(a.stack,c)}),"function"==typeof a&&a())}):(c.debug("Not replicating, no pouch ready."),void("function"==typeof a&&a()))}},replicateOnlyFromCorpus:{value:function(a,b,c){var d=this;return d.pouch?void d.pouch(function(a,e){var f=d.connection.corpusUrl;a?(d.debug("Opening db error",a),"function"==typeof c?c():(d.bug("Opening DB error"+JSON.stringify(a)),d.debug("Opening DB error"+JSON.stringify(a)))):e.replicate.from(f,{continuous:!1},function(a,e){d.debug("Replicate from "+f,e,a),a?"function"==typeof c?c():(d.bug("Corpus replicate from error"+JSON.stringify(a)),d.debug("Corpus replicate from error"+JSON.stringify(a))):(d.debug("Corpus replicate from success",e),"function"==typeof b&&b())})}):(d.debug("Not replicating, no pouch ready."),void("function"==typeof b&&b()))}},replicateToCorpus:{value:function(a,b,c,d){var e=this;a.replicate.to(b,{continuous:!0},function(a,f){e.debug("Replicated to "+b),e.debug(f),e.debug(a),a?(e.debug("replicate to db  error",a),"function"==typeof d?d():(e.bug("Database replicate to error"+JSON.stringify(a)),e.debug("Database replicate to error"+JSON.stringify(a)))):(e.debug("Database replicate to success",f),"function"==typeof c?c():e.debug("Database replicating"+JSON.stringify(e.connection)))})}},replicateFromCorpus:{value:function(a,b,c,d){var e=this;a.replicate.from(b,{continuous:!0},function(a,f){e.debug("Replicated from "+b),e.debug(f),e.debug(a),a?(e.debug("replicate from db  error",a),"function"==typeof d?d():(e.bug("Database replicate from error"+JSON.stringify(a)),e.debug("Database replicate from error"+JSON.stringify(a)))):(e.debug("Database replicate from success",f),"function"==typeof c?c():e.debug("Database replicating"+JSON.stringify(e.connection)))})}},whenDatabaseIsReady:{get:function(){var a=d.defer(),b=this,c=2e3;if(this._whenDatabaseIsReady)return this._whenDatabaseIsReady;this._whenDatabaseIsReady=a.promise;var f=function(){e.makeCORSRequest({type:"GET",url:b.url,data:{}}).then(function(d){return b.debug(d),d.doc_count>2?a.resolve(b):(setTimeout(f,c),void(c*=c))})["catch"](function(d){return b.warn(d),c>12e4?a.reject(d):(setTimeout(f,c),void(c*=c))})};return f(),this._whenDatabaseIsReady},set:function(a){this._whenDatabaseIsReady=a}},changePouch:{value:function(a,b){void 0===this.pouch&&(this.pouch=f.sync.pouch(this.isAndroidApp()?a.touchUrl+a.dbname:a.pouchUrl+a.dbname)),"function"==typeof b&&b()}},modifyTeam:{value:function(a){var b=d.defer(),c=this;return d.nextTick(function(){return a?a.username?a.password?(a.connection=c.connection,void i.CORS.makeCORSRequest({type:"POST",dataType:"json",url:c.connection.authUrl+"/addroletouser",data:a}).then(function(a){b.resolve(a)},function(d){d.details=a,c.debug(d),b.reject(d)}).fail(function(a){c.debug(a),b.reject(a)})):void b.reject({details:a,userFriendlyErrors:["Please supply a password."],status:412}):void b.reject({details:a,userFriendlyErrors:["Please supply a username."],status:412}):void b.reject({details:a,userFriendlyErrors:["This application has errored, please contact us."],status:412})}),b.promise}},addCorpusRoleToUser:{value:function(a,b,c,d){this.debug("deprecated use modifyTeam instead",a,b,c,d)}}}),c.Database=i},{"../CORS":1,"../FieldDBObject":4,"./../confidentiality_encryption/Confidential":18,"./Connection":21,q:223}],26:[function(a,b,c){var d=a("./Database").Database,e=function(a){this._fieldDBtype||(this._fieldDBtype="PsycholinguisticsDatabase"),this.debug("In PsycholinguisticsDatabase ",a),d.apply(this,arguments)},f="/_design/psycholinguistics/_view/COLLECTION?descending=true";e.prototype=Object.create(d.prototype,{constructor:{value:e},DEFAULT_COLLECTION_MAPREDUCE:{value:f}}),c.PsycholinguisticsDatabase=e},{"./Database":25}],27:[function(a,b,c){b.exports={title:"",titleAsUrl:"",connection:{},activityConnection:{},dbname:"",dateOfLastDatumModifiedToCheckForOldSession:"",confidential:{secretkey:""},publicCorpus:"Private",api:"private_corpora",comments:[],validationStati:[{validationStatus:"Checked*",color:"green","default":!0},{validationStatus:"Published*",color:"blue"},{validationStatus:"ToBeChecked*",color:"orange"},{validationStatus:"ApprovedLanguageLearningContent*",color:"green",showInLanguageLearnignApps:!0},{validationStatus:"ContributedLanguageLearningContent*",color:"orange"},{validationStatus:"Deleted*",color:"red",showInSearchResults:!1,showInLanguageLearnignApps:!1},{validationStatus:"Duplicate*",color:"red",showInSearchResults:!1,showInLanguageLearnignApps:!1}],tags:[{tag:"SampleData",color:"green"},{tag:"Food",color:"green"},{tag:"Winter",color:"white"},{tag:"Sports",color:"teal"},{tag:"News",color:"black"},{tag:"Family",color:"blue"},{tag:"Friends",color:"orange"},{tag:"Moving",color:"red"},{tag:"Vulgar",color:"black",showInLanguageLearnignApps:!1}],fields:[{id:"title",label:"Title",defaultfield:!0,help:"A name given to the resource. All other titles (e.g., translations) should be specified as the dcterms:alternative refinement. Example: Na tala 'uria na idulaa diana, Alternative: The road to good reading",json:{alternative:[]}},{id:"description",label:"Description",defaultfield:!0,help:"An account of the resource.",value:"This is probably your first Corpus, you can use it to play with the app... When you want to make a real corpus, click New : Corpus",json:{"abstract":"",tableOfContents:""}},{id:"keywords",type:"tags",label:"Keywords",defaultfield:!0,help:"Keywords describing for your corpus.",showToUserTypes:"all",json:{keywords:[]}},{id:"subject",label:"Subject Language",defaultfield:!0,help:"The topic of the resource. Recommended best practice is to use values from the olac:language scheme using two- and three-letter identifiers from ISO 639.",json:{languages:{}}},{id:"coverage",label:"Location",defaultfield:!0,help:"The spatial or temporal topic of the resource, the spatial applicability of the resource, or the jurisdiction under which the resource is relevant. For examples see: http://www.language-archives.org/NOTE/usage.html",json:{spatial:[],temporal:[]}},{id:"date",label:"Date(s)",defaultfield:!0,help:"Points or periods of time associated with an event in the lifecycle of the resource.",json:{available:"",created:"",dateAccepted:"",dateCopyrighted:"",dateSubmitted:"",issued:"",modified:"",valid:""}},{id:"rights",label:"Terms Of Use",defaultfield:!0,help:"Information about rights held in and over the resource. The rights, in most cases, belong to the creator  not the researcher or sponsor - or, in some cases, to the language community (particularly, if it is constituted as a legal entity). Can include: A description of the terms of use, and instructions on how to get access.",value:"Sample: The materials included in this corpus are available for research and educational use. If you want to use the materials for commercial purposes, please notify the author(s) of the corpus (myemail@myemail.org) prior to the use of the materials. Users of this corpus can copy and redistribute the materials included in this corpus, under the condition that the materials copied/redistributed are properly attributed.  Modification of the data in any copied/redistributed work is not allowed unless the data source is properly cited and the details of the modification is clearly mentioned in the work. Some of the items included in this corpus may be subject to further access conditions specified by the owners of the data and/or the authors of the corpus.",json:{accessRights:"Contact myemail@myemail.org if you would like to gain (read, write, comment, contributor, export, search) access to the non-public parts of this database",license:{title:"Default: Creative Commons Attribution-ShareAlike (CC BY-SA).",humanReadable:"This license lets others remix, tweak, and build upon your work even for commercial purposes, as long as they credit you and license their new creations under the identical terms. This license is often compared to copyleft free and open source software licenses. All new works based on yours will carry the same license, so any derivatives will also allow commercial use. This is the license used by Wikipedia, and is recommended for materials that would benefit from incorporating content from Wikipedia and similarly licensed projects.",imageUrl:"https://i.creativecommons.org/l/by/4.0/88x31.png",link:"http://creativecommons.org/licenses/by-sa/3.0/"}}},{id:"rightsHolder",label:"Copyright",defaultfield:!0,help:"A person or organization owning or managing rights over the resource. Example:  Copyright Regents of the University of California.",value:"Default: Add names of the copyright holders of the corpus."},{id:"contributor",label:"Contributors",defaultfield:!0,help:"Entity/ies responsible for making contributions to the resource. A Contributor may be a person, an organization, or a serviceany entity that has sufficient involvement in the creation or development of the resource to warrant explicit identification. A term from olac:role should be used to specify the role of the Contributor. Contributor is related to Creator since many of the terms in the role vocabulary (like author or photographer) name the role of the primary creator of a resource. The OLAC recommendation is that Contributor (with the appropriate role designation) be used in these cases, and that Creator be used only when there is not an appropriate term in the olac:role vocabulary for the role played by the entity that created the resource. A participating OLAC repository need not be concerned about the fact that other metadata services based on Dublin Core may prefer and even require the use of the Creator element. The OLAC-to-Simple-DC crosswalk built into the OLAC Aggregator automatically maps certain OLAC Contributor roles like author and photographer to the Creator element. See the discussion of Creator for more on its use. Follow the form in which the person's name would normally be listed in an alphabetical index in his or her own language or country of residence, e.g., FamilyName, GivenName for an English speaker. For examples see: http://www.language-archives.org/NOTE/usage.html",json:[]},{id:"creator",label:"Creators",defaultfield:!0,help:"An entity primarily responsible for making the resource. It refers to an entity with a primary role in the creation of the intellectual or artistic content of the resource. For examples see: http://www.language-archives.org/NOTE/usage.html"},{id:"publisher",label:"Publisher",defaultfield:!0,help:"An entity responsible for making the resource available. The Publisher is generally the business, organization, or sometimes individual who takes responsibility (and provides financial and production resources) for putting the resource into a form suitable for making it publicly available, whether in multiple hard copies (printing, pressing of a disc, etc), by broadcasting (radio, television, webcast), or posting to a public website."},{id:"identifier",label:"Identifier",defaultfield:!0,labelComputationalLinguists:"URI",readonly:!0,help:"An unambiguous reference to the resource within a given context.",json:{bibliographicCitation:""}},{id:"format",label:"Format",defaultfield:!0,help:"The file format, physical medium, or dimensions of the resource.",json:{extent:"",medium:""}},{id:"type",label:"Resource Type",defaultfield:!0,help:"The nature or genre of the resource (normally a dataset, but could also be a lexicon and/or a grammar).",value:"Dataset"},{id:"source",label:"Original Source(s)",defaultfield:!0,help:"The present resource may be derived from the Source resource in whole or in part."},{id:"provenance",label:"Provenance",defaultfield:!0,help:"A statement of any changes in ownership and custody of the resource since its creation that are significant for its authenticity, integrity and interpretation. Example: Collection of texts recorded by ____, transcribed with the assistance of a number of local residents. Body of materials were transferred to custody of SIL ____ Branch in 1980s, subsequently organized,  collated and annotated by J. L. ____, a researcher in a closely related _____ language. Annotations particularly relate to changes in orthographic and tone marking conventions over the years of collection and as compared to current practices"},{id:"language",label:"Documentation Language",defaultfield:!0,help:"A language of the resource. Language is used for a language the resource is in (eg: English), as opposed to the language it describes (eg: Quechua)."},{id:"relation",label:"Related resources",defaultfield:!0,help:"URI to related resource(s).",json:{conformsTo:[],hasFormat:[],hasPart:[],hasVersion:[],sFormatOf:[],isPartOf:[],isReferencedBy:[],isReplacedBy:[],isRequiredBy:[],isVersionOf:[],references:[],replaces:[],requires:[]}}],datumFields:[{id:"judgement",labelFieldLinguists:"Grammaticality Judgement",labelExperimenters:"Naturalness",labelNonLinguists:"Not-a-normal-thing-to-say",labelTranslators:"Grammatical/How-normal-Is-This-Example",size:"3",shouldBeEncrypted:!1,showToUserTypes:"linguist",defaultfield:!0,json:{grammatical:!0},help:"Acceptablity judgement (*,#,?  mean this sentence is strange).",helpLinguists:"Grammaticality/acceptability judgement (*, #, ?, 1-3, etc.). Leave this field blank if this entry is grammatical/acceptable.",helpDevelopers:"Grammaticality/acceptability judgement (*,#,?,1-3 etc). Leaving it blank usually means grammatical/acceptable, or your team can choose any symbol for this meaning."},{id:"utterance",labelFieldLinguists:"Transcription",labelNonLinguists:"International Phonetic Alphabet (IPA)",labelTranslators:"Transliteration",type:"IGT, parallelText",shouldBeEncrypted:!0,showToUserTypes:"all",defaultfield:!0,json:{writingSystem:{id:"",referenceLink:""}},help:"What was said/written in an alphabet the team is comfortable using.",helpLinguists:"Transcription of the utterance, without morpheme breaks and probably orthographic.",helpDevelopers:"Unparsed utterance in the language, in orthography or romanized or IPA transcription (what ever is commonly used for linguistic examples of this language.) Line 1 in your LaTeXed examples for handouts. Sample entry: amigas"},{id:"morphemes",labelFieldLinguists:"Morphemes",labelNonLinguists:"Segmentation",labelTranslators:"Prefix-z-root-suffix-z",type:"IGT",shouldBeEncrypted:!0,showToUserTypes:"linguist",defaultfield:!0,json:{alternates:[]},help:"Words divided into prefixes, root and suffixes using a - between each eg: un-forget-able.",helpLinguists:"Morpheme-segmented utterance in the language, probably transcribed phonemically.",helpDevelopers:"Morpheme-segmented utterance in the language. Used by the system to help generate glosses (below). Can optionally appear below (or instead of) the first line in your LaTeXed examples. Sample entry: amig-a-s"},{id:"gloss",labelFieldLinguists:"Gloss",labelNonLinguists:"Word-for-word Translation",labelTranslators:"Word-for-word Translation",type:"IGT",shouldBeEncrypted:!0,showToUserTypes:"linguist",defaultfield:!0,json:{language:"",alternates:[],conventions:{id:"",tagSet:[],referenceLink:""}},help:"Translation for each prefix, root and suffix in the words.",helpLinguists:"A sequence of glosses (i.e., brief translations), one for each morpheme in the morphemes field.",helpDevelopers:"Metalanguage glosses of each individual morpheme (above). Used by the system to help gloss, in combination with morphemes (above). It is Line 2 in your LaTeXed examples. We recommend Leipzig conventions (. for fusional morphemes, - for morpheme boundaries etc).  Sample entry: friend-fem-pl"},{id:"translation",labelFieldLinguists:"Translation",labelNonLinguists:"English",labelTranslators:"English",type:"parallelText",shouldBeEncrypted:!0,showToUserTypes:"all",defaultfield:!0,json:{writingSystem:{id:"",referenceLink:""},language:{ethnologueUrl:"",wikipediaUrl:"",iso:"",locale:"",englishName:"",nativeName:"",alternateNames:""}},help:"Translation into English/Spanish/Russian, or simply a language the team is comfortable with. There may also be additional languages in the other fields.",helpLinguists:"A translation of the utterance in the language of analysis, i.e., the metalanguage.",helpDevelopers:"The team's primary translation. It might not be English, just a language the team is comfortable with (in which case you should change the lable to the language you are using). There may also be additional translations in the other fields."},{id:"context",labelFieldLinguists:"Context",labelNonLinguists:"Context",labelTranslators:"Context",type:"wiki",shouldBeEncrypted:!1,showToUserTypes:"all",defaultfield:!0,json:{tags:[]},help:"Linguistic/social context when this can be said.",helpLinguists:"Linguistic/social context when this can be said, or when it is semantically/pragmatically felicitous etc."},{id:"documentation",labelFieldLinguists:"Discussion",labelNonLinguists:"Additional Documentation",labelTranslators:"Documentation",type:"wiki, LaTeX",shouldBeEncrypted:!1,showToUserTypes:"all",defaultfield:!0,json:{wiki:"",latex:""},help:"Additional discussion of this example (for handouts or for documentation).",helpLinguists:"Additional discussion of this example (for handouts or for documentation). This can be in Wiki or LaTeX or plain text formatting"},{id:"orthography",labelFieldLinguists:"Orthography",labelNonLinguists:"Written",labelTranslators:"Orthography",type:"IGT, parallelText",shouldBeEncrypted:!0,showToUserTypes:"all",defaultfield:!0,json:{writingSystem:{id:"",referenceLink:""}},help:"What was said/written using the alphabet/writing system of the language.",helpLinguists:"Orthographic transcription of the utterance; without morpheme breaks.",helpDevelopers:"Many teams will only use the utterance line. However if your team needs to distinguish between utterance and orthography this is the unparsed word/sentence/dialog/paragraph/document in the language, in its native orthography. If there are more than one orthography an additional field can be added to the corpus. This is Line 0 in your LaTeXed examples for handouts (if you distinguish the orthography from the utterance line and you choose to display the orthography for your language consultants and/or native speaker linguists). Sample entry: amigas"},{id:"allomorphs",labelFieldLinguists:"Allomorphs",labelNonLinguists:"",labelTranslators:"Prefixe-s-root-suffixe-s",type:"IGT",shouldBeEncrypted:!0,showToUserTypes:"linguist",defaultfield:!0,json:{alternates:[]},help:"Words divided into prefixes, root and suffixes which match the spelling of the word (not necessarily the actual dictionary entry of the word) using a - between each eg: prefix-prefix-root-suffix-suffix-suffix.",helpLinguists:"A segmentation of the utterance into morphemes in their surface realizations.",helpDevelopers:"Surface realizations of the morpheme-segmented utterance in the language. Used by the system to help generate glosses (below). Usually does not appear in your LaTeX examples unless you are working on morpho-phonology. Sample entry: amig-a-s"},{id:"syntacticCategory",labelFieldLinguists:"Morpho-Syntactic Category",labelNonLinguists:"",labelTranslators:"Part of Speech",type:"IGT",shouldBeEncrypted:!0,showToUserTypes:"machine, linguist",defaultfield:!0,json:{alternates:[],conventions:{id:"",tagSet:[],referenceLink:""}},help:"This is an optional field which can be used to help with search and data cleaning. eg: noun-thematicvowel-plural",helpLinguists:"A sequence of categories, one for each morpheme in the morphemes field.",helpDevelopers:"This optional field is used by the machine to help with search and data cleaning, in combination with morphemes and gloss (above). If you want to use it, you can choose to use any sort of syntactic category tagging you wish. It could be very theoretical like Distributed Morphology (Sample entry: -GEN-NUM), or very a-theroretical like the Penn Tree Bank Tag Set. (Sample entry: NNS) http://www.ims.uni-stuttgart.de/projekte/CorpusWorkbench/CQP-HTMLDemo/PennTreebankTS.html"},{id:"relatedData",labelFieldLinguists:"Related Data",labelNonLinguists:"Linked to",labelTranslators:"Linked to",labelComputationalLinguists:"Linked Data",type:"relatedData",shouldBeEncrypted:!1,showToUserTypes:"all",readonly:!0,defaultfield:!0,json:{relatedData:[]},help:"Related data in the database, or at any web url."},{id:"tags",labelFieldLinguists:"Tags",labelNonLinguists:"Tags",labelTranslators:"Tags",type:"tags",shouldBeEncrypted:!1,showToUserTypes:"all",defaultfield:!0,json:{tags:[]},help:"Tags for categorizing your data."},{id:"validationStatus",labelFieldLinguists:"Data validity/verification Status",labelNonLinguists:"Data validity/verification Status",
labelTranslators:"Data validity/verification Status",type:"tags",shouldBeEncrypted:!1,showToUserTypes:"all",defaultfield:!0,json:{tags:[]},help:"Tags about data validity. For example: ToBeCheckedBySeberina, CheckedByRicardo, Deleted etc...",helpLinguists:"Tags specifically relevant to data validity, e.g., NeedsToBeChecked.",helpDevelopers:"Any number of tags of data validity. For example: ToBeCheckedBySeberina, CheckedByRicardo, Deleted etc..."},{id:"enteredByUser",labelFieldLinguists:"Imported/Entered By",labelNonLinguists:"Entered By",labelTranslators:"Imported/Entered By",type:"users",shouldBeEncrypted:"",showToUserTypes:"all",readonly:!0,defaultfield:!0,json:{user:{},hardware:{},software:{}},help:"The user who originally entered this."},{id:"modifiedByUser",labelFieldLinguists:"Modified By",labelNonLinguists:"Modified By",labelTranslators:"Modified By",type:"users",shouldBeEncrypted:"",showToUserTypes:"all",readonly:!0,defaultfield:!0,json:{users:[]},help:"Users who modified this",helpDevelopers:"An array of users who modified this, this can optionally introduce a 'CheckedByUsername' into the datum's validation status if your team chooses."},{id:"syntacticTreeLatex",labelFieldLinguists:"Syntactic Tree/Constituency (LaTeX)",labelNonLinguists:"",labelTranslators:"",type:"LaTeX",shouldBeEncrypted:!0,showToUserTypes:"machine",defaultfield:!0,json:{alternates:[]},help:"This an optional field. If you want to use it, you can choose to use any sort of LaTeX Tree package (we use QTree by default) Sample entry: \\Tree [.S NP VP ]",helpLinguists:"A string-based representation of a syntax tree, i.e., a tree in bracket notation. We assume you will use the bracket notation conventions of The LaTeX tree-drawing package QTree, but you may use others if you wish.",helpDevelopers:"This optional field is used by the machine to make LaTeX trees and help with search and data cleaning, in combination with morphemes and gloss (above). If you want to use it, you can choose to use any sort of LaTeX Tree package (we use QTree by default) Sample entry: \\Tree [.S NP VP ]"}],conversationFields:[{id:"speakers",labelFieldLinguists:"Speakers",labelNonLinguists:"Speakers",labelTranslators:"Speakers",type:"users",shouldBeEncrypted:!0,defaultfield:!0,json:{users:[]},help:"Use this field to keep track of who your speaker is. You can use names, initials, or whatever your consultants prefer.",helpLinguists:"The speaker (or speakers) who produced or judged this utterance.",helpDevelopers:"Use this field to keep track of who your speaker is. You can use names, initials, or whatever your consultants prefer."},{id:"modality",labelFieldLinguists:"Modality",labelNonLinguists:"Modality",labelTranslators:"Modality",type:"tags",shouldBeEncrypted:!1,defaultfield:!0,json:{tags:[]},help:"Use this field to indicate if this is a voice or gesture tier, or a tier for another modality.",helpLinguists:"Use this field to indicate if this is a voice or gesture tier, or a tier for another modality."}],sessionFields:[{id:"goal",labelFieldLinguists:"Goal",labelNonLinguists:"Goal",labelTranslators:"Goal",shouldBeEncrypted:!1,defaultfield:!0,help:"The goals of this text/transcript or elicitation session. Why did you get together today or why is this data being added to the database, was it the second day of field methods class, or you wanted to collect some stories from you grandmother, or was it to check on some data you found in the literature...",helpLinguists:"The goal(s) that drove the elicitation session. For example, you may have wanted to collect stories or you may have had specific data questions relevant to a larger research question.",helpDevelopers:"The goals of the elicitation session. Why did you get together today, was it the second day of field methods class, or you wanted to collect some stories from you grandmother, or was it to check on some data you found in the literature..."},{id:"source",labelFieldLinguists:"Language Speakers/Publication/Source",labelNonLinguists:"By",labelTranslators:"Language Speakers/Publication/Source",shouldBeEncrypted:!1,defaultfield:!0,json:{users:[]},help:"This is a comma seperated field of all the consultants/publications/sources who were were the source/present for the data in this data session.",helpLinguists:"A comma-separated list of sources (e.g., textual documents) for this entry.",helpDevelopers:"This is a comma seperated field of all the consultants (usernames, or anonymous codes, or publication uri's) who were present for this elicitation session. This field also contains a (hidden) array of consultant/source masks if they are actual users of the system. "},{id:"dialect",type:"language",labelFieldLinguists:"Dialect",labelNonLinguists:"Dialect",labelTranslators:"Dialect",shouldBeEncrypted:!1,defaultfield:!0,help:"Dialect of this example (city, village, region etc)",helpLinguists:"The dialect represented by the data in this session.",helpDevelopers:"This dialect may precise as the team chooses (province, region, city, village or any other measure of dialect)"},{id:"register",type:"language",labelFieldLinguists:"Social Register",labelNonLinguists:"Social Register",labelTranslators:"Social Register",shouldBeEncrypted:!1,defaultfield:!0,help:"Social register of this example (friends, children speaking with children, formal, religious, ceremonial, etc.)",helpLinguists:"This is an optional field which indicates the social register of the example (friends, children speaking with children, formal, religious, ceremonial, etc.)"},{id:"language",type:"language",labelFieldLinguists:"Language Name",labelNonLinguists:"Language Name",labelTranslators:"Language Name (Ethnologue)",labelComputationalLinguists:"Language Name (ISO 639-3)",shouldBeEncrypted:!1,defaultfield:!0,json:{language:{ethnologueUrl:"",wikipediaUrl:"",iso:"",locale:"",englishName:"",nativeName:"",alternateNames:""}},help:"This is the langauge name (or language family), it is optionally tied to an Ethnologue language code (ISO 639-3).",helpLinguists:"The language represented by the data in this session.",helpDevelopers:"This is the langauge (or language family), there is optional extra information fields if your team wants to tie it to an Ethnologe three letter language code (ISO 639-3)."},{id:"location",type:"location",labelFieldLinguists:"Location",labelNonLinguists:"Location",labelTranslators:"Location",shouldBeEncrypted:!0,encrypted:!0,defaultfield:!0,json:{location:{latitude:0,longitude:0,accuracy:0}},help:"The GPS location of the elicitation session (if available)"},{id:"dateElicited",type:"date",labelFieldLinguists:"Original Date Elicited",labelNonLinguists:"OriginalDate Spoken",labelTranslators:"Original Date Spoken/Published",shouldBeEncrypted:!1,defaultfield:!0,json:{timestamp:{start:null,end:null,accuracy:null}},help:"The date when the elicitation session took place, or when the data within it was spoken/published.",helpLinguists:"The date when the elicitation session took place, or when the data within it was spoken/published."},{id:"participants",labelFieldLinguists:"Elicitation Session Participants",labelNonLinguists:"Session Participants",labelTranslators:"Participants",shouldBeEncrypted:!1,defaultfield:!0,json:{users:[]},help:"A comma-separated list of the people who were present for this elicitation session, or of the authors/reviewers of the publication represented by this session.",helpLinguists:"A comma-separated list of the people who were present for this elicitation session, or of the authors/reviewers of the publication represented by this session.",helpDevelopers:"This is a comma separated field of all the people who were present for this elicitation session. This field also contains a (hidden) array of user masks with more details about the people present, if they are not anonymous or are actual users of the system. "},{id:"DateSessionEntered",type:"date",labelFieldLinguists:"Date Entered",labelNonLinguists:"Date Entered",labelTranslators:"Date Entered",shouldBeEncrypted:!1,defaultfield:!0,json:{timestamp:{start:null,end:null,accuracy:null}},help:"The date when the elicitation session data was entered into the computer.",helpDevelopers:"The date when the elicitation session data was actually entered in the computer (could be different from the dateElicited, especailly if you usually elicit data with an audio recorder and/or a note book)."},{id:"device",type:"device",labelFieldLinguists:"Device Hardware",labelNonLinguists:"Device Hardware",labelTranslators:"Device Hardware",shouldBeEncrypted:!1,defaultfield:!0,json:{device:{}},help:"The optional device details of the equipment used to record the elicitation session. This can be useful for measuring phonetic quality of the recording etc. e.g.: Nexus 7 Android 4.1",helpLinguists:"The optional device details of the equipment used to record the elicitation session. This can be useful for measuring phonetic quality of the recording etc. e.g., Nexus 7 Android 4.1",helpDevelopers:"Your app can save optional anonymous device details of the equipment/software which used to record the elicitation session. This can be useful for measuring phonetic quality of the recording etc. e.g.: Nexus 7 Android 4.1"}],speakerFields:[{id:"anonymousCode",labelFieldLinguists:"Anonymous Code",labelNonLinguists:"Anonymous Code",labelTranslators:"Anonymous Code",shouldBeEncrypted:!1,showToUserTypes:"all",defaultfield:!0,help:"A field to anonymously identify language speakers/participants.",helpLinguists:"A field to anonymously identify language consultants/informants/experiment participants (by default it can be a timestamp, or a combination of experimenter initials, speaker/participant initials etc)."},{id:"firstname",labelFieldLinguists:"First Name",labelNonLinguists:"",labelTranslators:"",shouldBeEncrypted:!0,encrypted:!0,showToUserTypes:"all",defaultfield:!0,help:"The first name of the speaker/participant (optional, encrypted if speaker is anonymous)",helpLinguists:"The first name of the speaker/participant (optional, should be encrypted if speaker should remain anonymous)"},{id:"lastname",labelFieldLinguists:"Last Name",labelNonLinguists:"",labelTranslators:"",shouldBeEncrypted:!0,encrypted:!0,showToUserTypes:"all",defaultfield:!0,help:"The last name of the speaker/participant (encrypted).",helpLinguists:"The last name of the speaker/participant (optional, encrypted if speaker should remain anonymous)."},{id:"username",labelFieldLinguists:"Username",labelNonLinguists:"",labelTranslators:"",shouldBeEncrypted:!0,encrypted:!0,showToUserTypes:"all",defaultfield:!0,help:"Optional username of the speaker/participant, if the speaker/participant is registered in the system (encrypted)."},{id:"dateOfBirth",type:"date",labelFieldLinguists:"Date of Birth",labelNonLinguists:"",labelTranslators:"",shouldBeEncrypted:!0,encrypted:!0,showToUserTypes:"all",defaultfield:!0,json:{timestamp:{start:null,end:null,accuracy:null}},help:"Optional date of birth of the speaker/participant, if used by the experimental analysis (i.e., speaker/participants of 20 months performed differently from speaker/participants of 22 months)."},{id:"gender",labelFieldLinguists:"Gender",labelNonLinguists:"",labelTranslators:"",shouldBeEncrypted:!0,encrypted:!0,showToUserTypes:"all",defaultfield:!0,json:{choices:["Female","Male","Unknown"],children:["Girl","Boy","Unknown"],adult:["Woman","Man","Unknown"]},help:"Optional gender or biological sex of the speaker/participant, if used by the speaker/participants result reports or experimental analysis."},{id:"languages",type:"language collection",labelFieldLinguists:"Language(s) Spoken/Understood",labelNonLinguists:"Language(s) Spoken/Understood",labelTranslators:"Language(s) Spoken/Understood (Ethnologue)",labelComputationalLinguists:"Language(s) Spoken/Understood (ISO 639-3)",shouldBeEncrypted:!1,defaultfield:!0,json:{languages:[{language:{ethnologueUrl:"",wikipediaUrl:"",iso:"",locale:"",englishName:"",nativeName:"",alternateNames:""},fluency:{comprehensionFluency:"",speakingFluency:"",readingFluency:"",writingFluency:""},dates:{start:"",end:"",proportionOfUse:""}}]},help:"This is the language name (or language family), it is optionally tied to an Ethnologue language code (ISO 639-3).",helpLinguists:"This is the language (or language family), there are optional extra information fields if your team wants to tie it to an Ethnologue three letter language code (ISO 639-3)."},{id:"confidentiality",labelFieldLinguists:"Confidentiality Setting",labelNonLinguists:"Confidentiality Setting",labelTranslators:"Confidentiality Setting",shouldBeEncrypted:!1,value:"anonymous",showToUserTypes:"all",defaultfield:!0,json:{choices:["generalize","team","anonymous","public"]},help:"Confidentiality setting of this speaker. The default value is anonymous, which means that data can be associated to one speaker but the speaker cannot be identified. A value of hidden means data will be associated to the entire speaker population of the corpus. A value of team means that team members can see the consultant's identity but that viewers who are not team members can only see an anonymous user. A value of public means the speaker has signed a consent form and has asked that his/her data be associated to his/her user account or identity."}]}},{}],28:[function(a,b,c){b.exports={_id:"corpus",titleAsUrl:"private_corpus",connection:{},activityConnection:{},dbname:"",api:"corpora",comments:[],validationStati:[{validationStatus:"Checked*",color:"green","default":!0},{validationStatus:"Published*",color:"blue"},{validationStatus:"ApprovedLanguageLearningContent*",color:"green",showInLanguageLearnignApps:!0}],tags:[{tag:"SampleData",color:"green"}],fields:[{id:"title",help:"A name given to the resource. All other titles (e.g., translations) should be specified as the dcterms:alternative refinement. Example: Na tala 'uria na idulaa diana, Alternative: The road to good reading",value:"Private Corpus",json:{alternative:[]}},{id:"description",help:"An account of the resource.",value:"The details of this corpus are not public.",json:{"abstract":"",tableOfContents:""}},{id:"keywords",type:"tags",help:"Keywords describing for your database.",showToUserTypes:"all",json:{keywords:[]}},{id:"subject",help:"The topic of the resource. Recommended best practice is to use values from the olac:language scheme using two- and three-letter identifiers from ISO 639.",json:{languages:{}}},{id:"coverage",help:"The spatial or temporal topic of the resource, the spatial applicability of the resource, or the jurisdiction under which the resource is relevant. For examples see: http://www.language-archives.org/NOTE/usage.html",json:{spatial:[],temporal:[]}},{id:"date",help:"Points or periods of time associated with an event in the lifecycle of the resource.",json:{available:"",created:"",dateAccepted:"",dateCopyrighted:"",dateSubmitted:"",issued:"",modified:"",valid:""}},{id:"rights",help:"Information about rights held in and over the resource. The rights, in most cases, belong to the creator  not the researcher or sponsor - or, in some cases, to the language community (particularly, if it is constituted as a legal entity). Can include: A description of the terms of use, and instructions on how to get access.",label:"termsOfUse",value:"Sample: The materials included in this corpus are available for research and educational use. If you want to use the materials for commercial purposes, please notify the author(s) of the corpus (myemail@myemail.org) prior to the use of the materials. Users of this corpus can copy and redistribute the materials included in this corpus, under the condition that the materials copied/redistributed are properly attributed.  Modification of the data in any copied/redistributed work is not allowed unless the data source is properly cited and the details of the modification is clearly mentioned in the work. Some of the items included in this corpus may be subject to further access conditions specified by the owners of the data and/or the authors of the corpus.",json:{accessRights:"Contact myemail@myemail.org if you would like to gain (read, write, comment, contributor, export, search) access to the non-public parts of this database",license:{title:"Default: Creative Commons Attribution-ShareAlike (CC BY-SA).",humanReadable:"This license lets others remix, tweak, and build upon your work even for commercial purposes, as long as they credit you and license their new creations under the identical terms. This license is often compared to copyleft free and open source software licenses. All new works based on yours will carry the same license, so any derivatives will also allow commercial use. This is the license used by Wikipedia, and is recommended for materials that would benefit from incorporating content from Wikipedia and similarly licensed projects.",imageUrl:"https://i.creativecommons.org/l/by/4.0/88x31.png",link:"http://creativecommons.org/licenses/by-sa/3.0/"}}},{id:"rightsHolder",label:"copyright",help:"A person or organization owning or managing rights over the resource. Example:  Copyright Regents of the University of California.",value:"Default: Add names of the copyright holders of the corpus."},{id:"contributor",help:"Entity/ies responsible for making contributions to the resource. A Contributor may be a person, an organization, or a serviceany entity that has sufficient involvement in the creation or development of the resource to warrant explicit identification. A term from olac:role should be used to specify the role of the Contributor. Contributor is related to Creator since many of the terms in the role vocabulary (like author or photographer) name the role of the primary creator of a resource. The OLAC recommendation is that Contributor (with the appropriate role designation) be used in these cases, and that Creator be used only when there is not an appropriate term in the olac:role vocabulary for the role played by the entity that created the resource. A participating OLAC repository need not be concerned about the fact that other metadata services based on Dublin Core may prefer and even require the use of the Creator element. The OLAC-to-Simple-DC crosswalk built into the OLAC Aggregator automatically maps certain OLAC Contributor roles like author and photographer to the Creator element. See the discussion of Creator for more on its use. Follow the form in which the person's name would normally be listed in an alphabetical index in his or her own language or country of residence, e.g., FamilyName, GivenName for an English speaker. For examples see: http://www.language-archives.org/NOTE/usage.html",json:[]},{id:"creator",help:"An entity primarily responsible for making the resource. It refers to an entity with a primary role in the creation of the intellectual or artistic content of the resource. For examples see: http://www.language-archives.org/NOTE/usage.html"},{id:"publisher",help:"An entity responsible for making the resource available. The Publisher is generally the business, organization, or sometimes individual who takes responsibility (and provides financial and production resources) for putting the resource into a form suitable for making it publicly available, whether in multiple hard copies (printing, pressing of a disc, etc), by broadcasting (radio, television, webcast), or posting to a public website."},{id:"identifier",help:"An unambiguous reference to the resource within a given context.",json:{bibliographicCitation:""}},{id:"format",help:"The file format, physical medium, or dimensions of the resource.",json:{extent:"",medium:""}},{id:"type",help:"The nature or genre of the resource.",value:"Dataset"},{id:"source",help:"The present resource may be derived from the Source resource in whole or in part."},{id:"provenance",help:"A statement of any changes in ownership and custody of the resource since its creation that are significant for its authenticity, integrity and interpretation. Example: Collection of texts recorded by ____, transcribed with the assistance of a number of local residents. Body of materials were transferred to custody of SIL ____ Branch in 1980s, subsequently organized,  collated and annotated by J. L. ____, a researcher in a closely related _____ language. Annotations particularly relate to changes in orthographic and tone marking conventions over the years of collection and as compared to current practices"},{id:"language",help:"A language of the resource. Language is used for a language the resource is in (eg: English), as opposed to the language it describes (eg: Quechua)."},{id:"relation",help:"URI to related resource(s).",json:{conformsTo:[],hasFormat:[],hasPart:[],hasVersion:[],sFormatOf:[],isPartOf:[],isReferencedBy:[],isReplacedBy:[],isRequiredBy:[],isVersionOf:[],references:[],replaces:[],requires:[]}}],datumFields:[{id:"judgement",labelFieldLinguists:"Grammaticality Judgement",labelExperimenters:"Naturalness",labelNonLinguists:"Not-a-normal-thing-to-say",labelTranslators:"Grammatical/How-normal-Is-This-Example",size:"3",shouldBeEncrypted:!1,showToUserTypes:"linguist",defaultfield:!0,json:{grammatical:!0},help:"Acceptablity judgement (*,#,?  mean this sentence is strange)",helpLinguists:"Grammaticality/acceptability judgement (*,#,?,1-3 etc). Leaving it blank usually means grammatical/acceptable, or your team can choose any symbol for this meaning."},{id:"gloss",labelFieldLinguists:"Gloss",labelNonLinguists:"Word-for-word Translation",labelTranslators:"Word-for-word Translation",type:"IGT",shouldBeEncrypted:!0,showToUserTypes:"linguist",defaultfield:!0,json:{language:"",alternates:[],conventions:{id:"",tagSet:[],referenceLink:""}},help:"Translation for each prefix, root and suffix in the words",helpLinguists:"Metalanguage glosses of each individual morpheme (above). Used by the system to help gloss, in combination with morphemes (above). It is Line 2 in your LaTeXed examples. We recommend Leipzig conventions (. for fusional morphemes, - for morpheme boundaries etc)  Sample entry: friend-fem-pl"},{id:"syntacticCategory",labelFieldLinguists:"Morpho-Syntactic Category",labelNonLinguists:"",labelTranslators:"Part of Speech",type:"IGT",shouldBeEncrypted:!0,showToUserTypes:"machine, linguist",defaultfield:!0,json:{alternates:[],conventions:{id:"",tagSet:[],referenceLink:""}},help:"This optional field is used by the machine to help with search and data cleaning, in combination with morphemes and gloss (above). If you want to use it, you can choose to use any sort of syntactic category tagging you wish. It could be very theoretical like Distributed Morphology (Sample entry: -GEN-NUM), or very a-theroretical like the Penn Tree Bank Tag Set. (Sample entry: NNS) http://www.ims.uni-stuttgart.de/projekte/CorpusWorkbench/CQP-HTMLDemo/PennTreebankTS.html",helpLinguists:"This optional field is used by the machine to help with search and data cleaning, in combination with morphemes and gloss (above). If you want to use it, you can choose to use any sort of syntactic category tagging you wish. It could be very theoretical like Distributed Morphology (Sample entry: -GEN-NUM), or very a-theroretical like the Penn Tree Bank Tag Set. (Sample entry: NNS) http://www.ims.uni-stuttgart.de/projekte/CorpusWorkbench/CQP-HTMLDemo/PennTreebankTS.html"},{id:"relatedData",labelFieldLinguists:"Related Data",labelNonLinguists:"Linked to",labelTranslators:"Linked to",labelComputationalLinguists:"Linked Data",type:"relatedData",shouldBeEncrypted:!1,showToUserTypes:"all",defaultfield:!0,json:{relatedData:[]},help:"Related data in the database, or at any web url.",helpLinguists:"Related data in the database, or at any web url.",helpDevelopers:"Related data in the database, or at any web url."},{id:"tags",labelFieldLinguists:"Tags",labelNonLinguists:"Tags",labelTranslators:"Tags",type:"tags",shouldBeEncrypted:!1,showToUserTypes:"all",defaultfield:!0,json:{tags:[]},help:"Tags for constructions or other info that you might want to use to categorize your data.",helpLinguists:"Tags for constructions or other info that you might want to use to categorize your data."},{id:"validationStatus",labelFieldLinguists:"Data validity/verification Status",labelNonLinguists:"Data validity/verification Status",labelTranslators:"Data validity/verification Status",type:"tags",shouldBeEncrypted:!1,showToUserTypes:"all",defaultfield:!0,json:{tags:[]},help:"Any number of tags of data validity (replaces DatumStates). For example: ToBeCheckedBySeberina, CheckedByRicardo, Deleted etc...",helpLinguists:"Any number of tags of data validity (replaces DatumStates). For example: ToBeCheckedBySeberina, CheckedByRicardo, Deleted etc..."},{id:"syntacticTreeLatex",labelFieldLinguists:"Syntactic Tree/Constituency (LaTeX)",labelNonLinguists:"",labelTranslators:"",type:"LaTeX",shouldBeEncrypted:!0,showToUserTypes:"machine",defaultfield:!0,json:{alternates:[]},help:"This optional field is used by the machine to make LaTeX trees and help with search and data cleaning, in combination with morphemes and gloss (above). If you want to use it, you can choose to use any sort of LaTeX Tree package (we use QTree by default) Sample entry: \\Tree [.S NP VP ]",helpLinguists:"This optional field is used by the machine to make LaTeX trees and help with search and data cleaning, in combination with morphemes and gloss (above). If you want to use it, you can choose to use any sort of LaTeX Tree package (we use QTree by default) Sample entry: \\Tree [.S NP VP ]"}],conversationFields:[],sessionFields:[{id:"source",labelFieldLinguists:"Language Speakers/Publication/Source",labelNonLinguists:"By",labelTranslators:"Language Speakers/Publication/Source",shouldBeEncrypted:!1,defaultfield:!0,json:{users:[]},help:"This is a comma seperated field of all the consultants/publications/sources who were were the source/present for this elicitation session.",helpLinguists:"This is a comma seperated field of all the consultants/publications/sources who  were were the source/present for this elicitation session.",helpDevelopers:"This is a comma seperated field of all the consultants (usernames, or anonymouse codes, or publication uri's) who were present for this elicitation session. This field also contains a (hidden) array of consultant/source masks if they are actual users of the system. "},{id:"dialect",type:"language",labelFieldLinguists:"Dialect",labelNonLinguists:"Dialect",labelTranslators:"Dialect",shouldBeEncrypted:!1,defaultfield:!0,help:"Dialect of this example (city, village, region etc)",helpLinguists:"This dialect may precise as the team chooses (province, region, city, village or any other measure of dialect)"},{id:"register",type:"language",labelFieldLinguists:"Social Register",labelNonLinguists:"Social Register",labelTranslators:"Social Register",shouldBeEncrypted:!1,defaultfield:!0,help:"Social register of this example (friends, children speaking with children, formal, religious, ceremonial etc)",helpLinguists:"This is an optional field which indicates the social register of the example (friends, children speaking with children, formal, religious, ceremonial etc)"},{id:"language",type:"language",labelFieldLinguists:"Language Name",labelNonLinguists:"Language Name",labelTranslators:"Language Name (Ethnologue)",labelComputationalLinguists:"Language Name (ISO 639-3)",shouldBeEncrypted:!1,defaultfield:!0,json:{language:{ethnologueUrl:"",wikipediaUrl:"",iso:"",locale:"",englishName:"",nativeName:"",alternateNames:""}},help:"This is the langauge name (or language family), it is optionally tied to an Ethnologue language code (ISO 639-3).",helpLinguists:"This is the langauge (or language family), there is optional extra information fields if your team wants to tie it to an Ethnologe three letter language code (ISO 639-3)."},{id:"dateElicited",type:"date",labelFieldLinguists:"Original Date Elicited",labelNonLinguists:"OriginalDate Spoken",labelTranslators:"Original Date Spoken/Published",shouldBeEncrypted:!1,defaultfield:!0,json:{timestamp:{start:null,end:null,accuracy:null}},help:"The date when the elicitation session took place, or when the datum was spoken/published.",helpLinguists:"The date when the elicitation session took place, or when the datum was spoken/published."}],speakerFields:[{id:"anonymousCode",labelFieldLinguists:"Anonymous Code",labelNonLinguists:"Anonymous Code",labelTranslators:"Anonymous Code",shouldBeEncrypted:!1,showToUserTypes:"all",defaultfield:!0,help:"A field to anonymously identify language speakers/participants.",helpLinguists:"A field to anonymously identify language consultants/informants/experiment participants (by default it can be a timestamp, or a combination of experimenter initials, speaker/participant initials etc)."}]}},{}],29:[function(a,b,c){b.exports={description:"This is first database which contains the results of your experiment, you can use it to play with the app... When you want to make a real database, click New : Database/Corpus",participantFields:[{id:"courseNumber",labelExperimenter:"Course/Class/Section Number",labelNonLinguists:"",labelTranslators:"",shouldBeEncrypted:!0,encrypted:!0,showToUserTypes:"all",defaultfield:!0,help:"Optional course or section number, if used by the participants result reports or experimental conditions.",helpLinguists:"Optional course or section number, if used by the participants result reports or experimental conditions."},{id:"hemisphericDominance",labelExperimenter:"Hemispheric dominance (handedness)",labelNonLinguists:"",labelTranslators:"",shouldBeEncrypted:!0,showToUserTypes:"all",defaultfield:!0,json:{choices:["Right","Left","Unknown"]},help:"Optional right or left handedness or hemispheric dominante of the participant, if used by the participants result reports or experimental conditions.",helpLinguists:"Optional right or left handedness or hemispheric dominante of the participant, if used by the participants result reports or experimental conditions."}]}},{}],30:[function(a,b,c){var d=a("./../FieldDBObject").FieldDBObject,e=a("./../datum/DocumentCollection").DocumentCollection,f=a("./../comment/Comments").Comments,g=a("./../locales/ContextualizableObject").ContextualizableObject,h=a("q"),i=function(a){this._fieldDBtype||(this._fieldDBtype="DataList"),this.debug("Constructing DataList ",a),a&&a.comments,d.apply(this,arguments),this.debug("   Constructed datalist ",this)};i.prototype=Object.create(d.prototype,{constructor:{value:i},api:{get:function(){return this._api||d.DEFAULT_STRING},set:function(a){this.ensureSetViaAppropriateType("api",a)}},defaults:{get:function(){return{title:"Untitled Data List",description:"",datumIds:d.DEFAULT_ARRAY,docs:d.DEFAULT_COLLECTION}}},INTERNAL_MODELS:{value:{comments:f,docs:e,title:g,description:g}},title:{get:function(){return this._title||d.DEFAULT_STRING},set:function(a){this.ensureSetViaAppropriateType("title",a)}},description:{get:function(){return this._description||d.DEFAULT_STRING},set:function(a){this.ensureSetViaAppropriateType("description",a)}},docs:{get:function(){return this._docs},set:function(a){this.debug("creating the "+this.id+" datalist's docs");var b;this._docs&&(b=this._docs.primaryKey),this.ensureSetViaAppropriateType("docs",a),this._docs&&(delete this._docIds,b&&b!==this._docs.primaryKey&&(this._docs.primaryKey=b))}},add:{value:function(a){if(a&&"[object Array]"===Object.prototype.toString.call(a)){var b=this;for(var c in a)a[c]=b.add(a[c]);return a}return this.docs?this.debug("adding to existing datalist docs ",a):(this.debug("creating the datalist docs ",a),this.docs=[]),!this.INTERNAL_MODELS||!this.INTERNAL_MODELS.item||a instanceof this.INTERNAL_MODELS.item?(this.debug("Setting the type of this new item to LanguageDatum since it didnt have a type before, and there is no default item for this datalist."),a.fieldDBtype=a.fieldDBtype||"LanguageDatum"):a=new this.INTERNAL_MODELS.item(a),this.docs.add(a)}},addReallyComplicatedDeprecated:{value:function(a){return this.docs&&0!==this.docs.length?(this.debug("adding to existing data list",a),
this.docs.add(a)):(a="[object Array]"===Object.prototype.toString.call(a)?{collection:a}:{collection:[a]},a.primaryKey=this.primaryKey,this.debug("setting the docs  : ",a),this.docs=a,this.docs._collection[0])}},push:{value:function(a){return this.docs?this.debug("adding to existing datalist docs ",a):(this.debug("creating the datalist docs ",a),this.docs=[]),this.docs.push(a)}},unshift:{value:function(a){return this.docs?this.debug("adding to existing datalist docs ",a):(this.debug("creating the datalist docs ",a),this.docs=[]),this.docs.unshift(a)}},pop:{value:function(){return this.docs?this.docs.pop():void 0}},shift:{value:function(){return this.docs?this.docs.shift():void 0}},populate:{value:function(a){var b=this;this.docs?this.debug("populating an existing database ",this):(this.debug("creating the datalist docs to populate ",this),this.docs=[]);var c;this.save(),a=a.map(function(a){return"datalists"!==b.api,a.confidential=b.confidential,a=d.convertDocIntoItsType(a),a.fieldDBtype&&"LanguageDatum"===a.fieldDBtype&&(c="LanguageDatum"),a}),b.todo("OVERWRITING NEW INFO INTO EXISTING DATALIST, instead save the existing list, then add them and remove the ones that arent supposed ot be there."),b.docs=a,"LanguageDatum"===c&&(b.showDocPosition=!0,b.showDocCheckboxes=!0,b.docsAreReorderable=!0)}},reindexFromApi:{value:function(){var a=this,b=h.defer();if(this.whenReindexedFromApi=b.promise,!this.api)return this.debug("Not reindexing this datalist from the database, its not connected to an api."),h.nextTick(function(){b.reject({status:412,userFriendlyErrors:["This datalist doesn't need to be re-indexed. 29834."]})}),b.promise;if(!this.corpus||"function"!=typeof this.corpus.fetchCollection)return a.fetching=a.loading=!1,a.warn("This datalist has no corpus, it doesnt know how to find out which data are in it."),h.nextTick(function(){a.docs=a.docs||[],b.reject({status:412,userFriendlyErrors:["This application has errored. Please notify its developers: Cannot reindex this datalist if the corpus is not specified."]})}),b.promise;var c=function(c){a.fetching=a.loading=!1,a.warn(" problem fetching the data list"),a.debug("err",c),a.docs=a.docs||[],b.reject(c)};this.fetching=this.loading=!0;var d='/_design/data/_list/as_data_list/by_type?key="'+this.api+'"';return this.corpus.fetchCollection(d).then(function(c){return a.fetching=a.loading=!1,a.debug("Downloaded the auto-genrated data list of datum ordered by creation date in this data list",c),c?(c.docIds=c.docIds||c.datumIds,c.docIds&&c.docIds.length>0&&(a.docs||(a.docs=[]),a.debug("Iterating through the docids to make sure they are in the list."),c.docIds.map(function(b){if(a.debug("Looking at "+b),!a._docs[b]){a.debug("converting "+b+" into a placeholder");var c={dbname:a.dbname,loaded:!1};c[a.primaryKey]=b,a.debug("adding "+b+" into the docs"),a.add(c)}}),a.length!==c.docIds.length&&a.todo("Not removing items whcih the user currently has in this session which the server doesnt know about."),delete c.docIds),delete c.title,delete c.description,a.render(),void b.resolve(a)):void a.bug("There was a problem downloading the list of data in the "+a.title+" data list. Please report this.")},c).fail(function(c){console.error(c.stack,a),b.reject(c)}).done(function(){console.log("Done data list reindex if possible",a.docs.length)}),b.promise}},length:{get:function(){return this.docIds?this.docIds.length:0},set:function(a){this.warn("data list lengths comes from the size of the datumids, it cant be set manually to "+a)}},primaryKey:{get:function(){return this._docs&&this._docs.primaryKey?this._docs.primaryKey:(this.warn("cant get the primary key ",this._docs),"id")},set:function(a){this.docs&&this.docs.primaryKey&&this.docs.primaryKey!==a&&(this.docs.primaryKey=a)}},docIds:{get:function(){var a=this;return this.docs&&this.docs.length&&(this._docIds=[],this._docIds=this.docs.map(function(b){return a.debug("geting doc id of this doc ",b),b[a.primaryKey]})),this._docIds||d.DEFAULT_ARRAY},set:function(a){if(a!==this._docIds&&a&&a!==[]){if("function"!=typeof a.map)throw console.error(" trying to set docIds of datalist to something that isnt an array.",a),new Error("This is a very odd set of docIds "+a);var b=this;this._docs&&this._docs.add&&"function"==typeof this._docs.add||(this.docs=[]),a.map(function(a){if(b.debug("Looking at "+a),b._docs&&!b._docs[a]){b.debug("converting "+a+" into a placeholder");var c={dbname:b.dbname,loaded:!1};c[b.primaryKey]=a,b.debug("adding "+a+" into the docs"),b.add(c)}})}}},datumIds:{get:function(){return this.warn("datumIds is deprecated, please use docIds instead."),this.docIds},set:function(a){this.warn("datumIds is deprecated, please use docIds instead."),this.docIds=a}},icon:{get:function(){return"thumb-tack"}},getAllAudioAndVideoFiles:{value:function(a){var b=h.defer(),c=this;return h.nextTick(function(){a||(a=c.docIds),0===a.length&&(a=c.docIds);var d=[];c.debug("DATA LIST datumIdsToGetAudioVideo "+JSON.stringify(a)),a.map(function(a){var b=c.docs[a];if(b){var e=b.audioVideo||b._audioVideo;e&&"function"==typeof e.map&&e.map(function(a){a&&a.URL&&d.push(a.URL)})}}),b.resolve(d)}),b.promise}},select:{value:function(a){if(!this.docs||!this.docs.collection||"function"!=typeof this.docs.collection.map)return[];var b=[],c=this;return a&&"all"===a&&(a=this.primaryKey),this.docs.collection.map(function(d){return!a&&d.selected?(d.selected=!0,void b.push(d[c.primaryKey])):a&&d[a]?(d.selected=!0,void b.push(d[c.primaryKey])):void(d.selected=!1)}),this.debug("Selected ",b),b}},applyFunctionToAllIds:{value:function(a,b,c){a||(a=this.docIds),0===a.length&&(a=this.select()),b||(b="latexitDataList");var d=this;this.debug("DATA LIST docIdsToApplyFunction "+JSON.stringify(a)),a.map(function(a){var e=d.docs[a];return e?(e[b].apply(e,c),a):(d.warn(" Doc has not been fetched, cant apply the function to it."),a)})}},toJSON:{value:function(a,b,c){this.docs&&this.docs.length>0&&(this.docIds=null,this.docIds=this.docIds),c=c||[],c.push("_docs"),this.debug("Customizing toJSON ",a,c);var e=d.prototype.toJSON.apply(this,[a,b,c]);return this.todo("Adding datumIds for backward compatability until prototype can handle docIds"),e.datumIds=this.docIds,this.debug(e),e}}}),c.DataList=i},{"./../FieldDBObject":4,"./../comment/Comments":17,"./../datum/DocumentCollection":41,"./../locales/ContextualizableObject":58,q:223}],31:[function(a,b,c){var d=a("./SubExperimentDataList").SubExperimentDataList,e=a("./../datum/DocumentCollection").DocumentCollection,f=a("./../comment/Comments").Comments,g=a("./../locales/ContextualizableObject").ContextualizableObject,h=function(a){this._fieldDBtype||(this._fieldDBtype="ExperimentDataList"),this.debug("Constructing ExperimentDataList ",a),d.apply(this,arguments)};h.prototype=Object.create(d.prototype,{constructor:{value:h},INTERNAL_MODELS:{value:{comments:f,docs:e,title:g,description:g,instructions:g,item:d}}}),c.ExperimentDataList=h},{"./../comment/Comments":17,"./../datum/DocumentCollection":41,"./../locales/ContextualizableObject":58,"./SubExperimentDataList":32}],32:[function(a,b,c){var d=a("./DataList").DataList,e=a("./../datum/Stimulus").Stimulus,f=a("./../datum/DocumentCollection").DocumentCollection,g=a("./../comment/Comments").Comments,h=a("./../locales/ContextualizableObject").ContextualizableObject,i=function(a){this._fieldDBtype||(this._fieldDBtype="SubExperimentDataList"),this.debug("Constructing SubExperimentDataList ",a),d.apply(this,arguments)};i.prototype=Object.create(d.prototype,{constructor:{value:i},INTERNAL_MODELS:{value:{comments:g,docs:f,title:h,description:h,instructions:h,item:e}},subexperiments:{get:function(){return this.docs&&this.docs.length>0?this.docs:this.docIds},set:function(a){a&&a[0]&&"object"==typeof a[0]||a.constructor===f?this.docs=a:(this.docIds=a,this._subexperiments=a)}},trials:{get:function(){return this.docs&&this.docs.length>0?this.docs:this.docIds},set:function(a){a&&a[0]&&"object"==typeof a[0]||a.constructor===f?this.docs=a:(this.docIds=a,this._trials=a)}},toJSON:{value:function(a,b){this.debug("Customizing toJSON ",a,b);var c=d.prototype.toJSON.apply(this,arguments);return this.debug(c),this.docs&&this.docs.toJSON&&(this.todo("only save trials/subexperiments if there are responses in the trials, or if the experiment started or somethign. "),c.results=this.docs.toJSON()),c}}}),c.SubExperimentDataList=i},{"./../comment/Comments":17,"./../datum/DocumentCollection":41,"./../datum/Stimulus":45,"./../locales/ContextualizableObject":58,"./DataList":30}],33:[function(a,b,c){"use strict";var d=a("./LanguageDatum").LanguageDatum,e=function(a){this._fieldDBtype||(this._fieldDBtype="ComputationalLinguisticsDatum"),this.debug("Constructing ComputationalLinguisticsDatum: ",a),d.apply(this,[a])};e.naiveFrequency=function(a){var b={},c=0,d=0;return a.map(function(a){return c++,b[a]?void(b[a]=b[a]+1):(d+=1,b[a]=1)}),{tokens:c,types:d,frequencies:b}},e.prototype=Object.create(d.prototype,{constructor:{value:e},extractStats:{value:function(a){a&&this.warn("Options aren't used",a);var b=this.utterance||this.orthography,c=e.naiveFrequency(b.split("")),d=e.naiveFrequency(b.split(/\s+/));return this.stats={characters:{unigrams:c.frequencies,bigrams:{}},words:{unigrams:d.frequencies,bigrams:{}},tokens:{characters:{unigrams:c.tokens,bigrams:{}},words:{unigrams:d.tokens,bigrams:{}}},types:{characters:c.types,words:d.types}},this}},stats:{get:function(){return this._stats},set:function(a){this._stats=a}}}),c.ComputationalLinguisticsDatum=e},{"./LanguageDatum":42}],34:[function(a,b,c){"use strict";var d=a("./../FieldDBObject").FieldDBObject,e=a("./../audio_video/AudioVideo").AudioVideo,f=a("./../audio_video/AudioVideos").AudioVideos,g=a("./../comment/Comments").Comments,h=a("./DatumField").DatumField,i=a("./DatumFields").DatumFields,j=a("./DatumStates").DatumStates,k=a("./DatumTags").DatumTags,l=a("./../image/Images").Images,m=a("./Session").Session,n=a("./../corpus/corpus.json"),o=function(a){this._fieldDBtype||(this._fieldDBtype="Datum"),this.debug("Constructing Datum: ",a),d.apply(this,arguments)};o.prototype=Object.create(d.prototype,{constructor:{value:o},fields:{get:function(){return this.debug("getting fields"),!this._fields&&this.corpus&&"function"==typeof this.corpus.updateDatumToCorpusFields&&this.corpus.updateDatumToCorpusFields(this),this._fields},set:function(a){a&&!a.confidential&&this.confidential&&(a.confidential=this.confidential),this.ensureSetViaAppropriateType("fields",a)}},datumFields:{get:function(){return this.debug("datumFields is depreacted, just use fields instead"),this.fields},set:function(a){return this.debug("datumFields is depreacted, just use fields instead"),this.fields=a}},accessAsObject:{get:function(){var a={},b=function(b){a[b.id]=b.value};return this.fields.map(b),this.session?this.session.fields.map(b):this.warn("this datum is missing a session, this is stange"),a.comments=this.comments.map(function(a){return a.text}).join("; "),a.audioVideo=this.audioVideo.map(function(a){return a.filename}).join("; "),a.images=this.images.map(function(a){return a.filename}).join("; "),a},set:function(){}},addField:{value:function(a){if(this.fields||(this.fields=[]),"string"==typeof a){if(this.fields[a])return this.fields[a];a={id:a}}return this.debug("adding field",a),this.fields.add(a)}},addFile:{value:function(a){if(!a)return void this.warn("A null file was requested to be added to this datum",a);if(a.type=a.type||"",0===a.type.indexOf("audio"))this.audioVideo=this.audioVideo||[],this.audioVideo.add(a);else if(0===a.type.indexOf("video"))this.audioVideo=this.audioVideo||[],this.audioVideo.add(a);else if(0===a.type.indexOf("image"))this.images=this.images||[],this.images.add(a);else{var b=new e(a).toJSON();this.addRelatedData(b)}this.unsaved=!0}},audioVideo:{get:function(){return this._audioVideo&&"AudioVideos"===this._audioVideo.fieldDBtype&&(this._audioVideo.dbname=this.dbname),this._audioVideo||d.DEFAULT_COLLECTION},set:function(a){this.ensureSetViaAppropriateType("audioVideo",a)}},hasAudio:{get:function(){var a=!1;return this.audioVideo.length>0&&this.audioVideo.map(function(b){"deleted"!==b.trashed&&(a=!0)}),a},set:function(){}},play:{value:function(a){this.debug("optionalIndex",a),this._audioVideo&&"function"==typeof this._audioVideo.play&&this._audioVideo.play(0)}},images:{get:function(){return this._images&&"Images"===this._images.fieldDBtype&&(this._images.dbname=this.dbname),this._images||d.DEFAULT_COLLECTION},set:function(a){a&&!a.confidential&&this.confidential&&(a.confidential=this.confidential),this.ensureSetViaAppropriateType("images",a)}},hasImages:{get:function(){var a=!1;return this.images.length>0&&this.images.map(function(b){"deleted"!==b.trashed&&(a=!0)}),a},set:function(){}},relatedData:{get:function(){return this.fields?(this.fields&&!this.fields.relatedData&&n&&n.datumFields&&n.datumFields.length>=10&&this.fields.add(n.datumFields[10]),this.fields.relatedData.json=this.fields.relatedData.json||{},this.fields.relatedData.json.relatedData=this.fields.relatedData.json.relatedData||[],this.fields.relatedData.json.relatedData):void 0},set:function(){}},api:{value:"datums"},INTERNAL_MODELS:{value:{fields:i,audioVideo:f,session:m,comments:g,datumStates:j,datumTags:k,images:l}},fillWithCorpusFieldsIfMissing:{value:function(){if(this.fields){var a=window.app.corpus.datumFields.models;for(var b in a){var c=a[b].get("label");this.debug("Label "+c);var d=this.fields.where({label:c});0===d.length&&this.fields.push(a[b])}}}},search:{value:function(a,b){try{window.pageTracker._trackPageview("/search_results.php?q="+a)}catch(c){this.debug("Search Analytics not working.")}var d=this.processQueryString(a),e=!1;-1===a.indexOf(":")&&(e=!0,a=a.toLowerCase().replace(/\s/g,""));var f=this.accessAsObject;if(b){this.debug("Reducing fields to the fields requested by the user",b);for(var g in b)b.hasOwnProperty(g)&&b[g]&&(b[g]=f[g])}else b=f;var h=this.highlightMatches(b,a,e,d);return h&&h.length>0?(this.highlightedMatches=h,this.highlightedMatches):void delete this.highlightedMatches}},highlightMatches:{value:function(a,b,c,d){var e,f;this.debug("Highlighting matches for ",a,b,c,d);var g=[];if(""===b.trim())this.debug("user searched for nothing, which means we will include this item."),g=[" "];else{if(c){this.debug("user searched for GrossKeywordMatch of "+b);for(e in a)a.hasOwnProperty(e)&&a[e]&&(f=this.highlight(a[e],b),f.indexOf("<span")>-1&&g.push(f));return g}var h=[];this.debug(" Searching through ",d),f=this.matchesSingleCriteria(a,d[0]),f&&f.indexOf("<span")>-1&&(this.debug("      Found one match  "+f),h.push(f));for(var i=1;i<d.length;i+=2)if("AND"===d[i]){if(f=this.matchesSingleCriteria(a,d[i+1]),!(f&&f.indexOf("<span")>-1))return void this.debug("       Failed the Intersection match "+f);this.debug("       Passed intersection match  "+f),h.push(f)}else f=this.matchesSingleCriteria(a,d[i+1]),f&&f.indexOf("<span")>-1&&(this.debug("      Found another match  ",f),h.push(f));if(h&&h.length>0)return this.debug("This datum matches ",h),h;this.debug("This datum doesnt match ",d)}return g}},matchesSingleCriteria:{value:function(a,b){var c=b.indexOf(":"),d=b.substring(0,c),e=!1;0===d.indexOf("!")&&(d=d.replace(/^!/,""),e=!0);var f=b.substring(c+1);if(this.debug("    Looking at label:"+d+": value :"+f+": in :"+a[d]),"judgement"===d&&"grammatical"===f.toLowerCase()&&!a[d])return this.highlight("Grammatical","Grammatical");var g=a[d];return g=this.highlight(g,f),e&&(g=g.indexOf("<span")>-1?"":this.highlight(g,g)),g}},processQueryString:{value:function(a){if(a){a+="",a=a.replace(/\&\&/g," AND ").replace(/\|\|/g," OR "),this.debug("    Normalized  query string, "+a);var b=a.split(/ +/),c=[],d="";for(var e in b){var f=b[e].trim();if(f.length<=0)break;"AND"===f||"OR"===f?(c.push(d),c.push(f),d=""):d=d?d+" "+f:f}return c.push(d),this.debug("    Tokenized query string, ",c),c}}},getDisplayableFieldForActivitiesEtc:{value:function(){return this.model.fields.where({label:"utterance"})[0].get("mask")}},cloneDeprecated:{value:function(){var a=new o({audioVideo:new f(this.get("audioVideo").toJSON(),{parse:!0}),comments:new g(this.get("comments").toJSON(),{parse:!0}),dateEntered:this.get("dateEntered"),dateModified:this.get("dateModified"),fields:new i(this.fields.toJSON(),{parse:!0}),datumStates:new j(this.get("datumStates").toJSON(),{parse:!0}),datumTags:new k(this.get("datumTags").toJSON(),{parse:!0}),dbname:this.dbname,session:this.get("session")});return a}},getValidationStatus:{value:function(){var a="",b=this.fields.where({label:"validationStatus"});return b.length>0&&(b=b[0].get("mask").split(" "),b.length>0&&(a=b[0])),""===a&&(b=this.get("datumStates").where({selected:"selected"}),b.length>0&&(a=b[0].get("state"))),this.updateDatumState(a),a}},getValidationStatusColor:{value:function(a){return a||(a=this.getValidationStatus()),a.toLowerCase().indexOf("deleted")>-1?"danger":a.toLowerCase().indexOf("tobechecked")>-1?"warning":a.toLowerCase().indexOf("checked")>-1?"success":void 0}},updateDatumState:{value:function(a){if(a){this.debug("Asking to change the datum state to "+a);var b=this.get("datumStates");window.app.corpus.get("datumStates").each(function(a){var c=a.toJSON();c.selected="",b.addIfNew(c)});try{$.each(this.get("datumStates").where({selected:"selected"}),function(){this.get("state")!==a&&this.set("selected","")}),this.get("datumStates").where({state:a})[0].set("selected","selected")}catch(c){this.debug("problem getting color of datum state, probaly none are selected.",c)}var d=this.fields.where({label:"validationStatus"})[0];d!==[]&&d||(d=new h({label:"validationStatus",shouldBeEncrypted:"",showToUserTypes:"all",userchooseable:"disabled",help:"Any number of status of validity (replaces DatumStates). For example: ToBeCheckedWithSeberina, CheckedWithRicardo, Deleted etc..."}),this.fields.add(d));var e=d.get("mask")||"";e=a+" "+e;var f=_.unique(e.trim().split(" "));d.set("mask",f.join(" "))}}},putInTrash:{value:function(){this.set("trashed","deleted"+Date.now()),this.updateDatumState("Deleted"),this.saveAndInterConnectInApp(function(){window.appView&&window.appView.datumsEditView.showMostRecentDatum()})}},laTeXiT:{value:function(a){this.debug(a);var b;b=this.application&&this.application.corpus&&this.application.corpus.frequentFields?this.application.corpus.frequentFields:this.fields.map(function(a){return a.id});for(var c=this.fields.map(function(a){return a.value}),d=this.fields.map(function(a){return a.id}),e="\n",f=c.length-1;f>=0;f--)c[f]||(c.splice(f,1),d.splice(f,1));if(c&&c.length>0){var g=0;for(var h in c){if(b.indexOf(d[h])>=0)break;g++}e+=g!==d.length?"\n  \\begin{description}":"\n%  \\begin{description}";for(h in c)c[h]&&b.indexOf(d[h])>=0?e=e+"\n    \\item[\\sc{"+this.escapeLatexChars(d[h])+"}] "+this.escapeLatexChars(c[h]):c[h]&&(e=d[h].toLowerCase().indexOf("latex")>-1?e+"\n "+c[h]:e+"\n%    \\item[\\sc{"+this.escapeLatexChars(d[h])+"}] "+this.escapeLatexChars(c[h]));e+=g!==d.length?"\n  \\end{description}":"\n%  \\end{description}"}return e+="\n\\end{exe}\n\n"}},latexitDataList:{value:function(a){var b=this.laTeXiT(a);return a&&($("#export-type-description").html(" as <a href='http://latex.informatik.uni-halle.de/latex-online/latex.php?spw=2&id=562739_bL74l6X0OjXf' target='_blank'>LaTeX (GB4E)</a>"),$("#export-text-area").val($("#export-text-area").val()+b)),b}},latexitDatum:{value:function(a){var b=this.laTeXiT(a);if(a){$("#export-type-description").html(" as <a href='http://latex.informatik.uni-halle.de/latex-online/latex.php?spw=2&id=562739_bL74l6X0OjXf' target='_blank'>LaTeX (GB4E)</a>");var c="\\documentclass[12pt]{article} \n\\usepackage{fullpage} \n\\usepackage{tipa} \n\\usepackage{qtree} \n\\usepackage{gb4e} \n\\begin{document} \n"+b+"\\end{document}";$("#export-text-area").val(c)}return b}},escapeLatexChars:{value:function(a){var b=a;return b=b.replace(/\\/g,"\\textbackslashCURLYBRACES"),b=b.replace(/\^/g,"\\textasciicircumCURLYBRACES"),b=b.replace(/\~/g,"\\textasciitildeCURLYBRACES"),b=b.replace(/#/g,"\\#"),b=b.replace(/\$/g,"\\$"),b=b.replace(/%/g,"\\%"),b=b.replace(/&/g,"\\&"),b=b.replace(/_/g,"\\_"),b=b.replace(/{/g,"\\{"),b=b.replace(/}/g,"\\}"),b=b.replace(/</g,"\\textless"),b=b.replace(/>/g,"\\textgreater"),b=b.replace(/CURLYBRACES/g,"{}")}},datumIsInterlinearGlossText:{value:function(a){a||(a=this.fields.map(function(a){return a.id}));var b=!1,c=!1,d=!1;for(var e in a)("utterance"===a[e]||"morphemes"===a[e])&&(b=!0),"gloss"===a[e]&&(c=!0),"translation"===a[e]&&(d=!0);return c||b||d?!0:!1}},exportAsPlainText:{value:function(a){var b=this.fields.map(function(a){return a.value}),c=b.join("\n");return a&&($("#export-type-description").html(" as text (Word)"),$("#export-text-area").val($("#export-text-area").val()+c)),c}},exportAsCSV:{value:function(a,b,c){var d=this.accessAsObject,e=b||[],f=[];if(b)f=b.map(function(a){return d[a]||""});else for(var g in d)e.push(g),f.push(d[g]);c&&(f=e);var h=f.map(function(a){return'"'+a.replace(/"/g,'\\"')+'"'}).join(",")+"\n";return a&&($("#export-type-description").html(" as CSV (Excel, Filemaker Pro)"),$("#export-text-area").val($("#export-text-area").val()+h)),h}},encrypt:{value:function(){this.set("confidential",!0),this.fields.each(function(a){a.set("encrypted","checked")}),this.saveAndInterConnectInApp(window.app.router.renderDashboardOrNot,window.app.router.renderDashboardOrNot)}},decrypt:{value:function(){this.set("confidential",!1),this.fields.each(function(a){a.set("encrypted","")})}},saveAndInterConnectInApp:{value:function(a){"function"==typeof a&&a()}},setAsCurrentDatum:{value:function(){this.warn("Using deprected method setAsCurrentDatum.")}},highlight:{value:function(a,b,c){c=c||"highlight";var d=new RegExp("("+b+")","gi");return a.replace(d,"<span class='"+c+"'>$1</span>")}},toJSON:{value:function(a,b){this.debug("Customizing toJSON ",a,b);var c=d.prototype.toJSON.apply(this,arguments);return c?(this.debug("saving fields as the deprecated datumFields"),c.datumFields=c.fields,delete c.fields,c.audioVideo=c.audioVideo||[],c.comments=c.comments||[],this.debug(c),c):void this.warn("Not returning json right now.")}}}),c.Datum=o},{"./../FieldDBObject":4,"./../audio_video/AudioVideo":11,"./../audio_video/AudioVideos":13,"./../comment/Comments":17,"./../corpus/corpus.json":27,"./../image/Images":53,"./DatumField":35,"./DatumFields":36,"./DatumStates":38,"./DatumTags":40,"./Session":44}],35:[function(a,b,c){var d=a("./../FieldDBObject").FieldDBObject,e=a("./../confidentiality_encryption/Confidential").Confidential,f=function(a){this._fieldDBtype||(this._fieldDBtype="DatumField"),this.debug("Constructing DatumField ",a),a&&a.encryptedValue&&(a._encryptedValue=a.encryptedValue),a&&a.value&&(a._value=a.value),d.apply(this,arguments)};f.prototype=Object.create(d.prototype,{constructor:{value:f},defaults:{get:function(){return{id:Date.now(),labelFieldLinguists:"",labelPsychoLinguists:"",labelExperimenters:"",labelNonLinguists:"",labelTranslators:"",labelComputationalLinguist:"",type:"",shouldBeEncrypted:!1,showToUserTypes:"all",defaultfield:!1,value:"",mask:"",encrypted:"",json:{},help:"Put your team's data entry conventions here (if any)...",helpLinguists:"Put your team's data entry conventions here (if any)...",helpNonLinguists:"Put your team's data entry conventions here (if any)...",helpTranslators:"Put your team's data entry conventions here (if any)...",ComputationalLinguists:"Put your team's data entry conventions here (if any)...",helpDevelopers:"Put your team's data entry conventions here (if any)..."}},set:function(){}},internalModels:{value:{}},id:{get:function(){return this._id||d.DEFAULT_STRING},set:function(a){if(a!==this._id){if(!a)return void delete this._id;a.trim&&(a=a.trim());var b=a+"";return a=this.sanitizeStringForPrimaryKey(a),null===a?void this.bug("Invalid id, not using "+b+" id remains as "+this._id):void(this._id=a)}}},label:{get:function(){return this.debug("label is deprecated, instead automatically contextualize a label for appropriate user eg labelFieldLinguists, labelNonLinguists, labelTranslators, labelComputationalLinguist"),this._labelNonLinguists||this._labelFieldLinguists||this.id||d.DEFAULT_STRING},set:function(a){this.debug("label is deprecated, instead automatically contextualize a label for appropriate user eg labelFieldLinguists,  labelNonLinguists, labelTranslators, labelComputationalLinguist"),this._labelFieldLinguists||(a&&a.length>2?this._labelFieldLinguists=a[0].toUpperCase()+a.substring(1,a.length):this._labelFieldLinguists=a),this._labelNonLinguists||(a&&a.length>2?this._labelNonLinguists=a[0].toUpperCase()+a.substring(1,a.length):this._labelNonLinguists=a),this._id||(this.id=a)}},userchooseable:{get:function(){return this.debug("userchooseable is deprecated, instead use defaultfield"),this.defaultfield},set:function(a){this.debug("userchooseable is deprecated, instead use defaultfield"),"disabled"===a&&(a=!0),a||(a=!1),this.defaultfield=a}},labelFieldLinguists:{get:function(){return this._labelFieldLinguists||this.label},set:function(a){return a!==this._labelFieldLinguists?a?void(this._labelFieldLinguists=a.trim()):void delete this._labelFieldLinguists:void 0}},labelPsychoLinguists:{get:function(){return this._labelPsychoLinguists||this.labelFieldLinguists},set:function(a){return a!==this._labelPsychoLinguists?a?void(this._labelPsychoLinguists=a.trim()):void delete this._labelPsychoLinguists:void 0}},labelExperimenters:{get:function(){return this._labelExperimenters||this.labelNonLinguists},set:function(a){return a!==this._labelExperimenters?a?void(this._labelExperimenters=a.trim()):void delete this._labelExperimenters:void 0}},labelNonLinguists:{get:function(){return this._labelNonLinguists||this.label},set:function(a){return a!==this._labelNonLinguists?a?void(this._labelNonLinguists=a.trim()):void delete this._labelNonLinguists:void 0}},labelTranslators:{get:function(){return this._labelTranslators||this.labelNonLinguists},set:function(a){return a!==this._labelTranslators?a?void(this._labelTranslators=a.trim()):void delete this._labelTranslators:void 0}},labelComputationalLinguist:{get:function(){return this._labelComputationalLinguist||this.label},set:function(a){return a!==this._labelComputationalLinguist?a?void(this._labelComputationalLinguist=a.trim()):void delete this._labelComputationalLinguist:void 0}},type:{get:function(){return this._type||d.DEFAULT_STRING},set:function(a){return a!==this._type?a?void(this._type=a.trim()):void delete this._type:void 0}},shouldBeEncrypted:{get:function(){return this._shouldBeEncrypted||d.DEFAULT_FALSE},set:function(a){return this.verbose("Setting shouldBeEncrypted "+a,this),a!==this._shouldBeEncrypted?("checked"===a&&(a=!0),a=!!a,this.verbose("Setting shouldBeEncrypted "+a,this),this._shouldBeEncrypted===!0&&a===!1?void this.warn("This field's shouldBeEncrypted cannot be undone. Only a corpus administrator can change shouldBeEncrypted to false if it has been true before."):void(this._shouldBeEncrypted=a)):void 0}},encrypted:{get:function(){return this._value&&0===this._value.indexOf("confidential:")&&(this._encrypted=!0),this._encrypted||d.DEFAULT_FALSE},set:function(a){if(a!==this._encrypted){if(!a)return void delete this._encrypted;"checked"===a&&(a=!0),this._encrypted=!!a}}},showToUserTypes:{get:function(){return this._showToUserTypes||"all"},set:function(a){return a!==this._showToUserTypes?a?void(this._showToUserTypes=a.trim()):void delete this._showToUserTypes:void 0}},defaultfield:{get:function(){return this._defaultfield||d.DEFAULT_FALSE},set:function(a){return a!==this._defaultfield?a?void(this._defaultfield=!!a):void delete this._defaultfield:void 0}},repairMissingEncryption:{value:!0},value:{configurable:!0,get:function(){if(this.debug("looking up the value of this field",this._value),void 0===this._value||null===this._value||""===this._value)return d.DEFAULT_STRING;if(!this._shouldBeEncrypted)return this._value;if(!this.encrypted)return this._value;if(!this.decryptedMode)return this._encryptedValue&&this.warn("User is not able to view the  "+this.mask+"  value of "+this.label+", it is encrypted and the user isn't in decryptedMode."),this.mask||d.DEFAULT_STRING;if(!this._encryptedValue||0!==this._encryptedValue.indexOf("confidential:")){if(this.warn("The value was supposed to be encrypted but was not encrypted. This should not happen, it might only happen if an app was editing the data and didn't have the encryption implemented. Not overwritting the value."),!this.repairMissingEncryption||!this.confidential)return this._value;var a=this.confidential.encrypt(this._value);this.warn(" Encrypting the value "+this._value),this._encryptedValue=a,this._mask=this.createMask(this._value),this._value=this._mask}if(0===this._encryptedValue.indexOf("confidential:")){if(!this.confidential)return this.warn("This field's encrypter hasnt been set. It cannot be decrypted yet."),this.mask;var b=this.confidential.decrypt(this._encryptedValue);if(!b)return this.warn("Encryption key is the wrong key, showing the user the mask instead."),this.decryptedMode=!1,this.mask;if(this.type&&this.type.indexOf("number")>-1){var c=Number(b);isNaN(c)||(b=c)}return this.debug("decryptedValue "+b),b}this.bug("The value wasn't returned, this should never happen and is a bug in the logic.")},set:function(a){if(a!==this._value&&("function"==typeof a.trim&&(a=a.trim()),void 0!==a&&null!==a&&(""!==a||this._value))){if(!a&&this._value){var b=!this.encrypted||!this._shouldBeEncrypted||this._shouldBeEncrypted&&this.encrypted&&this.decryptedMode;return b?(this._value="",this._mask="",void(this._encryptedValue="")):void(this._value&&this.warn("The value "+this._value+" of "+this.id+" was requested to be removed by the user, but they are not able to edit the field currently. No changes were made "))}var c;if(!this._shouldBeEncrypted)return this._mask=a,void(this._value=this._mask);if(!this.encrypted)return this._encryptedValue=a,this._mask=a,void(this._value=this._mask);if(!this._value)return this.confidential?(this._encryptedValue=this.confidential.encrypt(a),this._mask=this.createMask(a),void(this._value=this._mask)):void("function"!=typeof a.indexOf||0!==a.indexOf("confidential:")||this._encryptedValue?this.warn("This field's encrypter hasnt been set. It cannot be edited yet."):(this._encryptedValue=a,this._value=this.mask,this.debug('This is probably a new field initialization from old data (the value has "confidential:" in it, and yet the encryptedValue isn\'t set')));if(!this.decryptedMode)return void(this._encryptedValue&&this.warn("User is not able to change the value "+this.mask+" of "+this.label+", it is encrypted and the user isn't in decryptedMode."));if(!this._encryptedValue||0!==this._encryptedValue.indexOf("confidential:")){if(this.warn("The value was changed, and it was supposed to be encrypted but was not encrypted. This should not happen, it might only happen if an app was editing the data and didn't have the encryption implemented."),!this.repairMissingEncryption||!this.confidential)return void this.warn(" Not overwritting the value.");c=this.confidential.encrypt(a),this._encryptedValue=c,this._mask=this.createMask(a),this._value=this._mask,this.warn(" Overwritting the value.")}if(!this.confidential)return void this.warn("This field's encrypter hasnt been set. It cannot be edited yet.");this._encryptedValue=this.confidential.encrypt(a),this._mask=this.createMask(a),this._value=this._mask}}},mask:{get:function(){return this._mask||d.DEFAULT_STRING},set:function(a){if(a!==this._mask){if(!a)return void delete this._mask;this.debug("Setting datum field mask "+a),"function"==typeof a.trim&&(a=a.trim()),this._mask=a}}},encryptedValue:{get:function(){return this._encryptedValue||d.DEFAULT_STRING},set:function(a){a&&a!==this._encryptedValue&&(this._encryptedValue&&this.warn(this.id+" cannot be changed directly, instead you must be in decryptedMode "),this.debug(" not setting "+a))}},json:{get:function(){return this._json||d.DEFAULT_OBJECT;
},set:function(a){if(a!==this._json){if(!a)return void delete this._json;a&&this._shouldBeEncrypted&&this.encrypted&&!this.decryptedMode&&this.debug("encrypt json also"),this._json=a}}},help:{configurable:!0,get:function(){return this._help||this._helpNonLinguists||"Put your team's data entry conventions here (if any)..."},set:function(a){if(a!==this._help){if(!a)return void delete this._help;this._help=a.trim(),this._helpNonLinguists||(this.helpNonLinguists=this._help)}}},helpLinguists:{get:function(){return this._helpLinguists||this.help},set:function(a){return a!==this._helpLinguists?a?void(this._helpLinguists=a.trim()):void delete this._helpLinguists:void 0}},helpNonLinguists:{get:function(){return this._helpNonLinguists||this.help},set:function(a){return a!==this._helpNonLinguists?a?void(this._helpNonLinguists=a.trim()):void delete this._helpNonLinguists:void 0}},helpTranslators:{get:function(){return this._helpTranslators||this.help},set:function(a){return a!==this._helpTranslators?a?void(this._helpTranslators=a.trim()):void delete this._helpTranslators:void 0}},helpComputationalLinguists:{get:function(){return this._helpComputationalLinguists||this.help},set:function(a){return a!==this._helpComputationalLinguists?a?void(this._helpComputationalLinguists=a.trim()):void delete this._helpComputationalLinguists:void 0}},helpDevelopers:{get:function(){return this._helpDevelopers||this.help},set:function(a){return a!==this._helpDevelopers?a?void(this._helpDevelopers=a.trim()):void delete this._helpDevelopers:void 0}},validate:{value:function(a){this.tood("Vaidating is commented out ",a)}},upgrade:{value:function(a,b){return b=b||{},void 0===a.mask&&this.mask&&(a.mask=this.mask),void 0===a.value&&this.value&&(a.value=this.value),void 0===a.shouldBeEncrypted&&this.shouldBeEncrypted&&(a.shouldBeEncrypted=this.shouldBeEncrypted),void 0===a.encrypted&&this.encrypted&&(a.encrypted=this.encrypted),a.mask&&""!==a.mask&&("checked"!==a.shouldBeEncrypted?a.value=a.mask:"checked"!==a.encrypted?a.value=a.mask:this.corpus.confidential.decryptedMode?(0!==a.mask.indexOf("confidential:")?a.value=this.corpus.confidential.encrypt(a.mask):0===a.mask.indexOf("confidential:")&&(a.mask=this.mask(this.corpus.confidential.decrypt(this.value)),a.value=this.value),a.value&&0!==a.value.indexOf("confidential")?a.value=this.corpus.confidential.encrypt(a.mask):a.value&&0===a.value.indexOf("confidential")&&(a.mask=this.corpus.confidential.decrypt(this.value),a.value=this.value)):("checked"===this.encrypted&&("checked"===a.encrypted||this.corpus.confidential.decryptedMode||(a.encrypted="checked")),a.mask&&0===a.mask.indexOf("confidential")?(a.mask=this.mask(this.corpus.confidential.decrypt(this.value)),a.value=this.value):(a.mask=this.mask,a.value=this.value),a.value&&0!==a.value.indexOf("confidential")?(a.mask=this.mask(this.value),a.value=this.corpus.confidential.encrypt(this.value)):(a.mask=this.mask,a.value=this.value))),a}},createMask:{value:function(a){return a=a||"",a+="",a.replace(/[^_=., -]/g,"x")}},saveAndInterConnectInApp:{value:function(a){"function"==typeof a&&a()}},confidential:{get:function(){return this.confidentialEncrypter},set:function(a){a!==this.confidentialEncrypter&&("function"!=typeof a.encrypt&&a.secretkey&&(a=new e(a)),this.confidentialEncrypter=a)}},toJSON:{value:function(a,b){this.debug("Customizing toJSON ",a,b),a=!0;var c=d.prototype.toJSON.apply(this,arguments);return delete c.dateCreated,delete c.dateModified,delete c.comments,delete c.dbname,c.label=this.id,c.hint||delete c.hint,c.value=this.value||"",c.mask=this.mask||"",b&&(c.mask===c.value&&delete c.mask,c.encryptedValue===c.value&&delete c.encryptedValue,this.debug("removeEmptyAttributes",c)),c.helpNonLinguists===c.help&&delete c.helpNonLinguists,c.helpDevelopers===c.help&&delete c.helpDevelopers,c.helpLinguists===c.help&&delete c.helpLinguists,c.helpComputationalLinguists===c.help&&delete c.helpComputationalLinguists,c.helpTranslators===c.help&&delete c.helpTranslators,(c.labelTranslators===c.label||c.labelTranslators===c.labelFieldLinguists)&&delete c.labelTranslators,c.labelExperimenters===c.label&&delete c.labelExperimenters,(c.labelNonLinguists===c.label||c.labelNonLinguists===c.labelFieldLinguists)&&delete c.labelNonLinguists,c.labelFieldLinguists===c.label&&delete c.labelFieldLinguists,(c.labelPsychoLinguists===c.label||c.labelPsychoLinguists===c.labelFieldLinguists)&&delete c.labelPsychoLinguists,(c.labelComputationalLinguist===c.label||c.labelComputationalLinguist===c.labelFieldLinguists)&&delete c.labelComputationalLinguist,c.id=this.id,delete c._id,c.fieldDBtype=this.fieldDBtype,delete c._type,this.debug("json",c),c}}}),c.DatumField=f},{"./../FieldDBObject":4,"./../confidentiality_encryption/Confidential":18}],36:[function(a,b,c){var d=a("./../Collection").Collection,e=a("./../datum/DatumField").DatumField,f=function(a){this._fieldDBtype||(this._fieldDBtype="DatumFields"),this.debug("Constructing DatumFields length: ",a),d.apply(this,arguments)};f.prototype=Object.create(d.prototype,{constructor:{value:f},primaryKey:{value:"id"},INTERNAL_MODELS:{value:{item:e}},capitalizeFirstCharacterOfPrimaryKeys:{value:!1},docsAreReorderable:{get:function(){return null!==this._docsAreReorderable&&void 0!==this._docsAreReorderable?this._docsAreReorderable:!0},set:function(a){return null===a||void 0===a?void delete this._docsAreReorderable:void(this._docsAreReorderable=a)}},showDocPosition:{get:function(){return null!==this._showDocPosition&&void 0!==this._showDocPosition?this._showDocPosition:!0},set:function(a){return null===a||void 0===a?void delete this._showDocPosition:void(this._showDocPosition=a)}},cloneStructure:{value:function(a){a&&this.todo("includeEvenEmptyAttributes is not implemented: "+a);var b=d.prototype.toJSON.apply(this,arguments);return b.map=b.map(function(a){return a.value="",a.mask="",a.encryptedValue="",a}),b}}}),c.DatumFields=f},{"./../Collection":3,"./../datum/DatumField":35}],37:[function(a,b,c){var d=a("./../FieldDBObject").FieldDBObject,e=a("./../user/UserMask").UserMask,f=function(a){this._fieldDBtype||(this._fieldDBtype="DatumState"),this.debug("Constructing DatumState ",a),d.apply(this,arguments)};f.prototype=Object.create(d.prototype,{constructor:{value:f},defaults:{value:{state:"Checked",color:"",consultant:e,showInSearchResults:"checked",selected:""}},INTERNAL_MODELS:{value:{consultant:e}},validationStatus:{get:function(){return!this._validationStatus&&this.state&&(this.warn("state is deprecated, use validationStatus instead."),this._validationStatus=this.state),this._validationStatus||d.DEFAULT_STRING},set:function(a){return a!==this._validationStatus?a?void(this._validationStatus=a.trim()):void delete this._validationStatus:void 0}}}),c.DatumState=f},{"./../FieldDBObject":4,"./../user/UserMask":75}],38:[function(a,b,c){var d=a("./DatumTags").DatumTags,e=a("./DatumState").DatumState,f=function(a){this._fieldDBtype||(this._fieldDBtype="DatumStates"),this.debug("Constructing DatumStates length: ",a),d.apply(this,arguments)};f.prototype=Object.create(d.prototype,{constructor:{value:f},primaryKey:{value:"validationStatus"},INTERNAL_MODELS:{value:{item:e}}}),c.DatumStates=f},{"./DatumState":37,"./DatumTags":40}],39:[function(a,b,c){var d=a("./../FieldDBObject").FieldDBObject,e=function(a){this._fieldDBtype||(this._fieldDBtype="DatumTag"),this.debug("Constructing DatumTag ",a),d.apply(this,arguments)};e.prototype=Object.create(d.prototype,{constructor:{value:e}}),c.DatumTag=e},{"./../FieldDBObject":4}],40:[function(a,b,c){var d=a("./../Collection").Collection,e=a("./DatumTag").DatumTag,f=function(a){this._fieldDBtype||(this._fieldDBtype="DatumTags"),this.debug("Constructing DatumTags ",a),d.apply(this,arguments)};f.prototype=Object.create(d.prototype,{constructor:{value:f},primaryKey:{value:"tag"},INTERNAL_MODELS:{value:{item:e}}}),c.DatumTags=f},{"./../Collection":3,"./DatumTag":39}],41:[function(a,b,c){var d=a("./../Collection").Collection,e=a("./../FieldDBObject").FieldDBObject,f=function(a){this._fieldDBtype||(this._fieldDBtype="DocumentCollection"),this.debug("Constructing DocumentCollection ",a),d.apply(this,arguments)};f.prototype=Object.create(d.prototype,{constructor:{value:f},INTERNAL_MODELS:{value:{item:e}},sanitizeStringForPrimaryKey:{value:function(a){return a}}}),c.DocumentCollection=f},{"./../Collection":3,"./../FieldDBObject":4}],42:[function(a,b,c){"use strict";var d=a("./Datum").Datum,e=a("./../FieldDBObject").FieldDBObject,f=function(a){this._fieldDBtype||(this._fieldDBtype="LanguageDatum"),a&&"string"==typeof a&&(this.debug("Turning LanguageDatum "+a+" to an object"),a={orthography:a}),this.debug("Constructing LanguageDatum: ",a),d.apply(this,[a])};f.prototype=Object.create(d.prototype,{constructor:{value:f},length:{get:function(){return this.utterance?this.utterance.length:this.orthography?this.orthography.length:this.morphemes?this.morphemes.length:void 0}},orthography:{configurable:!0,get:function(){return this.fields&&this.fields.orthography?(this.debug(" getting orthography "+this._id+" to "+this.fields.orthography.value),this.fields.orthography.value):e.DEFAULT_STRING},set:function(a){this.fields&&this.fields.orthography||this.addField("orthography"),this.debug("    Setting orthography "+this._id+" to "+a),this.fields.orthography.value=a}},utterance:{configurable:!0,get:function(){return this.fields&&this.fields.utterance?this.fields.utterance.value:e.DEFAULT_STRING},set:function(a){this.fields&&this.fields.utterance||this.addField("utterance"),this.fields.utterance.value=a}},morphemes:{configurable:!0,get:function(){if(this.fields&&this.fields.morphemes){if(this.fields.morphemes.value)return this.fields.morphemes.value;var a=this.utterance||this.orthography||e.DEFAULT_STRING;return this.debug("morphemes is not defined so using "+a),a+""}return e.DEFAULT_STRING},set:function(a){this.debug("setting morphemes "+a),this.fields&&this.fields.morphemes||this.addField("morphemes"),this.debug(" this.fields.morphemes ",this.fields.morphemes),this.fields.morphemes.value=a,this.debug(" this.fields.morphemes.value ",this.fields.morphemes.value)}},allomorphs:{configurable:!0,get:function(){return this.fields&&this.fields.allomorphs?this.fields.allomorphs.value:e.DEFAULT_STRING},set:function(a){this.fields&&this.fields.allomorphs||this.addField("allomorphs"),this.fields.allomorphs.value=a}},gloss:{configurable:!0,get:function(){return this.fields&&this.fields.gloss?this.fields.gloss.value:e.DEFAULT_STRING},set:function(a){this.fields&&this.fields.gloss||this.addField("gloss"),this.fields.gloss.value=a}},syntacticCategory:{configurable:!0,get:function(){return this.fields&&this.fields.syntacticCategory?this.fields.syntacticCategory.value:e.DEFAULT_STRING},set:function(a){this.fields&&this.fields.syntacticCategory||this.addField("syntacticCategory"),this.fields.syntacticCategory.value=a}},translation:{configurable:!0,get:function(){return this.fields&&this.fields.translation?this.fields.translation.value:e.DEFAULT_STRING},set:function(a){this.fields&&this.fields.translation||this.addField("translation"),this.fields.translation.value=a}},igt:{get:function(){var a,b,c,d,e,f,g={},h={},i=[],j=/[#?!,\/\(\)\*\#]/g,k=/[ \t\n]+/,l=!1;this.fields.map(function(c){if(c.type&&c.type.indexOf("parallelText")>-1&&(h[c.id]=c.value),c.type&&-1!==c.type.indexOf("IGT")){var d=c.value.replace(/#?!.,\//g,"").split(k);d=d.map(function(c){return l&&c&&(a=c.replace(/\(\*[^)]*\)/g,"$1"),a=a.replace(/\*\(([^)]*)\)/,"$1"),b=a.replace(j,""),c=b),c}),g[c.id]=d}}),this.debug("Collected all the IGT lines",g),this.debug("Collected all the Paralel Text lines",h),c=0;for(d in g)g[d]&&g[d].length>c&&(c=g[d].length);for(e=0;c>e;e++){f={};for(d in g)this.debug("working on   "+d,g[d]),g[d]&&g[d].length>e&&g[d][e]?f[d]=g[d][e]:f[d]="";i.push(f)}return this.debug("IGT+ tuples",i),{tuples:i,parallelText:h}},set:function(){this.warn("Setting the igt has to be copy pasted from one of the other codebases")}},laTeXiT:{value:function(a){this.debug(a);var b;b=this.application&&this.application.corpus&&this.application.corpus.frequentFields?this.application.corpus.frequentFields:this.fields.map(function(a){return a.id});var c=this.fields.map(function(a){return a.value}),d=this.fields.map(function(a){return a.id}),e=-1,f="",g=-1,h="",i=-1,j="",k=-1,l="",m=-1,n="",o="\n\\begin{exe} \n  \\ex [";this.datumIsInterlinearGlossText()&&(e=d.indexOf("judgement"),e>=0&&(f=c[e],d.splice(e,1),c.splice(e,1)),g=d.indexOf("utterance"),g>=0&&(h=c[g],d.splice(g,1),c.splice(g,1)),i=d.indexOf("morphemes"),i>=0&&(j=c[i],d.splice(i,1),c.splice(i,1)),k=d.indexOf("gloss"),k>=0&&(l=c[k],d.splice(k,1),c.splice(k,1)),m=d.indexOf("translation"),m>=0&&(n=c[m],d.splice(m,1),c.splice(m,1)),o=o+this.escapeLatexChars(f)+"]{"+this.escapeLatexChars(h)+"\n  \\gll "+this.escapeLatexChars(j)+"\\\\\n  "+this.escapeLatexChars(l)+"\\\\\n  \\trans "+this.escapeLatexChars(n)+"}\n\\label{}");for(var p=c.length-1;p>=0;p--)c[p]||(c.splice(p,1),d.splice(p,1));if(c&&c.length>0){var q=0;for(var r in c){if(b.indexOf(d[r])>=0)break;q++}o+=q!==d.length?"\n  \\begin{description}":"\n%  \\begin{description}";for(r in c)c[r]&&b.indexOf(d[r])>=0?o=o+"\n    \\item[\\sc{"+this.escapeLatexChars(d[r])+"}] "+this.escapeLatexChars(c[r]):c[r]&&(o=d[r].toLowerCase().indexOf("latex")>-1?o+"\n "+c[r]:o+"\n%    \\item[\\sc{"+this.escapeLatexChars(d[r])+"}] "+this.escapeLatexChars(c[r]));o+=q!==d.length?"\n  \\end{description}":"\n%  \\end{description}"}return o+="\n\\end{exe}\n\n"}},datumIsInterlinearGlossText:{value:function(a){a||(a=this.fields.map(function(a){return a.id}));var b=!1,c=!1,d=!1;for(var e in a)("utterance"===a[e]||"morphemes"===a[e])&&(b=!0),"gloss"===a[e]&&(c=!0),"translation"===a[e]&&(d=!0);return c||b||d?!0:!1}}}),c.LanguageDatum=f},{"./../FieldDBObject":4,"./Datum":34}],43:[function(a,b,c){var d=a("./Stimulus").Stimulus,e=a("q"),f=function(a){this._fieldDBtype||(this._fieldDBtype="Response"),this.debug("Constructing Response ",a),d.apply(this,arguments)};f.prototype=Object.create(d.prototype,{constructor:{value:f},jsonType:{get:function(){return this.fieldDBtype}},collection:{get:function(){return this.fieldDBtype}},pauseAudioWhenConfirmingResponse:{value:null,configurable:!0},addResponse:{value:function(a,b){if(!a)throw new Error("Cannot add response without the x y information found in the touch/click responseEvent");var c=Date.now(),d=this.application.audioPlayer.getDuration(this.audioFile)||0;d?d=1e3*d:this.warn("The audio has no duration.. This is strange."),this.pauseAudioWhenConfirmingResponse&&this.pauseAudio();var f=this,g=e.defer();if(this.confirmResponseChoiceMessage){this.contextualizer.currentLocale=this.application.interfaceLocale;var h=this.contextualizer.localize(this.confirmResponseChoiceMessage),i={iconSrc:f.ownerComponent.iconSrc,message:h};this.confirm(i.message).then(function(){g.resolve()},function(){g.reject(new Error("The x prevented the cancel?"))}).fail(function(a){console.error(a.stack,f)})}else g.resolve();g.promise.then(function(){f.stopAudio(),f.ownerComponent.nextStimulus()},function(a){f.warn("Not continuing to next stimulus",a),this.pauseAudioWhenConfirmingResponse&&f.playAudio()}).fail(function(a){console.error(a.stack,f)});var j="";b&&(j=this[b].substring(this[b].lastIndexOf("/")+1).replace(/\..+$/,"").replace(/\d+_/,""),j===this.target.orthographic?j=this.target:this.distractors.map(function(a){j===a.orthographic&&(j=a)}));var k={reactionTimeAudioOffset:c-this.reactionTimeStart-d,reactionTimeAudioOnset:c-this.reactionTimeStart,x:a.x,y:a.y,pageX:a.pageX,pageY:a.pageY,choice:j,score:this.scoreResponse(this.target,j)};this.responses.push(k),f.warn("Recorded response",JSON.stringify(k))}},addOralResponse:{value:function(a,b){var c=Date.now(),d=this.application.audioPlayer.getDuration(this.audioFile)||0;d?d=1e3*d:this.warn("The audio has no duration.. This is strange."),this.pauseAudioWhenConfirmingResponse&&this.pauseAudio();var f=this,g=e.defer();if(this.confirmResponseChoiceMessage){this.contextualizer.currentLocale=this.application.interfaceLocale;var h=this.contextualizer.localize(this.confirmResponseChoiceMessage),i={iconSrc:f.ownerComponent.iconSrc,message:h};this.confirm(i.message).then(function(){g.resolve()},function(){g.reject(new Error("The x prevented the cancel?"))}).fail(function(a){console.error(a.stack,f)})}else b||g.resolve();g.promise.then(function(){f.stopAudio(),f.ownerComponent.nextStimulus()},function(a){f.warn("Not continuing to next stimulus",a),this.pauseAudioWhenConfirmingResponse&&f.playAudio()}).fail(function(a){console.error(a.stack,f)});var j={reactionTimeAudioOffset:c-this.reactionTimeStart-d,reactionTimeAudioOnset:c-this.reactionTimeStart,x:0,y:0,pageX:0,pageY:0,choice:a,score:a.score};this.responses=this.responses||[],this.responses.push(j),f.warn("Recorded response",JSON.stringify(j))}},scoreResponse:{value:function(a,b){return b.orthographic?b.orthographic===a.orthographic?1:0:"error"}},addNonResponse:{value:function(a){if(!a)throw"Cannot add response without the x y information found in the touch/click responseEvent";var b=Date.now(),c={reactionTimeAudioOffset:b-this.reactionTimeStart,reactionTimeAudioOnset:b-this.reactionTimeStart,x:a.x,y:a.y,pageX:a.pageX,pageY:a.pageY,chosenVisualStimulus:"none",responseScore:-1};this.responses=this.responses||[],this.nonResponses.push(c),this.warn("Recorded non-response, the user is confused or not playing the game.",JSON.stringify(c))}},playAudio:{value:function(a){this.application.audioPlayer.play(this.audioFile,a)}},pauseAudio:{value:function(){this.application.audioPlayer.pause(this.audioFile)}},stopAudio:{value:function(){this.application.audioPlayer.stop(this.audioFile)}},load:{value:function(a){for(var b in a)a.hasOwnProperty(b)&&(this[b]=a[b]);null===this.responses&&(this.responses=[]),null===this.nonResponses&&(this.nonResponses=[]),this.nonResponses=[],this.experimenterId=this.application.experiment.experimenter.id,this.participantId=this.application.experiment.participant.id}}}),c.Response=f},{"./Stimulus":45,q:223}],44:[function(a,b,c){var d=a("./../confidentiality_encryption/Confidential").Confidential,e=a("./DatumFields").DatumFields,f=a("./../data_list/DataList").DataList,g=a("./../FieldDBObject").FieldDBObject,h=a("./../corpus/corpus.json"),i=function(a){this._fieldDBtype||(this._fieldDBtype="Session"),this.debug("Constructing Session: ",a),a=a||{},a&&(a._rev||a.fields)||(a.fields=this.defaults.fields),(a.docIds||a.docs)&&this.initializeDatalist(),this.debug(" -> ",a.datalist),g.apply(this,arguments),this.debug("   after construction: ",this._datalist)};i.prototype=Object.create(g.prototype,{constructor:{value:i},dateAndGoalSnippet:{get:function(){var a=this.goal;a.length>31&&(a=a.substr(0,30)+"...");var b=this.dateElicited;return b.length>16&&(b=b.substr(0,15)+"..."),b+" : "+a},set:function(){this.debug("cant set the snippet.")}},title:{get:function(){return this.goal},set:function(a){return this.warn("title is syntactic sugar for goal, if it was used this will make it overwrite the goal field"),this.goal=a}},goal:{configurable:!0,get:function(){return this.fields&&this.fields.goal?this.fields.goal.value:g.DEFAULT_STRING},set:function(a){this.fields&&this.fields.goal||(this.fields=this.defaults.fields),(!a||a.indexOf&&a.indexOf("Change this session")>-1)&&(a="Practice collecting linguistic utterances or words"),this.fields.goal.value=a}},date:{get:function(){return this.dateElicited},set:function(a){return this.warn("date is syntactic sugar for dateElicited"),this.dateElicited=a}},dateElicited:{configurable:!0,get:function(){return this.fields&&this.fields.dateElicited?(this.fields.dateElicited.value&&this.fields.dateElicited.value.indexOf&&this.fields.dateElicited.value.indexOf("Change this to a tim")>-1&&(this.fields.dateElicited.value="Probably prior to "+new Date(this.dateCreated)),!this.fields.dateElicited.value&&this.dateCreated&&(this.fields.dateElicited.value=new Date(this.dateCreated)+""),this.fields.dateElicited.value):g.DEFAULT_STRING},set:function(a){this.fields||(this.fields=this.defaults.fields),a&&a.indexOf&&a.indexOf("Change this to a tim")>-1&&(a="Probably prior to "+new Date(this.dateCreated)),this.fields.dateElicited.value=a}},api:{value:"sessions"},INTERNAL_MODELS:{value:{fields:e,confidential:d,docs:g.DEFAULT_COLLECTION,docIds:g.DEFAULT_COLLECTION,datalist:f}},sessionFields:{get:function(){return this.fields},set:function(a){return this.warn("sessionFields are depreacted, use fields instead "+this.id),this.fields=a}},fields:{get:function(){return this.debug("getting fields "+this.id),this._fields},set:function(a){a&&!a.confidential&&this.confidential&&(a.confidential=this.confidential),this.ensureSetViaAppropriateType("fields",a)}},defaults:{get:function(){var a={fields:h.sessionFields};return JSON.parse(JSON.stringify(a))},set:function(){}},confidentiality:{get:function(){return this.fields?this.fields.confidentiality.value:void 0},set:function(a){this.fields||(this.fields=this.defaults.fields),this.fields.confidentiality.value=a}},participants:{configurable:!0,get:function(){return this.fields&&this.fields.participants&&this.fields.participants.json&&this.fields.participants.json.users?this.fields.participants.json.users:void 0},set:function(a){if(this.fields||(this.fields=this.defaults.fields),"string"==typeof a&&(a=a.indexOf(",")>-1?a.split():[a],a=a.map(function(a){return a=a.trim(),{username:a,name:a,gravatar:""}})),"[object Array]"===Object.prototype.toString.call(a)){var b=this;a.map(function(a){b.fields.participants.json.users.unshift(a)})}else this.fields.participants.json.users.unshift(a)}},consultants:{get:function(){var a=[];return this.fields&&this.fields.participants&&this.fields.participants.json&&this.fields.participants.json.users&&(this.fields.participants.json.users.map(function(b){b.role&&b.role.indexOf("speaker")>-1&&a.push(b)}),0===a.length&&(a=this.fields.participants.json.users)),a},set:function(a){this.fields||(this.fields=this.defaults.fields),"string"==typeof a&&(a=a.indexOf(",")>-1?a.split(","):[a],a=a.map(function(a){return a=a.trim(),{username:a,name:a,gravatar:""}})),"[object Array]"!==Object.prototype.toString.call(a)&&(a=[a]);var b=this;a=a.map(function(a){return a.role?a.role="speaker,"+a.role:a.role="speaker",b.fields.participants.json.users.unshift(a),a}),this.debug("adding consultant",a)}},user:{get:function(){var a=[];return this.fields&&this.fields.participants&&this.fields.participants.json&&this.fields.participants.json.users&&(this.fields.participants.json.users.map(function(b){b.role&&b.role.indexOf("dataEntry")>-1&&a.push(b)}),0===a.length&&(a=this.fields.participants.json.users)),a[0]},set:function(a){this.fields||(this.fields=this.defaults.fields),"string"==typeof a&&(a=a.indexOf(",")>-1?a.split(","):[a],a=a.map(function(a){return a=a.trim(),{username:a,name:a,gravatar:""}})),"[object Array]"!==Object.prototype.toString.call(a)&&(a=[a]);var b=this;a=a.map(function(a){return a.role?a.role="dataEntry,"+a.role:a.role="dataEntry",b.fields.participants.json.users.unshift(a),a}),this.debug("adding user",a)}},encryptByCorpus:{value:!0},confidential:{get:function(){return this.confidentialEncrypter},set:function(a){this.ensureSetViaAppropriateType("confidential",a,"confidentialEncrypter"),this._fields&&this.confidentialEncrypter&&(this._fields.confidential=this.confidentialEncrypter)}},languages:{get:function(){return this.fields?this.fields.languages.value:void 0},set:function(a){var b,c;"string"==typeof a?(this.debug("User set the languages with a string"),this.fields.languages&&this.fields.languages&&this.fields.languages.json&&this.confirm("Do you want to set the languages from "+JSON.stringify(this.fields.languages.json)+" to "+a),b=a,c={value:a,label:"languages",json:{languages:a.split(",")}},c.json.languages=c.json.languages.map(function(a){return{iso:a.toLowerCase().trim(),name:a.trim(),nativeName:a.trim()}})):c=a,this.fields||(this.fields=this.defaults.fields),b&&(this.fields.languages.value=b),this.debug("setting language ",c);for(var d in c)c.hasOwnProperty(d)&&(this.debug("looking at "+d),this.fields.languages[d]=c[d])}},dialects:{get:function(){return this.languages},set:function(a){return this.languages=a}},docIds:{get:function(){return this._datalist&&this._datalist.docIds?this._datalist.docIds:void 0},set:function(a){this._datalist||this.initializeDatalist(),this._datalist.docIds=a}},docs:{get:function(){return this._datalist&&this._datalist._docs?this._datalist._docs:void 0},set:function(a){if(!a||0===a.length)return void this.warn("cant clear the docs of a session like this.",a);this.whenReindexedFromApi||this.initializeDatalist();var b,c=this;this.whenReindexedFromApi.fail(function(a){console.log(a.stack)}).done(function(){c.warn("  making sure "+a.length+" items are in the list of data."),a.map(function(a){b=a[c._datalist.primaryKey],b?c._datalist._docs[b]||(c.warn("Adding "+a+" to the list. "),c._datalist._docs.add(a)):(c.warn("This doc has no primary key, trying to add it anyway.",a),c._datalist._docs.add(a))})})}},utterances:{get:function(){return this.docs},set:function(a){return this.docs=a}},transcriptions:{get:function(){return this.docs},set:function(a){return this.docs=a}},items:{get:function(){return this.docs},set:function(a){return this.docs=a}},datum:{get:function(){return this.docs},set:function(a){return this.docs=a}},data:{get:function(){return this.docs},set:function(a){return this.docs=a}},records:{get:function(){return this.docs},set:function(a){return this.docs=a}},entries:{get:function(){return this.docs},set:function(a){return this.docs=a}},examples:{get:function(){return this.docs},set:function(a){return this.docs=a}},cards:{get:function(){return this.docs},set:function(a){return this.docs=a}},add:{value:function(a){if(a){if(this.debug("Adding to the "+this.id+" session",a),this._datalist&&this._datalist.docs&&"function"==typeof this._datalist.docs.add)return this._datalist.docs.add(a);this.whenReindexedFromApi||this.initializeDatalist();var b=this;this.whenReindexedFromApi.fail(function(a){console.log(a.stack)}).done(function(){b._datalist.docs.add(a)})}}},length:{get:function(){return this._datalist?this._datalist.length||0:0},set:function(a){this.warn("Cant set the lenght of a session. It's automatically determined by the number of items in its data list.",a)}},initializeDatalist:{value:function(a){if(this.debug(" initializeDatalist ",this._datalist),this._datalist&&this._datalist.whenReindexedFromApi)return a&&this.todo("the caller asked for a speciific data list to be created, ignoring it. "),void this.debug("Datalist is already ready.");if(a||(a={title:{"default":"All data in "+this.goal},dbname:this.dbname,docs:[]}),this._datalist=new f(a),this.id&&(this._datalist.api="_design/data/_list/as_data_list/by_session_or_user?key=%22"+this.id+"%22"),this.debug("Asking the datalist to check for changes in the database."),"function"!=typeof this._datalist.reindexFromApi)throw this.warn("This datalist isnt real,  throwing error... ",this,this._datalist),new Error("this DataList isnt real.");this._datalist.reindexFromApi()}},whenReindexedFromApi:{get:function(){return this._datalist&&this._datalist.whenReindexedFromApi?this._datalist.whenReindexedFromApi:void 0},set:function(){}},datalist:{get:function(){return this.debug("Getting datalist "+this.id,this._datalist),this._datalist},set:function(a){this.debug("Cant set the datalist on a session",this._datalist,a)}},saveAndInterConnectInApp:{value:function(a){"function"==typeof a&&a()}},setAsCurrentSession:{value:function(a,b){var c=this;return c.application.corpus.dbname!==this.dbname?void("function"==typeof b?b():c.bug("This is a bug, cannot load the session you asked for, it is not in this corpus.")):(c.application.get("currentSession").id!==this.id&&c.application.set("currentSession",this),c.application.get("authentication").get("userPrivate").get("mostRecentIds").sessionid=this.id,c.application.get("authentication").saveAndInterConnectInApp(),void(c.application?c.application.setUpAndAssociateViewsAndModelsWithCurrentSession(function(){"function"==typeof a?a():(c.application.currentSessionReadView.format="leftSide",c.application.currentSessionReadView.render(),c.application.toastUser("Sucessfully connected all views up to session: "+this.id,"alert-success","Connected!"))}):"function"==typeof a&&a()))}},toJSON:{value:function(a,b){this.debug("Customizing toJSON ",a,b);var c=["_docs","_docIds","_datalist","docs","docIds","datalist","whenReindexedFromApi"],d=g.prototype.toJSON.apply(this,[a,b,c]);return this.debug(d),d}}}),c.Session=i},{"./../FieldDBObject":4,"./../confidentiality_encryption/Confidential":18,"./../corpus/corpus.json":27,"./../data_list/DataList":30,"./DatumFields":36}],45:[function(a,b,c){var d=a("./LanguageDatum").LanguageDatum,e=function(a){this._fieldDBtype||(this._fieldDBtype="Stimulus"),this.debug("Constructing Stimulus ",a),d.apply(this,arguments)};e.prototype=Object.create(d.prototype,{constructor:{value:e},prime:{get:function(){return this._prime},set:function(a){this._prime=a}},target:{get:function(){return this._target},set:function(a){this._target=a}},distractors:{get:function(){return this._distractors},set:function(a){this._distractors=a}},layout:{get:function(){return this._layout},set:function(a){this._layout=a}}}),c.Stimulus=e},{"./LanguageDatum":42}],46:[function(a,b,c){var d={initialize:function(){},exportCSV:function(){},exportXML:function(){},exportLaTex:function(){}};c.Export=d},{}],47:[function(a,b,c){(function(b){!function(c){"use strict";var d={},e=a("./activity/Activities").Activities;d.Activities=e,d.Activities=e;var f=a("./activity/Activity").Activity;d.Activity=f,d.Activity=f;var g=a("./app/App").App;d.App=g,d.App=g;var h=a("./audio_video/AudioVideo").AudioVideo;d.AudioVideo=h,d.AudioVideo=h;var i=a("./audio_video/AudioVideoRecorder").AudioVideoRecorder;d.AudioVideoRecorder=i,d.AudioVideoRecorder=i;var j=a("./audio_video/AudioVideos").AudioVideos;d.AudioVideos=j,d.AudioVideos=j;var k=a("./authentication/Authentication").Authentication;d.Authentication=k,d.Authentication=k;var l=a("./CORS").CORS;d.CORS=l,d.CORS=l;var m=a("./Collection").Collection;d.Collection=m,d.Collection=m;var n=a("./comment/Comment").Comment;d.Comment=n,d.Comment=n;var o=a("./comment/Comments").Comments;d.Comments=o,d.Comments=o;var p=a("./confidentiality_encryption/Confidential").Confidential;d.Confidential=p;var q=a("./corpus/ComputationalLinguisticsCorpus").ComputationalLinguisticsCorpus;d.ComputationalLinguisticsCorpus=q,d.ComputationalLinguisticsCorpus=q;var r=a("./datum/ComputationalLinguisticsDatum").ComputationalLinguisticsDatum;d.ComputationalLinguisticsDatum=r,d.ComputationalLinguisticsDatum=r,d.Confidential=p;var s=a("./corpus/Connection").Connection;d.Connection=s,d.Connection=s;var t=a("./user/Consultant").Consultant;d.Consultant=t,d.Consultant=t;var u=a("./locales/ContextualizableObject").ContextualizableObject;d.ContextualizableObject=u,d.ContextualizableObject=u;var v=a("./locales/Contextualizer").Contextualizer;d.Contextualizer=v,d.Contextualizer=v;var w=a("./corpus/Corpora").Corpora;d.Corpora=w,d.Corpora=w;var x=a("./corpus/Corpus").Corpus;d.Corpus=x,d.Corpus=x;var y=a("./corpus/CorpusMask").CorpusMask;d.CorpusMask=y,d.CorpusMask=y;var z=a("./data_list/DataList").DataList;d.DataList=z,d.DataList=z;var A=a("./corpus/Database").Database;d.Database=A,d.Database=A;var B=a("./datum/Datum").Datum;d.Datum=B,d.Datum=B;var C=a("./datum/DatumField").DatumField;d.DatumField=C,d.DatumField=C;var D=a("./datum/DatumFields").DatumFields;d.DatumFields=D,d.DatumFields=D;var E=a("./data_list/ExperimentDataList").ExperimentDataList;d.ExperimentDataList=E,d.ExperimentDataList=E;var F=a("./export/Export");d.Export=F,d.Export=F;var G=a("./corpus/Database").FieldDBConnection;d.FieldDBConnection=G,d.FieldDBConnection=G;var H=a("./image/Image").Image;d.Image=H,d.Image=H;var I=a("./FieldDBObject").FieldDBObject;
d.FieldDBObject=I,d.FieldDBObject=I;var J=a("./corpus/Corpus").FieldDatabase;d.FieldDatabase=J,d.FieldDatabase=J;var K=a("./glosser/Glosser").Glosser;d.Glosser=K,d.Glosser=K;var L=a("./hotkey/HotKeys").HotKeys;d.HotKeys=L,d.HotKeys=L;var M=a("./image/Images").Images;d.Images=M,d.Images=M;var N=a("./import/Import").Import;d.Import=N,d.Import=N;var O=a("./datum/LanguageDatum").LanguageDatum;d.LanguageDatum=O,d.LanguageDatum=O;var P=a("./lexicon/Lexicon").Lexicon;d.Lexicon=P,d.Lexicon=P;var Q=a("./user/Participant").Participant;d.Participant=Q,d.Participant=Q;var R=a("./permission/Permission").Permission;d.Permission=R,d.Permission=R;var S=a("./permission/Permissions").Permissions;d.Permissions=S,d.Permissions=S;var T=a("./app/PsycholinguisticsApp").PsycholinguisticsApp;d.PsycholinguisticsApp=T,d.PsycholinguisticsApp=T;var U=a("./corpus/PsycholinguisticsDatabase").PsycholinguisticsDatabase;d.PsycholinguisticsDatabase=U,d.PsycholinguisticsDatabase=U;var V=a("./datum/Response").Response;d.Response=V,d.Response=V;var W=a("./Router").Router;d.Router=W,d.Router=W;var X=a("./search/Search").Search;d.Search=X,d.Search=X;var Y=a("./datum/Session").Session;d.Session=Y,d.Session=Y;var Z=a("./user/Speaker").Speaker;d.Speaker=Z,d.Speaker=Z;var $=a("./datum/Stimulus").Stimulus;d.Stimulus=$,d.Stimulus=$;var _=a("./data_list/SubExperimentDataList").SubExperimentDataList;d.SubExperimentDataList=_,d.SubExperimentDataList=_;var aa=a("./user/Team").Team;d.Team=aa,d.Team=aa;var ba=a("./glosser/Tree").Tree;d.Tree=ba,d.Tree=ba;var ca=a("./unicode/UnicodeSymbol").UnicodeSymbol;d.UnicodeSymbol=ca,d.UnicodeSymbol=ca;var da=a("./unicode/UnicodeSymbols").UnicodeSymbols;d.UnicodeSymbols=da,d.UnicodeSymbols=da;var ea=a("./user/User").User;d.User=ea,d.User=ea;var fa=a("./user/UserMask").UserMask;d.UserMask=fa,d.UserMask=fa;var ga=a("./user/UserPreference").UserPreference;d.UserPreference=ga,d.UserPreference=ga;var ha=a("./user/Users").Users;d.Users=ha,d.Users=ha;var ia=a("q");d.Q=ia,d.Q=ia,l.bug=I.prototype.bug,d.Document=d.FieldDBObject,d.Document=d.FieldDBObject,c.FieldDB=d,b.FieldDB=d,setTimeout(function(){var b="FieldDB";if(d&&d.FieldDBObject&&d.FieldDBObject.application&&d.FieldDBObject.application.brand){b=d.FieldDBObject.application.brand.replace(/\W/g,"_");try{window[b]=d,window.FieldDB=d,s.URLParser=URL}catch(c){console.warn("Couldnt attach the FieldDB library as "+b,c),s.URLParser=a("url")}}console.log("-----------------------------------------------------"),console.log("-----------------------------------------------------"),console.log("-----------------------------------------------------"),console.log("   ___                      _   _            _    "),console.log("  | _ \\_____ __ _____ _ _  | | | |______ _ _( )___"),console.log("  |  _/ _ \\ V  V / -_| '_| | |_| (_-/ -_| '_|/(_-<"),console.log("  |_| \\___/\\_/\\_/\\___|_|    \\___//__\\___|_|   /__/"),console.log("    ___     _                   _   _         "),console.log("   |_ _|_ _| |_ ___ _ _ __ _ __| |_(___ _____ "),console.log("    | || ' |  _/ -_| '_/ _` / _|  _| \\ V / -_)"),console.log("   |___|_||_\\__\\___|_| \\__,_\\__|\\__|_|\\_/\\___|"),console.log("         ___                 _     "),console.log("        / __|___ _ _  ______| |___ "),console.log("       | (__/ _ | ' \\(_-/ _ | / -_)"),console.log("        \\___\\__.|_||_|__\\__.|_\\___|"),console.log("                                                                                                                  "),console.log("-----Power User's Interactive Console loaded "+(new d.FieldDBObject).version),console.log("-----------------------------------------------------"),console.log("-----for available models/functionality, type--------"),console.log("                            "+b+"."),console.log("-----------------------------------------------------"),console.log("-----------------------------------------------------"),console.log("-----------------------------------------------------"),console.log("-----------------------------------------------------")},1e3)}("object"==typeof c&&c||this)}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./CORS":1,"./Collection":3,"./FieldDBObject":4,"./Router":5,"./activity/Activities":6,"./activity/Activity":7,"./app/App":8,"./app/PsycholinguisticsApp":9,"./audio_video/AudioVideo":11,"./audio_video/AudioVideoRecorder":12,"./audio_video/AudioVideos":13,"./authentication/Authentication":15,"./comment/Comment":16,"./comment/Comments":17,"./confidentiality_encryption/Confidential":18,"./corpus/ComputationalLinguisticsCorpus":20,"./corpus/Connection":21,"./corpus/Corpora":22,"./corpus/Corpus":23,"./corpus/CorpusMask":24,"./corpus/Database":25,"./corpus/PsycholinguisticsDatabase":26,"./data_list/DataList":30,"./data_list/ExperimentDataList":31,"./data_list/SubExperimentDataList":32,"./datum/ComputationalLinguisticsDatum":33,"./datum/Datum":34,"./datum/DatumField":35,"./datum/DatumFields":36,"./datum/LanguageDatum":42,"./datum/Response":43,"./datum/Session":44,"./datum/Stimulus":45,"./export/Export":46,"./glosser/Glosser":48,"./glosser/Tree":49,"./hotkey/HotKeys":51,"./image/Image":52,"./image/Images":53,"./import/Import":54,"./lexicon/Lexicon":56,"./locales/ContextualizableObject":58,"./locales/Contextualizer":59,"./permission/Permission":65,"./permission/Permissions":66,"./search/Search":67,"./unicode/UnicodeSymbol":68,"./unicode/UnicodeSymbols":69,"./user/Consultant":70,"./user/Participant":71,"./user/Speaker":72,"./user/Team":73,"./user/User":74,"./user/UserMask":75,"./user/UserPreference":76,"./user/Users":77,q:223,url:178}],48:[function(a,b,c){"use strict";var d=a("q"),e=a("../FieldDBObject").FieldDBObject,f=a("./../map_reduce/MapReduce").MapReduceFactory,g=a("../lexicon/Lexicon").Lexicon,h=a("../../map_reduce_data/views/morpheme_n_grams/map").morpheme_n_grams,i=f({filename:"morpheme_n_grams",mapString:h}),j=function(a){this._fieldDBtype||(this._fieldDBtype="Glosser"),a=a||{},this.debug("Constructing Glosser length: ",a),e.apply(this,arguments)};j.morphemeBoundaryRegEX=/[-=]/g,j.Lexicon=g,j.morpheme_n_grams_mapReduce=i,j.calculateAllAlternativeCombinations=function(a){var b=function(){};if(a.alternateMorphemeLines=a.alternateMorphemeLines||[],b("Beginning with a set of alternatives "+a.alternateMorphemeLines),a.alternateMorphemeSegmentationsByWord){a.columns=[];for(var c in a.alternateMorphemeSegmentationsByWord)a.alternateMorphemeSegmentationsByWord.hasOwnProperty(c)&&a.alternateMorphemeSegmentationsByWord[c].fullParses&&a.columns.push(a.alternateMorphemeSegmentationsByWord[c].fullParses)}a.columns=a.columns||[];var d=a.columns.length-1;b("Finding all alternative parses for ",a.columns);var e=function(c,f){if(a.columns[f]){j.removeRedundantCopies(a.columns[f]);var g=a.columns[f].length;b(" There are "+g+" alternative parses for word "+(f+1));for(var h=0;g>h;h++){var i=c.slice(0),k=a.columns[f][h];i.push(k),f===d?(b("  found a complete alternate",i),a.alternateMorphemeLines.push(i.join(" "))):(b("\n"+i+":  set"),e(i,f+1))}}};return e([],0),"function"==typeof a.sort&&(a.alternateMorphemeLines=a.alternateMorphemeLines.sort(a.sort)),j.removeRedundantCopies(a.alternateMorphemeLines),b(a.alternateMorphemeLines),a},j.sortAlternatesByMoreSegmentation=function(a,b){var c=0;a&&"function"==typeof a.split&&(c=a.split(j.morphemeBoundaryRegEX).length);var d=0;return b&&"function"==typeof b.split&&(d=b.split(j.morphemeBoundaryRegEX).length),d-c},j.sortAlternatesByLessSegmentation=function(a,b){var c=0;a&&"function"==typeof a.split&&(c=a.split(j.morphemeBoundaryRegEX).length);var d=0;return b&&"function"==typeof b.split&&(d=b.split(j.morphemeBoundaryRegEX).length),c-d},j.removeRedundantCopies=function(a){for(var b={},c=a.length-1;c>=0;--c)b.hasOwnProperty(a[c])?a.splice(c,1):b[a[c]]=!0;return a},j.removeWordBoundaryPlaceholders=function(a){return a.replace(/-?@-?/g," ").trim()},j.prototype=Object.create(e.prototype,{constructor:{value:j},INTERNAL_MODELS:{value:{lexicon:g}},dbname:{get:function(){return this._dbname?this._dbname:this.corpus&&this.corpus.dbname?this.corpus.dbname:void 0},set:function(a){this._dbname=a}},lexicon:{get:function(){return this.debug("getting lexicon"),this._lexicon},set:function(a){this.ensureSetViaAppropriateType("lexicon",a)}},downloadPrecedenceRules:{value:function(a){return this.warn("DEPRECATED downloadPrecedenceRules use fetch instead"),this.fetch({url:a})}},fetch:{value:function(a){if(this.fetching&&this.whenFetched)return this.whenFetched;var b=this,c=d.defer();this.whenFetched=c.promise,a=a||{};var e="";if(a&&a.url&&(e=a.url),!e||"default"===e){var f;if(this.dbname||a.dbname||(f={userFriendlyErrors:["Glosser's webservice can't be guessed, there is no current database identifier so the URL must be defined."]}),this.corpus||(f={userFriendlyErrors:["Glosser's webservice can't be guessed, there is no corpus loaded so the URL must be defined."]}),f)return c.reject(f),this.whenFetched;e=this.corpus.prefs&&this.corpus.prefs.glosserURL?this.corpus.prefs.glosserURL:this.corpus.url+"/_design/data/_view/"+i.filename+"?group=true"}return this.fetching=!0,g.CORS.makeCORSRequest({type:"GET",url:e}).then(function(a){if(!a||!a.rows||void 0===a.rows.length)return b.fetching=!1,void c.reject({details:a,userFriendlyErrors:["The result from the server "+e+" was not a standard response. Please report this."]});if(b.morphemeSegmentationKnowledgeBase=a,b.fetching=!1,b.dbname)try{localStorage.setItem(b.dbname+"morphemeSegmentationKnowledgeBase",JSON.stringify(b.morphemeSegmentationKnowledgeBase))}catch(d){if("localStorage is not defined"===d.message)console.warn("cannot save precedence self.morphemeSegmentationKnowledgeBase for offline use");else{for(var f in localStorage)f.indexOf("self.morphemeSegmentationKnowledgeBase")>-1&&localStorage.removeItem(f);try{localStorage.setItem(b.dbname+"self.morphemeSegmentationKnowledgeBase",JSON.stringify(b.morphemeSegmentationKnowledgeBase))}catch(g){b.warn("Your lexicon is huge!",g)}}}c.resolve(b.morphemeSegmentationKnowledgeBase)},function(a){b.fetching=!1,b.debug("Error getting precedence self.morphemeSegmentationKnowledgeBase:",a),c.reject(a)}).fail(function(a){b.fetching=!1,b.warn("Exception getting precedence self.morphemeSegmentationKnowledgeBase:",a.stack),b.bug("Exception getting precedence rules in the glosser."),c.reject(a)}),this.whenFetched}},morphemeSegmentationKnowledgeBase:{get:function(){if(!this._morphemeSegmentationKnowledgeBase&&!this.lastMorphemePrecedenceRelationsLookupTimestamp&&Date.now()-this.lastMorphemePrecedenceRelationsLookupTimestamp>3e4&&this.corpus&&this.corpus["this"].dbname)try{var a=localStorage.getItme(this.corpus["this"].dbname+"morphemeSegmentationKnowledgeBase");a&&(a=JSON.parse(a)),a&&(this.morphemeSegmentationKnowledgeBase=a),this.lastMorphemePrecedenceRelationsLookupTimestamp=Date.now()}catch(b){console.warn("Glosser's morpheme segmentation knowledge cannot be persisted across page loads for offline use.",b),this.lastMorphemePrecedenceRelationsLookupTimestamp=1/0}return this._morphemeSegmentationKnowledgeBase},set:function(a){if(a&&a.rows&&"function"==typeof a.rows.filter&&(a=a.rows),a&&"function"==typeof a.filter){var b={},c=0;a=a.map(function(a){a.key&&"function"==typeof a.key.indexOf&&a.key.indexOf("@-@")>-1||("number"==typeof a.value?(b[a.key]=a.value,c++):(b[a.key]||(b[a.key]=b[a.key]||[],c++),b[a.key].push(a.value)))}),b.length=c,a=b}this._morphemeSegmentationKnowledgeBase=a}},morphemefinder:{value:function(a,b){return a&&a.utterance?(a.morphemes?(a.alternateMorphemeLines=a.alternateMorphemeLines||[],a.alternateMorphemeLines.unshift(a.morphemes),j.removeRedundantCopies(a.alternateMorphemeLines)):a.morphemes=a.utterance+"",b||this.justCopyDontGuessIGT||a.justCopyDontGuessIGT?a:this.morphemeSegmentationKnowledgeBase&&this.morphemeSegmentationKnowledgeBase.length?(a.utteranceWithExplictWordBoundaries="@"+a.utterance.trim().toLocaleLowerCase().split(/\s+/).join("@")+"@",a.matchingRules=[],this.findRelevantSegmentationContexts(a),this.debug(" Found matchingRules "+a.utterance+" which conservatively yields exact segmentation matches "+a.utteranceWithExplictWordBoundaries,a.matchingRules),this.conservative!==!1?(this.debug(" Not looking harder for segmentation. Currently "+a.utterance+" directly segments as "+a.utteranceWithExplictWordBoundaries),a.morphemes=a.utteranceWithExplictWordBoundaries.replace(/-?@-?/g," ").trim(),a):(console.warn(" Continuing to look harder for segmentation. Currently "+a.utterance+" directly segments as "+a.utteranceWithExplictWordBoundaries),this.findaAllPossibleMorphemeLines(a),a)):a):a}},findRelevantSegmentationContexts:{value:function(a){if(!a.utteranceWithExplictWordBoundaries)return a;this.debug("Looking for matching rules "+a.utteranceWithExplictWordBoundaries),a.matchingRules||(a.matchingRules=[]);var b=a.utteranceWithExplictWordBoundaries+"";for(var c in this.morphemeSegmentationKnowledgeBase)this.morphemeSegmentationKnowledgeBase.hasOwnProperty(c)&&"length"!==c&&(b.indexOf(c.replace(j.morphemeBoundaryRegEX,""))>=0?(this.debug("   matching rule "+b+" <-"+c),c.split(j.morphemeBoundaryRegEX).length>2&&(a.utteranceWithExplictWordBoundaries=a.utteranceWithExplictWordBoundaries.replace(c.replace(j.morphemeBoundaryRegEX,""),c)),this.debug("      now "+a.utteranceWithExplictWordBoundaries),a.matchingRules.push({segmentation:c,contexts:this.morphemeSegmentationKnowledgeBase[c],morphemes:c.split(j.morphemeBoundaryRegEX)})):this.debug("   not matching rule "+b+" |- "+c));return a}},findaAllPossibleMorphemeLines:{value:function(a){if(a.alternateMorphemeLines=a.alternateMorphemeLines||[],a.usedRules=a.usedRules||[],!a.utteranceWithExplictWordBoundaries)return a;a.utterance=a.utterance||j.removeWordBoundaryPlaceholders(a.utteranceWithExplictWordBoundaries),a.alternateMorphemeLines.push(a.utterance),this.debug("alternateMorphemeLines "+a.alternateMorphemeLines),a.matchingRules&&a.matchingRules.length||(this.findRelevantSegmentationContexts(a),a.alternateMorphemeLines.push(j.removeWordBoundaryPlaceholders(a.utteranceWithExplictWordBoundaries))),a.alternateMorphemeSegmentationsByWord||(a.alternateMorphemeSegmentationsByWord={},a.utteranceWithExplictWordBoundaries.split(/-?@-?/).map(function(b){b&&(a.alternateMorphemeSegmentationsByWord[b.replace(j.morphemeBoundaryRegEX,"")]={fullParses:[b],prefixTemplates:[],suffixTemplates:[]})}));var b,c;for(var d in a.alternateMorphemeSegmentationsByWord){this.debug("\nFinding prefixtemplate "+d);for(var e=["@"],f=0;10>f&&void 0!==e[f];f++)for(c=0;c<a.matchingRules.length;c++)if(b=a.matchingRules[c],!(e.length>2&&"@"===e[e.length-1])&&e[f]===b.morphemes[0]&&("@"===b.morphemes[1]||d.indexOf(b.morphemes[1])>-1)){if(a.usedRules.push(b),e[f+1]){this.debug("Ambiguity point for prefixes "+d+" "+e[f+1],a.alternateMorphemeSegmentationsByWord[d]),a.alternateMorphemeSegmentationsByWord[d].prefixTemplates.push(e.pop());break}e[f+1]=b.morphemes[1],this.debug("   prefixtemplate "+e.join("-"))}e.length>2&&"@"===e[0]&&"@"===e[e.length-1]?(this.debug("Prefix matches entire word. "+e.join("-")),e.pop(),e.shift(),a.alternateMorphemeSegmentationsByWord[d].fullParses.push(e.join("-")),e=a.alternateMorphemeSegmentationsByWord[d].prefixTemplates.pop()||["@"],this.debug("Considering another parse "+e.join("-"))):(e=a.alternateMorphemeSegmentationsByWord[d].prefixTemplates.pop()||["@"],this.debug("Considering another parse "+e.join("-")));var g=[];if("@"!==e[e.length-1]||1===e.length){g.push("@"),this.debug("   suffixtemplate "+g.join("-"));for(var h=0;10>h&&void 0!==g[h];h++)for(var i=0;i<a.matchingRules.length;i++){var k=a.matchingRules[i];if(g[h]===k.morphemes[1]&&("@"===k.morphemes[0]||d.indexOf(k.morphemes[0])>-1)){if(a.usedRules.push(k),g[h+1]){this.debug("Ambiguity point for suffixes "+d+" "+g[h+1],a.alternateMorphemeSegmentationsByWord[d]),a.alternateMorphemeSegmentationsByWord[d].suffixTemplates.push(g.pop());break}g[h+1]=k.morphemes[0],this.debug("   suffixtemplate "+g.join("-"))}}}else this.debug("what is this condition");var l=[];l=e.concat(g.reverse());for(var m in l)l[m]="("+l[m]+")";var n=new RegExp(l.join("(.*)"),"");this.debug("Considering regex ",n);var o=d.replace(n,"$1-$2-$3-$4-$5-$6-$7-$8-$9").replace(/\$[0-9]/g,"").replace(/@/g,"").replace(/--+/g,"-").replace(/^-/,"").replace(/-$/,"");this.debug("Potential parse of "+d.replace(/@/g,"")+" is "+o),a.alternateMorphemeSegmentationsByWord[d].fullParses.push(o)}return a.sort=j.sortAlternatesByMoreSegmentation,j.calculateAllAlternativeCombinations(a),a.morphemes=a.alternateMorphemeLines[0],a}},contextSensitiveGlossFinder:{value:function(a,b){var c=a.morphemes;if(!c)return"";if(b||!this.lexicon){var d=c.trim().replace(/[^ =-]+/g,"?");a.gloss=d}else a=this.lexicon.guessContextSensitiveGlosses(a);return a}},guessUtteranceFromMorphemes:{value:function(a){return!a.utterance&&a.morphemes&&(a.utterance=a.morphemes.replace(/[-.]/g,"")),a}},guessMorphemesFromUtterance:{value:function(a,b){return a.morphemes?a:(this.morphemefinder(a,b),a.gloss||(a=this.contextSensitiveGlossFinder(a,b)),a)}},guessGlossFromMorphemes:{value:function(a,b){return a.gloss?a:(a.morphemes||(a.morphemes=a.utterance),a=this.contextSensitiveGlossFinder(a,b))}},morphemeSegmentationKnowledgeBaseGraph:{get:function(){if(this._morphemeSegmentationKnowledgeBaseGraph)return this._morphemeSegmentationKnowledgeBaseGraph;if(this.morphemeSegmentationKnowledgeBase){var a=[],b=[];for(var c in this.morphemeSegmentationKnowledgeBase){"@"===this.morphemeSegmentationKnowledgeBase[c].key.x&&(this.morphemeSegmentationKnowledgeBase[c].key.x="#_"),"@"===this.morphemeSegmentationKnowledgeBase[c].key.y&&(this.morphemeSegmentationKnowledgeBase[c].key.y="_#");var d=b.indexOf(this.morphemeSegmentationKnowledgeBase[c].key.x);0>d&&(b.push(this.morphemeSegmentationKnowledgeBase[c].key.x),d=b.length-1);var e=b.indexOf(this.morphemeSegmentationKnowledgeBase[c].key.y);0>e&&(b.push(this.morphemeSegmentationKnowledgeBase[c].key.y),e=b.length-1),-1===this.morphemeSegmentationKnowledgeBase[c].key.y.indexOf("@")&&a.push({source:d,target:e,value:1})}var f=[];for(var g in b)f.push({name:b[g],length:b[g].length});return this.morphemeSegmentationKnowledgeBaseGraph={},this.morphemeSegmentationKnowledgeBaseGraph.links=a,this.morphemeSegmentationKnowledgeBaseGraph.nodes=f,this.morphemeSegmentationKnowledgeBaseGraph}}},saveAndInterConnectInApp:{value:function(a){"function"==typeof a&&a()}},visualizeMorphemesAsForceDirectedGraph:{value:function(){this.warn("visualizeMorphemesAsForceDirectedGraph is deprecated use visualizePrecedenceRelationsAsForceDirectedGraph instead")}},visualizePrecedenceRelationsAsForceDirectedGraph:{value:function(a){return a=a||{},this.lexicon&&this.lexicon.length?(this.lexicon.connectedGraph||this.lexicon.entryRelations||!this.morphemeSegmentationKnowledgeBase||(this.lexicon.entryRelations=this.morphemeSegmentationKnowledgeBase),this.lexicon.visualizeAsForceDirectedGraph(a),this):(this.warn("Cannot visualize an empty lexicon."),this)}},render:{value:function(a){return this.visualizePrecedenceRelationsAsForceDirectedGraph(a)}},isWithinConfidenceRange:{value:function(a,b){return b?a.confidence<=b.max&&a.confidence>=b.min:!0}}}),c.Glosser=j},{"../../map_reduce_data/views/morpheme_n_grams/map":79,"../FieldDBObject":4,"../lexicon/Lexicon":56,"./../map_reduce/MapReduce":64,q:223}],49:[function(a,b,c){var d=function(a){if(a.length<2)return a.join(" ");var b=a.pop(),c=a.pop();return a.push("["+c+" "+b+"]"),d(a)},e=function(a){if(a.length<2)return a.join(" ");var b=a.shift(),c=a.shift();return a.unshift("["+b+" "+c+"]"),e(a)},f=function(a){if(window.count++,a.length<2)return a.join(" ");var b,c;return window.count%2===1?(b=a.shift(),c=a.shift(),a.unshift("["+b+" "+c+"]")):(b=a.pop(),c=a.pop(),a.push("["+c+" "+b+"]")),f(a)},g=function(a){var b={};return b.left=e(a.split(" ")).replace(/\[/g," [ ").replace(/\]/g," ] "),b.right=d(a.split(" ")).replace(/\[/g," [ ").replace(/\]/g," ] "),b.mixed=f(a.split(" ")).replace(/\[/g," [ ").replace(/\]/g," ] "),b},h={mixedBranching:f,rightBranching:d,leftBranching:e,generate:g};c.Tree=h},{}],50:[function(a,b,c){var d=a("./../FieldDBObject").FieldDBObject,e=function(a){this._fieldDBtype||(this._fieldDBtype="HotKey"),this.debug("Constructing HotKey",a),d.apply(this,arguments)};e.prototype=Object.create(d.prototype,{constructor:{value:e},defaults:{value:{firstKey:"",secondKey:"",functiontocall:function(){},description:""}},keySequence:{get:function(){var a=this.firstKey+"+"+this.secondKey;return this.debug("Getting keySequence "+a),a}}}),c.HotKey=e},{"./../FieldDBObject":4}],51:[function(a,b,c){var d=a("./../Collection").Collection,e=a("./HotKey").HotKey,f=function(a){this._fieldDBtype||(this._fieldDBtype="HotKeys"),a&&""===a.firstkey&&""===a.secondKey&&""===a.description&&(a=null,this.debug("Upgrading pre v2 hotkeys")),this.debug("Constructing HotKeys ",a),d.apply(this,arguments)};f.prototype=Object.create(d.prototype,{constructor:{value:f},primaryKey:{value:"keySequence"},INTERNAL_MODELS:{value:{item:e}}}),c.HotKeys=f},{"./../Collection":3,"./HotKey":50}],52:[function(a,b,c){var d=a("./../audio_video/AudioVideo").AudioVideo,e=function(a){this._fieldDBtype||(this._fieldDBtype="Image"),this.debug("Constructing Image length: ",a),d.apply(this,arguments)};e.prototype=Object.create(d.prototype,{constructor:{value:e},api:{value:"images"}}),c.Image=e},{"./../audio_video/AudioVideo":11}],53:[function(a,b,c){var d=a("./../Collection").Collection,e=a("./Image").Image,f=function(a){this._fieldDBtype||(this._fieldDBtype="Images"),this.debug("Constructing Images length: ",a),d.apply(this,arguments)};f.prototype=Object.create(d.prototype,{constructor:{value:f},primaryKey:{value:"URL"},INTERNAL_MODELS:{value:{item:e}}}),c.Images=f},{"./../Collection":3,"./Image":52}],54:[function(a,b,c){var d,e=a("./../image/Image").Image,f=a("./../audio_video/AudioVideo").AudioVideo,g=a("./../audio_video/AudioVideos").AudioVideos,h=a("./../Collection").Collection,i=a("./../CORS").CORS,j=a("./../corpus/Corpus").Corpus,k=a("./../user/Participant").Participant,l=a("./../datum/Datum").Datum,m=a("./../datum/DatumField").DatumField,n=a("./../datum/DatumFields").DatumFields,o=a("./../FieldDBObject").FieldDBObject,p=a("./../datum/Session").Session,q=a("textgrid").TextGrid,r=a("q");try{window.atob||console.log("ATOB is not defined, loading from npm"),d=window.atob}catch(s){d=a("atob")}var t=function(a){var b;b=a.split(",")[0].indexOf("base64")>=0?d(a.split(",")[1]):unescape(a.split(",")[1]);for(var c=a.split(",")[0].split(":")[1].split(";")[0],e=new Uint8Array(b.length),f=0;f<b.length;f++)e[f]=b.charCodeAt(f);return new Blob([e],{type:c})},u=function(a){for(var b={},c=[],d=0,e=a.length;e>d;++d)b.hasOwnProperty(a[d])||a[d]&&(c.push(a[d]),b[a[d]]=1);return c},v=function(a){this._fieldDBtype||(this._fieldDBtype="Import"),this.debug(" new import ",a),o.apply(this,arguments),a=a||{};var b=a.session||{};b.datalist=a.datalist||{title:{"default":"Imported Data"},docs:{id:"tempdatalist",collection:[],primaryKey:"tempId"}},this.session=b,this.session.goal="Goal from file import"};v.prototype=Object.create(o.prototype,{constructor:{value:v},fillWithDefaults:{value:function(){this.datumFields||(this.datumFields=this.corpus.datumFields.clone())}},defaults:{get:function(){return{status:"",showImportFirstStep:!0,showImportSecondStep:!1,showImportThirdStep:!1,progress:{total:0,completed:0},datalist:{},session:{},dbname:"",files:[],asFieldMatrix:[],asCSV:[]}},set:function(){}},INTERNAL_MODELS:{value:{progress:{},datumFields:n,session:p,corpus:j}},showImportSecondStep:{get:function(){return this.dontShowSecondStep?!1:this.asCSV&&this.asCSV.length>0},set:function(){}},showImportThirdStep:{get:function(){return this.datalist&&this.datalist.docs&&this.datalist.docs.length>0},set:function(){}},addFileUris:{value:function(a){var b=r.defer(),c=this,d=a.fileList.map(function(b){return c.debug("adding file",b),c.addFileUri({uri:b,readOptions:a.readOptions,preprocessOptions:a.preprocessOptions,importOptions:a.importOptions,dbname:a.dbname})});return r.allSettled(d).then(function(d){c.debug("done with promises "+d.length),b.resolve(a)}),b.promise}},addFileUrl:{value:function(){this.warn("addFileUrl is deprecated, use addFileUri")}},addFileUri:{value:function(a){var b=r.defer(),c=this;if(!a)throw new Error("Options must be specified {}");if(!a.uri)throw new Error("Uri must be specified in the options in order to import it"+JSON.stringify(a));return r.nextTick(function(){c.debug("addFileUri",a),c.readUri(a).then(function(){return c.preprocess.apply(c,arguments)}).then(function(d){c.debug("Preprocess is finished"),c.debug("result.datum.length: "+d.datum.length),c.datalist.add(d.datum),d.fileName=d.fileName||a.uri.replace(new RegExp(".*"+a.dbname+"/"),""),c.files.add(d),b.resolve(d)}).fail(function(a){console.error(a.stack),b.reject(a)})}),b.promise}},readUri:{value:function(a){this.debug("readUri",a);var b=r.defer(),c=this;return r.nextTick(function(){if(!a)throw new Error("Options must be specified {}");c.debug("readUri");var d=function(a){if(c.debug("pipeline",a.uri),a.readOptions)try{return a.readOptions.readFileFunction(a,function(d,e){d?(c.debug("read file",d),b.reject(d)):(c.debug("rawText",e.length),c.debug("done rawText"),a.rawText=e,b.resolve(a))})}catch(d){b.reject(d)}c.warn("TODO reading url in browser"),i.makeCORSRequest({type:"GET",dataType:"json",uri:a.uri}).then(function(d){c.debug(d),a.rawText=d,b.resolve(a)},function(a){c.debug(a),b.reject(a)}).fail(function(a){console.error(a.stack,c),b.reject(a)})};c.debug("find"+a.uri),c.corpus.find(a.id||a.uri).then(function(b){return b&&b._id?(c.debug("similarData",b._id,b._rev),a.datum=c.corpus.newDatum(b),a.datum.session=a.datum.session||c.session,d(a)):(c.debug("similarData",b.length),Array.isArray(b)&&1===b.length?(a.datum=c.corpus.newDatum(b[0]),a.datum.session=a.datum.session||c.session,d(a)):(c.debug("readUri newDatumAsync"),void c.corpus.newDatumAsync().then(function(b){a.datum=b,a.datum.session=a.datum.session||c.session,d(a)})))}).fail(function(a){c.debug("corpus.find fail",a),b.reject(a)})}),b.promise}},convertTableIntoDataList:{value:function(a){return this.warn("convertTableIntoDataList is deprecated, use convertMatrixIntoDataList"),this.convertMatrixIntoDataList(a)}},convertMatrixIntoDataList:{value:function(){var a=this,b=r.defer();if(!("participants"!==this.importType||this.corpus&&this.corpus.confidential&&this.corpus.confidential.secretkey))return r.nextTick(function(){b.reject({userFriendlyErrors:["Cannot create encrypted participants at this time","Corpus's encrypter isn't available right now, maybe the app is still loading?"]})}),b.promise;if(!this.asFieldMatrix||0===this.asFieldMatrix.length)return r.nextTick(function(){b.reject({userFriendlyErrors:["There was nothing to import. Are you sure you ran step 1?"]})}),b.promise;r.nextTick(function(){b.resolve(a.datalist)});try{a.progress||(a.progress={total:0,completed:0}),a.progress.total=a.asFieldMatrix.length;var c=" typing/copy paste into text area",d="This is the data list which results from the import of the text typed/pasted in the import text area.";try{c=a.files.map(function(a){return a.name}).join(", "),d="This is the data list which results from the import of these file(s). "+a.fileDetails}catch(e){a.todo("turn the copy pasted text into a File to upload")}if(a.session.consultants=[],a.metadataLines&&(a.session.goal=a.metadataLines.join("\n")+"\n"+a.session.goal),a.render("session"),a.datalist.description=d,!a.extractedHeaderObjects){if(a.warn("There was no extracted header."),!(a.asFieldMatrix&&a.asFieldMatrix.length>0&&a.asFieldMatrix[0].concat))return b.promise;a.warn("Using the first row as the extracted header."),a.extractedHeaderObjects=a.asFieldMatrix[0].concat([]),a.extractedHeaderObjects=a.extractedHeaderObjects.map(function(a){return""!==a&&void 0!==a&&null!==a?(a&&!a.id&&void 0!==a.value&&null!==a.value&&(a.id=a.value,a.value=""),a):void 0})}var g,h,i;try{var j=function(a){return a&&a.id&&"columnplaceholder"!==a.id?"":a.id};for(i=0;i<a.extractedHeaderObjects.length;i++){if(g=a.extractedHeaderObjects[i].id||a.extractedHeaderObjects[i],h=a.normalizeImportFieldWithExistingCorpusFields(g),h&&h.id){var m=a.extractedHeaderObjects.map(j);m.indexOf(h.id)>=0&&a.bug("You seem to have some column labels '"+h.id+"' that are duplicated (the same label on two columns). This will result in a strange import where only the second of the two will be used in the import. Is this really what you want?.")}a.debug(i+" correspondingDatumField",h),a.debug("setting extractedHeaderObjects was once problematic",a.extractedHeaderObjects[i],h),a.extractedHeaderObjects[i]=h}}catch(e){throw this.warn(e),this.warn(e.stack),new Error(" problem in extractedHeaderObjects ")}a.debugMode,a.debug("JSON.stringify(self.extractedHeaderObjects, null, 2)"),a.extractedHeaderObjects.map(function(b){a.debug("headerField",b)});var n,p,q;a.asFieldMatrix.map(function(b){if(a.progress.completed=a.progress.completed+1,!b||b.length<1)return void a.debug("Skipping empty row");a.debug("Working on row ",b);var c;a.debug("Cloning fields ",a.extractedHeaderObjects.length);var d=a.extractedHeaderObjects.map(function(a){return a.toJSON()});for(a.debug("Cloned fields ",d.length),a.debug("fields[0] equals extractedHeaderObjects[0]",d[0]===a.extractedHeaderObjects[0]),"participants"===a.importType?(c=new k({fields:d}),a.debug("Creating a participant.",b)):"audioVideo"===a.importType?(c=new f,c.description=a.rawText,a.debug("Creating a audioVideo.",c.description)):(c=new l({fields:d}),a.debug("Creating a datum.",b)),c.confidential=a.corpus.confidential,n="",p=0;p<b.length;p++)if(q=b[p],a.debug("working on cell ",q),!q||p>a.extractedHeaderObjects.length||"columnplaceholder"===a.extractedHeaderObjects[p].id)a.debug("Skipping column "+p+" :",q);else{if("audioVideo"===a.importType)a.debug("this is an audioVideo but we arent doing anything with the self.importFields");else{for(var e in q)q.hasOwnProperty(e)&&(c.fields._collection[p][e]=q[e]);b[p]=c.fields._collection[p]}n+=q.value}n.replace(/[ \t\n]/g,"").length>=2?(a.debugMode,c&&(c.tempId=o.uuidGenerator(),c.dbname=a.corpus.dbname,a.datalist.add(c))):a.debug("Didn't add row with only blank cells:"+n+": ")}),a.debug("Finished building the data list"),a.showImportThirdStep=!0,a.render(),a.progress.total=a.progress.completed=a.datalist.length}catch(e){a.warn("There was a problem while converting the matrix into a data list.",e),a.warn(e.stack),b.reject("There was a problem while converting the matrix into a data list.")}return b.promise}},preprocess:{value:function(a){var b=r.defer(),c=this;return this.verbose("In the preprocess",this),r.nextTick(function(){if(c.debug("Preprocessing  "),a.datum.fields.orthography.value=a.rawText,a.datum.fields.utterance&&(a.datum.fields.utterance.value=a.rawText),a.datum.id=a.datum.tempId=a.id||a.uri.replace(new RegExp(".*"+a.dbname+"/"),""),a.datum.id.lastIndexOf("/")>-1&&(a.datum.id=a.datum.tempId=a.datum.id.substring(a.datum.id.lastIndexOf("/")+1,a.datum.id.lastIndexOf("."))),"function"==typeof a.preprocessOptions.preprocessFunction&&a.preprocessOptions.preprocessFunction(a.datum),c.debug("running write for preprocessed"),!a.preprocessOptions||!a.preprocessOptions.writePreprocessedFileFunction)return b.resolve(a);var d=".fielddb";c.application&&c.application.brandLowerCase&&(d="."+c.application.brandLowerCase),a.preprocessedUri=a.uri+d;var e=JSON.stringify(a.datum.toJSON(!1,"removeempty"),null,2);try{a.preprocessOptions.writePreprocessedFileFunction({preprocessedUri:a.preprocessedUri,body:e},function(d,e){return d?(c.debug("Couldnt write "+a.preprocessedUri,d),b.reject(d)):(c.debug("Wrote "+a.preprocessedUri,e),c.debug("Preprocesing success"),void b.resolve(a))})}catch(f){b.reject(f)}}),b.promise}},importFields:{get:function(){return this._importFields&&0!==this._importFields.length||("participants"===this.importType?this.corpus&&this.corpus.participantFields?this._importFields=new n(this.corpus.participantFields.clone()):this._importFields=new n(this.corpus.defaults_psycholinguistics.participantFields):this.corpus&&this.corpus.datumFields&&(this._importFields=new n(this.corpus.datumFields.clone()))),
this._importFields||(this._importFields=new n),this._importFields},set:function(a){this._importFields=a}},normalizeImportFieldWithExistingCorpusFields:{value:function(a){var b;return this.corpus&&this.corpus.normalizeFieldWithExistingCorpusFields&&(b=this.corpus.normalizeFieldWithExistingCorpusFields(a,this.importFields)),this.debug("correspondingDatumField ",b),b?b:new m({id:"columnplaceholder",value:""})}},"import":{value:function(a){var b=r.defer(),c=this;this.todo("TODO test the import");var d=[],e=[];return this.datalist.docs&&this.datalist.docs._collection?e=this.datalist.docs._collection:this.warn("There were no docs prepared for import, this is odd."),c.progress=c.progress||{},e.map(function(a){if("audioVideo"===c.importType)c.debug("not doing any save for an audio video import");else{c.bug("test the save on the new docs from import"),"participant"===c.importType&&(a.id=a.anonymousCode||Date.now()),a.session=c.session,c.debug(" saving",a.id),c.progress.total++;var e=a.save();e.then(function(a){c.debug(a),c.progress.completed++},function(a){c.debug(a),c.progress.completed++}).fail(function(a){console.error(a.stack,c),b.reject(a)}),d.push(e)}}),r.allSettled(d).then(function(d){return c.debug(d),b.resolve(d),c.progress.completed++,c.render(),a},function(d){return c.debug(d),b.resolve(d),c.progress.completed++,c.render(),a}).fail(function(a){console.error(a.stack,c),b.reject(a)}),b.promise}},fileDetails:{get:function(){return this._fileDetails||o.DEFAULT_STRING},set:function(a){this._fileDetails=a}},datalist:{get:function(){return this.session&&this.session.datalist?this.session.datalist:void 0},set:function(a){return this._session&&a===this._session.datalist?this:a&&a.docs&&a.docs.primaryKey&&"tempId"===a.docs.primaryKey?(this.debug("  setting the _session.datalist",a.docs.primaryKey),delete this._session._datalist,this._session.initializeDatalist(a),this):(this.warn("  not setting the datalist, its missing some stuff ",a),this)}},session:{get:function(){return this._session?(this.debug("getting the _session "+this._session.fields.length),this._session):void this.debug("There's no session!")},set:function(a){if(a!==this._session){if(!a||!a.datalist||!a.datalist.docs)return void this.warn("  not setting the session on import, its missing some stuff ",a);a.datalist.docs.primaryKey="tempId";var b=a.datalist;this.debug("  setting the _session",a),a instanceof p||(a=new p(a)),this.debug("  setting the _session's datalist",b),this._session=a,this.datalist=b}}},files:{get:function(){return this.debug("Getting Datum collection"),this._files||(this._files=new h({id:"importfiles",inverted:!1,primaryKey:"fileName"})),this.debug("Returning a collection"),this._files},set:function(a){a!==this._files&&(this._files=a)}},pause:{value:function(){return this}},resume:{value:function(){return this}},id:{get:function(){return this.datalist?this.datalist.id:void 0},set:function(a){this.datalist&&(this.datalist.id=a)}},url:{value:"/datalists"},corpus:{get:function(){return this._corpus?this._corpus:void 0},set:function(a){a!==this._corpus&&(this._corpus=a)}},asFieldMatrix:{get:function(){return this._asFieldMatrix},set:function(a){this._asFieldMatrix=a}},asCSV:{get:function(){return this.asFieldMatrix},set:function(a){var b,c;a=a.map(function(a){return a.map(function(a){return(void 0===a||null===a)&&(a={value:""}),"object"!=typeof a&&(a={value:a}),a&&a.value&&"function"==typeof a.value.trim&&(a.value=a.value.trim()),""!==a.value&&(b=Number(a.value),isNaN(b)?(c=new Date(a.value),isNaN(c.getDate()&&c.getYear()>70)||(a.type="date",a.json={date:c,timestamp:{end:c.getTime()}})):(a.value=b,a.type="number")),a})}),this.asFieldMatrix=a}},importCSV:{value:function(a,b){if(a){var c=a.split("\n");if(c.length<3){var d=a.split("\r");d.length>c.length&&(c=d,this.status=this.status+" Detected a \r line ending.")}var e=c[0],f=!1;c[0].split("","").length>2&&c[5].split("","").length>2&&(f=!0,this.status=this.status+" Detected text was already surrounded in quotes.");for(var g in c)f?c[g]=c[g].trim().replace(/^"/,"").replace(/"$/,"").split("",""):c[g]=this.parseLineCSV(c[g]);var h=[];c.length>1?(e=e,h=f?e.trim().replace(/^"/,"").replace(/"$/,"").split("",""):this.parseLineCSV(e)):1===c.length&&(h=c[0].map(function(){return""})),this.extractedHeaderObjects=h,this.asCSV=c,"function"==typeof b&&b()}}},parseLineCSV:{value:function(a){var b=[],c=",";this.debug(a,typeof a);var d=a.split(c);d.length<2&&(c=";"),a=a.replace(new RegExp(c,"g")," "+c),a=a.split(new RegExp(c,"g"));var e,f;for(e=0;e<a.length;e++)a[e]=a[e].replace(/\s*$/g,"");a[a.length-1]=a[a.length-1].replace(/^\s*|\s*$/g,"");var g=-1;for(e=0;e<a.length;e++){if(a[e].match(/"$/)&&g>=0){for(f=g+1;e>=f;f++)a[g]=a[g]+c+a[f],a[f]="-DELETED-";g=-1}g=a[e].match(/^"/)?e:g}for(f=0,e=0;e<a.length;e++)"-DELETED-"!==a[e]&&(b[f]=a[e],b[f]=b[f].replace(/^\s*|\s*$/g,""),b[f]=b[f].replace(/^"|"$/g,""),b[f]=b[f].replace(/""/g,'"'),f++);return b}},importXML:{value:function(){throw new Error("The app thinks this might be a XML file, but we haven't implemented this kind of import yet. You can vote for it in our bug tracker.")}},importElanXML:{value:function(a,b){if(a){return void this.todo("import xml parsers to turn xml import back on")}}},importTabbed:{value:function(a,b){if(a){var c,d=a.split("\n");d.length<3&&(d=a.split("\r"),this.status=this.status+" Detected a \n line ending.");for(c in d)d[c]=d[c].split("	");this.asCSV=d,"function"==typeof b&&b()}}},metadataLines:[],importToolbox:{value:function(a,b){if(a){var c=a.split("\n"),d=!1;c.length<3&&(c=a.split("\r"),d=!0,this.status=this.status+" Detected a \r line ending.");for(var e=[],f=-1,g=[],h="",i="";!i&&c.length>0;){var j=c[0].match(/^\\[a-zA-Z]+\b/);j&&j.length>0?i=j[0]:this.metadataLines.push(c.shift())}for(var k in c)if(0===c[k].indexOf(i))f+=1,e[f]={},e[f][i.replace(/\\/g,"")]=c[k].replace(i,"").trim(),g.push(i.replace(/\\/g,""));else if(f>=0)if(c[k].match(/^\\/)){var l=c[k].split(/ +/);h=l[0].replace("\\",""),e[f][h]=c[k].replace(l[0],""),g.push(h)}else""!==c[1].trim()&&(e[f][h]+=c[k]);g=u(g);var m=[];for(var n in e){var o=[];for(var p in g){var q=e[n][g[p]];q?o.push(q):o.push("")}m.push(o)}m===[]&&m.push(""),this.extractedHeaderObjects=g,this.asCSV=m,"function"==typeof b&&b()}}},importMorphChallengeSegmentation:{value:function(a,b,c){var d=a.trim().split("\n");d.length<3&&(d=a.split("\r"),b.status=b.status+" Detected a \n line ending.");var e,f,g,h,i,j,k,l,m,n=b.files[0].name,o=["orthography","utterance","morphemes","gloss","alternatesAnalyses","alternates","original","source"],p=function(a){return j=a.trim().split(" "),j.map(function(a){return{morphemes:a.split(":")[0],gloss:a.split(":")[1]}})},q=function(a){return a.morphemes.replace("+","")},r=function(a){return a.gloss.replace("+","")};for(m in d)if(e=f=d[m]+"",l=n+":line:"+m,g=e.split(/\t/),h=g[0],g&&g[1]){i=g[1].split(","),i=i.map(p),j=i[0].map(q).join("-"),k=i[0].map(r).join("-"),i.shift();for(var s=[],t=0;i>t;t++)s.push(i[t].map(q).join("-"));d[m]=[h,h,j,k,g[1],s.join(","),f+"",l]}b.extractedHeaderObjects=o,b.asCSV=d,"function"==typeof c&&c()}},uploadFiles:{value:function(a){var b=r.defer(),c=this;return c.error="",c.status="",r.nextTick(function(){var d=(new f).BASE_SPEECH_URL+"/upload/extract/utterances",e=new FormData;if(c.todo("use the files passed instead of jquery ",a),0===a.indexOf("data")){var g=t(a);a=[g]}c.rawText="",$.each(a,function(a,b){e.append(a,b),b.name&&(c.rawText=c.rawText+" "+b.name)}),c.rawText&&c.rawText.trim()&&(c.rawText=c.rawText.trim(),c.render()),!c.dbname&&c.parent&&c.parent.dbname&&(c.dbname=c.parent.dbname),e.append("token",c.uploadtoken||"uploadingfromspreadsheet"),e.append("pouchname",c.dbname),e.append("dbname",c.dbname),e.append("username",c.application.authentication.user.username),e.append("returnTextGrid",c.returnTextGrid||!0),c.audioVideo=null,$.ajax({url:d,type:"post",cache:!1,contentType:!1,processData:!1,data:e,success:function(a){if(a&&200===a.status){c.uploadDetails=a,c.files=a.files,c.status="File(s) uploaded and utterances were extracted.";var d=[];c.rawText="";for(var e=0;e<a.files.length;e++)if(a.files[e].textGridStatus>=400){c.debug(a.files[e]);var g=a.files[e].textGridInfo;a.files[e].textGridStatus>=500&&(g=" Please report this error."),d.push("Generating the textgrid for "+a.files[e].fileBaseName+" seems to have failed. "+g),a.files[e].filename=a.files[e].name,a.files[e].type&&(a.files[e].type.indexOf("audio")>-1||a.files[e].type.indexOf("video")>-1)&&(a.files[e].filename=a.files[e].fileBaseName+".mp3"),a.files[e].URL=(new f).BASE_SPEECH_URL+"/"+c.corpus.dbname+"/"+a.files[e].filename,a.files[e].description=a.files[e].description||"File from import",c.addAudioVideoFile(a.files[e])}else c.downloadTextGrid(a.files[e]);d.length>0&&(c.status=d.join(", "),b.resolve(c.status))}else{c.debug(a);var h="Upload might have failed to complete processing on your file(s). Please report this error.";c.status=h+": "+JSON.stringify(a),b.reject(h)}},error:function(a){var d={};if(a&&a.responseJSON)d=a.responseJSON;else{var e="Error contacting the server. ";e+=a.status>=500?" Please report this error.":413===a.status?" Your file is too big for upload, please try using FFMpeg to convert it to an mp3 for upload (you can still use your original video/audio in the app when the utterance chunking is done on an mp3.) ":" Are you offline? If you are online and you still recieve this error, please report it to us: ",d={status:a.status,userFriendlyErrors:[e+a.status]}}c.debug(d),d&&d.userFriendlyErrors&&(c.status="",c.error="Upload error: "+d.userFriendlyErrors.join(" "),c.bug(c.error)),b.reject(c.error)}}),c.status="Contacting server..."}),b.promise}},downloadTextGrid:{value:function(a){var b=this,c=(new f).BASE_SPEECH_URL+"/"+this.corpus.dbname+"/"+a.fileBaseName+".TextGrid";i.makeCORSRequest({url:c,type:"GET",withCredentials:!1}).then(function(c){if(c){a.textgrid=c;var d="unknown";a.syllablesAndUtterances&&a.syllablesAndUtterances.syllableCount&&(d=a.syllablesAndUtterances.syllableCount);var e="unknown";a.syllablesAndUtterances&&a.syllablesAndUtterances.pauseCount&&(e=parseInt(a.syllablesAndUtterances.pauseCount,10));var g=1;e>0&&(g=e+2);var h=" Downloaded Praat TextGrid which contained a count of roughly "+d+" syllables and auto detected utterances for "+a.fileBaseName+" The utterances were not automatically transcribed for you, you can either save the textgrid and transcribe them using Praat, or continue to import them and transcribe them after.";a.description=h,b.status=b.status+"<br/>"+h,b.fileDetails=b.status+h,window&&window.appView&&"function"==typeof window.appView.toastUser&&window.appView.toastUser(h,"alert-info","Import:"),b.rawText=b.rawText.trim()+"\n\n\nFile name = "+a.fileBaseName+".mp3\n"+c,b.parent?b.debug("Not showing second import step, this looks like its audio import only."):b.importTextGrid(b.rawText,null),a.filename=a.fileBaseName+".mp3",a.URL=(new f).BASE_SPEECH_URL+"/"+b.corpus.dbname+"/"+a.fileBaseName+".mp3",b.addAudioVideoFile(a),b.rawText=b.rawText.trim()}else b.debug(c),a.textgrid="Error result was empty. "+c},function(c){var d={};if(c&&c.responseJSON)d=c.responseJSON;else{var e="Error contacting the server. ";e+=c.status>=500?" Please report this error.":" Are you offline? If you are online and you still recieve this error, please report it to us: ",d={status:c.status,userFriendlyErrors:[e+c.status]}}b.debug(d),d&&d.userFriendlyErrors&&(b.status=a.fileBaseName+"import error: "+d.userFriendlyErrors.join(" "),window&&window.appView&&"function"==typeof window.appView.toastUser&&window.appView.toastUser(d.userFriendlyErrors.join(" "),"alert-danger","Import:"))}).fail(function(a){console.error(a.stack,b)})}},addAudioVideoFile:{value:function(a){if(!a)return void this.warn("No details were provided to add be added to any file collection.");var b="relatedData";a.type.indexOf("image")>-1?(b="images",a=new e(a)):(a.type.indexOf("audio")>-1||a.type.indexOf("video")>-1)&&(b="audioVideo"),this[b]||(this[b]=new g),this[b].add(a),this.parent&&("function"==typeof this.parent.markAsNeedsToBeSaved&&this.parent.markAsNeedsToBeSaved(),"function"==typeof this.parent.addFile?this.parent.addFile(a):this.parent.audioVideo&&"function"==typeof this.parent.audioVideo.push?this.parent.audioVideo.push(a):this.bug("There was a problem attaching this file. Please report this."),this.render())}},importTextGrid:{value:function(a,b){if(a){var c=q.textgridToIGT(a),d="copypastedtextgrid_unknownaudio";this.files&&this.files[0]&&this.files[0].name&&(d=this.files[0].name),d=d.replace(/\.textgrid/i,""),c&&c.intervalsByXmin||"function"==typeof b&&b();var e,f,g,h,i,j=[],k=[],l=[];if(c.isIGTNestedOrAlignedOrBySpeaker.probablyAligned){for(f in c.intervalsByXmin)if(c.intervalsByXmin.hasOwnProperty(f)&&c.intervalsByXmin[f]){for(h={},g=0;g<c.intervalsByXmin[f].length;g++)i=c.intervalsByXmin[f][g],h.startTime=h.startTime?h.startTime:i.xmin,h.endTime=h.endTime?h.endTime:i.xmax,h.utterance=h.utterance?h.utterance:i.text.trim(),h.modality="spoken",h.tier=i.tierName,h.speakers=i.speaker,h.audioFileName=i.fileName||d,h.CheckedWithConsultant=i.speaker,l.push(h.speakers),h[i.tierName]=i.text,k.push(i.tierName);j.push(h)}}else for(f in c.intervalsByXmin)if(c.intervalsByXmin.hasOwnProperty(f)&&c.intervalsByXmin[f])for(g=0;g<c.intervalsByXmin[f].length;g++)h={},i=c.intervalsByXmin[f][g],h.startTime=h.startTime?h.startTime:i.xmin,h.endTime=h.endTime?h.endTime:i.xmax,h.utterance=h.utterance?h.utterance:i.text.trim(),h.modality="spoken",h.tier=i.tierName,h.speakers=i.speaker,h.audioFileName=i.fileName||d,h.CheckedWithConsultant=i.speaker,l.push(h.speakers),h[i.tierName]=i.text,k.push(i.tierName),j.push(h);k=u(k),l=u(l),l.length>0?this.consultants=l.join(","):this.consultants="Unknown",k=k.concat(["utterance","tier","speakers","CheckedWithConsultant","startTime","endTime","modality","audioFileName"]);var m=[];for(var n in j){var o=[];for(e in k){var p=j[n][k[e]];p?o.push(p):o.push("")}o.length>=8&&o.slice(0,o.length-8).join("").replace(/[0-9.]/g,"").length>0&&"silent"!==o[o.length-8]?m.push(o):this.debug("This row has only the default columns, not text or anything interesting.",o)}m===[]&&m.push(""),this.extractedHeaderObjects=k,this.asCSV=m,"function"==typeof b&&b()}}},importLatex:{value:function(){throw new Error("The app thinks this might be a LaTeX file, but we haven't implemented this kind of import yet. You can vote for it in our bug tracker.")}},importTextIGT:{value:function(a,b){if(a){var c,d=a.split(/\n\n+/),e=!1;if(d.length<3){var f=a.split("\r\r");f.length>d.length&&(this.status=this.status+" Detected a MAC line ending.",e=!0,d=f)}for(c in d)e?d[c]=d[c].replace(/  +/g," ").split("\r"):d[c]=d[c].replace(/  +/g," ").split("\n");this.asCSV=d,this.extractedHeaderObjects=d[0],"function"==typeof b&&b()}}},importRawText:{value:function(a){this.ignoreLineBreaksInRawText&&a.replace(/\n+/g," ").replace(/\r+/g," "),this.datalist.add(new l({fields:[{id:"orthography",value:a}]})),this.debug("added a datum to the collection")}},readFiles:{value:function(a){var b=r.defer(),c=this,d=[];return a=a||{},this.progress={total:0,completed:0},r.nextTick(function(){var e=[],f=c.files,g=[];c.progress.total=f.length;for(var h,i=0;h=f[i];i++){var j=[escape(h.name),h.type||"n/a","-",h.size,"bytes, last modified:",h.lastModifiedDate?h.lastModifiedDate.toLocaleDateString():"n/a"].join(" ");c.status=c.status+"; "+j,e.push(JSON.parse(JSON.stringify(h))),h.type&&(h.type.indexOf("audio")>-1||h.type.indexOf("video")>-1||h.type.indexOf("image")>-1)?g.push(h):a.readOptions?d.push(a.readOptions.readFileFunction.apply(c,[{file:h.name,start:a.start,stop:a.stop}])):d.push(c.readFileIntoRawText({file:h,start:a.start,stop:a.stop}))}g.length>0&&d.push(c.uploadFiles(c.files)),c.fileDetails=e,r.allSettled(d).then(function(a){b.resolve(a.map(function(a){return c.progress.completed+=1,a.value}))},function(a){c.error="Error processing files",b.reject(a)}).fail(function(d){console.error(d.stack,c),c.warn("There was an error when importing these options ",d,a),b.reject(d)})}),b.promise}},readFileIntoRawText:{value:function(a){var b=r.defer(),c=this;return this.debug("readFileIntoRawText",a),r.nextTick(function(){if(!a)return a={error:"Options must be defined for readFileIntoRawText"},void b.reject(a);if(!a.file)return a.error="Options: file must be defined for readFileIntoRawText",void b.reject(a);a.start=a.start?parseInt(a.start,10):0,a.stop=a.stop?parseInt(a.stop,10):a.file.size-1;var d=new FileReader;d.onloadend=function(d){d.target.readyState===FileReader.DONE&&(a.rawText=d.target.result,c.rawText=c.rawText+a.rawText,b.resolve(a))};var e="";a.file.slice?e=a.file.slice(a.start,a.stop+1):a.file.mozSlice?e=a.file.mozSlice(a.start,a.stop+1):a.file.webkitSlice&&(e=a.file.webkitSlice(a.start,a.stop+1)),d.readAsText(e)}),b.promise}},guessFormatAndPreviewImport:{value:function(a){a||(a=0);var b={handout:{confidence:0,id:"handout",importFunction:this.importTextIGT},csv:{confidence:0,id:"csv",importFunction:this.importCSV},tabbed:{confidence:0,id:"tabbed",importFunction:this.importTabbed},xml:{confidence:0,id:"xml",importFunction:this.importXML},toolbox:{confidence:0,id:"toolbox",importFunction:this.importToolbox},elanXML:{confidence:0,id:"elanXML",importFunction:this.importElanXML},praatTextgrid:{confidence:0,id:"praatTextgrid",importFunction:this.importTextGrid},latex:{confidence:0,id:"latex",importFunction:this.importLatex}};if(this.files&&this.files[a]){var c=this.files[a].name.split(".").pop().toLowerCase();"csv"===c?b.csv.confidence++:"txt"===c?this.rawText.split("	").length>20?b.tabbed.confidence++:b.handout.confidence++:"eaf"===c?b.elanXML.confidence++:"xml"===c?b.xml.confidence++:"sf"===c?b.toolbox.confidence++:"tex"===c?b.latex.confidence++:"textgrid"===c?b.praatTextgrid.confidence++:"mov"===c?b.praatTextgrid.confidence++:"wav"===c?b.praatTextgrid.confidence++:"mp3"===c&&b.praatTextgrid.confidence++}else if(this.rawText&&this.rawText.length){var d=this.rawText.length;this.rawText.indexOf("\\gll")>-1||this.rawText.indexOf("\\begin{")>-1||this.rawText.indexOf("\\ex")>-1?b.latex.confidence=100:this.rawText.indexOf("mpi.nl/tools/elan/EAF")>-1?b.elanXML.confidence=100:this.rawText.indexOf("<?xml")>-1?b.xml.confidence=100:(b.csv.confidence=this.rawText.split(",").length/d,b.tabbed.confidence=this.rawText.split("	").length/d,b.handout.confidence=this.rawText.split(/\n\n+/).length/d,b.toolbox.confidence=this.rawText.split(/\n\\/).length/d,b.praatTextgrid.confidence=this.rawText.split("intervals").length/d)}this.importTypeConfidenceMeasures=b;var e;for(var f in b)b.hasOwnProperty(f)&&(!e||e.confidence<b[f].confidence)&&(e=b[f]);this.importTypeConfidenceMeasures.mostLikely=e,this.status="",e.importFunction.apply(this,[this.rawText,null])}},readBlob:{value:function(a,b,c,d){this.warn("Read blob is deprecated",a,b,c,d)}}}),c.Import=v},{"./../CORS":1,"./../Collection":3,"./../FieldDBObject":4,"./../audio_video/AudioVideo":11,"./../audio_video/AudioVideos":13,"./../corpus/Corpus":23,"./../datum/Datum":34,"./../datum/DatumField":35,"./../datum/DatumFields":36,"./../datum/Session":44,"./../image/Image":52,"./../user/Participant":71,atob:96,q:223,textgrid:256}],55:[function(a,b,c){var d=a("./../Collection").Collection,e=a("./../FieldDBObject").FieldDBObject,f=function(a){if(this.fieldDBtype||(this.fieldDBtype="Context"),"string"==typeof a)this.morphemes=a;else for(var b in a)a.hasOwnProperty(b)&&(this[b]=a[b]);Object.apply(this,arguments)};f.prototype=Object.create(Object.prototype,{constructor:{value:f},id:{get:function(){var a=this._id||this.URL||this.context||this.morphemes||this.utterance||this.orthography;return a},set:function(a){a!==this.id&&(console.warn("setting id  on context "+a+", it doesnt match the expected id."+this.id),this._id=a)}},equals:{value:function(a){return a&&this.id&&this.id===a.id?!0:void 0}},merge:{value:function(a,b,c){var d,f,g;if(0===arguments.length)return this.warn("Invalid call to merge, there was no object provided to merge"),null;if(b||c)if("self"===a)d=this,f=d;else{if(!a||!b)return this.warn("Invalid call to merge, invalid arguments were provided to merge",arguments),null;d=a,f=this}else f=d=this,b=e.convertDocIntoItsType(a);for(g in d)d.hasOwnProperty(g)&&"function"!=typeof d[g]&&"number"==typeof d[g]&&(f[g]=d[g]+b[g]);return f}},isEmpty:{value:function(){return e.prototype.isEmpty.apply(this,arguments)}},debug:{value:function(){e.prototype.debug.apply(this,arguments)}},toJSON:{value:function(a,b,c){c=c||[],c=c.concat(["fieldDBtype","dateCreated"]);var d=e.prototype.toJSON.apply(this,[!1,!0,c]);return d.URL=d.URL||"",d._id=d._id||d.id,(d._id===d.URL||d._id===d.context||d._id===d.morphemes||d._id===d.utterance||d._id===d.orthography)&&(delete d._id,delete d.id),d}}});var g=function(a){this._fieldDBtype||(this._fieldDBtype="Contexts"),this.debug("Constructing Contexts length: ",a),d.apply(this,arguments)};g.prototype=Object.create(d.prototype,{constructor:{value:g},api:{value:"contexts"},primaryKey:{value:"id"},INTERNAL_MODELS:{value:{item:f}},sanitizeStringForPrimaryKey:{value:function(a){return this.debug("sanitizeStringForPrimaryKey"),a?("function"!=typeof a.replace&&(a+=""),a=a.replace(/[""+=?.\/\[\]{}() ]/g,"")):null}},length:{get:function(){var a=0;return this._collection&&"function"==typeof this._collection.map&&this._collection.map(function(b){a+=b.count?b.count:1}),this.debug(" getting number of context lengths of "+this.id+" "+a),a},set:function(a){this.debug(" cant set length of "+this.id+" "+a)}},set:{value:function(a,b,c,e){if(b){this.debug("context count before"+b.count);var f=this.find(b);this.debug("matching contexts ",f);var g;return f&&f.length?(g=f[0],g.merge("self",b)):g=d.prototype.set.apply(this,[a,b,c,e]),g}}},preview:{configurable:!0,get:function(){if(!this.collection)return"";var a=this.map(function(a){return a.id});return a=!a&&this.length?this.length+" contexts":a.join("; ")},set:function(){}}}),c.Context=f,c.Contexts=g,c.Contexts.Context=g.Context},{"./../Collection":3,"./../FieldDBObject":4}],56:[function(a,b,c){"use strict";var d;try{d=FieldDB.Bindings}catch(e){d={defineBindings:function(a,b){}},console.warn("Warning two-way editable binding in the lexicon won't work because the bindings weren't injected.")}var f=a("../Collection").Collection,g=a("../CORS").CORS,h=a("q"),i=a("./LexiconNode").LexiconNode,j=a("./Contexts").Contexts,k=a("./../map_reduce/MapReduce").MapReduceFactory,l=a("../../map_reduce_lexicon/views/lexiconNodes/map").lexiconNodes,m=k({filename:"lexiconNodes",mapString:l}),n=a("../../map_reduce_lexicon/views/morphemesPrecedenceContext/map").morphemesPrecedenceContext,o=k({filename:"morphemesPrecedenceContext",mapString:n}),p=function(a){this._fieldDBtype||(this._fieldDBtype="Lexicon"),a=a||[],a&&("[object Array]"===Object.prototype.toString.call(a)||a.rows)?a.rows&&a.rows[0]&&a.rows[0].key&&a.rows[0].key.relation||a[0]&&(a[0].relation||a[0].key&&a[0].key.relation)?(a.rows?a.entryRelations=a.rows:a={entryRelations:a},this.debug("constructing a lexicon from a set of connected nodes "+a.entryRelations.length)):(a={collection:a},this.debug("constructing a lexicon from a set of nodes "+a.collection.length)):(a.collection=a.collection||a.wordFrequencies||[],!a.orthography||a.collection&&0!==a.collection.length||"function"!=typeof p.bootstrapLexicon||(this.warn("constructing a lexicon from an orthography"),p.bootstrapLexicon(a))),a&&a.corpus&&(this._corpus=a.corpus),this.debug("constructing a lexicon from json "),this.id="lexicon",f.apply(this,[a]),this.entryRelations&&(this.debug("constructing a graph from lexicon's relations",a),this.updateConnectedGraph())};p.morphemeBoundaryRegEX=/[-=]/g,p.prototype=Object.create(f.prototype,{constructor:{value:p},primaryKey:{value:"headword"},INTERNAL_MODELS:{value:{item:i}},sorted:{value:!0},id:{get:function(){return this._id="lexicon",this._id},set:function(a){a!==this._id&&("lexicon"!==a&&this.warn('Lexicon id cannot be set, it is "lexicon" by default.'+a),a="lexicon",this._id=a)}},capitalizeFirstCharacterOfPrimaryKeys:{value:!1},sanitizeStringForPrimaryKey:{value:function(a){return this.debug("sanitizeStringForPrimaryKey"),a?("function"!=typeof a.replace&&(a+=""),a=a.replace(/[-""+=?.\/\[\]{}() ]/g,"")):null}},bindToView:{value:function(){return this.render(arguments)}},render:{value:function(a){var b,c,e,f,g,h,i,j,k,l,m,n,o;if(a=a||{},b=a.lexicalEntriesElement||a.element||this.lexicalEntriesElement,!b||"function"!=typeof b.appendChild)return this.warn("Lexicon will be unable to render a visual representation of its lexical entries. If you intended to render it, you should provide an element where it should be rendered.",b),this;if(this.localDOM=a.localDOM||this.localDOM,!this.localDOM)try{this.localDOM=document}catch(q){return this.warn("Lexicon will be unable to render the lexical entries. If you intended to render it, you should provide an localDOM to the lexicon."),this}var r=this;return o=a.igtFields,o||(this.corpus&&this.corpus.datumFields&&this.corpus.datumFields.length?(o=[],this.corpus.datumFields.map(function(a){a&&a.type&&"IGT"===a.type&&o.push(a.id)})):o=p.LexiconNode.prototype.expandedIGTFields),c=r.localDOM.createElement("ul"),b.appendChild(c),r.status="Rendering "+this.collection.length+" entries.",this.collection.map(function(a){var b,p;if(!(a&&"@"===a.morphemes||a&&"_#"===a.morphemes||a&&"#_"===a.morphemes)){r.status+="\nBinding "+a.id;var q=function(a){a.target.parentElement.__data__.clean().then(function(b){if(!b||!b.length)return void console.warn("there were no proposed changes.");var c=[];b.map(function(a){c.push(a.before+" -> "+a.after)});var d=r.confirm("Would you like to clean this lexical entry? (This will change all examples you see here to have this new information.)\n\n"+c.join("\n"));d&&a.target.parentElement.__data__.save().then(function(a){r.debug("Saving success...",a),r.popup("Saved "+c.join(" "))},function(a){r.warn("Saving failed...",a),r.bug("Save failed. "+a.userFriendlyErrors.join(" "))}).fail(function(b){r.warn("Saving failed...",b),r.bug("Save failed. Please notify the app's developers "+a.target.parentElement.__data__.datumids.join(" "))})})},s=function(a){if(a&&a.target&&a.target.__data__){if(a.target.jsonView?(q(a),b.hidden=!b.hidden,a.target.jsonView.hidden=b.hidden):(a.target.jsonView=r.localDOM.createElement("textarea"),a.target.appendChild(a.target.jsonView),a.target.jsonView.classList.add("lexiconJSON"),b.hidden=!b.hidden),a.target.jsonView.hidden){var c;try{c=JSON.parse(a.target.jsonView.innerHTML);for(var d in c)c.hasOwnProperty(d)}catch(e){console.warn("Invalid JSON "+a.target.jsonView.innerHTML,e)}}else a.target.jsonView.innerHTML=JSON.stringify(a.target.__data__,null,2);try{window.currentlySelectedNode=a.target,console.log("window.currentlySelectedNode",window.currentlySelectedNode.__data__)}catch(a){console.warn("Unable to make current node investigatable on the console.")}}},t={add:function(){}};f=r.localDOM.createElement("li"),f.classList||(f.classList=t),f.__data__=a,f.style.opacity=f.__data__.confidence,f.classList.add("lexical-entry"),f.classList.add("scrollable"),f.__data__.morphemes&&(f.id=f.__data__.morphemes),l=r.localDOM.createElement("span"),l.classList||(l.classList=t),l.contentEditable="true",l.classList.add("headword"),l.setAttribute("title","CLick to edit the headword of your lexical entry"),m=r.localDOM.createElement("button"),m.classList||(m.classList=t),m.classList.add("btn"),m.setAttribute("title","Click here to save"),m.innerHTML="Save ",m.onclick=q,n=r.localDOM.createElement("span"),n.classList||(n.classList=t),n.classList.add("utteranceContext"),b=r.localDOM.createElement("span"),b.classList||(b.classList=t),b.contentEditable="true",b.classList.add("discussion"),b.hidden=!0,f.__data__.discussion=f.__data__.discussion||"Lorem ipsum dolor sit amet, consectetur adipisicing elit, ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.",f.ondblclick=s,k=r.localDOM.createElement("dl");var u={listItemView:f,saveButtonView:m,headwordView:l,contextsView:n,discussionView:b,fieldListView:k,fieldViews:{},data:e},v=function(a,c){if(a[c]&&"object"!=typeof a[c]){l.classList.add(c+":"+encodeURI(a[c])),b.classList.add(c+":"+encodeURI(a[c])),h=r.localDOM.createElement("dt"),g=r.localDOM.createElement("span"),g.classList||(g.classList=t),g.innerHTML=c,g.classList.add("fieldlabel"),g.classList.add(c),g.classList.add(encodeURI(a[c])),h.appendChild(g),k.appendChild(h),i=r.localDOM.createElement("dd"),j=r.localDOM.createElement("span"),j.classList||(j.classList=t),j.contentEditable="true",j.classList.add("fieldvalue"),j.classList.add(c),j.classList.add(encodeURI(a[c])),u.fieldViews[c]=j,i.appendChild(j),k.appendChild(i);var e="fieldViews."+c+".value",f="listItemView.__data__."+c,m={};m[e]={"<-":f};var n={};n[f]={"<->":e},d.defineBindings(u,m),d.defineBindings(u,n)}};o.map(function(a){try{v(f.__data__,a)}catch(b){console.warn(b.stack)}});for(p in f.__data__)if(f.__data__.hasOwnProperty(p)&&f.__data__.hasOwnProperty(p)&&(0===p.indexOf("_")&&(p=p.replace("_","")),!(["discussion","headword","version","fieldDBtype"].indexOf(p)>-1||o.indexOf(p)>-1||"object"==typeof f.__data__[p]||"function"==typeof f.__data__[p])))try{v(f.__data__,p)}catch(w){console.warn(w.stack)}d.defineBindings(u,{"headwordView.value":{"<-":"listItemView.__data__.headword"},"saveButtonView.innerHTML":{"<-":"'Save '+listItemView.__data__.headword"},"discussionView.value":{"<-":"listItemView.__data__.discussion"},"contextsView.innerHTML":{"<-":"listItemView.__data__.contexts.preview"},"listItemView.title":{"<-":"'Example: '+listItemView.__data__.contexts.preview"},"listItemView.hidden":{"<-":"listItemView.__data__.confidence < self.localDOM.getElementById('lexiconConfidenceThreshold').value / 10"}}),d.defineBindings(u,{"listItemView.__data__.headword":{"<->":"headwordView.value"},"listItemView.__data__.discussion":{"<->":"discussionView.value"}}),f.appendChild(l),f.appendChild(b),f.appendChild(k),f.appendChild(n),f.appendChild(m),c.appendChild(f)}}),this}},entryRelations:{get:function(){return this._entryRelations},set:function(a){if(a){a&&a.rows&&(a=a.rows);var b,c,d,e,f,g,h;this.glossMightBeMissingFromMorphemesNGram=!1;var i=!this.corpus||!this.corpus.prefs||!this.corpus.prefs.showGlosserAsMorphemicTemplate;if("[object Array]"===Object.prototype.toString.call(a)){this._entryRelations=this._entryRelations||[];for(var j={},k=!1,l=0;l<a.length;l++)if(a.hasOwnProperty(l)&&a[l])if(e=a[l].key||a[l],"object"!=typeof e)for(e=(e+"").split(p.morphemeBoundaryRegEX),g=1,h="","number"==typeof a[l].value?g=a[l].value:(h=a[l].value,g=0),b=e[0],c=1;c<e.length;c++)this.debug(" working on "+b+"-"+e[c]),!i||"@"!==b&&"@"!==e[c]?(f=j[b+"-"+e[c]],f?(g&&(f.count+=g),h&&(f.source.contexts.add(h),f.target.contexts.add(h)),this.debug(" already found "+f.count,f.contexts)):(this.debug("  new "),f={source:{morphemes:b},target:{morphemes:e[c]},relation:"precedes"},g&&(f.count=g),h&&(f.source.contexts=new p.Contexts([h]),f.target.contexts=new p.Contexts([h])),"@"===f.source.morphemes&&(f.source.morphemes="#_"),"@"===f.target.morphemes&&(f.target.morphemes="_#"),j[b+"-"+e[c]]=f,this._entryRelations.push(f),k=!0),b=e[c]):(this.debug("Skipping word boundary since it makes the relations significantly smaller, and it wasnt specifically requested in the corpus preferences showGlosserAsMorphemicTemplate: "+e),b=e[c]);else this.debug("not upgrading entity relations");else this.debug("skipping ",a[l]);k?this.glossMightBeMissingFromMorphemesNGram=!0:this._entryRelations=a,this.debug("uniqueNGrams",j)}else{this.debug(" Converting object of ngrams in to relations",a),this._entryRelations=this._entryRelations||[],this.glossMightBeMissingFromMorphemesNGram=!0;for(d in a)if(a.hasOwnProperty(d)&&d&&"length"!==d)for(e=d.split(p.morphemeBoundaryRegEX),
b=e[0],c=1;c<e.length;c++)this.debug(" working on "+b+"-"+e[c]),!i||"@"!==b&&"@"!==e[c]?(f={source:{morphemes:b},target:{morphemes:e[c]},relation:"precedes"},b=e[c],"number"==typeof a[d]?f.count=a[d]:"[object Array]"===Object.prototype.toString.call(a[d])?(f.source.contexts=a[d],f.target.contexts=a[d]):(f.source.contexts=a[d],f.target.contexts=a[d]),"@"===f.source.morphemes&&(f.source.morphemes="#_"),"@"===f.target.morphemes&&(f.target.morphemes="_#"),this._entryRelations.push(f)):(this.debug("Skipping word boundary since it makes the relations significantly smaller, and it wasnt specifically requested in the corpus preferences showGlosserAsMorphemicTemplate: "+e),b=e[c])}}}},precedenceRelations:{get:function(){return this.entryRelations},set:function(a){this.entryRelations=a}},guessFirstGloss:{value:function(a){if(!a.morphemes)return console.warn("There was no morphemes line to guess the gloss from..."),a;var b=[],c=[],d="",e=a.morphemes.trim().split(/\s+/);for(var f in e){var g=e[f].split(p.morphemeBoundaryRegEX),h=[];for(var i in g)if(g.hasOwnProperty(i)){c=[];var j="?";if(d=g[i]){if(this.debug("looking for "+d),c=this.find("morphemes",d),c&&c.length>0)try{j=c[0].gloss||"?"}catch(k){}this.debug("found  "+j),h.push(j)}else h.push(j)}b.push(h.join("-"))}return a.gloss=b.join(" "),a.alternateGlossLines=a.alternateGlossLines?a.alternateGlossLines.concat(b.join(" ")):[a.gloss],a}},guessContextSensitiveGlosses:{value:function(a){if(!a.morphemes)return console.warn("There was no morphemes line to guess the gloss from..."),a;var b=[],c=[],d="",e=a.morphemes.trim().split(/\s+/);for(var f in e){f>0&&e>f&&b.push([" "]);for(var g=e[f].split(p.morphemeBoundaryRegEX),h=0;h<g.length;h++)h>0&&h<g.length&&b.push(["-"]),d=g[h],d?(this.debug("looking for "+d),c=this.find("morphemes",d),c&&c.length>0&&c[0].gloss?b.push(c):b.push(["?"])):b.push(["?"])}return a.alternateGlossLines=a.alternateGlossLines||[],a.gloss=b.map(function(a){if(a&&a.length){var b=a[0];return"string"!=typeof b&&(b=a[0].gloss),b}}).join(""),a.alternateGlossLines.unshift(a.gloss),a}},maxLexiconSize:{get:function(){return this._maxLexiconSize?this._maxLexiconSize:this.corpus&&this.corpus.prefs&&this.corpus.prefs.maxLexiconSize?this.corpus.prefs.maxLexiconSize:p.maxLexiconSize},set:function(a){this.corpus&&this.corpus.prefs?this.corpus.prefs.maxLexiconSize=a:this._maxLexiconSize=a}},set:{value:function(a,b,c,d){if(b&&b.key&&(b=p.convertMapReduceRowIntoLexicalEntry(b)),b){if(this.length>this.maxLexiconSize)return void this.debug("Lexicon is too big, ignoring...",b);b&&"string"!=typeof b&&"function"==typeof p.LexiconNode.mergeContextsIntoContexts&&(this.debug("\n adding   ",b,"\n"),p.LexiconNode.mergeContextsIntoContexts(b),this.debug("done combining contexts",b.contexts)),b instanceof p.LexiconNode||(this.debug("converting into node",b),b=new p.LexiconNode(b),this.debug(" converted into node headword",b.headword)),this.debug("looking for  "+b.headword+" in ",this.collection.length);var e;if(b.gloss&&!this.glossMightBeMissingFromMorphemesNGram)e=this.find(b);else if(e=this.find("morphemes",b.morphemes),e.length>1){this.debug("found "+e.length+" lexical entries which has these morphemes: "+b.morphemes);for(var g=-1,h=e.length-1;h>=0;h--)if(e[h].id===b.morphemes+"|"){g=h;break}g>-1?(e=[e[g]],this.debug("using the one that also has an unspecified gloss.")):(this.warn("found "+e.length+" lexical entries which has these morphemes: "+b.morphemes+". But using none of them because they all have glosses and this node came from a morpheme segmetnation with no gloss so we cant know which entry it refers to: "+e.map(function(a){return a.id})),e=[])}else this.debug("found "+e.length+" lexical entries which has these morphemes: "+b.morphemes);this.debug("matching lexical entries ",e);var i;return e&&e.length?(i=e[0],i.confidence&&b.confidence&&(i.confidence=b.confidence=(parseFloat(i.confidence,10)+parseFloat(b.confidence,10))/2),i.count&&b.count&&(i.count=b.count=parseFloat(i.count,10)+parseFloat(b.count,10)),i.gloss&&!b.gloss&&(b.gloss=i.gloss),i.merge("self",b,"overwrite")):(i=f.prototype.set.apply(this,[a,b,c,d]),i?this.debug(" finished setting lexical entry "+i.id):this.warn("Entry wasnt added",b)),i}}},addOrMergeDeprecated:{value:function(a){if(!a)return a;if(a&&"[object Array]"===Object.prototype.toString.call(a)){for(var b=0;b<a.length;b++)a[b]=this.addOrMergeDeprecated(a[b]);return a}this.debug("running addOrMergeDeprecated",a.headword);var c=this.find(a);return c&&c.length?(c=c[0],this.debug("Merging a simlar entry into the existing entry in the lexicon "+c.headword+" "+a.headword),c.merge("self",a),a=c):(a instanceof p.LexiconNode||(a=new p.LexiconNode(a)),a=this.add(a),this.debug("Added value "+a.headword)),a}},generatePrecedenceForceDirectedRulesJsonForD3:{value:function(){return this.updateConnectedGraph(arguments)}},updateConnectedGraph:{value:function(a){if(!this.entryRelations||!this.entryRelations.length)return void this.warn("Cannot visualize relations between lexical entities if the lexicon doesn't know about any entryRelations");var b=this;return!a&&this.corpus&&this.corpus.prefs&&(a=this.corpus.prefs),a||(a={}),this.connectedGraph=this.connectedGraph||{length:0,nodes:{},links:[]},this.availableLexicalRelations=this.availableLexicalRelations=[{icon:'<i class="fa fa-arrow-right"></i>',name:"Precedes",maker:": Show x-> y",ticked:!0},{icon:'<i class="fa fa-arrow-left"></i>',name:"Follows",maker:": Show x <- y",ticked:!1},{icon:'<i class="fa fa-volume-up"></i>',name:"Phonology",maker:": Show phonological priming",ticked:!1},{icon:'<i class="fa fa-globe"></i>',name:"Semantics",maker:": Show semantic priming",ticked:!1},{icon:'<i class="fa fa-share"></i>',name:"Syntax",maker:": Show morpho-syntactic priming",ticked:!1},{icon:'<i class="fa fa-refresh"></i>',name:"All ",maker:": Show all relations in the lexicon",ticked:!1}],this.entryRelations.map(function(c){if(c)try{var d=c.key||c;d.count=c.value?c.value:c.key?c.key.count:null,b.debug("Adding ",d," to connected graph");var e=d.source||d.from||d.previous||d.x,f=d.target||d.to||d.subsequent||d.y,g=c.id||"";if(g||b.debug("Cant figure out the URL(s) of where this node might have come from"),e instanceof p.LexiconNode||(b.debug("\nCreating lexical entry from only orthography "+e),e=new p.LexiconNode(e),b.debug("Converted source into a lexicon node",e.headword)),f instanceof p.LexiconNode||(b.debug("\nCreating lexical entry from only orthography "+f),f=new p.LexiconNode(f),b.debug("Converted target into a lexicon node",f.headword)),d.context&&"string"==typeof d.context){b.debug("Upgrading v1 precedence relation to node and edges");var h={URL:g,morphemes:d.context};d.count?h.count=d.count:b.debug("Don't know how often this context appears",c.value),e.contexts=[h],f.contexts=[h]}else b.debug("This is not a v1 relation",c),d.count&&(b.debug("setting frequencyCount using edge count",d.count),e.count+=d.count,f.count+=d.count);if(!e||!f)return void b.warn("Missing either a `source` or `target` ",e,f);if(("@"===e.morphemes||"_#"===e.morphemes||"#_"===e.morphemes||"@"===f.morphemes||"_#"===f.morphemes||"#_"===f.morphemes)&&!a.showGlosserAsMorphemicTemplate)return void b.debug("Skipping a connection involving a word boundary ",d);if("@"===e.morphemes&&(e.morphemes="#_"),"@"===f.morphemes&&(f.morphemes="_#"),!e.morphemes||!f.morphemes)return void b.warn("Missing morphemes on the nodes, this relation cant be added to the graph ",e,f);if(!a.maxDistanceForContext&&d.distance>1||a.maxDistanceForContext&d.distance>a.maxDistanceForContext)return void b.debug("Skipping distantly related nodes "+d.distance);if(!a.showRelations&&"precedes"!==d.relation||a.showRelations&&-1===a.showRelations.indexOf(d.relation))return void b.debug("Skipping nodes which arent related by precedence "+d.relation);if(!b.isWithinConfidenceRange(e,a.confidenceRange)||!b.isWithinConfidenceRange(f,a.confidenceRange))return void b.warn("Skipping nodes which arent confident enough ",d.confidence);if(e=b.add(e),f=b.add(f),!e||!f)return void b.debug("Skipping relation beause one fo the two nodes was excluded from the graph (probably lexicon is too big)");b.connectedGraph.nodes[e.headword]?b.connectedGraph.nodes[e.headword]!==e&&(b.warn(e.morphemes+" was already defined. merging with this node "+e.headword),b.connectedGraph.nodes[e.headword].merge("self",e,"overwrite")):(b.connectedGraph.length++,b.connectedGraph.nodes[e.headword]=e),e=b.connectedGraph.nodes[e.headword],b.connectedGraph.nodes[f.headword]?b.connectedGraph.nodes[f.headword]!==f&&(b.warn(f.morphemes+" was already defined. merging with this node"),b.connectedGraph.nodes[f.headword].merge("self",f,"overwrite")):(b.connectedGraph.length++,b.connectedGraph.nodes[f.headword]=f),f=b.connectedGraph.nodes[f.headword],d.source=e,d.target=f,delete d.previous,delete d.subsequent,delete d.from,delete d.to,b.connectedGraph[d.relation]=b.connectedGraph[d.relation]||[],b.connectedGraph[d.relation].push(d),b.connectedGraph.links.push(d)}catch(i){b.warn("Skipping relation because of an error "+i,i.stack,c)}}),this.updateAvailableLexicalRelations(),this.connectedGraph}},updateAvailableLexicalRelations:{value:function(){if(!this.connectedGraph)return void this.warn("unable to update availableLexicalRelations, connectedGraph is not defined.");this.availableLexicalRelations=this.availableLexicalRelations||[];var a,b=this,c={};this.availableLexicalRelations.map(function(a){c[a.name.toLowerCase()]=a});for(a in this.connectedGraph)this.connectedGraph.hasOwnProperty(a)&&this.connectedGraph[a]&&this.connectedGraph[a].length&&(["nodes"].indexOf(a)>-1||(c[a]||"links"===a&&c.all?c[a].count=b.connectedGraph[a].length:this.availableLexicalRelations.push({icon:'<i class="fa fa-link"></i>',name:a,maker:": Other",ticked:!1,count:this.connectedGraph[a].length})));return this.availableLexicalRelations}},dbname:{get:function(){return this._dbname?this._dbname:this.corpus&&this.corpus.dbname?this.corpus.dbname:void 0},set:function(a){this._dbname=a}},fetch:{value:function(a){var b=h.defer(),c=this;if(this.fetching&&this.whenReady)return this.warn("Fetching is in process, don't need to fetch right now..."),this.whenReady;a=a||{};var d="";if(a.url&&(d=a.url),!d||"default"===d){if(!this.dbname&&!a.dbname)throw"Glosser's webservice can't be guessed, there is no current corpus so the URL must be defined.";d=this.corpus.prefs&&this.corpus.prefs.lexiconURL?this.corpus.prefs.lexiconURL:this.corpus.url+"/_design/lexicon/_view/"+m.filename+"?group=true&limit="+this.maxLexiconSize}return this.fetching=!0,this.whenReady=b.promise,p.CORS.makeCORSRequest({type:"GET",url:d}).then(function(a){return c.fetching=!1,a&&a.rows&&a.rows.length?(c.add(a.rows),void b.resolve(c.collection)):void b.reject({details:a,userFriendlyErrors:["The result from the server was not a standard response. Please report this."]})},function(a){c.fetching=!1,b.reject(a)}).fail(function(a){c.fetching=!1,console.error(a.stack,c),b.reject(a)}),b.promise}},fetchConnectedGraph:{value:function(a){this.debug("not doing anything for fetchConnectedGraph ",a)}},buildLexiconFromCouch:{value:function(a,b){this.warn("DEPRECATED buildLexiconFromCouch use fetch instead. not using "+a,b)}},buildLexiconFromLocalStorage:{value:{value:function(a,b){var c=localStorage.getItem(a+"lexiconResults");c&&(this.generatePrecedenceForceDirectedRulesJsonForD3(c),"function"==typeof b&&b())}}},isWithinConfidenceRange:{value:function(a,b){return b?a.confidence<=b.max&&a.confidence>=b.min:!0}},visualizeAsForceDirectedGraph:{value:function(a){var b=this;a=a||{};var c=a.divElement||a.connectionsElement||a.element,d=a.prefs;if(!d&&this.corpus&&this.corpus.prefs&&(d=this.corpus.prefs),d||(d={}),d.showRelations||(d.showRelations=["precedes"]),this.connectedGraph&&this.connectedGraph.links&&this.connectedGraph.links.length&&this.connectedGraph.nodes)this.warn("Not updating the connected graph, it was already generated.");else{if(this.warn("Updating the connected graph, it wasnt ready yet. ",this.connectedGraph),this.updateConnectedGraph(d),!this.connectedGraph||!this.connectedGraph.nodes)return this;this.connectedGraph.links=[],d.showRelations.map(function(a){return a&&b.connectedGraph[a]&&b.connectedGraph[a].length?void(b.connectedGraph.links=b.connectedGraph.links.concat(b.connectedGraph[a])):this})}if(this.debug("Displaying a connected graph of "+this.connectedGraph.links.length+" links"),0===b.connectedGraph.links.length)return this;if(!this.d3)try{this.d3=d3}catch(e){return this.warn("Lexicon will be unable to render a visual representation of itself. If you intended to render it, you should add d3 as a dependancy to your app.",this.d3),this}if(!c)return this.warn("Lexicon will be unable to render a visual representation of itself. If you intended to render it, you should provide an divElement where it should be rendered.",c),this;this.debug("Using divElement",c);var f=a.width||c.clientWidth||200,g=a.height||350;if(d.clear)this.connectedGraph.svg&&this.connectedGraph.svg[0]&&this.connectedGraph.svg[0][0]&&this.connectedGraph.svg[0][0].innerHTML&&(this.connectedGraph.svg[0][0].innerHTML="");else if(c.children&&c.children.length&&this.connectedGraph.svg&&this.connectedGraph.svg[0]&&this.connectedGraph.svg[0][0]&&this.connectedGraph.svg[0][0].innerHTML)return this.debug("Not re-rendering the lexicon connected graph."),b;var h;if(!b.localDOM)try{b.localDOM=document}catch(e){return b.warn("Lexicon will be unable to render the connected graph. If you intended to render it, you should provide an localDOM to the self."),b}h=b.localDOM.createElement("div"),b.localDOM.body.appendChild(h),h=this.d3.select(h).style("position","absolute").style("z-index","10").style("visibility","hidden").html("");var i=function(a){var b=a.source.x-a.target.x,c=a.source.y-a.target.y,d=Math.sqrt(b*b+c*c);return"M"+a.source.x+","+a.source.y+"A"+d+","+d+" 0 0,1 "+a.target.x+","+a.target.y},j=function(a){return"_#"===a.morphemes&&(a.x=f-20,a.y=g/2),"#_"===a.morphemes&&(a.x=20,a.y=g/2),"translate("+a.x+","+a.y+")"},k=this.d3.scale.linear().range(["darkblue","darkred"]).domain([1,8]),l=function(a){return"#_"===a.morphemes?"#00000":"_#"===a.morphemes?"#fffff":a.morphemes?k(a.morphemes.length):(b.warn("this morpheme is empty ",a),"#ffffff")},m=this.d3.layout.force().nodes(this.d3.values(b.connectedGraph.nodes)).links(b.connectedGraph.links).size([f,g]).linkDistance(30).friction(.5).charge(-120);this.connectedGraph.svg=b.localDOM.createElement("svg"),"function"!=typeof c.appendChild?(b.warn("You have provided a defective divElement, it is unable to append divElements to itself. Appending to the body of the document instead.",c),b.localDOM.body.appendChild(b.connectedGraph.svg)):c.appendChild(b.connectedGraph.svg),this.connectedGraph.svg=this.d3.select(b.connectedGraph.svg);try{this.connectedGraph.svg=this.d3.select(c).append("svg")}catch(e){}b.connectedGraph.svg.attr("width",f).attr("height",g),b.connectedGraph.svg.append("defs").selectAll("marker").data(m.links()).enter().append("marker").attr("id",function(a){return a}).style("opacity",function(){return.5}).attr("viewBox","0 -5 10 10").attr("refX",15).attr("refY",-1.5).attr("markerWidth",6).attr("markerHeight",6).attr("orient","auto").append("path").attr("d","M0,-5L10,0L0,5");var n=b.connectedGraph.svg.append("g").selectAll("path").data(m.links()).enter().append("path").attr("class",function(a){var b=a.distance||1;return"link "+a.relation+" distance"+b}).attr("marker-end",function(a){return"url(#"+a.relation+")"}),o=b.connectedGraph.svg.append("g").selectAll("circle").data(m.nodes()).enter().append("circle").attr("class","node").attr("r",5).style("fill",l).style("opacity",function(a){return a.confidence?a.confidence/2:1}).on("mouseover",function(a){var c;return b.localDOM&&(c=b.localDOM.getElementById(a.id)),c=c?c.innerHTML+"<p>"+c.getAttribute("title")+"<p>":"Morpheme: "+a.morphemes+"<br/> Gloss: "+a.gloss+"<br/> Confidence: "+a.confidence,h?void 0:h.style("visibility","visible").html("<div class='node_details_tooltip self'>"+c+"</div>")}).on("mousemove",function(){return h?void 0:h.style("top",event.pageY-10+"px").style("left",event.pageX+10+"px")}).on("mouseout",function(){return h?void 0:h.style("visibility","hidden")}).on("click",function(a){if(b.application&&b.application.router){var c=b.application.basePathname+b.application.currentCorpusDashboard+"/lexicon/"+a.headword;b.application.router.navigate(c,{trigger:!0})}}).call(m.drag),p=b.connectedGraph.svg.append("g").selectAll("text").data(m.nodes()).enter().append("text").attr("x",8).attr("y",".31em").style("opacity",function(a){return a.confidence?a.confidence/2:1}).style("color",l).text(function(a){return a.morphemes}),q=function(){n.attr("d",i),o.attr("transform",j),p.attr("transform",j)};try{m.on("tick",q).start()}catch(e){"TypeError: Cannot read property 'weight' of undefined"===e.message?b.bug("Something is wrong with one of the links in the lexicon, it doesn't have a source or target. ",e.stack):b.warn("\nThe lexicon was able to start the connected graph. Something was wrong. ",e.stack)}return this}}}),p.convertMapReduceRowIntoLexicalEntry=function(a){if(a){var b=a.key||a;return"string"==typeof b?void console.warn(" Lexical node skipped ",b):b.error?void console.warn(" Lexical node indicates an error/inconsitancy in the corpus data ",b):"@"===b.morphemes?void console.warn(" skipping word boundary ",b):(b.count=a.value||a.count,b)}},p.lexicon_nodes_mapReduce=m,p.lexicon_precedence_context_mapReduce=o;var q=function(a){var b=new p(a);return console.warn(" LexiconFactory is deprecated"),b};p.CORS=g,p.bootstrapLexicon=p.lexicon_nodes_mapReduce,p.LexiconNode=i,p.Contexts=j,p.LexiconFactory=q,p.maxLexiconSize=400,c.Lexicon=p},{"../../map_reduce_lexicon/views/lexiconNodes/map":80,"../../map_reduce_lexicon/views/morphemesPrecedenceContext/map":81,"../CORS":1,"../Collection":3,"./../map_reduce/MapReduce":64,"./Contexts":55,"./LexiconNode":57,q:223}],57:[function(a,b,c){var d=a("../CORS"),e=a("q"),f=a("./../datum/LanguageDatum").LanguageDatum,g=a("./../../api/corpus/corpus.json"),h=a("./../audio_video/AudioVideos").AudioVideos,i=a("./../lexicon/Contexts").Contexts,j=a("./../comment/Comments").Comments,k=a("./../datum/DatumFields").DatumFields,l=a("./../datum/DatumStates").DatumStates,m=a("./../datum/DatumTags").DatumTags,n=a("./../image/Images").Images,o=a("./../datum/Session").Session,p=function(a){return a.replace(/([()[{*+.$^\\|?])/g,"\\$1")},q=function(a){this._fieldDBtype||(this._fieldDBtype="LexiconNode"),this.debug("Declaring a LexiconNode",a),f.apply(this,arguments),"function"==typeof this.toJSON?this.fossil=this.toJSON():(this.fossil={},this.expandedIGTFields.map(function(a){a&&this[a]&&(this.fossil[a]=this[a])})),this.debug("constructed "+this.id),this.debug("morphemes "+this.morphemes),this.debug("contexts ",this.contexts)};q.prototype=Object.create(f.prototype,{constructor:{value:q},api:{value:"lexicalNodes"},INTERNAL_MODELS:{value:{fields:k,audioVideo:h,session:o,comments:j,contexts:i,datumStates:l,datumTags:m,images:n}},id:{configurable:!0,get:function(){return this.headword},set:function(a){this.headword!==a&&(this.headword=a)}},headword:{configurable:!0,get:function(){if(this.debug(" getting headword ",this.fields?this.fields.length:this),this._headword)return this._headword;var a="";return this.morphemes&&(a=this.morphemes),a+=q.HEADWORD_DELIMITER,this.gloss&&"?"!==this.gloss&&"??"!==this.gloss&&this.gloss&&(a+=this.gloss),a&&a!==q.HEADWORD_DELIMITER?a:void 0},set:function(a){this._headword=this._id=a}},count:{configurable:!0,get:function(){return this._contexts&&this._contexts instanceof i&&this._contexts.length?this._contexts&&this._contexts instanceof i?(this.debug(" getting number of context counts of "+this.id+" "+this._contexts.length),this._contexts.length):0:(this.debug(" getting _count of "+this.id+" "+this._count),this._count||0)},set:function(a){this.debug(" setting count of "+this.id+" "+a),this._contexts&&this._contexts instanceof i&&this._contexts.length?this.debug("Ignoring count "+a+", this lexical node has contexts we can use instead."+this._contexts.length):this._count=a}},categories:{configurable:!0,get:function(){return this.syntacticCategory.split(/\s+/)},set:function(a){this.syntacticCategory=a.join(" ")}},datumids:{configurable:!0,get:function(){return this._datumids||[]},set:function(a){this._datumids=a}},contexts:{configurable:!0,get:function(){return this._contexts||(this._contexts=new this.INTERNAL_MODELS.contexts,this.debug("Initializing contexts of "+this.id)),this._contexts},set:function(a){this.ensureSetViaAppropriateType("contexts",a),this.debug(" set contexts to ",this._contexts)}},corpus:{get:function(){return this.parent&&this.parent.corpus?this.parent.corpus:this._corpus?this._corpus:void 0},set:function(a){this.parent||(this._corpus=a)}},addField:{value:function(a){return this.debug("Adding a field to lexical node "+this.id,a),this.fields||this.corpus&&this.corpus.datumFields&&this.corpus.datumFields.length||(this.fields=JSON.parse(JSON.stringify(g.datumFields))),f.prototype.addField.apply(this,arguments)}},merge:{value:function(a,b,c){return f.prototype.merge.apply(this,[a,b,c])}},uniqueEntriesOnHeadword:{value:function(a,b){a&&!b&&"LexiconNode"===this._fieldDBtype&&(a=this,b=a);var c=!0;return a&&b?a.headword!==b.headword?c=!1:c:c=!1}},equalDepreated:{value:function(a){this.warn(" checking equality ",this.headword,a.headword);var b,c,d,e=this,f=!0;if(!e||!a)return f=!1;if(e.headword!==a.headword)return f=!1;this.debug(" checking expandedIGTFields",this.expandedIGTFields);for(b in this.expandedIGTFields)c=this.expandedIGTFields[b],e.hasOwnProperty(c)&&(this.debug(c),e[c]!==a[c]&&(f=!1));if(f){for(b in this.combineFieldsIfEqual)c=this.combineFieldsIfEqual[b],e.hasOwnProperty(c)&&(d=[],e[c]=e[c].concat(a[c]),e[c].map(function(a){-1===d.indexOf(a)&&d.push(a)}),e[c]=d,a[c]=d);if(e.confidence&&a.confidence&&(e.confidence=(parseFloat(e.confidence,10)+parseFloat(a.confidence,10))/2,a.confidence=e.confidence),e.allomorphs||a.allomorphs){var g=e.allomorphs?e.allomorphs:"";g=g+g?", ":"",g=g+a.allomorphs?a.allomorphs:"",e.allomorphs=g,a.allomorphs=g}}return f}},expandedIGTFields:{value:["morphemes","gloss","allomorphy","phonetic","orthography"]},combineFieldsIfEqual:{value:["datumids","utteranceContext"]},sortBy:{value:"headword",writable:!0},compare:{value:function(a,b){a&&!b&&"LexiconNode"===this._fieldDBtype&&(a=this,b=a);var c=0,d=a.sortBy;return b&&b&&b[this.sortBy]?a&&a&&a[this.sortBy]?c="number"==typeof a[d]&&"number"==typeof b[d]?a[d]-b[d]:"string"==typeof a[d]&&"string"==typeof b[d]?a[d]<b[d]?-1:a[d]>b[d]?1:0:"string"==typeof a[d]?1:-1:1:-1}},clean:{value:function(){var a=e.defer();this.cleanedData=[];var b=[],c=this;this.proposedChanges=[];for(var g=function(a){f&&f.prototype.INTERNAL_MODELS&&(a=new f(a)),a.fields.map(function(a){if(c.fossil[a.label]!==c[a.label]&&new RegExp(p(c.fossil[a.label]),"i").test(a.mask)){var b={before:a.mask+""};return a.mask=a.mask.replace(new RegExp(p(c.fossil[a.label]),"ig"),c[a.label]),a.value=a.mask,b.after=a.mask,c.proposedChanges.push(b),a}}),c.cleanedData.push(a)},h=function(a){c.warn("There was a problem opening your data.",a),c.bug("There was a problem opening your data. "+a.userFriendlyErrors)},i=0;i<this.datumids.length;i++)b[i]=d.makeCORSRequest({method:"GET",dataType:"json",url:this.url+"/"+this.datumids[i]}),b[i].then(g).fail(h);return e.allSettled(b).then(function(b){c.debug(" cleaned promises are finished ",b),a.resolve(c.proposedChanges)}),a.promise}},save:{value:function(){var a=e.defer(),b=this,c=[];for(b.debug("Saving cleaned datum...");this.cleanedData&&this.cleanedData.length>0;){var f=this.cleanedData.pop();c.push(d.makeCORSRequest({method:"PUT",dataType:"json",data:f,url:this.url+"/"+f._id}))}return e.allSettled(c).then(function(c){c.map(function(a){"fulfilled"===a.state&&a.value&&a.value.ok?b.debug("Your changes have been successfully saved! ",a.value):b.bug("One of your changes was not saved "+f._id+" "+a.value.userFriendlyErrors.join("\n"))}),a.resolve(c),b.unsaved=!0}),a.promise}},unsaved:{configurable:!0,get:function(){return this._unsaved?this._unsaved:(this.fossil&&!this.equals(this.fossil)&&(this._unsaved=!0),this._unsaved)},set:function(a){this._unsaved=a}}}),q.HEADWORD_DELIMITER="|",q.mergeContextsIntoContexts=function(a){if(a){var b={URL:""},c=!1;return a.context&&("object"==typeof a.context?(b=a.context,b.URL=b.URL||"",console.log("Context was already an object on this lexical node",b)):b.context=a.context+"",c=!0,a.context="",delete a.context),a.utterance&&(b.utterance=a.utterance+"",c=!0,a.utterance="",delete a.utterance),a.orthography&&a.orthography!==a.morphemes&&(b.orthography=a.orthography+"",c=!0,a.orthography="",delete a.orthography),c?(a.contexts?(a.contexts instanceof q.prototype.INTERNAL_MODELS.contexts||(a.contexts=new q.prototype.INTERNAL_MODELS.contexts([a.contexts])),a.contexts.add(b)):a.contexts=new q.prototype.INTERNAL_MODELS.contexts([b]),a.contexts):a.contexts}},c.LexiconNode=q},{"../CORS":1,"./../../api/corpus/corpus.json":27,"./../audio_video/AudioVideos":13,"./../comment/Comments":17,"./../datum/DatumFields":36,"./../datum/DatumStates":38,"./../datum/DatumTags":40,"./../datum/LanguageDatum":42,"./../datum/Session":44,"./../image/Images":53,"./../lexicon/Contexts":55,q:223}],58:[function(a,b,c){var d=a("./../FieldDBObject").FieldDBObject,e=a("q"),f=function h(a){if(this.debug("Constructing ContextualizableObject ",a),a&&"string"==typeof a){if(h.compatibleWithSimpleStrings)return new String(a);var b="locale_"+a.replace(/[^a-zA-Z0-9-]/g,"_"),c=a;a={"default":b},this.originalString=c,this.data=this.data||{},this.data[b]={message:c},this.add(b,c)}for(var d in a)a.hasOwnProperty(d)&&"contextualizer"!==d&&this.add(d,a[d]);Object.apply(this,arguments)},g=!1;f.compatibleWithSimpleStrings=!0,f.prototype=Object.create(Object.prototype,{constructor:{value:f},fieldDBtype:{value:"ContextualizableObject"},contextualizer:{get:function(){return d.prototype.contextualizer}},debug:{value:function(a,b,c,e){return d.application&&d.application.contextualizer?d.application.contextualizer.debug:void(g&&(console.log(this.fieldDBtype.toUpperCase()+"-DEBUG FORCED: "+a),b&&console.log(b),c&&console.log(c),e&&console.log(e)))}},todo:{value:function(){return d.prototype.todo.apply(this,arguments)}},contextualize:{value:function(a){this.debug("requesting contextualization of "+a);var b;return this.contextualizer&&(b=this.contextualizer.contextualize(a)),b&&b!==a||(b=this.data&&this.data[a]?this.data[a].message:a),this.debug("::"+b+"::"),b}},updateContextualization:{value:function(a,b){this.debug("updateContextualization"+a);var c,d=this;return this.contextualizer&&(this.debug(this.contextualizer.data),c=this.contextualizer.updateContextualization(a,b),c!==!0&&(d.todo("Test async updatePromiseOrSyncrhonousConfirmed"),e.nextTick(function(){if(d.contextualizer){var c=d.contextualizer.contextualize(a);c&&c!==a||!d.data||(d.data[a]=d.data[a]||{message:""},d.data[a].message=b)}else console.warn("This is strange, i lost my contextualizer...",d)}))),this._default===a&&(this.originalString=b),c}},add:{value:function(a,b){var c="_"+a;this[c]=b,this.__defineGetter__(a,function(){return this.debug("overidding getter"),this.contextualize(this[c])}),this.__defineSetter__(a,function(a){this.debug("overidding setter "+c,a),this.updateContextualization(this[c],a)}),this.debug("adding string to ContextualizableObject's own data "+a),this.data=this.data||{},this.data[a]={message:b},(0===a.indexOf("locale_")||0===a.indexOf("localized_"))&&(this.debug("intializing the data in this ContextualizableObject"),this.debug(" for_context "+a),this.debug(" locale_string "+b),this.contextualizer&&(this.debug(" adding to contextualizer: "+a+" as "+b),this.contextualizer.updateContextualization(a,b),this.debug("added to contextualizer "+this.contextualizer.contextualize(a)))),this.debug("data",this.data)}},isEmpty:{value:function(){return d.prototype.isEmpty.apply(this,arguments)}},toJSON:{value:function(a,b){var c,d,e={};if(!f.compatibleWithSimpleStrings&&this.originalString)return this.originalString;this.debug("Original string is not defined, returning an object. ",f.compatibleWithSimpleStrings,this.originalString);for(c in this)this.hasOwnProperty(c)&&"function"!=typeof this[c]&&"contextualizer"!==c&&0===c.indexOf("_")&&(d=c.replace(/^_/,""),(!b||b&&!this.isEmpty(c))&&(this[c]&&"function"==typeof this[c].toJSON?e[d]=this[c].toJSON(a,b):e[d]=this[c]));if(a&&this.INTERNAL_MODELS)for(c in this.INTERNAL_MODELS)!e[c]&&this.INTERNAL_MODELS&&(this.INTERNAL_MODELS[c]&&"function"==typeof this.INTERNAL_MODELS[c]&&"function"==typeof(new this.INTERNAL_MODELS[c]).toJSON?e[c]=(new this.INTERNAL_MODELS[c]).toJSON(a,b):e[c]=this.INTERNAL_MODELS[c]);return e["default"]&&this.originalString&&(e[e["default"]]=this.originalString,delete e.originalString),e}}}),c.ContextualizableObject=f},{"./../FieldDBObject":4,q:223}],59:[function(a,b,c){(function(b){var d=a("./../FieldDBObject").FieldDBObject,e=a("./ELanguages").ELanguages,f=a("./../CORS").CORS,g=a("q"),h=a("./en/messages.json"),i=a("./es/messages.json"),j=a("./elanguages.json"),k=function(a){this._fieldDBtype||(this._fieldDBtype="Contextualizer"),this.debug("Constructing Contextualizer ",a);var b=arguments;if(a||(a={},b=[a]),a.defaultLocale&&a.defaultLocale.iso||(a.defaultLocale={iso:"en"}),a.currentContext||(a.currentContext="default"),a.elanguages||(a.elanguages=j),d.apply(this,b),a&&void 0!==a.alwaysConfirmOkay||(this.debug("By default it will be okay for users to modify global locale strings. IF they are saved this will affect other users."),this.alwaysConfirmOkay=!0),this.userOverridenLocalePreference)this.currentLocale=this.userOverridenLocalePreference;else try{-1===navigator.languages[0].indexOf(this.currentLocale.iso)&&(this.currentLocale=navigator.languages[0])}catch(c){this.debug("not using hte browser's language",c)}return this};k.prototype=Object.create(d.prototype,{constructor:{value:k},INTERNAL_MODELS:{value:{elanguages:e}},_require:{value:"undefined"!=typeof b?b.require:"undefined"!=typeof window?window.require:null},data:{get:function(){return this._data},set:function(a){this._data=a}},currentLocale:{get:function(){return this._currentLocale?this._currentLocale:this._mostAvailableLanguage?this._mostAvailableLanguage:this.defaultLocale},set:function(a){a!==this._currentLocale&&(a&&a.toLowerCase&&"string"==typeof a&&(a=a.toLowerCase().replace(/[^a-z-]/g,""),a=this.elanguages&&this.elanguages[a]?this.elanguages[a]:{iso:a}),this.debug("SETTING LOCALE FROM "+this._currentLocale+" to ",a,this.data),this._currentLocale=a)}},userOverridenLocalePreference:{get:function(){var a;try{a=JSON.parse(localStorage.getItem("_userOverridenLocalePreference"))}catch(b){this.debug("Localstorage is not available, using the object there will be no persistance across loads",b,this._userOverridenLocalePreference),a=this._userOverridenLocalePreference}if(a)return a},set:function(a){if(a)try{localStorage.setItem("_userOverridenLocalePreference",JSON.stringify(a))}catch(b){this._userOverridenLocalePreference=a,this.debug("Localstorage is not available, using the object there will be no persistance across loads",b,this._userOverridenLocalePreference)}else try{localStorage.removeItem("_userOverridenLocalePreference")}catch(b){this.debug("Localstorage is not available, using the object there will be no persistance across loads",b,this._userOverridenLocalePreference),delete this._userOverridenLocalePreference}}},availableLanguages:{get:function(){if(this.data=this.data||{},this._availableLanguages&&this.data[this._availableLanguages._collection[0].iso]&&this._availableLanguages._collection[0].length===this.data[this._availableLanguages._collection[0].iso].length)return this._availableLanguages;var a=new e,b=0;for(var c in this.data)this.data.hasOwnProperty(c)&&(this.elanguages[c].length=this.data[c].length,this.elanguages[c].length>b?(a.unshift(this.elanguages[c]),
b=this.elanguages[c].length):a.push(this.elanguages[c]));return 0===b||0===a.length?(this.todo("Ensuring that at least english is an available language, not sure if this is a good idea."),a.unshift(this.elanguages.en)):a._collection.map(function(a){return a.percentageOfAvailability=Math.round(a.length/b*100),a}),this.todo("test whether setting the currentLocale to the most complete locale has adverse affects."),this._mostAvailableLanguage=a._collection[0],this._availableLanguages=a,a}},defaults:{get:function(){return{en:JSON.parse(JSON.stringify(h)),es:JSON.parse(JSON.stringify(i))}}},loadDefaults:{value:function(){return this.defaults.en?this.addMessagesToContextualizedStrings("en",this.defaults.en):this.debug("English Locales did not load."),this.defaults.es?this.addMessagesToContextualizedStrings("es",this.defaults.es):this.debug("English Locales did not load."),this}},localize:{value:function(a,b){return this.contextualize(a,b)}},contextualize:{value:function(a,b){b||(b=this.currentLocale.iso),b&&b.iso&&(b=b.iso),this.debug("Resolving localization in "+b);var c,e=a;if("object"==typeof a){var f=!1;for(c in a)if(a.hasOwnProperty(c)&&(c.indexOf(this.currentContext)>-1||("child"===this.currentContext||"game"===this.currentContext)&&c.indexOf("gamified")>-1)){e=a[c],f=!0,this.debug("Using "+c+" for this contxtualization.");break}!f&&a["default"]&&(this.debug("Using default for this contxtualization. ",a),e=a["default"])}if(!this.data)return this.warn("No localizations available, resolving the key itself: ",e),e;var g=!0;return this.data[b]&&this.data[b][e]&&void 0!==this.data[b][e].message?(e=this.data[b][e].message,this.debug("Resolving requested contextualization using requested language: ",e),g=!1):this.data[this.defaultLocale.iso]&&this.data[this.defaultLocale.iso][e]&&void 0!==this.data[this.defaultLocale.iso][e].message?(e=this.data[this.defaultLocale.iso][e].message,this.debug("Resolving requested contextualization using default language: ",e),g=!1):("object"==typeof a&&(a[e]&&this.data[b]&&this.data[b][a[e]]&&void 0!==this.data[b][a[e]].message&&this.data[b][a[e]].message?(e=this.data[b][a[e]].message,this.debug("Resolving localization using requested contextualization: ",a[e]),g=!1):a["default"]&&this.data[b]&&this.data[b][a["default"]]&&void 0!==this.data[b][a["default"]].message&&this.data[b][a["default"]].message?(e=this.data[b][a["default"]].message,this.debug("Resolving localization using default contextualization: ",a["default"]),g=!1):a["default"]&&this.data[this.defaultLocale.iso]&&this.data[this.defaultLocale.iso][a["default"]]&&void 0!==this.data[this.defaultLocale.iso][a["default"]].message&&this.data[this.defaultLocale.iso][a["default"]].message&&(e=this.data[this.defaultLocale.iso][a["default"]].message,this.debug("Resolving localization using default contextualization and default locale: ",a["default"]),g=!1)),g&&this.data[this.defaultLocale.iso]&&this.data[this.defaultLocale.iso][e]&&void 0!==this.data[this.defaultLocale.iso][e].message&&this.data[this.defaultLocale.iso][e].message&&(e=this.data[this.defaultLocale.iso][e].message,this.debug("Resolving localization using default: ",e))),g&&!this.requestedCorpusSpecificLocalizations&&d&&d.application&&d.application.corpus&&d.application.corpus.loaded&&"function"==typeof d.application.corpus.getCorpusSpecificLocalizations&&(d.application.corpus.getCorpusSpecificLocalizations(),this.requestedCorpusSpecificLocalizations=!0),e=e.replace(/^locale_/,"")}},updateContextualization:{value:function(a,b){var c=g.defer(),d=this,e="",f="create ";if(this.whenReadys=this.whenReadys||[],this.todo("Test async updateContextualization"),this.whenReadys.push(c.promise),this.data[this.currentLocale.iso]=this.data[this.currentLocale.iso]||{},this.data[this.currentLocale.iso][a]&&this.data[this.currentLocale.iso][a].message===b)return g.nextTick(function(){c.resolve(b)}),c.promise;this.data[this.currentLocale.iso][a]&&(e=this.data[this.currentLocale.iso][a].message,f="update ");var h=function(b,e){d.debug("Adding the user's message. ",b,e),d.data[d.currentLocale.iso][b]=d.data[d.currentLocale.iso][b]||{},d.data[d.currentLocale.iso][b].message=e,d.fossil||(d.fossil=d.toJSON()),d.unsaved=!0;var f={};f[a]={message:e},d.addMessagesToContextualizedStrings(d.currentLocale.iso,f),g.nextTick(function(){c.resolve(e)})};return!this.testingAsyncConfirm&&this.alwaysConfirmOkay?(d.debug("  Running synchonosuly. ",a,b),h(a,b),c.promise):(d.debug("     Running asynchonosuly. ",a,b),this.confirm("Do you also want to "+f+a+" for other users? \n"+e+" -> "+b).then(function(c){d.debug("Recieved confirmation ,",c),h(a,b)},function(a){d.debug("Not updating , user clicked cancel",a),c.reject(a)}).fail(function(a){console.error(a.stack,d),c.reject(a)}),c.promise)}},audio:{value:function(a){this.debug("Resolving localization in "+this.currentLocale.iso);var b={};return this.data?(this.data[this.currentLocale.iso]&&this.data[this.currentLocale.iso][a]&&void 0!==this.data[this.currentLocale.iso][a].audio&&this.data[this.currentLocale.iso][a].audio?(b=this.data[this.currentLocale.iso][a].audio,this.debug("Resolving localization audio using requested language: ",b)):this.data[this.defaultLocale.iso]&&this.data[this.defaultLocale.iso][a]&&void 0!==this.data[this.defaultLocale.iso][a].audio&&this.data[this.defaultLocale.iso][a].audio&&(b=this.data[this.defaultLocale.iso][a].audio,this.warn("Resolving localization audio using default: ",b)),b):(this.warn("No localizations available, resolving empty audio details"),b)}},addUrls:{value:function(a,b){var c,d=[];for(c=0;c<a.length;c++)d.push(this.addUrl(a[c],b));return g.all(d)}},addUrl:{value:function(a,b){var c,e=g.defer(),h=this;return!b&&d&&d.application&&d.application.corpus&&d.application.corpus.url&&(this.debug("using corpus as base url"),b=d.application.corpus.url),a.indexOf(!1)?(c=a.replace("/messages.json",""),c.indexOf("/")>-1&&(c=c.substring(c.lastIndexOf("/"))),c=c.replace(/[^a-zA-Z-]/g,"").toLowerCase(),(!c||c.length<2)&&(c="default")):c="en",f.makeCORSRequest({method:"GET",url:b+"/"+a,dataType:"json"}).then(function(b){h.originalDocs=h.originalDocs||[],h.originalDocs.push(a),h.addMessagesToContextualizedStrings(c,b).then(e.resolve,e.reject).fail(function(a){console.error(a.stack,h),e.reject(a)})},function(a){h.warn("There werent any locales at this url"+b+" :( Maybe this database has no custom locale messages.",a)}).fail(function(a){console.error(a.stack,h),e.reject(a)}),e.promise}},addMessagesToContextualizedStrings:{value:function(a,b){var c=g.defer(),d=this;if(!b)return g.nextTick(function(){c.reject("The locales data was empty!")}),c.promise;!a&&b._id&&(a=b._id.replace("/messages.json",""),a.indexOf("/")>-1&&(a=a.substring(a.lastIndexOf("/"))),a=a.replace(/[^a-zA-Z-]/g,"").toLowerCase(),(!a||a.length<2)&&(a="default")),d.originalDocs=d.originalDocs||[],d.originalDocs.push(b),d.data=d.data||{};for(var e in b)b.hasOwnProperty(e)&&0!==e.indexOf("_")&&(d.data[a]=d.data[a]||{length:0},d.data[a][e]=b[e],d.data[a].length++);return g.nextTick(function(){c.resolve(d.data)}),c.promise}},save:{value:function(){var a=[];for(var b in this.data)if(this.data.hasOwnProperty(b)){this.debug("Requsting save of "+b);var c=new d(this.data[b]);c.dbname=this.dbname,this.debug("Will save locale save of ",c);var e=!!this.fossil;this.email?(this.debug(" via Git ",c),a.push(c.saveToGit({email:this.email,message:"Updated locale messages"},e))):(c.id=b+"/messages.json",this.debug("   via REST ",c),a.push(c.save(null,e)))}return g.allSettled(a)}}}),c.Contextualizer=k}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./../CORS":1,"./../FieldDBObject":4,"./ELanguages":60,"./elanguages.json":61,"./en/messages.json":62,"./es/messages.json":63,q:223}],60:[function(a,b,c){var d=a("./../Collection").Collection,e=a("./../FieldDBObject").FieldDBObject,f=function(a){this._fieldDBtype||(this._fieldDBtype="ELanguages"),this.debug("Constructing ELanguages ",a),d.apply(this,arguments)};f.prototype=Object.create(d.prototype,{constructor:{value:f},primaryKey:{value:"iso"},INTERNAL_MODELS:{value:{item:e}},sanitizeStringForPrimaryKey:{value:function(a){return a}}}),c.ELanguages=f},{"./../Collection":3,"./../FieldDBObject":4}],61:[function(a,b,c){b.exports=[{iso:"Non applicable",name:"NA",nativeName:"Non applicable"},{iso:"ab",name:"Abkhaz",nativeName:""},{iso:"aa",name:"Afar",nativeName:"Afaraf"},{iso:"af",name:"Afrikaans",nativeName:"Afrikaans"},{iso:"ak",name:"Akan",nativeName:"Akan"},{iso:"sq",name:"Albanian",nativeName:"Shqip"},{iso:"am",name:"Amharic",nativeName:""},{iso:"ar",name:"Arabic",nativeName:""},{iso:"an",name:"Aragonese",nativeName:"Aragons"},{iso:"hy",name:"Armenian",nativeName:""},{iso:"as",name:"Assamese",nativeName:""},{iso:"av",name:"Avaric",nativeName:" ,  "},{iso:"ae",name:"Avestan",nativeName:"avesta"},{iso:"ay",name:"Aymara",nativeName:"aymar aru"},{iso:"az",name:"Azerbaijani",nativeName:"azrbaycan dili"},{iso:"bm",name:"Bambara",nativeName:"bamanankan"},{iso:"ba",name:"Bashkir",nativeName:" "},{iso:"eu",name:"Basque",nativeName:"euskara"},{iso:"be",name:"Belarusian",nativeName:""},{iso:"bn",name:"Bengali",nativeName:""},{iso:"bh",name:"Bihari",nativeName:""},{iso:"bi",name:"Bislama",nativeName:"Bislama"},{iso:"bs",name:"Bosnian",nativeName:"bosanski jezik"},{iso:"br",name:"Breton",nativeName:"brezhoneg"},{iso:"bg",name:"Bulgarian",nativeName:" "},{iso:"my",name:"Burmese",nativeName:""},{iso:"ca",name:"Catalan; Valencian",nativeName:"Catal"},{iso:"ch",name:"Chamorro",nativeName:"Chamoru"},{iso:"ce",name:"Chechen",nativeName:" "},{iso:"ny",name:"Chichewa; Chewa; Nyanja",nativeName:"chiChea, chinyanja"},{iso:"zh",name:"Chinese",nativeName:""},{iso:"cv",name:"Chuvash",nativeName:" "},{iso:"kw",name:"Cornish",nativeName:"Kernewek"},{iso:"co",name:"Corsican",nativeName:"corsu"},{iso:"cr",name:"Cree",nativeName:""},{iso:"hr",name:"Croatian",nativeName:"hrvatski"},{iso:"cs",name:"Czech",nativeName:"esky"},{iso:"da",name:"Danish",nativeName:"dansk"},{iso:"dv",name:"Divehi; Dhivehi; Maldivian;",nativeName:""},{iso:"nl",name:"Dutch",nativeName:"Nederlands, Vlaams"},{iso:"en",name:"English",nativeName:"English",selected:!0},{iso:"eo",name:"Esperanto",nativeName:"Esperanto"},{iso:"et",name:"Estonian",nativeName:"eesti"},{iso:"ee",name:"Ewe",nativeName:"Eegbe"},{iso:"fo",name:"Faroese",nativeName:"froyskt"},{iso:"fj",name:"Fijian",nativeName:"vosa Vakaviti"},{iso:"fi",name:"Finnish",nativeName:"suomi"},{iso:"fr",name:"French",nativeName:"franais"},{iso:"ff",name:"Fula; Fulah; Pulaar; Pular",nativeName:"Fulfulde, Pulaar, Pular"},{iso:"gl",name:"Galician",nativeName:"Galego"},{iso:"ka",name:"Georgian",nativeName:""},{iso:"de",name:"German",nativeName:"Deutsch"},{iso:"el",name:"Greek, Modern",nativeName:""},{iso:"gn",name:"Guaran",nativeName:"Avae"},{iso:"gu",name:"Gujarati",nativeName:""},{iso:"ht",name:"Haitian; Haitian Creole",nativeName:"Kreyl ayisyen"},{iso:"ha",name:"Hausa",nativeName:"Hausa, "},{iso:"he",name:"Hebrew (modern)",nativeName:""},{iso:"hz",name:"Herero",nativeName:"Otjiherero"},{iso:"hi",name:"Hindi",nativeName:", "},{iso:"ho",name:"Hiri Motu",nativeName:"Hiri Motu"},{iso:"hu",name:"Hungarian",nativeName:"Magyar"},{iso:"ia",name:"Interlingua",nativeName:"Interlingua"},{iso:"id",name:"Indonesian",nativeName:"Bahasa Indonesia"},{iso:"ie",name:"Interlingue",nativeName:"Occidental"},{iso:"ga",name:"Irish",nativeName:"Gaeilge"},{iso:"ig",name:"Igbo",nativeName:"Ass Igbo"},{iso:"ik",name:"Inupiaq",nativeName:"Iupiaq, Iupiatun"},{iso:"io",name:"Ido",nativeName:"Ido"},{iso:"is",name:"Icelandic",nativeName:"slenska"},{iso:"it",name:"Italian",nativeName:"Italiano"},{iso:"iu",name:"Inuktitut",nativeName:""},{iso:"ja",name:"Japanese",nativeName:""},{iso:"jv",name:"Javanese",nativeName:"basa Jawa"},{iso:"kl",name:"Kalaallisut, Greenlandic",nativeName:"kalaallisut"},{iso:"kn",name:"Kannada",nativeName:""},{iso:"kr",name:"Kanuri",nativeName:"Kanuri"},{iso:"ks",name:"Kashmiri",nativeName:", "},{iso:"kk",name:"Kazakh",nativeName:" "},{iso:"km",name:"Khmer",nativeName:""},{iso:"ki",name:"Kikuyu, Gikuyu",nativeName:"Gky"},{iso:"rw",name:"Kinyarwanda",nativeName:"Ikinyarwanda"},{iso:"ky",name:"Kirghiz, Kyrgyz",nativeName:" "},{iso:"kv",name:"Komi",nativeName:" "},{iso:"kg",name:"Kongo",nativeName:"KiKongo"},{iso:"ko",name:"Korean",nativeName:""},{iso:"ku",name:"Kurdish",nativeName:"Kurd, "},{iso:"kj",name:"Kwanyama, Kuanyama",nativeName:"Kuanyama"},{iso:"la",name:"Latin",nativeName:"latine"},{iso:"lb",name:"Luxembourgish, Letzeburgesch",nativeName:"Ltzebuergesch"},{iso:"lg",name:"Luganda",nativeName:"Luganda"},{iso:"li",name:"Limburgish, Limburgan, Limburger",nativeName:"Limburgs"},{iso:"ln",name:"Lingala",nativeName:"Lingla"},{iso:"lo",name:"Lao",nativeName:""},{iso:"lt",name:"Lithuanian",nativeName:"lietuvi kalba"},{iso:"lu",name:"Luba-Katanga",nativeName:""},{iso:"lv",name:"Latvian",nativeName:"latvieu valoda"},{iso:"gv",name:"Manx",nativeName:"Gaelg, Gailck"},{iso:"mk",name:"Macedonian",nativeName:" "},{iso:"mg",name:"Malagasy",nativeName:"Malagasy fiteny"},{iso:"ms",name:"Malay",nativeName:"bahasa Melayu"},{iso:"ml",name:"Malayalam",nativeName:""},{iso:"mt",name:"Maltese",nativeName:"Malti"},{iso:"mi",name:"Mori",nativeName:"te reo Mori"},{iso:"mr",name:"Marathi (Marh)",nativeName:""},{iso:"mh",name:"Marshallese",nativeName:"Kajin Maje"},{iso:"mn",name:"Mongolian",nativeName:""},{iso:"na",name:"Nauru",nativeName:"Ekakair Naoero"},{iso:"nv",name:"Navajo, Navaho",nativeName:"Din bizaad, Dinkeh"},{iso:"nb",name:"Norwegian Bokml",nativeName:"Norsk bokml"},{iso:"nd",name:"North Ndebele",nativeName:"isiNdebele"},{iso:"ne",name:"Nepali",nativeName:""},{iso:"ng",name:"Ndonga",nativeName:"Owambo"},{iso:"nn",name:"Norwegian Nynorsk",nativeName:"Norsk nynorsk"},{iso:"no",name:"Norwegian",nativeName:"Norsk"},{iso:"ii",name:"Nuosu",nativeName:" Nuosuhxop"},{iso:"nr",name:"South Ndebele",nativeName:"isiNdebele"},{iso:"oc",name:"Occitan",nativeName:"Occitan"},{iso:"oj",name:"Ojibwe, Ojibwa",nativeName:""},{iso:"cu",name:"Old Church Slavonic",alternateNames:"Old Church Slavonic, Church Slavic, Church Slavonic, Old Bulgarian, Old Slavonic",nativeName:" "},{iso:"om",name:"Oromo",nativeName:"Afaan Oromoo"},{iso:"or",name:"Oriya",nativeName:""},{iso:"os",name:"Ossetian, Ossetic",nativeName:" "},{iso:"pa",name:"Panjabi, Punjabi",nativeName:", "},{iso:"pi",name:"Pli",nativeName:""},{iso:"fa",name:"Persian",nativeName:""},{iso:"pl",name:"Polish",nativeName:"polski"},{iso:"ps",name:"Pashto, Pushto",nativeName:""},{iso:"pt",name:"Portuguese",nativeName:"Portugus"},{iso:"qu",name:"Quechua",nativeName:"Runa Simi, Kichwa"},{iso:"rm",name:"Romansh",nativeName:"rumantsch grischun"},{iso:"rn",name:"Kirundi",nativeName:"kiRundi"},{iso:"ro",name:"Romanian, Moldavian, Moldovan",nativeName:"romn"},{iso:"ru",name:"Russian",nativeName:" "},{iso:"sa",name:"Sanskrit (Saskta)",nativeName:""},{iso:"sc",name:"Sardinian",nativeName:"sardu"},{iso:"sd",name:"Sindhi",nativeName:",  "},{iso:"se",name:"Northern Sami",nativeName:"Davvismegiella"},{iso:"sm",name:"Samoan",nativeName:"gagana faa Samoa"},{iso:"sg",name:"Sango",nativeName:"yng t sng"},{iso:"sr",name:"Serbian",nativeName:" "},{iso:"gd",name:"Scottish Gaelic; Gaelic",nativeName:"Gidhlig"},{iso:"sn",name:"Shona",nativeName:"chiShona"},{iso:"si",name:"Sinhala, Sinhalese",nativeName:""},{iso:"sk",name:"Slovak",nativeName:"slovenina"},{iso:"sl",name:"Slovene",nativeName:"slovenina"},{iso:"so",name:"Somali",nativeName:"Soomaaliga, af Soomaali"},{iso:"st",name:"Southern Sotho",nativeName:"Sesotho"},{iso:"es",name:"Spanish; Castilian",nativeName:"espaol, castellano"},{iso:"su",name:"Sundanese",nativeName:"Basa Sunda"},{iso:"sw",name:"Swahili",nativeName:"Kiswahili"},{iso:"ss",name:"Swati",nativeName:"SiSwati"},{iso:"sv",name:"Swedish",nativeName:"svenska"},{iso:"ta",name:"Tamil",nativeName:""},{iso:"te",name:"Telugu",nativeName:""},{iso:"tg",name:"Tajik",nativeName:", toik, "},{iso:"th",name:"Thai",nativeName:""},{iso:"ti",name:"Tigrinya",nativeName:""},{iso:"bo",name:"Tibetan Standard",alternateNames:"Tibetan Standard, Tibetan, Central",nativeName:""},{iso:"tk",name:"Turkmen",nativeName:"Trkmen, "},{iso:"tl",name:"Tagalog",alternateNames:"Wikang Tagalog,  ",nativeName:"Wikang Tagalog"},{iso:"tn",name:"Tswana",nativeName:"Setswana"},{iso:"to",name:"Tonga (Tonga Islands)",nativeName:"faka Tonga"},{iso:"tr",name:"Turkish",nativeName:"Trke"},{iso:"ts",name:"Tsonga",nativeName:"Xitsonga"},{iso:"tt",name:"Tatar",nativeName:", tatara, "},{iso:"tw",name:"Twi",nativeName:"Twi"},{iso:"ty",name:"Tahitian",nativeName:"Reo Tahiti"},{iso:"ug",name:"Uighur, Uyghur",nativeName:"Uyurq, "},{iso:"uk",name:"Ukrainian",nativeName:""},{iso:"ur",name:"Urdu",nativeName:""},{iso:"uz",name:"Uzbek",nativeName:"zbek, , "},{iso:"ve",name:"Venda",nativeName:"Tshivena"},{iso:"vi",name:"Vietnamese",nativeName:"Ting Vit"},{iso:"vo",name:"Volapk",nativeName:"Volapk"},{iso:"wa",name:"Walloon",nativeName:"Walon"},{iso:"cy",name:"Welsh",nativeName:"Cymraeg"},{iso:"wo",name:"Wolof",nativeName:"Wollof"},{iso:"fy",name:"Western Frisian",nativeName:"Frysk"},{iso:"xh",name:"Xhosa",nativeName:"isiXhosa"},{iso:"yi",name:"Yiddish",nativeName:""},{iso:"yo",name:"Yoruba",nativeName:"Yorb"},{iso:"za",name:"Zhuang, Chuang",nativeName:"Sa cue, Saw cuengh"}]},{}],62:[function(a,b,c){b.exports={application_title:{message:"LingSync beta",description:"The title of the application, displayed in the web store."},application_description:{message:"An on/offline fieldlinguistics database app which adapts to its user's I-Language.",description:"The description of the application, displayed in the web store."},locale_Close_and_login_as_LingLlama:{message:"Login as LingLlama",description:"button"},locale_Close_and_login_as_LingLlama_Tooltip:{message:"You can log in as LingLlama to explore the app pre-populated with data. There are also comments left by users to explain what widgets are for and how you can use them. If you're new to the app this is a great place to start after watching the videos. ",description:"tooltip"},locale_Username:{message:"Username:"},locale_Password:{message:"Password:"},locale_Sync_my_data_to_this_computer:{message:"Sync my data to this device"},locale_Welcome_to_FieldDB:{message:"Welcome to LingSync!"},locale_An_offline_online_fieldlinguistics_database:{message:"This app is part of a free, open source project developed collectively by field linguists and software developers to make a modular, user-friendly app which can be used to collect, search and share data, both online and offline."},locale_Welcome_Beta_Testers:{message:"<p>Welcome Beta Testers! Please sit back with a cup of tea and <a target='top' href='https://www.youtube.com/embed/videoseries?list=PL984DA79F4B314FAA'>watch this play list before you begin testing the app</a>. Leave us notes, bugs, comments, suggestions etc in the Contact Us/Bug Report form in the User Menu. Your feedback helps us prioritize what to fix/implement next!</p>"},locale_Welcome_Screen:{message:"<p>Curious what this is? <a target='top' href='https://www.youtube.com/embed/videoseries?list=PL984DA79F4B314FAA'>You can watch this play list to find out.</a>. You can find help and more info in the top right menu of the Corpus Dashboard.</p>"},locale_Create_a_new_user:{message:"Register"},locale_What_is_your_username_going_to_be:{message:"What is your username going to be?"},locale_Confirm_Password:{message:"Confirm Password:"},locale_Sign_in_with_password:{message:"Register"},locale_Warning:{message:"Warning!"},locale_Instructions_to_show_on_dashboard:{comment:"<p>Welcome! This is your Corpus dashboard. On the left side, there are Corpus and Elicitation Session quick-views, both of which you    can make full screen by clicking the icon on the top right corner. Full    screen shows you details of the Corpus and Elicitation Session. If this   is your first time seeing this message, you should change your corpus   title and description by clicking <i class=' icon-edit'></i>. You can hover over any    icon to see what the icon does. You should also change your session goals     and date for your first elicitation session.</p>    <p>For more help text, videos and userguide, click the <span class='caret'></span> on the top right corner of the app.     To more information about what a 'Corpus' is, click <i class=' icon-cogs resize-full'></i>.     It will show the corpus settings, which contains explanations of each component of a 'Corpus.'</p>    <p>This is the first draft of these instructions. Please help us make this better. <a href='https://docs.google.com/forms/d/18KcT_SO8YxG8QNlHValEztGmFpEc4-ZrjWO76lm0mUQ/viewform' target='_new'>Contact us</a> </p>",message:"<p>Welcome! This is your Corpus dashboard. If this is your first time seeing this message, please do the following: </p> <p><b>Corpus</b> On the left side, there is Corpus quick-view. Edit your corpus title and description by clicking <i class=' icon-edit'></i>. To see what Corpus consists of, click <i class=' icon-cogs resize-full'></i>. </p> <p><b>Elicitation Session</b> Below the Corpus quick-view, there is Elicitation Session quick-view. Edit the goal and date for your first elicitation session by clicking <i class=' icon-edit'></i>. Click <i class=' icon icon-resize-full'></i> to see more details of Elicitation Session. </p> <p> You can hover over any icon to see what the icon does. For more help text, videos and userguide, click the <span class='caret'></span> on the top right corner of the app. </p> <p>This is the first draft of these instructions. Please help us make this better. <a href='https://docs.google.com/forms/d/18KcT_SO8YxG8QNlHValEztGmFpEc4-ZrjWO76lm0mUQ/viewform' target='_new'>Contact us</a> </p>"},locale_elicitation_sessions_explanation:{message:"<p>Like in the real world, an Elicitation Session can have a variety of forms. For example: a 1 hour session with a language consultant, a 3 hour field methods class with several speakers, an extended conversation or narrative, or data from a file import. </p> <p>You can describe various aspects of an Elicitation Session such as date, goal/topic, consultant(s), etc. by clicking the <i class='icons icon-edit'></i> icon in Dashboard view. For additional options, click on the <i class='icon-calendar'></i> icon beside the session name in the list below.</p> <p>Any description you enter will be displayed in the list of Elicitation Sessions below to help you identify them. This information will also be automatically copied into every Datum that is associated with the Session, so that you can search for individual Datum by date, consultant, dialect, etc. </p>"},locale_datalists_explanation:{message:"<p>A Datalist is a collection of Datum that you put together for some reason. Some examples are: making a handout, sharing data with someone, exporting into another program, or simply keeping track of similar Datum for your research.</p> <p> Creating a Datalist is like making a bookmark to a set of custom search results. First, do a search for whatever you want the Datalist to be about. Then, if you don't want some of the results to be included in the Datalist, click the <i class='icon-remove-sign'></i> icon by any Datum to remove it. Finally, edit the title and description, and click the save button to create the Datalist.</p> <p>You can see your Datalists on the left side of your dashboard (click plus/minus to expand/minimize) or in the list below (double-click on a title to view details). </p><p>To see all your data, do a search with nothing in the search bar. If you have over 200 Datum in your corpus, this can be pretty slow, so you may prefer to search for a subset. In general, a Datalist with more than 100 Datum will take a few seconds to load.</p> <p> In the Datalist view, the Datum will appear in the colour of their current state (i.e. Checked with a consultant, To be checked, Deleted etc). You can make new states in the Datum State Settings on this page. </p>"},locale_permissions_explanation:{message:"<p>Permissions are where you give other people access to your corpus.</p><p>To add another team member, you need to know their username. Click the <i class='icons icon-edit'></i> icon at the top right and then come back to Permissions and click the 'See current team members' button. You can then add users by typing in their username by the appropriate group.</p> <ul><li>Admins can add other people to any group but not do anything with the data unless they are also writers/readers.</li> <li>Writers can enter new data, add comments, change Datum State from 'to be checked to 'checked' etc, but not see data that is already entered. </li><li>Readers can see data that is already entered in the app but not edit or comment on it. </li></ul><p>If you want someone to be able to both enter data and see existing data, add them as both a writer and a reader.</p><p>If you want to make your corpus public and findable on Google as recommended by EMLED data management best practices, type 'Public' in the 'Public or Private' field below.</p><p>You can, and should, encrypt any Datum containing sensitive information by clicking the <i class=' icon-unlock'></i> button at the bottom of the Datum. Encrypted Datums are shown as 'xxx xx xx xx' to all users, including on the web. If you want to see the contents of a confidential Datum, click on the <i class='icon-eye-open'></i> and enter your password. This will make the Datum visible for 10 minutes.</p>"},locale_datum_fields_explanation:{message:"<p>Datum Fields are fields where you can add information about your Datum. There fields are automatically detected when you import data, so if you have data already, you should import it to save you time configuring your corpus. </p> <p>By default, the app comes with 4 fields which it uses to create inter-linearized glosses (the pretty view which you are used to seeing in books and handouts). You can add any number of fields (we have tested using over 400 fields). </p> <p>In the Datum Edit view, the fields that are used most frequently in your corpus will automatically appear when you open a Datum, and you can click on <i class='icon-list-alt'> </i> to see the rare fields. </p><p>The fields in your corpus (shown below) are automatically available in search. You can choose to encrypt particular fields (e.g. utterance). If you mark a Datum as confidential, the encrypted fields will be encrypted in the database and masked from the user as 'xxx xx xxxxx'. For example, you may choose to not encrypt a lambda calculus field or a grammatical notes field, as these are usually purely a linguistic formalism and may not transmit any personal information which your consultants would like to keep confidential. </p><p> Each Datum Field has a help convention, which is the text you see below. Use this to help everyone remember what information goes in which field. Anyone who can enter data in your corpus can see these help conventions by clicking the <i class='icon-question-sign'></i> next to the Datum Field label in the Datum Edit view. </p><p>You can edit the help text by clicking <i class='icons icon-edit'></i> icon at the top right. These help conventions are also exported as a README.txt when you export your data, as recommended by EMELD data management best practices. </p>"},locale_conversation_fields_explanation:{message:"<p>Conversation Fields are fields which where you can add information about your Conversation. As defaults the conversation comes with 2 fields (audio and speakers), and each turn of the conversation (each Datum within it) comes with the usual 4 default datum fields.  You can add any number of fields here if they are relevant to the WHOLE conversation (ex: location, context, world knowledge, sociolinguistic variables).  The conversation fields in your corpus (shown below) are automatically available in the search. You can choose to encrypt particular fields (e.g. utterance). If you mark a Conversation as confidential, the encrypted fields will be encrypted in the database and masked from the user as 'xxx xx xxxxx'. For example, you may choose to not encrypt a 'location' field, but instead choose to encrypt a 'world knowledge' field as it may contain sensitive personal information which consultants would not want public. Each Conversation field can have a help convention, which is the text you see below. Your team members can see these help/conventions by clicking the <i class='icon-question-sign'></i> next to the Conversation field label in the Conversation Edit view. These help conventions are also exported as a README.txt when you export your data, as recommended by EMELD data management best practices. </p>"},locale_datum_states_explanation:{message:"<p>Datum States are used to keep track of whether the data is valid or invalid, for example, 'Checked' with a consultant, 'To be checked', 'Deleted' etc. </p> <p>Datum States can be as detailed as you choose. You can create your own Datum States for your own corpus to help you manage your team's data validation workflow (e.g. 'To be checked with Sophie,' 'Checked with Gladys').  You can assign colours to your Datum States, which will appear as the background colour of the Datum in any Datalist. </p> <p> If you flag a Datum as Deleted it won't show up in search results anymore, but a Datum in a corpus is never really deleted. It remains in the database complete with its change history so that you can review it at a later date. (In future we might add a button to allow users to 'empty the trash' and mass-delete old Datum from the system.) </p> "},locale_advanced_search_explanation:{message:"<p>Search errs on the side of including more results, rather than missing anything. </p> <p>For example, you can type 'nay' and search will find the morphemes 'onay', 'naya' etc. </p> <p>Search automatically creates a temporary list of data. If you enter new matching data, it will be added automatically this can be a handy way to see the data you have entered recently, as you enter data.. If you want to keep the list of data, click Save and a new DataList will be created. </p> <p>For now, search is offline, running on your device, but we would eventually like to have a more advanced search that works online, sorts results better, and could let you search for minimal pairs using features.</p>"},locale_New_User:{message:"New User"},locale_Activity_Feed_Your:{message:"Your Activity Feed"},locale_Activity_Feed_Team:{message:"Corpus Team Activity Feed"},locale_Refresh_Activities:{message:"Refresh activity feed to bring it up-to-date."},locale_Need_save:{message:" Need save:"},locale_60_unsaved:{message:"<strong>60% unsaved.</strong>"},locale_Recent_Changes:{message:"Recent Changes:"},locale_Need_sync:{message:"Need sync:"},locale_Differences_with_the_central_server:{message:"Differences with the central server:"},locale_to_beta_testers:{message:"These messages are here to communicate to users what the app is doing. We will gradually reduce the number of messages as the app becomes more stable. <p>You can close these messages by clicking on their x.</p>"},locale_We_need_to_make_sure_its_you:{message:"We need to make sure it's you..."},locale_Yep_its_me:{message:"Yep, it's me"},locale_Log_Out:{message:"Log Out"},locale_Log_In:{message:"Log In"},locale_User_Settings:{
message:"User Settings"},locale_Keyboard_Shortcuts:{message:"Keyboard Shortcuts"},locale_Corpus_Settings:{message:"Corpus Settings"},locale_Terminal_Power_Users:{message:"Power Users Backend"},locale_New_Datum:{message:"New Datum"},locale_New_menu:{message:"New"},locale_New_Conversation:{message:"New Conversation"},locale_New_Data_List:{message:"New Data List"},locale_New_Session:{message:"New Session"},locale_New_Corpus:{message:"New Corpus"},locale_Data_menu:{message:"Data"},locale_Import_Data:{message:"Import Data"},locale_Export_Data:{message:"Export Data"},locale_All_Data:{message:"All Data"},locale_All_Speakers:{message:"All (Native/Heritage) Speakers"},locale_All_Language_Consultants:{message:"All Language Consultants"},locale_All_Participants:{message:"All Participants"},locale_All_Users:{message:"All Users"},locale_All_Elicitation_Sessions:{message:"All Elicitation Sessions"},locale_All_Datalists:{message:"All Datalists"},locale_Save:{message:"Save"},locale_Title:{message:"Title:"},locale_Description:{message:"Description:"},locale_Copyright:{message:"Corpus Copyright:"},locale_License:{message:"Corpus License:"},locale_License_explanation:{message:"If you make a portion of your corpus available to other people, EMELD recommends that you document clearly your terms of use, and apply a license to enforce them. For easy to understand standard licenses, you can consult <a href='http://creativecommons.org/licenses/' target='_blank'>Creative Commons</a>. Creative Commons licenses are applied to most web/community owned/created data, be it Wikipedia or other popular content sharing websites and mobile apps."},locale_Terms_of_use:{message:"Corpus Terms of Use:"},locale_Terms_explanation:{message:"When you decide to make a portion of your corpus public, EMELD recommend that you cleary state your Terms of Use with your corpus. You can modify the sample of Terms of Use in the textbox below according to the policy of your project (be sure to discuss with other project members and affected parties before deciding on your terms of use). Please also try to choose a license which makes sense with your Terms of Use. For your reference, see also the terms of use for other corpora such as: <a href='http://www.aiatsis.gov.au/collections/muraread.html' target='_blank'>Mura</a>, <a href='http://www.paradisec.org.au/services.html' target='_blank'>PARADISEC</a>, <a href='http://linguistics.berkeley.edu/~survey/archive/terms-of-use.php' target='_blank'>Survey of California and Other Indian Languages</a> "},locale_Sessions_associated:{message:"Elicitation Sessions associated with this corpus"},locale_Datalists_associated:{message:"Datalists associated with this corpus"},locale_Permissions_associated:{message:"Permissions associated with this corpus"},locale_Datum_field_settings:{message:"Datum Field Settings"},locale_Conversation_field_settings:{message:"Conversation Field Settings"},locale_Encrypt_if_confidential:{message:"Encrypt if confidential:"},locale_Help_Text:{message:"Help Text:"},locale_Add:{message:"Add"},locale_Datum_state_settings:{message:"Datum State Settings"},locale_Green:{message:"Green"},locale_Orange:{message:"Orange"},locale_Red:{message:"Red"},locale_Blue:{message:"Blue"},locale_Teal:{message:"Teal"},locale_Black:{message:"Black"},locale_Default:{message:"Default"},locale_Elicitation_Session:{message:"Elicitation Session"},locale_Export:{message:"Export"},locale_Actions:{message:"Actions"},locale_Navigation:{message:"Navigation"},locale_Datum_Status_Checked:{message:"Mark Datum status as checked/verified with language consultant"},locale_Next_Datum:{message:"Next Datum"},locale_Previous_Datum:{message:"Previous Datum"},locale_Data_Entry_Area:{message:"Data Entry Area <small>(1-200 datum)</small>"},locale_Search:{message:"Type your search query, or hit enter to see all data"},locale_View_Profile_Tooltip:{message:"Click to view user's page"},locale_View_Public_Profile_Tooltip:{message:"View/edit your public user's page"},locale_Edit_User_Profile_Tooltip:{message:"Click to edit your user profile"},locale_Public_Profile_Instructions:{message:"This is your public user's page. You can edit it to change/remove information. This is what your team members can see when they click on your gravatar. All of this information (including your gravatar) can be different from the information in your private profile."},locale_Private_Profile_Instructions:{message:"This is your private profile."},locale_Edit_Public_User_Profile:{message:"Edit my public user's page"},locale_Close:{message:"Close"},locale_New_Corpus_Instructions:{message:"Edit the fields below to create a new corpus, or push ESC to enter more data in the current corpus"},locale_New_Corpus_Warning:{message:" The New Corpus functionality still needs more testing, this message will disappear when New Corpus is not experimental."},locale_Cancel:{message:"Cancel"},locale_Next:{message:"Next"},locale_Show:{message:"Show"},locale_per_page:{message:"per page"},locale_New_Session_Instructions:{message:"<p>Edit the fields below to create a new elicitation session, or push ESC to enter more data in the current session.</p>"},locale_Consultants:{message:"Consultant(s):"},locale_Goal:{message:"Goal:"},locale_When:{message:"When:"},locale_Save_And_Import:{message:"Save and Finish Importing"},locale_Import:{message:"Import"},locale_percent_completed:{message:"% completed."},locale_Import_Instructions:{comment:" <ol> <li>Type, or Drag and drop a file/text (csv, txt, tabbed, xml, text, eaf, sf) to the area indicated below.</li> <li>(Edit/type in the text area to correct information as needed.)</li> <li>Associate your corpus's existing default data fields with the appropriate columns by either dragging the colored datum fields, or by typing in the column header input box .</li> <li>Type in any other column headings that you want to keep in your data, the app will automatically add these to the corpus' default datum fields. This means that you can search through them to locate your data. Each row in the table will be come a 'datum' in your corpus database.</li> <li>Click on the Attempt Import button at any time to see what your data will look like in a interlinear glossed data list.</li> <li>Review the interlinear glossed data list which appears on the left to see if the import looks good.</li> <li>(Continue to edit the table cells as needed, click Attempt Import and review data list as many times as you would like until the import looks correct).</li> <li>When satisfied with the data list, click Save and your data will be imported into your corpus. A new elicitation session will be created using the date modified of the file you imported (if you want, you can edit this session later to add a more accurate goal discussing why the file was originally created), a new data list will also be created which contains all these data since it is likely that you grouped this data together into a file for a reason in the first place. You can find the resulting new default datum fields, session, and data list in your Corpus Settings page.</li><li>(Click on the home button to do something else while it imports your data in the background.)</li> </ol>",message:"Everyone's data is different. <a href='http://www.facebook.com/LingSyncApp'>You might know some fellow users who might be able to help you import yours: </a>"},locale_Import_First_Step:{message:"<p>Step 1: Drag & drop, copy-paste or type your data into the text area, or select audio/video file(s) from your computer. Yes, you can edit the data inside the text area.</p>"},locale_Import_Second_Step:{message:"<p>Step 2: Drag and drop or type the field names in column headers. Edit data in the table as needed.</p>"},locale_Import_Third_Step:{message:"<p>Step 3: The imported data will look like this. Edit in the table or the text area above as needed. Edit the datalist title and description, and the eliciation session section before finishing import. </p>"},locale_Drag_Fields_Instructions:{message:"<p>Drag (or type) the coloured datum fields to the column headings which match. Type in any additional column headings which you would like to keep as datum fields. The columns will become default datum fields in your corpus database and will also become fields that you can search through to locate your data. Each row will become a 'datum' in your corpus database.</p>"},locale_Add_Extra_Columns:{message:"Insert Extra Columns"},locale_Attempt_Import:{message:"Preview Import"},locale_LaTeX_Code:{message:"LaTeX Code:"},locale_Unicode_Instructions:{message:"By default this is also a keyboard shortcut to type this character in a datum field. To customize the shortcut:"},locale_Remove_Unicode:{message:"Remove Unicode"},locale_Unicode:{message:"Unicode"},locale_Drag_and_Drop:{message:"<small>Drag and Drop</small>"},locale_AND:{message:"AND"},locale_OR:{message:"OR"},locale_Advanced_Search:{message:"Advanced Search"},locale_Advanced_Search_Tooltip:{message:"Advanced Search allows you to use your corpus-wide datum fields or session details to search for datum, using either AND or OR with substring match."},locale_User_Profile:{message:"User Profile"},locale_Private_Profile:{message:"User Profile"},locale_Public_Profile:{message:"Public Profile"},locale_Email:{message:"Email:"},locale_Research_Interests:{message:"Research Interests:"},locale_Affiliation:{message:"Affiliation:"},locale_Corpora:{message:"Corpora:"},locale_Gravatar:{message:"Gravatar"},locale_Gravatar_URL:{message:"Gravatar URL:"},locale_Firstname:{message:"First name:"},locale_Lastname:{message:"Last name:"},locale_Skin:{message:"Skin:"},locale_Background_on_Random:{message:"Background on Random"},locale_Transparent_Dashboard:{message:"Transparent Dashboard"},locale_Change_Background:{message:"Change Background"},locale_Number_Datum:{message:"Number of Datum to appear at a time:"},locale_Help_Text_Placeholder:{message:"Put a help text or your team data entry conventions for this field here (optional)."},locale_Add_Placeholder:{message:"Add...."},locale_Datalist_Description:{message:"You can use Datalists to create handouts or to prepare for sessions with consultants, or to share with collaborators."},locale_Add_Tag:{message:"New Tag..."},locale_Drag_and_Drop_Placeholder:{message:"Drag and drop, copy-paste or type your data here."},locale_Paste_Type_Unicode_Symbol_Placeholder:{message:"Paste/type unicode symbol"},locale_TIPA_shortcut:{message:"TIPA/keyboard shortcut"},locale_Show_Activities:{message:"Show Activities"},locale_Hide_Activities:{message:"Hide Activities"},locale_Show_Dashboard:{message:"Show dashboard with data entry form"},locale_Save_on_this_Computer:{message:"Save on this device."},locale_Sync_and_Share:{message:"Sync and share with team"},locale_Show_Readonly:{message:"Show read only"},locale_Show_Fullscreen:{message:"Show full screen"},locale_Add_New_Datum_Field_Tooltip:{message:"Add new datum field"},locale_Add_New_Conversation_Field_Tooltip:{message:"Add new conversation field"},locale_Add_New_Datum_State_Tooltip:{message:"Add new datum state"},locale_Show_in_Dashboard:{message:"Show in dashboard"},locale_Edit_corpus:{message:"Edit Corpus"},locale_Show_corpus_settings:{message:"Show Corpus Settings"},locale_Drag_and_Drop_Audio_Tooltip:{message:"Drag and drop audio over the audio player to attach an audio file. Drag and drop option for YouTube videos coming soon."},locale_Play_Audio:{message:"Play audio"},locale_Play_Audio_checked:{message:"Play audio of checked items"},locale_Remove_checked_from_datalist_tooltip:{message:"Remove checked datum from this data list (they will still be in the corpus). "},locale_Plain_Text_Export_Tooltip:{message:"Export as plain text/Copy to clipboard"},locale_Plain_Text_Export_Tooltip_checked:{message:"Export as plain text/Copy checked items to clipboard"},locale_Duplicate:{message:"Duplicate datum to create a minimal pair"},locale_Encrypt:{message:"Make this datum confidential"},locale_Encrypt_checked:{message:"Make checked items confidential"},locale_Decrypt_checked:{message:"Remove confidentiality from checked items (Warning: this will save them as decrypted in the database). If you just want to unmask them so you can edit edit them, click on the eye instead."},locale_Decrypt:{message:"Remove confidentiality from this datum (Warning: this will save it as decrypted in the database). If you just want to unmask it so you can edit edit it, click on the eye instead."},locale_Show_confidential_items_Tooltip:{message:"Unmask confidential/encrypted data so that it can be edited and read for the next 10 minutes."},locale_Hide_confidential_items_Tooltip:{message:"Return to masked view of confidential/encrypted data"},locale_Edit_Datalist:{message:"Edit Data List"},locale_Export_checked_as_LaTeX:{message:"Export checked as LaTeX"},locale_Export_checked_as_CSV:{message:"Export checked as CSV"},locale_Hide_Datalist:{message:"Hide datalist"},locale_Show_Datalist:{message:"Show datalist"},locale_Edit_Datum:{message:"Edit Datum"},locale_See_Fields:{message:"Hide/Show infrequent fields"},locale_Add_Tags_Tooltip:{message:"Add a tag to this datum. Tags can be used to categorize datum, count how many datum of each tag you have, and search datum."},locale_Edit_Session:{message:"Edit Session"},locale_Show_Unicode_Palette:{message:"Show Unicode Palette"},locale_Hide_Unicode_Palette:{message:"Hide Unicode Palette"},locale_Add_new_symbol:{message:"Add new symbol"},locale_Public_or_Private:{message:"Public or Private:"},locale_Insert_New_Datum:{message:"Insert a new datum on top of the dashboard center"},locale_LaTeX:{message:"Export datum as LaTeX"},locale_CSV_Tooltip:{message:"Export datum as CSV"},locale_of:{message:"of"},locale_pages_shown:{message:"pages shown"},locale_More:{message:"More"}}},{}],63:[function(a,b,c){b.exports={application_title:{message:"iCampo beta"},application_description:{message:"Un aplicacion de coleccin de datos linguisticos."},locale_Close_and_login_as_LingLlama:{message:"Entrar como LingLlama",description:"button"},locale_Close_and_login_as_LingLlama_Tooltip:{message:"TODO translate You can log in as LingLlama to explore the app pre-populated with data. There are also comments left by users to explain what widgets are for and how you can use them. If you're new to FieldDB this is a great place to start after watching the videos.",description:"tooltip"},locale_Username:{message:"Usuario:"},locale_Password:{message:"Contrasea:"},locale_Sync_my_data_to_this_computer:{message:"Sincronisa mis datos con esta computadora"},locale_Welcome_to_FieldDB:{message:"Bienvenido a iCampo! <small>beta</small>"},locale_An_offline_online_fieldlinguistics_database:{message:"Un aplicacion de coleccion de datos linguisticos...gratis y OpenSource"},locale_Welcome_Beta_Testers:{message:"Bienvenidos! Por favor <a target='top' href='https://www.youtube.com/embed/videoseries?list=PL984DA79F4B314FAA'>vea estos tutoriales antes de empezar de probar iCampo</a>. Dejanos notas, comentarios, sugerencias en la forma abajo."},locale_Create_a_new_user:{message:"Crear un nuevo usuario"},locale_What_is_your_username_going_to_be:{message:"Que quieres por su usuario?"},locale_Confirm_Password:{message:"Confirme su contrasea:"},locale_Sign_in_with_password:{message:"Registrar"},locale_Warning:{message:"Aviso!"},locale_Instructions_to_show_on_dashboard:{message:"TODO translate instructions"},locale_elicitation_sessions_explanation:{message:"<p>TODO translate An Elicitation Session is very similar to an elicitation session in the real world. This could be a 1-hour Session with one language consultant, or a 3-hour field methods class, or data from a file import. Generally an elicitation session happens on a specific day, or across a few days, you can write a date or text in the 'dateElicited' field. Often we have a goal set out when we meet for an elicitation Session, if you want, you can put this into the 'Goal' field of the Sessions and it will appear in the Session quick links below. An Elicitation Session has many fields which you can edit by clicking on the <i class='icon-calendar'></i> icons in the app to see the details. These fields are information which is common to all datum elicited that day for example, the dialect, perhaps the language consultants present the date etc. The Session fields are copied into the Datum that were elicited during that Session, this makes it possible to search for Datum containing a particular dialect and/or speaker etc. </p>"},locale_datalists_explanation:{message:"<p>TODO translate A Datalist is a collection of Datum that you put together for a reason, it could be to prepare  a handout, to share some of your data with someone, to export into another program or simply to keep track of similar Datum for your research. You could think of Datalists as curated search results that the app remembers for you. Datalists have titles and descriptions, their titles appear as links below. You can click on the links to see the details of the  Datalist. In the Datalist view, the Datum will appear in the colour of their current state (i.e. Checked with a consultant, To be checked, Deleted etc). You can make new states in the Datum State Settings on this page. You can create new Datalists by doing a search for what you want to be in the Datalist. You can refine the Datalist items by clicking on <i class='icon-remove-sign'></i> to remove Datum in the Datalist view. The Datalist view is normally on the left side of your dashboard, you can see it by double clicking on a Datalist in the list below. If you want to see all your data click on the 'All Data' link below, this will load all your data into a Datalist view. If you have over 200 Datum in your corpus, this can be pretty slow. If you have a large corpus you may prefer searching for a subset of your data rather than skimming all of it at once. In general, any Datalist with more than 100 Datum takes a few seconds to load and display all the Datum it contains. </p>"},locale_permissions_explanation:{message:"<p>TODO translate Permissions are where you give your team members access to your corpus. Add users to the 'Admin' group if you want to let them add other team members. Add users to the 'Writers' group if you want to let them add comments, enter new data, change Datum State from 'to be checked to 'checked' etc. For example, if you would like to allow your language consultant to enter or check data, you can put them in the 'writers' group. Add users to the 'Readers' group if you want them to be able to see your data, but not modify it. For example, you might want to share your data with other researchers outside of your team, but you might not want them to leave comments or modify , or mass-export the data. If you want to make your corpus public and findable on Google as recommended by EMLED data management best practices, click the Public checkbox. Don't worry, if your corpus contains confidential or personal information you can, and should, encrypt the Datum containing sensitive information using the <i class=' icon-unlock'></i> buttons. Data which are encrypted are shown as 'xxx xx xx xx' to all users, including on the web. If you want to see the contents of the confidential datum you have to click on the <i class='icon-eye-open'></i>, it will prompt you for your password to make sure you are really you. This will make confidential data visible for 10 minutes.</p>"},locale_datum_fields_explanation:{message:"<p>TODO translate Datum Fields are fields which where you can add information about your Datum. There fields are automatically detected when you import data, so if you have data already, you should import it to save you time configuring your corpus. As defaults the app comes with 4 fields which it uses to create inter-linear-glossed text views (i.e. pretty view which you are used to seeing in books and handouts). You can add any number of fields (we have tested using over 400 fields). In the Datum Edit view, the fields that are used most frequently in your corpus will automatically appear when you open a Datum, and you can click on <i class='icon-list-alt '> </i> to see the rare fields. The fields in your corpus (shown below) are automatically available in the search. You can choose to encrypt particular fields (e.g. utterance). If you mark a Datum as confidential, the encrypted fields will be encrypted in the database and masked from the user as 'xxx xx xxxxx'. For example, you may choose to not encrypt a lambda calculus field, or a grammatical notes field, as these are usually purely a linguistic formalism and may not transmit any personal information which your consultants would like to keep confidential. Each Datum Fields can have a help convention, which is the text you see below. Your team members can see these help/conventions by clicking the <i class='icon-question-sign'></i> next to the Datum Field label in the Datum Edit view. These help conventions are also exported as a README.txt when you export your data, as recommended by EMELD data management best practices. </p>"},locale_datum_states_explanation:{message:"<p>TODO translate Datum States are used to keep track of whether the data is valid or invalid, for example, 'Checked' with a consultant, 'To be checked', 'Deleted' etc. Datum States can be as detailed as you choose. You can create your own Datum States for your own corpus to help you manage your team's data validation workflow (e.g. 'To be checked with Sophie,' 'Checked with Gradys').  You can assign colours to your Datum States, these colours will appear in your data list. You can flag a Datum as Deleted and it won't show up in search results. A Datum in a corpus is never really deleted, it remains in the database complete with its change history so that you can review it at a later date.  (In future we might add a button to allow users to 'empty the trash' and mass-delete old Datum from the system.) </p> "},locale_advanced_search_explanation:{message:"<p>TODO translate There are two ways to access Search, you can type in your query in the search box which is always present on the top left of the screen, or you can click on the button next to it to get to the Advanced Search. Search is very important to field linguists, this is why we made the Search very powerful, and we are planning on making it more powerful in the future. You can type any string of characters in the Datum or Session Fields below. The search will look through the datum of your corpus, and find datum which contain that substring, this means you can type 'nay' and you will get morphemes 'onay' 'naya' etc. While this is not ideal for finding allomorphs, it works pretty well. Right now the search is happening on your computer, offline. In the future we will be adding a 'lexicon webservice' which will work on indexing your morphemes glosses etc to make search faster, but also smarter by build a more linguistically informed indexes of your data so that you can use linguistic constructs to search for your data as you do naturally when you search with your eyes, rather than with a database. We also have planned a 'Dream' module for phonological search that essentially uses a feature geometry ontology to let you search for minimal pairs. A search automatically creates a temporary Datalist, which appears below the Session quick view on the left side of the screen. You can choose to rename and save this Datalist if created a collection of data that you wanted. You can also leave this search data list open, if you enter new datum which matched your search query that appears in the top left corner, they will automatically appear in the search data list too. This can be handy for you to see datum around a certain phenomena while you are entering new data. If your search query is hard to formulate to get all the examples you need, you can search for nothing (leave all fields blank) and it will return all your data as a new Datalist. In general we have decided to implement search such that it errs on the side of high recall, i.e. that it finds all relevant examples, but also returns some garbage, rather than high precision, i.e. that it finds only exact examples, but misses some relevant ones. Currently the search results are not sorted by relevancy to the query. Once we have a proper 'lexicon webservice' we will have more measures of relevancy and will be able to return results and their relevancy scores. </p>"},locale_New_User:{message:"Usuario Nuevo"},locale_Activity_Feed_Your:{message:"TODO translate Your Canal de Actividad"},locale_Activity_Feed_Team:{message:"TODO translate Corpus Team Canal de Actividad"},locale_Refresh_Activities:{message:"TODO translate"},locale_View_Profile_Tooltip:{message:"TODO translate Click to view user's page"},locale_View_Public_Profile_Tooltip:{message:"TODO translate View/edit your public user's page"},locale_Edit_User_Profile_Tooltip:{message:"TODO translate Click to edit your user profile"},locale_Public_Profile_Instructions:{message:" TODO translateThis is your public profile, you can edit it to change/remove information. This is what people can see when they click on your gravatar."},locale_Private_Profile_Instructions:{message:"TODO translate This is your private profile, only you members on your team can see it."},locale_Edit_Public_User_Profile:{message:"TODO translate Edit My Public Profile"},locale_Need_save:{message:"Se ocupa guadar:"},locale_60_unsaved:{message:"<strong>60% sin guardar.</strong>"},locale_Recent_Changes:{message:"Cambios Recientes:"},locale_Need_sync:{message:"Se ocupa sincronisar:"},locale_Differences_with_the_central_server:{message:"Diferencias con el servidor central:"},locale_to_beta_testers:{message:"Estos mensajes son para comunicar con los provadores que hace la aplicacin. Los mensajes se desaparesern cuando la aplicacin esta mas estable. <p>Puedes cerrar los mensajes con el x.</p>"},locale_We_need_to_make_sure_its_you:{message:"Ocupamos asegurar que es ustd..."},locale_Yep_its_me:{message:"Si, soy yo!"},locale_Log_Out:{message:"Salir"},locale_Log_In:{message:"Entrar"},locale_User_Profile:{message:"Perfil de Usuario"},locale_Private_Profile:{message:"TODO translate Perfil Privada"},locale_Public_Profile:{message:"TODO translate Perfil Publico"},locale_User_Settings:{message:"Configuracin de Usuario"},locale_Keyboard_Shortcuts:{message:"Funciones rpidas de teclado"},locale_Corpus_Settings:{message:"Configuracin de Corpus"},locale_Terminal_Power_Users:{message:"Terminal"},locale_New_Datum:{message:"Dato Nuevo"},locale_New_menu:{message:"Nuevo"},locale_New_Data_List:{message:"Lista de Datos Nuevo"},locale_New_Session:{message:"Sesin Nuevo"},locale_New_Corpus:{message:"Corpus Nuevo"},locale_Data_menu:{message:"Datos"},locale_Import_Data:{message:"Importe de Datos"},locale_Export_Data:{message:"Exporte de Datos"},locale_Save:{message:"Guadar"},locale_Title:{message:"Ttulo:"},locale_Description:{message:"Descripcin:"},locale_Sessions_associated:{message:"Sesines de Elicitacin asociados con el corpus"},locale_Datalists_associated:{message:"Listas de datos asociados con el corpus"},locale_Permissions_associated:{message:"Permisos asociados con el corpus"},locale_Datum_field_settings:{message:"Configuracin de los detailles de datos"},locale_Encrypt_if_confidential:{message:"Encripta si es confidencial:"},locale_Help_Text:{message:"Texto de Ayuda:"},locale_Add:{message:"Aadir"},locale_Datum_state_settings:{message:"Configuracin de Estado de Datos"},locale_Green:{message:"Verde"},locale_Orange:{message:"Naranjado"},locale_Red:{message:"Rojo"},locale_Blue:{message:"Azul"},locale_Teal:{message:"Verde Azulado"},locale_Black:{message:"Negro"},locale_Default:{message:"Gris"},locale_Elicitation_Session:{message:"Sesin de Elicitacin"},locale_Export:{message:"Exportar"},locale_Actions:{message:"Accines"},locale_Navigation:{message:"Navegacin"},locale_Datum_Status_Checked:{message:"TODO translate Mark Datum status as checked/verified with language consultant"},locale_Next_Datum:{message:"Prximo Dato"},locale_Previous_Datum:{message:"ltimo Dato"},locale_Data_Entry_Area:{message:"TODO translate Data Entry Area <small>(1-5 datum)</small>"},locale_Search:{message:"Bzqueda"},locale_Close:{message:"Cerrar"},locale_New_Corpus_Instructions:{message:"Edite la forma abajo para crear un nuevo corpus, o presione ESC para entrar ms datos en el corpus presente."},locale_New_Corpus_Warning:{message:"La funcionalidad del corpus nuevo an necesita ms pruebas, este mensaje desaparecer cuando Corpus Nuevo no es experimental."},locale_Cancel:{message:"Cancel"},locale_Next:{message:"Prximo"},locale_Show:{message:"Mostrar"},locale_per_page:{message:"por pagina"},locale_New_Session_Instructions:{message:"<p> Edite los forma abajo para crear una sesin, o presionar ESC para entrar ms datos en la sesin presente. </ p> "},locale_Consultants:{message:"Consultor(es):"},locale_Goal:{message:"Objectivo:"},locale_When:{message:"Fecha:"},locale_Save_And_Import:{message:"Guardar y Terminar de Importar"},locale_Import:{message:"Importar"},locale_percent_completed:{message:"% completo."},locale_Import_Instructions:{message:" <ol> <li> Jalar y Soltar un archivo (csv, txt, tabed, xml, text) a la zona abajo..</li> <li>(Modificar su informacin como necesario.)</li> <li> Jalar o escribe los detailles de datos arriba de los columnos que coinciden. Las columnas se convertirn en filas de su pagina de datos. .</li> <li>Precionar el botn Intenta Importar.</li> <li>Revisa la lista de datos y averigua que su importe se ve bien. </li> <li>Modifica la tabla como necesario, oprime Intentar Importar cuando la lista esta listo, puede hacer este paso las veces que quiere. </li> <li>Cuando esta sastifecho con la lista de datos, oprime Guadar y su lista de datos seran importados a su corpus y un nuevo lista de datos ser creado. </li> </ol>"},locale_Drag_Fields_Instructions:{message:"TODO translate Drag (or type) the colored datum fields to the column headings which match, type in any additional column headings which you would like to keep as datum fields. The columns will become searchable fields in your database."},locale_Add_Extra_Columns:{message:" Agrega Columnas Extras"},locale_Attempt_Import:{message:"Intenta Importar"},locale_LaTeX_Code:{message:"Codigo de LaTeX:"},locale_Unicode_Instructions:{message:"Esto es un funcin rpida de teclado para entrar esta letra en un fila de datos. Para cambiar el funcin:"},locale_Remove_Unicode:{message:"Quite Unicode"},locale_Unicode:{message:"Unicode"},locale_Drag_and_Drop:{message:"<small>Jalar y Soltar</small>"},locale_AND:{message:"Y"},locale_OR:{message:"O"},locale_Advanced_Search:{message:"Bsqueda Advanzada"},locale_Advanced_Search_Tooltip:{message:"Bsqueda Advanzada allows you to use your corpus-wide datum fields or session details to search for datum, using either AND or OR with substring match."},locale_Email:{message:"Correo Electronico:"},locale_Research_Interests:{message:"Intereses de Investigacin"},locale_Affiliation:{message:"Afiliacin"},locale_Corpora:{message:"Corpora"},locale_Gravatar:{message:"Gravatar"},locale_Gravatar_URL:{message:"Gravatar URL"},locale_Firstname:{message:"Primer nombre:"},locale_Lastname:{message:"Apellido:"},locale_Skin:{message:"Foro:"},locale_Background_on_Random:{message:"Aleatorio de Foro"},locale_Transparent_Dashboard:{message:"Tablero Transparente"},locale_Change_Background:{message:"Cambiar Foro"},locale_Number_Datum:{message:"Numbero de Datos a la vez:"},locale_Add_Placeholder:{message:"Aadir...."},locale_Datalist_Description:{message:"Se puede usar las lista de datos para preparar para sesiones con consultantes o compartir con colaboradores."},locale_Add_Tag:{message:"Etiqueta Nueva..."},locale_locale_Help_Text:{message:"TODO this should be merged with locale_Help_Text?  Se puede incluir text de ayuda aqui (opcional)"},locale_Drag_and_Drop_Placeholder:{message:"Jale y Suelta achivos o textos aqui!"
},locale_Paste_Type_Unicode_Symbol_Placeholder:{message:"Tecla o pega smbulo de unicode"},locale_TIPA_shortcut:{message:"Funcin rapida de teclado"},locale_Show_Activities:{message:"Mostrar actividades"},locale_Hide_Activities:{message:"Esconder actividades"},locale_Show_Dashboard:{message:"Mostrar Tablero"},locale_Save_on_this_Computer:{message:"Guardar en la computadora"},locale_Sync_and_Share:{message:"Sincronizar y compartir con el equipo"},locale_Show_Readonly:{message:"Mostrar en forma para leer "},locale_Show_Fullscreen:{message:"Mostrar en pantalla completa "},locale_Add_New_Datum_Field_Tooltip:{message:"Aadir un nuevo detaille de dato"},locale_Add_New_Datum_State_Tooltip:{message:"Aadir un estado de dato"},locale_Show_in_Dashboard:{message:"Mostrar en Tablero"},locale_Edit_corpus:{message:"Edita Corpus"},locale_Show_corpus_settings:{message:"Mostrar Configuracin de Corpus"},locale_Drag_and_Drop_Audio_Tooltip:{message:"TODO translate Drag and drop audio over the audio player to attach an audio file. You can also drag and drop a YouTube video URL to attach a YouTube video instead."},locale_Play_Audio:{message:"Tocar audio"},locale_Plain_Text_Export_Tooltip:{message:"TODO translate Export as plain text/Copy to clipboard"},locale_Plain_Text_Export_Tooltip_checked:{message:"TODO translate Export as plain text/Copy checked items to clipboard"},locale_Duplicate:{message:"Duplicar Dato por hacer un contraste miniml"},locale_Encrypt:{message:"Encriptar/Decriptar"},locale_Encrypt_checked:{message:"TODO translate Make checked items confidential"},locale_Decrypt_checked:{message:"TODO translate Remove confidentiality from checked items (Warning: this will save them as decrypted in the database). If you want them to stay confidential and just want to edit them, click on the eye instead."},locale_Decrypt:{message:"TODO translate Remove confidentiality from this datum (Warning: this will save it as decrypted in the database). If you want it to stay confidential and just want to edit it, click on the eye instead."},locale_Show_confidential_items_Tooltip:{message:"TODO translate Unmask confidential/encrypted items so that they can be edited and read for the next 10 minutes."},locale_Hide_confidential_items_Tooltip:{message:"TODO translate Return to masked view of confidential/encrypted datum"},locale_Edit_Datalist:{message:"Editar lista de datos"},locale_Export_checked_as_LaTeX:{message:"Exportar lista de datos seleccionados en formato LaTeX"},locale_Export_checked_as_CSV:{message:"Exportar lista de datos seleccionados en formato CSV"},locale_Hide_Datalist:{message:"Esconder lista de datos"},locale_Show_Datalist:{message:"Mostrar lista de datos"},locale_Edit_Datum:{message:"Editar Datos"},locale_See_Fields:{message:"TODO translate Hide/Show infrequent fields"},locale_Add_Tags_Tooltip:{message:"Aadir etiquetas"},locale_Edit_Session:{message:"Editar Sesin"},locale_Show_Unicode_Palette:{message:"Mostrar los Unicodes"},locale_Hide_Unicode_Palette:{message:"Esconder los Unicodes"},locale_Add_new_symbol:{message:"Aadir un smbulo nuevo"},locale_Public_or_Private:{message:"Publico o Privado:"},locale_Play_Audio_checked:{message:"Tocar audio de los seleccionados"},locale_Remove_checked_from_datalist_tooltip:{message:"TODO translate los seleccionados"},locale_Insert_New_Datum:{message:"Insertar un nuevo dato arriba"},locale_LaTeX:{message:"Exportar dato en formato LaTeX"},locale_CSV_Tooltip:{message:"Exportar dato en formato CSV "},locale_of:{message:"de"},locale_pages_shown:{message:"pagnas mostradas"},locale_More:{message:"Ms"}}},{}],64:[function(require,module,exports){var debugMode=!1,MapReduceFactory=function(options){options=options||{filename:"",map:null,reduce:null},options.rows=options.rows||[];var debug=function(){},sum=function(a){return debug("summing ",a),a&&a.reduce?a&&"number"!=typeof a[0]?(debug("using number of values "+a.length),a.length):a.reduce(function(a,b){return debug("adding "+a+" "+b),a+b}):(debug("this isn't an array"),a)},count=function(a,b,c){return debug("counting"+a),c?(debug("suming "+b),sum(b)):(debug("count  "+b.length),b.length)};if(options.emit=options.emit||function(a,b){debugMode&&debug(options),options.rows.push({key:a,value:b})},options._count=options._count||count,options.group=options.group||function(a){debugMode&&debug(options),options.reduce=options.reduce||options._count,a=a||options.rows;var b={};a.map(function(a){var c=a.key,d=a.value;"string"!=typeof c&&(c=JSON.stringify(c)),"string"!=typeof d&&(d=JSON.stringify(d)),b[c]?b[c].push(d):b[c]=[d]}),debug("regrouped ",b);var c=!1,d=[];for(var e in b)b.hasOwnProperty(e)&&d.push({key:e,value:options.reduce(e,b[e],c)});return debug("reduced ",d),"[object Array]"===Object.prototype.toString.call(d.value)&&(c=!0,d=d.map(function(a){return a.value=options.reduce(null,a.value,c),a})),debug("re-reduced ",d),{rows:d.sort(function(a,b){return a.key-b.key})}},options.customMap=function(doc,emit,rows){if(rows=rows||options.rows||[],emit)try{eval("options.map = "+options.map.toString()+";"),options.mustRescopeEmit=!0,debug("customizing emit")}catch(e){console.warn("Probably running in a Chrome app or other context where eval is not permitted. Using global emit and results for options")}if(options.map(doc),options.mustRescopeEmit)try{emit=options.emit,eval("options.map = "+options.map.toString()+";"),options.mustRescopeEmit=!1,debug("rescoped emit")}catch(e){console.warn("Probably running in a Chrome app or other context where eval is not permitted. Using global emit and results for options")}else debug("not rescoping emit, already using the default");return{rows:rows}},!options.map&&options.mapFilePath)try{options.mapString=require(options.mapFilename)[options.filename]}catch(exception){debug("Unable to load the map reduce "+options.mapFilePath,exception.stack)}if(!options.map&&options.mapString)try{var emit=options.emit;eval("options.map = "+options.mapString.toString()+";")}catch(exception){console.log("Unable to parse the map reduce in this context, most likely eval is not permitted. (The app will function normally, you just can't run the map reduces in a custom scope.) "),options.map=function(){options.emit("error","unable to load map reduce")}}if(!options.reduce&&options.reduceString)try{eval("options.reduce = "+options.reduceString.toString()+";")}catch(exception){console.log("Unable to parse the map reduce in this context, most likely eval is not permitted. (The app will function normally, you just can't run the map reduces in a custom scope.) ")}return options};exports.MapReduceFactory=MapReduceFactory},{}],65:[function(a,b,c){var d=a("./../FieldDBObject").FieldDBObject,e=a("./../user/Users").Users,f=function(a){this._fieldDBtype||(this._fieldDBtype="Permission"),this.debug("Constructing Permission ",a),d.apply(this,arguments)};f.prototype=Object.create(d.prototype,{constructor:{value:f},INTERNAL_MODELS:{value:{users:e}},length:{get:function(){return this.users&&this.users.length?this.users.length:0}},map:{get:function(){if(this.users&&"function"==typeof this.users.map){var a=this;return function(b){return this.users.map.apply(a.users,[b])}}return void 0}}}),c.Permission=f},{"./../FieldDBObject":4,"./../user/Users":77}],66:[function(a,b,c){var d=a("./../Collection").Collection,e=a("./Permission").Permission,f=a("./../user/Users").Users,g=a("./../CORS").CORS,h=a("q"),i=function(a){this._fieldDBtype||(this._fieldDBtype="Permissions"),this.debug("Constructing Permissions ",a),this.cacheTimeLength=1e3,d.apply(this,arguments)};i.prototype=Object.create(d.prototype,{constructor:{value:i},INTERNAL_MODELS:{value:{item:e,usersNotOnTeam:f,allUsers:f}},contributors:{get:function(){return this.readerCommenterWriters},set:function(){this.warn("contributors cannot be set. it is only syntactic sugar. If you want to modify roles, see the addUser and removeUser functions")}},collaborators:{get:function(){return this.readerCommenterOnlys},set:function(){this.warn("collaborators cannot be set. it is only syntactic sugar. If you want to modify roles, see the addUser and removeUser functions")}},owners:{get:function(){return this.admins},set:function(a){this.admins=a}},giveMeUsersWithTheseRolesAndNotTheseRoles:{value:function(a,b){if(!a||!b)return this.bug("Invalid request for users, you must supply the roles you want, and the roles you dont want."),new f;if("[object Array]"!==Object.prototype.toString.call(a)||"[object Array]"!==Object.prototype.toString.call(b))return this.bug("Invalid request for users, you must supply an array of the roles you want, and the roles you dont want."),new f;var c,d,e=new f,g=this,h=a.join(" ")+" onlys",i=[];a=a.map(function(a){return(a+"s").replace(/ss$/,"s")}),b=b.map(function(a){return(a+"s").replace(/ss+$/,"s")}),c=a.pop(),i=this[c]?new f(this[c].users.toJSON()):new f;var j=function(a){g.debug("  Checking on "+a.username),-1===g[c].users.indexOf(a.username)&&(g.debug("   - removing "+a.username+" from "+h+" because they are not in "+c),i.remove(a.username))},k=function(a){return a.username};for(d=a.length-1;d>=0;d--)if(c=a[d],g.debug("Making sure "+i.map(k)+" are "+c),g[c]){if(!g[c])return this.warn("  This team doesn't have a "+c+" so this means the "+h+" is empty."),e;for(var l=i._collection.length-1;l>=0;l--)j(i._collection[l])}if(this.debug("These users "+i.map(function(a){return a.username}).join(" ")+" have all the roles requested: "+h.replace("onlys","")),!i||0===i.length)return e;var m=function(a){i[a.username]&&(g.debug("  - "+a.username+" is also in "+c+" so removing them from the "+h+", there are "+i.length+" left"),i.remove(a.username))};for(d=b.length-1;d>=0;d--)if(c=b[d],g[c]&&(g[c].users.map(m),0===i.length))return e;return i}},adminOnlys:{get:function(){return this._adminOnlys&&this._adminOnlys.timestamp&&Date.now()-this._adminOnlys.timestamp<this.cacheTimeLength?this.debug("Not regenerating the list of adminOnlys, its fresh enough. "+new Date(this._adminOnlys.timestamp)):(this._adminOnlys=this.giveMeUsersWithTheseRolesAndNotTheseRoles(["admin"],["writer","reader"]),this._adminOnlys.timestamp=Date.now()),this._adminOnlys},set:function(){this.warn("adminOnlys cannot be set. it is only syntactic sugar. If you want to modify roles, see the addUser and removeUser functions")}},writeOnlys:{get:function(){return this._writeOnlys&&this._writeOnlys.timestamp&&Date.now()-this._writeOnlys.timestamp<this.cacheTimeLength?this.debug("Not regenerating the list of writeOnlys, its fresh enough. "+new Date(this._writeOnlys.timestamp)):(this._writeOnlys=this.giveMeUsersWithTheseRolesAndNotTheseRoles(["writer"],["admin","reader"]),this._writeOnlys.timestamp=Date.now()),this._writeOnlys},set:function(){this.warn("writeOnlys cannot be set. it is only syntactic sugar. If you want to modify roles, see the addUser and removeUser functions")}},readOnlys:{get:function(){return this._readOnlys&&this._readOnlys.timestamp&&Date.now()-this._readOnlys.timestamp<this.cacheTimeLength?this.debug("Not regenerating the list of readOnlys, its fresh enough. "+new Date(this._readOnlys.timestamp)):(this._readOnlys=this.giveMeUsersWithTheseRolesAndNotTheseRoles(["reader"],["admin","writer"]),this._readOnlys.timestamp=Date.now()),this._readOnlys},set:function(){this.warn("readOnlys cannot be set. it is only syntactic sugar. If you want to modify roles, see the addUser and removeUser functions")}},commentOnlys:{get:function(){return this._commentOnlys&&this._commentOnlys.timestamp&&Date.now()-this._commentOnlys.timestamp<this.cacheTimeLength?this.debug("Not regenerating the list of commentOnlys, its fresh enough. "+new Date(this._commentOnlys.timestamp)):(this._commentOnlys=this.giveMeUsersWithTheseRolesAndNotTheseRoles(["commenter"],["admin","writer","reader"]),this._commentOnlys.timestamp=Date.now()),this._commentOnlys},set:function(){this.warn("commentOnlys cannot be set. it is only syntactic sugar. If you want to modify roles, see the addUser and removeUser functions")}},readerCommenterOnlys:{get:function(){return this._readerCommenterOnlys&&this._readerCommenterOnlys.timestamp&&Date.now()-this._readerCommenterOnlys.timestamp<this.cacheTimeLength?this.debug("Not regenerating the list of readerCommenterOnlys, its fresh enough. "+new Date(this._readerCommenterOnlys.timestamp)):(this._readerCommenterOnlys=this.giveMeUsersWithTheseRolesAndNotTheseRoles(["reader","commenter"],["admin","writer"]),this._readerCommenterOnlys.timestamp=Date.now()),this._readerCommenterOnlys},set:function(){this.warn("readerCommenterOnlys cannot be set. it is only syntactic sugar. If you want to modify roles, see the addUser and removeUser functions")}},readerWriters:{get:function(){return this.readerCommenterWriters},set:function(){this.warn("readerWriters cannot be set. it is only syntactic sugar. If you want to modify roles, see the addUser and removeUser functions")}},readerCommenterWriters:{get:function(){return this._readerCommenterWriterOnlys&&this._readerCommenterWriterOnlys.timestamp&&Date.now()-this._readerCommenterWriterOnlys.timestamp<this.cacheTimeLength?this.debug("Not regenerating the list of readerCommenterWriterOnlys, its fresh enough. "+new Date(this._readerCommenterWriterOnlys.timestamp)):(this._readerCommenterWriterOnlys=this.giveMeUsersWithTheseRolesAndNotTheseRoles(["reader","writer","commenter"],["admin"]),this._readerCommenterWriterOnlys.timestamp=Date.now()),this._readerCommenterWriterOnlys},set:function(){this.warn("readerCommenterWriters cannot be set. it is only syntactic sugar. If you want to modify roles, see the addUser and removeUser functions")}},readerCommenterWriterAdmins:{get:function(){return this._readerCommenterWriterAdminAlso&&this._readerCommenterWriterAdminAlso.timestamp&&Date.now()-this._readerCommenterWriterAdminAlso.timestamp<this.cacheTimeLength?this.debug("Not regenerating the list of readerCommenterWriterAdminAlso, its fresh enough. "+new Date(this._readerCommenterWriterAdminAlso.timestamp)):(this._readerCommenterWriterAdminAlso=this.giveMeUsersWithTheseRolesAndNotTheseRoles(["reader","writer","admin"],[]),this._readerCommenterWriterAdminAlso.timestamp=Date.now()),this._readerCommenterWriterAdminAlso},set:function(){this.warn("readerCommenterWriterAdmins cannot be set. it is only syntactic sugar. If you want to modify roles, see the addUser and removeUser functions")}},readOwnDataWriteOwnDataOnlys:{get:function(){return this.readOwnDataWriteOwnDataOnly||[]},set:function(){this.warn("readOwnDataWriteOwnDataOnlys cannot be set. it is only syntactic sugar. If you want to modify roles, see the addUser and removeUser functions")}},readCommentAllWriteOwnDataOnlys:{get:function(){return this.readCommentAllWriteOwnDataOnly||[]},set:function(){this.warn("readCommentAllWriteOwnDataOnlys cannot be set. it is only syntactic sugar. If you want to modify roles, see the addUser and removeUser functions")}},readAllWriteOwnDataOnlys:{get:function(){return this.readAllWriteOwnDataOnly||[]},set:function(){this.warn("readAllWriteOwnDataOnlys cannot be set. it is only syntactic sugar. If you want to modify roles, see the addUser and removeUser functions")}},viewAsBasePermissionSystem:{get:function(){return this}},viewAsGroupedPermissionSystem:{get:function(){return{adminOnlys:this.adminOnlys,writeOnlys:this.writeOnlys,readOnlys:this.readOnlys,readerCommenterOnlys:this.readerCommenterOnlys,readerWriters:this.readerCommenterWriters,admins:this.readerCommenterWriterAdmins,commentOnlys:this.commentOnlys}}},viewAsDataBasePermissionSystem:{get:function(){return{admins:this.readerCommenterWriterAdmins,writers:this.readerCommenterWriters,readers:this.readerCommenterOnlys,commenters:this.readerCommenterOnlys}}},viewAsEmailingTeamPermissionSystem:{get:function(){return{contributors:this.contributors,collaborators:this.collaborators,owners:this.readerCommenterWriterAdmins}}},addUser:{value:function(a){if(!a||!a.roles)return void this.warn("You should provide roles you want to add... doing nothing.");this.debug(a.roles);var b=a.roles;delete a.roles;for(var c=b.length-1;c>=0;c--){var d=b[c];if(!this[d]&&(d=d.toLowerCase()+"s",!this[d])){var e=this.buildPermissionFromAPermissionType(d);this.debug(" Creating a permssion group for "+d,e),this.add(e)}this[d].users.add(a),this.debug("the user was added to the permission group "+d+" there are a total of "+this[d].length+" users with this sort of access ",this[d].users)}}},removeUser:{value:function(a){if("string"==typeof a&&(a={username:a,roles:this.currentPermissions},this.warn("Remove was requested of a username, removing the username entirely from the permission team.")),!a||!a.roles)return void this.warn("You should provide roles you want to remove... doing nothing.");this.debug(a.roles);var b=a.roles;delete a.roles;for(var c=b.length-1;c>=0;c--){var d=b[c];if(this[d]||(d=d.toLowerCase()+"s"),this[d]){if(this[d].users[a.username]){var e=this[d].users.remove(a);this.debug("removed ",e)}else this.warn("The user "+a.username+" was not in the "+d+" anyway.");this.debug("the user "+a.username+" is not in "+d+" there are a total of "+this[d].length+" users with this sort of access ",this[d].users)}}}},currentPermissions:{get:function(){if(!this._collection||0===this._collection)return[];var a=this;return this._collection.map(function(b){return b[a.primaryKey]})}},buildPermissionFromAPermissionType:{value:function(a){var b=a.replace(/s/,"").replace(/writer/,"write").replace(/er/,""),c=a;c&&c.length>2&&(c=c[0].toUpperCase()+c.substring(1,c.length));var d="These users can perform "+b+" operations on the corpus";return{users:[],verb:b,id:a,labelFieldLinguists:c,helpLinguists:d,directObject:"corpus"}}},fetch:{value:function(){var a=h.defer(),b=this;if(!this.parent)return h.nextTick(function(){b.fetching=b.loading=!1,a.reject({error:"Cannot fetch if the permissions are not attached to a corpus"})}),a.promise;if(!(this.application&&this.application.authentication&&this.application.authentication.user&&this.application.authentication.user.username))return h.nextTick(function(){b.fetching=b.loading=!1,a.reject({error:"Cannot fetch if the permissions are not in an application."})}),a.promise;if(this.loaded)return this.warn("not fetching permissions, they are fresh."),h.nextTick(function(){b.fetching=b.loading=!1,a.resolve(b)}),a.promise;var c={connection:this.parent.connection.toJSON(),username:this.application.authentication.user.username};return c.connection=c.couchConnection=c.connection,this.fetching=this.loading=!0,g.makeCORSRequest({type:"POST",data:c,dataType:"json",url:this.parent.connection.authUrl+"/corpusteam"}).then(function(c){b.fetching=b.loading=!1,b.loaded=!0,b.populate(c.users),a.resolve(b)},function(c){b.fetching=b.loading=!1,b.debug(c),a.reject(c)}).fail(function(c){console.error(c.stack,b),a.reject(c)}),a.promise}},populate:{value:function(a){a&&"defaults"!==a||(a={},this.debug("Using default permission types")),a.admins=a.admins||[],a.writers=a.writers||[],a.readers=a.readers||[],a.commenters=a.commenters||[],a.exporters=a.exporters||[],a.notonteam=a.notonteam||[],a.allusers=a.allusers||[],this.usersNotOnTeam=new f(a.notonteam),this.allUsers=new f(a.allusers),delete a.allusers,delete a.notonteam;var b;for(b in a)if(a.hasOwnProperty(b)&&b){if("[object Array]"===Object.prototype.toString.call(a[b])){var c=a[b];a[b]=this.buildPermissionFromAPermissionType(b),a[b].users=c}this.debug("adding "+b,a[b]),this.add(new e(a[b]))}}},sanitizeStringForPrimaryKey:{value:function(a){return a}}}),c.Permissions=i},{"./../CORS":1,"./../Collection":3,"./../user/Users":77,"./Permission":65,q:223}],67:[function(a,b,c){var d=a("./../FieldDBObject").FieldDBObject,e=a("./../data_list/DataList").DataList,f=function(a){this._fieldDBtype||(this._fieldDBtype="Search"),this.debug("Constructing Search length: ",a),d.apply(this,arguments)};f.prototype=Object.create(d.prototype,{constructor:{value:f},defaults:{value:{searchQuery:""}},INTERNAL_MODELS:{value:{datalist:e}},searchKeywords:{get:function(){return this.warn("searchKeywords is deprecated, use searchQuery instead."),this.searchQuery},set:function(a){this.warn("searchKeywords is deprecated, use searchQuery instead."),this.searchQuery=a}},id:{configurable:!0,get:function(){return encodeURI(this.searchQuery)},set:function(a){var b=decodeURI(a);this.searchQuery!==a&&this.searchQuery!==b&&(a===b?this.searchQuery=a:a!==b&&(this.searchQuery=b))}},searchQuery:{get:function(){return this._searchQuery||this.defaults.searchQuery},set:function(a){if(a!==this._searchQuery){if(!a)return void delete this._searchQuery;this._searchQuery=a.trim(),this._id=encodeURI(this._searchQuery)}}},search:{configurable:!0,writable:!0,value:function(a){a!==this.searchQuery&&(this.searchQuery=a),this.prepareDataListForSearchQuery(a),this.warn("Search has not been set up for this app."+a)}},prepareDataListForSearchQuery:{value:function(a){if(a&&this.datalist&&this.datalist.id===encodeURI(a))return void this.warn("Search data list was already set up for "+a);var b="";this.corpus&&this.corpus.dbname&&(b=this.corpus.title||this.corpus.dbname,b=" in "+b),this.datalist={id:this.id,title:a,description:"This is the result of searching for : "+a+b+" on "+new Date}}},datalist:{get:function(){return this.debug("Getting datalist "+this.searchQuery,this._datalist),this._datalist},set:function(a){a&&a.id&&this._datalist&&this._datalist.id&&a.id!==this._datalist.id&&this._datalist.length&&(this.previousSearchDataLists||(this.previousSearchDataLists={},this.previousSearchDataListsCount=0),this.previousSearchDataLists[this._datalist.id]=this._datalist,this.previousSearchDataListsCount++),this.debug("Setting datalist on search ",this._datalist,a),this.ensureSetViaAppropriateType("datalist",a),this._datalist.id=this.id}},clearPreviousSearchDataLists:{value:function(){this.warn("Releasing memory for"+this.previousSearchDataListsCount+" previousSearchDataLists "),delete this.previousSearchDataLists,delete this.previousSearchDataListsCount}}}),c.Search=f},{"./../FieldDBObject":4,"./../data_list/DataList":30}],68:[function(a,b,c){var d=a("./../FieldDBObject").FieldDBObject,e=function(a){this._fieldDBtype||(this._fieldDBtype="UnicodeSymbol"),this.debug("Constructing UnicodeSymbol length: ",a),d.apply(this,arguments)};e.prototype=Object.create(d.prototype,{constructor:{value:e},defaults:{value:{symbol:"",tipa:"",useCount:0}},symbol:{get:function(){return this._symbol},set:function(a){if(a!==this._symbol){if(!a)return void delete this._symbol;"function"==typeof a.trim&&(a=a.trim()),this._symbol=a.trim()}}},toJSON:{value:function(a,b){this.debug("Customizing toJSON ",a,b);var c=d.prototype.toJSON.apply(this,arguments);return delete c.dateCreated,delete c.dateModified,delete c.version,this.debug(c),c}}}),c.UnicodeSymbol=e},{"./../FieldDBObject":4}],69:[function(a,b,c){var d=a("./../Collection").Collection,e=a("./UnicodeSymbol").UnicodeSymbol,f=function(a){this._fieldDBtype||(this._fieldDBtype="UnicodeSymbols"),this.debug("Constructing UnicodeSymbols length: ",a),d.apply(this,arguments)};f.prototype=Object.create(d.prototype,{constructor:{value:f},primaryKey:{value:"symbol"},INTERNAL_MODELS:{value:{item:e}},fill:{value:function(){this.add(new e({tipa:"",symbol:""})),this.add(new e({tipa:"",symbol:""})),this.add(new e({tipa:"",symbol:""})),this.add(new e({tipa:"",symbol:""})),this.add(new e({tipa:"",symbol:""})),this.add(new e({tipa:"",symbol:""})),this.add(new e({tipa:"",symbol:""})),this.add(new e({tipa:"",symbol:""})),this.add(new e({tipa:"",symbol:""})),this.add(new e({tipa:"",symbol:""})),this.add(new e({tipa:"\\lambda",symbol:" "})),this.add(new e({tipa:"\\alpha",symbol:" "})),this.add(new e({tipa:"\\beta",symbol:" "})),this.add(new e({tipa:"\\forall",symbol:""})),this.add(new e({tipa:"\\exists",symbol:""})),this.add(new e({tipa:"^{\\circ}",symbol:""})),this.add(new e({tipa:"",symbol:""})),this.add(new e({tipa:"",symbol:""})),this.add(new e({tipa:"",symbol:""})),this.add(new e({tipa:"",symbol:""})),this.add(new e({tipa:"",symbol:""})),this.add(new e({tipa:"",symbol:""}))}},sanitizeStringForPrimaryKey:{value:function(a){return this.debug("sanitizeStringForPrimaryKey"),a?("function"!=typeof a.replace&&(a+=""),a=a.replace(/[-""+=?.\/\[\]{}() ]/g,"")):null}}}),c.UnicodeSymbols=f},{"./../Collection":3,"./UnicodeSymbol":68}],70:[function(a,b,c){var d=a("./Speaker").Speaker,e=a("./../corpus/corpus.json"),f=function(a){this._fieldDBtype||(this._fieldDBtype="Consultant"),this.debug("Constructing Consultant: ",a),d.apply(this,arguments)};f.prototype=Object.create(d.prototype,{constructor:{value:f},api:{value:"consultants"},defaults:{get:function(){var a={fields:e.consultantFields||e.speakerFields};return JSON.parse(JSON.stringify(a))}}}),c.Consultant=f},{"./../corpus/corpus.json":27,"./Speaker":72}],71:[function(a,b,c){var d=a("./Speaker").Speaker,e=a("./../corpus/corpus.json"),f=function(a){this._fieldDBtype||(this._fieldDBtype="Participant"),this.debug("Constructing Participant length: ",a),d.apply(this,arguments)};f.prototype=Object.create(d.prototype,{constructor:{value:f},api:{value:"participants"},defaults:{get:function(){var a={fields:[]};try{this.application&&this.application.corpus&&(this.application.corpus.participantFields?a.fields=this.application.corpus.participantFields.clone():this.application.corpus.speakerFields&&(a.fields=this.application.corpus.speakerFields.clone()))}catch(b){this.warn("Cant get participant fields from the current corpus, instead using defaults."),a.fields=e.participantFields||e.speakerFields}return a.fields&&0!==a.fields.length||(this.warn("There were no corpus specific speaker or participant fiels, instead using defaults"),a.fields=e.participantFields||e.speakerFields),JSON.parse(JSON.stringify(a))}}}),c.Participant=f},{"./../corpus/corpus.json":27,"./Speaker":72}],72:[function(a,b,c){var d=a("./../confidentiality_encryption/Confidential").Confidential,e=a("./../datum/DatumFields").DatumFields,f=a("./../FieldDBObject").FieldDBObject,g=a("./UserMask").UserMask,h=a("./../corpus/corpus.json"),i=function(a){this._fieldDBtype||(this._fieldDBtype="Speaker"),this.debug("Constructing Speaker: ",a),a&&(a._rev||a.fields)||(a=a||{},a.fields=this.defaults.fields),g.apply(this,arguments)};i.prototype=Object.create(g.prototype,{constructor:{value:i},api:{value:"speakers"},INTERNAL_MODELS:{value:{username:f.DEFAULT_STRING,anonymousCode:f.DEFAULT_STRING,gravatar:f.DEFAULT_STRING,fields:e,user:g,confidential:d}},defaults:{get:function(){var a={fields:h.speakerFields};return JSON.parse(JSON.stringify(a))}},confidentiality:{get:function(){return this.fields?this.fields.confidentiality.value:void 0},set:function(a){this.fields||(this.fields=new e(this.defaults.fields)),this.fields.confidentiality.value=a}},fields:{get:function(){return this.debug("getting fields"),this._fields},set:function(a){if(a!==this._fields){if(!a)return void delete this._fields;"function"==typeof this.INTERNAL_MODELS.fields&&"[object Array]"===Object.prototype.toString.call(a)&&(a=new this.INTERNAL_MODELS.fields(a)),a.confidential||(a.confidential=this.confidential),this._fields=a}}},buildGravatar:{value:function(){return this._gravatar="968b8e7fb72b5ffe2915256c28a9414c",this._gravatar}},gravatar:{get:function(){return this.buildGravatar()},set:function(a){this.warn("Cannot set the gravatar of a "+this.fieldDBtype+" (it must be anonymous)."+a)}},username:{get:function(){return this.fields&&this.fields.username&&this.fields.username.value?("generalize"===this.fields.confidentiality.value?this.fields.username.mask="A native speaker":"team"===this.fields.confidentiality.value?(this.todo("IF the user is part of the team, they can see the username of the consultant."),this.fields.username.mask=this.anonymousCode):"anonymous"===this.fields.confidentiality.value?this.fields.username.mask=this.anonymousCode||this.fields.username.mask:"public"===this.fields.confidentiality.value?this.fields.username.mask=this.fields.username.value:this.fields.username.mask="A native speaker",this.fields.username.decryptedMode?this.fields.username.value:this.fields.username.mask):this.id?this.id:void 0},set:function(a){return this.confidential?(this.fields||(this.fields=new e(this.defaults.fields)),this.fields.username.confidential=this.confidential,void(this.fields.username.value=a)):void this.warn("Cannot set the username before the confidential is set")}},encryptByCorpus:{value:!0},id:{get:function(){return this.anonymousCode},set:function(a){this.anonymousCode=a}},anonymousCode:{get:function(){try{return this.fields&&this.fields.anonymousCode?this.fields.anonymousCode.value.toUpperCase():this._id}catch(a){return this.warn("there was a problem getting the anonymousCode of this speaker",a),this._id}},set:function(a){var b;return this.fields&&this.fields.username&&this.fields.username.value&&(this.fields.username.decryptedMode=!0,b=this.fields.username.value,this.fields.username.decryptedMode=!1),b&&a.toLowerCase().indexOf(b)>-1?void this.bug("Cannot set the anonymous code to contain any part of the user's actual username, this would potentially breach their confidentiality."):(this.fields||(this.fields=new e(this.defaults.fields)),this.fields.anonymousCode.value=this._id=a,this.debug("Set the id and the anonymousCode of this user"+this._id,this),void(this.encryptByCorpus||(this.confidential=new d({secretkey:a}))))}},confidential:{get:function(){return this.debug("using this speaker's confidential encrypter"),this.confidentialEncrypter},set:function(a){a!==this.confidentialEncrypter&&("function"!=typeof a.encrypt&&a.secretkey&&(a=new this.INTERNAL_MODELS.confidential(a)),this.confidentialEncrypter=a,this.fields&&(this.fields.confidential=a))}},dateOfBirth:{configurable:!0,get:function(){return this.fields&&this.fields.dateOfBirth?this.fields.dateOfBirth.value:void 0},set:function(a){this.debug("Setting dateOfBirth "+a,this.confidential),this.fields||(this.fields=new e(this.defaults.fields)),this.fields.dateOfBirth.value=a}},firstname:{configurable:!0,get:function(){return this.fields&&this.fields.firstname?this.fields.firstname.value:void 0},set:function(a){this.fields||(this.fields=new e(this.defaults.fields)),this.fields&&this.fields.firstname?this.fields.firstname.value=a:this.fields.firstname.value=a}},lastname:{configurable:!0,get:function(){return this.fields&&this.fields.lastname?this.fields.lastname.value:void 0},set:function(a){this.fields||(this.fields=new e(this.defaults.fields)),this.fields&&this.fields.lastname?this.fields.lastname.value=a:this.fields.lastname.value=a}},languages:{get:function(){return this.fields?this.fields.languages.value:void 0},set:function(a){var b,c;"string"==typeof a?(this.debug("User set the languages with a string"),this.fields.languages&&this.fields.languages&&this.fields.languages.json&&this.confirm("Do you want to set the languages from "+JSON.stringify(this.fields.languages.json)+" to "+a),b=a,c={value:a,label:"languages",json:{languages:a.split(",")}},c.json.languages=c.json.languages.map(function(a){return{iso:a.toLowerCase().trim(),name:a.trim(),nativeName:a.trim()}})):c=a,this.fields||(this.fields=new e(this.defaults.fields)),b&&(this.fields.languages.value=b),this.debug("setting language ",c);for(var d in c)c.hasOwnProperty(d)&&(this.debug("looking at "+d),this.fields.languages[d]=c[d])}},dialects:{get:function(){return this.languages},set:function(a){return this.languages=a}},user:{get:function(){if(!this.userMask){var a=this;this["public"]&&this.username?(this.userMask=new this.INTERNAL_MODELS.user({}),this.userMask.username=this.username,this.userMask.fetch().then(function(b){a.debug('Fetched speaker"s user mask',b)},function(b){a.debug('Failed to fetch speaker"s user mask',b)}).fail(function(b){console.error(b.stack,a)})):this.userMask={},this.userMask={username:this.anonymousCode,gravatar:this.gravatar}}return this.userMask},set:function(a){a!==this.userMask&&(a||(a={}),this.userMask=a)}},languageOne:{get:function(){return this.getLanguageNumber(0)},set:function(a){
return this.setLanguageNumber(0,a)}},languageTwo:{get:function(){return this.getLanguageNumber(1)},set:function(a){return this.setLanguageNumber(1,a)}},languageThree:{get:function(){return this.getLanguageNumber(2)},set:function(a){return this.setLanguageNumber(2,a)}},languageFour:{get:function(){return this.getLanguageNumber(3)},set:function(a){return this.setLanguageNumber(3,a)}},languageFive:{get:function(){return this.getLanguageNumber(4)},set:function(a){return this.setLanguageNumber(4,a)}},getLanguageNumber:{value:function(a){return this.fields&&this.fields.languages&&this.fields.languages.json&&this.fields.languages.json.languages&&this.fields.languages.json.languages[a]?this.fields.languages.json.languages[a]:void 0}},setLanguageNumber:{value:function(a,b){return this.fields&&this.fields.languages&&(this.fields.languages.json=this.fields.languages.json||{languages:[]},b!==this.fields.languages.json.languages[a])?(b.iso&&(b={language:b,fluency:{comprehensionFluency:"native",speakingFluency:"native"},dates:{start:"",end:"",proportionOfUse:""}}),b.fluency=b.fluency||{},b.dates=b.dates||{},b.language=b.language||{},this.fields.languages.json.languages[a]=b,this.fields.languages.json.languages[a]):void 0}}}),c.Speaker=i},{"./../FieldDBObject":4,"./../confidentiality_encryption/Confidential":18,"./../corpus/corpus.json":27,"./../datum/DatumFields":36,"./UserMask":75}],73:[function(a,b,c){var d=a("./UserMask").UserMask,e=function(a){this._fieldDBtype||(this._fieldDBtype="Team"),this.debug("Constructing Team: ",a),d.apply(this,arguments)};e.prototype=Object.create(d.prototype,{constructor:{value:e},id:{get:function(){return"team"},set:function(a){a!==this._id&&("team"!==a&&this.warn('Cannot set team id to anything other than "team."'),this._id="team")}},defaults:{value:{username:"",password:"",email:"",gravatar:"",researchInterest:"",affiliation:"",description:"",subtitle:"",datalists:[],mostRecentIds:{},firstname:"",lastname:"",teams:[],sessionHistory:[]}},subtitle:{get:function(){return this.name},set:function(a){a!==this.name&&(this.warn("subtitle is deprecated, use name instead."),this.name=a)}},merge:{value:function(a,b,c){return this.debug("Customizing merge ",a),b.id&&(b.id=""),d.prototype.merge.apply(this,[a,b,c])}}}),c.Team=e},{"./UserMask":75}],74:[function(a,b,c){var d=a("./../activity/Activities").Activities,e=a("./../FieldDBObject").FieldDBObject,f=a("./UserMask").UserMask,g=a("./../datum/DatumFields").DatumFields,h=a("./../corpus/Connection").Connection,i=a("./../corpus/Corpora").Corpora,j=a("./../corpus/Database").Database,k=a("./../confidentiality_encryption/Confidential").Confidential,l=a("./UserPreference").UserPreference,m=a("./user.json"),n=a("q"),o=function(a){this._fieldDBtype||(this._fieldDBtype="User"),a&&a.nodejs&&(this.todo("creating user from express body, verify options are sanitized "),delete a.nodejs,delete a.password),this.debug("Constructing User length: ",a),f.apply(this,arguments),this.username&&(this.id=this.username)};o.prototype=Object.create(f.prototype,{constructor:{value:o},api:{value:"users"},defaults:{get:function(){return JSON.parse(JSON.stringify(m))}},INTERNAL_MODELS:{value:{username:e.DEFAULT_STRING,firstname:e.DEFAULT_STRING,lastname:e.DEFAULT_STRING,email:e.DEFAULT_STRING,gravatar:e.DEFAULT_STRING,researchInterest:e.DEFAULT_STRING,affiliation:e.DEFAULT_STRING,description:e.DEFAULT_STRING,appbrand:e.DEFAULT_STRING,fields:g,prefs:l,mostRecentIds:e,activityConnection:d,authUrl:e.DEFAULT_STRING,userMask:f,corpora:i,newCorpora:i,sessionHistory:e.DEFAULT_ARRAY,datalistHistory:e.DEFAULT_ARRAY}},hotkeys:{get:function(){return this.prefs?this.prefs.hotkeys:void 0},set:function(a){this.prefs||(this.prefs=new this.INTERNAL_MODELS.prefs),"[object Array]"!==Object.prototype.toString.call(a)&&(a=a.firstKey||a.secondKey||a.description?[a]:[]),this.prefs.hotkeys=a,delete this.hotkeys}},authUrl:{get:function(){return this._authUrl||""},set:function(a){if(this.debug("setting authurl",a),a!==this._authUrl){if(!a)return void delete this._authUrl;"function"==typeof a.trim&&(a=a.trim()),a=a.replace(/[^.\/]*.fieldlinguist.com:3183/g,"auth.lingsync.org"),this._authUrl=a}}},datalists:{get:function(){return this.datalistHistory},set:function(a){a&&!this._datalistHistory&&(this.datalistHistory=a)}},dataLists:{get:function(){return this.datalistHistory},set:function(a){a&&!this._datalistHistory&&(this.datalistHistory=a)}},datalistHistory:{get:function(){return this._datalistHistory||e.DEFAULT_ARRAY},set:function(a){this._datalistHistory=a}},sessions:{get:function(){return this.sessionHistory},set:function(a){a&&!this._sessionHistory&&(this.sessionHistory=a)}},sessionHistory:{get:function(){return this._sessionHistory||e.DEFAULT_ARRAY},set:function(a){this._sessionHistory=a}},mostRecentIds:{configurable:!0,get:function(){return this._mostRecentIds||e.DEFAULT_OBJECT},set:function(a){if(a!==this._mostRecentIds){if(!a)return void delete this._mostRecentIds;a instanceof this.INTERNAL_MODELS.mostRecentIds||(a=new this.INTERNAL_MODELS.mostRecentIds(a)),a.connection=a.connection||a.corpusConnection||a.couchConnection,delete a.corpusConnection,delete a.couchConnection,a.connection&&(a.connection=new h(a.connection)),this._mostRecentIds=a}}},prefs:{get:function(){return this._prefs},set:function(a){this.ensureSetViaAppropriateType("prefs",a)}},corpuses:{configurable:!0,get:function(){return this.corpora},set:function(a){this.corpora=a}},newCorpusConnections:{configurable:!0,get:function(){return this.newCorpora},set:function(a){this.newCorpora=a}},appbrand:{get:function(){return this.prefs&&this.prefs.preferredDashboardType===this.prefs.defaults.preferredDashboardType&&"phophlo"===this._appbrand&&(this.debug(" setting preferredDashboardType from user "+this._appbrand),this.prefs.preferredDashboardType="experimenter"),this._appbrand||"lingsync"},set:function(a){a!==this._appbrand&&(this._appbrand?this.warn("appbrand cannot be modified by client side apps."):(a.trim&&(a=a.trim()),this._appbrand=a),this.debug(" setting preferredDashboardType from user "+this._appbrand),this.prefs&&this.prefs.preferredDashboardType===this.prefs.defaults.preferredDashboardType&&"phophlo"===this._appbrand&&(this.prefs._preferredDashboardType="experimenter",this.debug(" it is now "+this.prefs.preferredDashboardType)))}},userMask:{get:function(){return this.debug("getting userMask"),this._userMask},set:function(a){a&&"object"==typeof a&&(a.username=this.username,a.gravatar=a.gravatar||this.gravatar,a.researchInterest=a.researchInterest||"No public information available",a.description=a.description||"No public information available",a.affiliation=a.affiliation||"No public information available",a.id=a.username),this.ensureSetViaAppropriateType("userMask",a)}},publicSelf:{get:function(){return this.userMask},set:function(a){this.userMask=a}},activityConnection:{get:function(){return this.debug("getting activityConnection"),this._activityConnection},set:function(a){a&&(a.parent=this,!a.confidential&&this.confidential&&(a.confidential=this.confidential)),this.ensureSetViaAppropriateType("activityConnection",a),this.username&&this._activityConnection&&this._activityConnection._connection&&!this._activityConnection._database&&(this._activityConnection._database=new j({dbname:this.username+"-activity_feed",connection:this._activityConnection._connection}))}},activityCouchConnection:{configurable:!0,get:function(){return this.activityConnection},set:function(a){this.activityConnection=a}},toJSON:{value:function(a,b,c){this.debug("Customizing toJSON ",a,b,c),a=!0;var d=f.prototype.toJSON.apply(this,arguments);return this.corpora&&"function"==typeof this.corpora.toJSON?d.corpora=this.corpora.toJSON():d.corpora=this.corpora,delete d.corpuses,delete d.connection,delete d.authentication,d.datalists=this.datalists,d.mostRecentIds&&(delete d.mostRecentIds.fieldDBtype,delete d.mostRecentIds.version,delete d.mostRecentIds.dateCreated,delete d.mostRecentIds.dateModified,delete d.mostRecentIds.comments,d.mostRecentIds.dbname||delete d.mostRecentIds.dbname),this.debug(d),d}},save:{value:function(a){this.debug("Customizing save ",a);var b,c,d,e=n.defer();this.whenReady=e.promise;var f=this;if(n.nextTick(function(){e.resolve(f)}),!this._rev)return this.warn("Refusing to save a user doc which is incomplete, and doesn't have a rev"),e.promise;try{b=localStorage.getItem("X09qKvcQn8DnANzGdrZFqCRUutIi2C"),b||(b=k.secretKeyGenerator(),localStorage.setItem("X09qKvcQn8DnANzGdrZFqCRUutIi2C",b))}catch(g){this.constructor.prototype.temp=this.constructor.prototype.temp||{},b=this.constructor.prototype.temp.X09qKvcQn8DnANzGdrZFqCRUutIi2C,b||(b=k.secretKeyGenerator(),this.constructor.prototype.temp.X09qKvcQn8DnANzGdrZFqCRUutIi2C=b),this.debug("unable to use local storage, this app wont be very usable offline "),this.debug(" error ",g)}c=b+this.username;var h=this.toJSON();f.debug("saving "+c,h),d=new k({secretkey:c}).encrypt(h);try{localStorage.setItem(c,d)}catch(g){this.constructor.prototype.temp=this.constructor.prototype.temp||{},this.constructor.prototype.temp[c]=d,this.debug("unable to use local storage, this app wont be very usable offline "),this.debug(" error ",g)}return e.promise}},fetch:{value:function(a){this.debug("Customizing fetch ",a);var b,c,d,f,g={},h=this,i=n.defer();this.whenReady=i.promise,n.nextTick(function(){i.resolve(h)});try{b=localStorage.getItem("X09qKvcQn8DnANzGdrZFqCRUutIi2C")}catch(j){h.constructor.prototype.temp=h.constructor.prototype.temp||{},b=h.constructor.prototype.temp.X09qKvcQn8DnANzGdrZFqCRUutIi2C,h.debug("unable to use local storage, this app wont be very usable offline "),h.debug(" error ",j)}if(!b)return h.warn("cannot fetch user info locally"),i.promise;c=b+h.username;try{d=localStorage.getItem(c)}catch(j){if(!h.constructor.prototype.temp)return h.warn("no local users have been saved"),e.prototype.fetch.apply(h,arguments);d=h.constructor.prototype.temp[c]}return g={},d?(h.debug("userKey is "+c),h.debug("user encrypted is "+d),g=new k({secretkey:c}).decrypt(d),h.debug(" Opening user prefs from previous session on self device",g),h._rev||(f="overwrite"),h.merge("self",new o(g),f),i.promise):(h.warn("This user "+h.username+" hasnt been used this device before, need to request their prefs when they login."),i.promise)}}}),c.User=o},{"./../FieldDBObject":4,"./../activity/Activities":6,"./../confidentiality_encryption/Confidential":18,"./../corpus/Connection":21,"./../corpus/Corpora":22,"./../corpus/Database":25,"./../datum/DatumFields":36,"./UserMask":75,"./UserPreference":76,"./user.json":78,q:223}],75:[function(a,b,c){var d=a("./../FieldDBObject").FieldDBObject,e=a("./../datum/DatumFields").DatumFields,f=a("./../corpus/Corpora").Corpora,g=a("md5"),h=function(a){this._fieldDBtype||(this._fieldDBtype="UserMask"),this.debug("Constructing a UserMask "+a),d.apply(this,arguments)};h.prototype=Object.create(d.prototype,{constructor:{value:h},api:{value:"users"},INTERNAL_MODELS:{value:{corpora:f,username:d.DEFAULT_STRING,firstname:d.DEFAULT_STRING,lastname:d.DEFAULT_STRING,gravatar:d.DEFAULT_STRING,researchInterest:d.DEFAULT_STRING,affiliation:d.DEFAULT_STRING,description:d.DEFAULT_STRING,fields:e}},buildGravatar:{value:function(a){return a?g(a):"0df69960706112e38332395a4f2e7542"}},defaults:{value:{username:"",firstname:"",lastname:"",email:"",gravatar:"",researchInterest:"",affiliation:"",description:""}},id:{get:function(){return this._username||(this._username=""),this._username||this._id},set:function(a){a!==this._username&&(a||(a=""),this._username=this._id=a.trim())}},userMask:{get:function(){return{username:this.username,gravatar:this.gravatar,name:this.name}},set:function(a){this.debug("users masks cant be set.",a)}},username:{get:function(){return this._username||(this._username=""),this._username},set:function(a){a!==this._username&&(a||(a=""),this._username=a.trim())}},firstname:{configurable:!0,get:function(){return this._firstname||(this._firstname=""),this._firstname},set:function(a){a!==this._firstname&&(a||(a=""),this._firstname=a.trim())}},lastname:{configurable:!0,get:function(){return this._lastname||(this._lastname=""),this._lastname},set:function(a){a!==this._lastname&&(a||(a=""),this._lastname=a.trim())}},gravatar:{get:function(){return!this._gravatar&&this.email&&(this._gravatar=g(this.email)),this._gravatar},set:function(a){a!==this._gravatar&&(a||(a=""),a.indexOf("gravatar.com")>-1?a=a.replace("https://secure.gravatar.com/avatar/",""):a.indexOf("user_gravatar.png")>-1&&(a=""),this._gravatar=a.trim())}},email:{get:function(){return this._email||(this._email=""),this._email},set:function(a){if(a!==this._email){a||(a="");var b=/^(([^<>()[\]\\.,;:\s@\"]+(\.[^<>()[\]\\.,;:\s@\"]+)*)|(\".+\"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;b.test(a)&&(this._email=a.trim())}}},affiliation:{get:function(){return this._affiliation||(this._affiliation=""),this._affiliation},set:function(a){a!==this._affiliation&&(a||(a=""),this._affiliation=a.trim())}},researchInterest:{get:function(){return this._researchInterest||(this._researchInterest=""),this._researchInterest},set:function(a){a!==this._researchInterest&&(a||(a=""),this._researchInterest=a.trim())}},description:{get:function(){return this._description||(this._description=""),this._description},set:function(a){a!==this._description&&(a||(a=""),this._description=a.trim())}},name:{configurable:!0,get:function(){this.firstname=this.firstname||"",this.lastname=this.lastname||"";var a=(this.firstname+" "+this.lastname).trim();return a?a:this.anonymousCode||this.username},set:function(a){if(a&&a.indexOf(" ")>-1){var b=a.replace(/ +/g," ").split(" ");b[0]&&(this._firstname=b[0]),b[1]&&(this._lastname=b[1])}}},corpora:{configurable:!0,get:function(){return this._corpora||d.DEFAULT_ARRAY},set:function(a){this.ensureSetViaAppropriateType("corpora",a)}},validateUsername:{value:function(a){if(!a)return{valid:!1,username:null,original:null,suggestion:null};var b=a.toLowerCase().replace(/[^a-z0-9_]/g,""),c={valid:!0,username:a,original:a};return b!==a&&(c.valid=!1,c.suggestion=b,c.username=b),c}},fields:{configurable:!0,get:function(){return this._fields&&(this._fields.confidential=this.confidential),this._fields},set:function(a){if(a!==this._fields){if(!a)return void delete this._fields;"[object Array]"===Object.prototype.toString.call(a)&&(a=new this.INTERNAL_MODELS.fields(a)),this._fields=a}}},toJSON:{value:function(a,b){this.debug("Customizing toJSON ",a,b);var c=d.prototype.toJSON.apply(this,arguments);return c.name=this.name,this.debug(c),c}}}),c.UserMask=h},{"./../FieldDBObject":4,"./../corpus/Corpora":22,"./../datum/DatumFields":36,md5:198}],76:[function(a,b,c){var d=a("./../FieldDBObject").FieldDBObject,e=a("./../hotkey/HotKeys").HotKeys,f=a("./../unicode/UnicodeSymbols").UnicodeSymbols,g=function(a){this._fieldDBtype||(this._fieldDBtype="UserPreference"),this.debug("Constructing UserPreference length: ",a),d.apply(this,arguments)};g.preferredDashboardLayouts=["layoutAllTheData","layoutJustEntering","layoutWhatsHappening","layoutCompareDataLists"],g.preferredDashboardTypes=["fieldlinguistNormalUser","fieldlinguistPowerUser"],g.prototype=Object.create(d.prototype,{constructor:{value:g},defaults:{get:function(){return{skin:"",numVisibleDatum:2,transparentDashboard:!1,alwaysRandomizeSkin:!0,numberOfItemsInPaginatedViews:10,preferredDashboardLayout:"layoutAllTheData",preferredDashboardType:"fieldlinguistNormalUser",preferredSpreadsheetShape:{columns:2,rows:3},hotkeys:[],unicodes:[]}}},INTERNAL_MODELS:{value:{hotkeys:e,unicodes:f}},skin:{get:function(){return this._skin||this.defaults.skin},set:function(a){if(this.debug("setting _skin from "+a),a!==this._skin){if(!a)return void delete this._skin;a.trim&&(a=a.trim()),this._skin=a}}},transparentDashboard:{get:function(){return this._transparentDashboard||this.defaults.transparentDashboard},set:function(a){this.debug("setting _transparentDashboard from "+a),a!==this._transparentDashboard&&(a!==!1&&"false"!==a&&a?this._transparentDashboard=!0:this._transparentDashboard=!1)}},alwaysRandomizeSkin:{get:function(){return this._alwaysRandomizeSkin||this.defaults.alwaysRandomizeSkin},set:function(a){this.debug("setting _alwaysRandomizeSkin from "+a),a!==this._alwaysRandomizeSkin&&(a!==!1&&"false"!==a&&a?this._alwaysRandomizeSkin=!0:this._alwaysRandomizeSkin=!1)}},preferedDashboardType:{get:function(){return this.warn("preferedDashboardType is deprecated use preferredDashboardType instead"),this.preferredDashboardType},set:function(a){this.warn("preferedDashboardType is deprecated use preferredDashboardType instead"),this.preferredDashboardType=a}},preferredDashboardType:{get:function(){return this._preferredDashboardType||this.defaults.preferredDashboardType},set:function(a){if(this.debug("setting _preferredDashboardType from "+a),a!==this._preferredDashboardType){if(!a)return void delete this._preferredDashboardType;a.trim&&(a=a.trim()),this._preferredDashboardType=a}}},preferedDashboardLayout:{get:function(){return this.warn("preferedDashboardLayout is deprecated use preferredDashboardLayout instead"),this.preferredDashboardLayout},set:function(a){this.warn("preferedDashboardType is deprecated use preferredDashboardLayout instead"),this.preferredDashboardLayout=a}},preferredDashboardLayout:{get:function(){return this._preferredDashboardLayout||this.defaults.preferredDashboardLayout},set:function(a){if(a!==this._preferredDashboardLayout){if(!a)return void delete this._preferredDashboardLayout;this.preferredDashboardType||("layoutAllTheData"===this._preferredDashboardLayout||"layoutJustEntering"===this._preferredDashboardLayout||"layoutWhatsHappening"===this._preferredDashboardLayout?this.preferredDashboardType="fieldlinguistNormalUser":("layoutCompareDataLists"===this._preferredDashboardLayout||"layoutEverythingAtOnce"===this._preferredDashboardLayout)&&(this.preferredDashboardType="fieldlinguistPowerUser")),this._preferredDashboardLayout=a}}},preferedSpreadsheetShape:{get:function(){return this.warn("preferedSpreadsheetShape is deprecated use preferredSpreadsheetShape instead"),this.preferredSpreadsheetShape},set:function(a){this.warn("preferedDashboardType is deprecated use preferredSpreadsheetShape instead"),this.preferredSpreadsheetShape=a}},preferredSpreadsheetShape:{get:function(){return this._preferredSpreadsheetShape||(this._preferredSpreadsheetShape=JSON.parse(JSON.stringify(this.defaults.preferredSpreadsheetShape))),this._preferredSpreadsheetShape},set:function(a){this._preferredSpreadsheetShape=a}},hotkeys:{get:function(){return this._hotkeys||d.DEFAULT_COLLECTION},set:function(a){if(a!==this._hotkeys){if(!a)return void delete this._hotkeys;a.firstKey&&(a=[a]),"[object Array]"===Object.prototype.toString.call(a)&&(a=new this.INTERNAL_MODELS.hotkeys(a)),this._hotkeys=a}}},unicodes:{get:function(){return this._unicodes||d.DEFAULT_COLLECTION},set:function(a){if(a!==this._unicodes){if(!a)return void delete this._unicodes;"[object Array]"===Object.prototype.toString.call(a)&&(a=new this.INTERNAL_MODELS.unicodes(a)),this._unicodes=a}}},numVisibleDatum:{get:function(){return this._numVisibleDatum||this.defaults.numVisibleDatum},set:function(a){if(a!==this._numVisibleDatum){if(!a)return void delete this._numVisibleDatum;"function"==typeof a.trim&&(a=a.trim()),a=parseInt(a,10),this._numVisibleDatum=a}}},numberOfItemsInPaginatedViews:{get:function(){return this._numberOfItemsInPaginatedViews||this.defaults.numberOfItemsInPaginatedViews},set:function(a){if(a!==this._numberOfItemsInPaginatedViews){if(!a)return void delete this._numberOfItemsInPaginatedViews;"function"==typeof a.trim&&(a=a.trim()),a=parseInt(a,10),this._numberOfItemsInPaginatedViews=a}}},preferedLocale:{get:function(){return this.warn("preferedLocale is deprecated use preferredLocale instead"),this.preferredLocale},set:function(a){this.warn("preferedDashboardType is deprecated use preferredLocale instead"),this.preferredLocale=a}},preferredLocale:{get:function(){return this._preferredLocale},set:function(a){if(this.debug("setting _preferredLocale from "+a),a!==this._preferredLocale){if(!a)return void delete this._preferredLocale;a.trim&&(a=a.trim()),this._preferredLocale=a}}},toJSON:{value:function(a,b){this.debug("Customizing toJSON ",a,b);var c=["fieldDBtype","dateCreated","version"],e=d.prototype.toJSON.apply(this,[a,b,c]);if(!e)return void this.warn("Not returning json right now.");if(this.debug("JSON before removing items which match defaults",e),!a)for(var f in this.defaults)this.defaults.hasOwnProperty(f)&&(new d(e[f]).equals(this.defaults[f])||"[object Array]"===Object.prototype.toString.call(e[f])&&0===e[f].length)&&(this.debug("removing pref which is set to a default "+f),delete e[f]);return"{}"===JSON.stringify(e)?{}:(e.fieldDBtype=this.fieldDBtype,e.version=this.version,e.dateCreated=this.dateCreated,this.debug("Json",e),e)}}}),c.UserPreference=g},{"./../FieldDBObject":4,"./../hotkey/HotKeys":51,"./../unicode/UnicodeSymbols":69}],77:[function(a,b,c){var d=a("./../Collection").Collection,e=a("./UserMask").UserMask,f=function(a){this._fieldDBtype||(this._fieldDBtype="Users"),this.debug("Constructing Users ",a),d.apply(this,arguments)};f.prototype=Object.create(d.prototype,{constructor:{value:f},primaryKey:{value:"username"},INTERNAL_MODELS:{value:{item:e}},sanitizeStringForPrimaryKey:{value:function(a){return a}}}),c.Users=f},{"./../Collection":3,"./UserMask":75}],78:[function(a,b,c){b.exports={_id:"",jsonType:"user",username:"",email:"",corpora:[{protocol:"",domain:"",port:"",dbname:"",path:"",authUrl:"",userFriendlyServerName:"",title:"",corpusid:"",titleAsUrl:"",description:"The details of this corpus are not public."}],activityConnection:{protocol:"",domain:"",port:"",dbname:"",path:"",authUrl:"",userFriendlyServerName:""},appbrand:"",gravatar:"",appVersionWhenCreated:"",authServerVersionWhenCreated:"",authUrl:"",dateCreated:"",dateModified:"",researchInterest:"",affiliation:"",description:"",subtitle:"",prefs:{skin:"",numVisibleDatum:10,transparentDashboard:!1,alwaysRandomizeSkin:!0,numberOfItemsInPaginatedViews:10,unicodes:[{symbol:"",tipa:"",useCount:0},{symbol:"",tipa:"",useCount:0},{symbol:"",tipa:"",useCount:0},{symbol:"",tipa:"",useCount:0},{symbol:"",tipa:"",useCount:0},{symbol:"",tipa:"",useCount:0},{symbol:"",tipa:"",useCount:0},{symbol:"",tipa:"",useCount:0},{symbol:"",tipa:"",useCount:0},{symbol:"",tipa:"",useCount:0},{symbol:" ",tipa:"lambda",useCount:0},{symbol:" ",tipa:"alpha",useCount:0},{symbol:" ",tipa:"\beta",useCount:0},{symbol:"",tipa:"\forall",useCount:0},{symbol:"",tipa:"exists",useCount:0},{symbol:"",tipa:"^{circ}",useCount:0},{symbol:"",tipa:"",useCount:0},{symbol:"",tipa:"",useCount:0},{symbol:"",tipa:"",useCount:0},{symbol:"",tipa:"",useCount:0},{symbol:"",tipa:"",useCount:0},{symbol:"",tipa:"",useCount:0}],preferredDashboardLayout:"default",showNewDatumAtTopOrBottomOfDataEntryArea:"bottom",hotkeys:[]},mostRecentIds:{corpusid:"",datalistid:"",sessionid:"",connection:{protocol:"",domain:"",port:"",dbname:"",path:"",authUrl:"",userFriendlyServerName:"",corpusid:""}},firstname:"",lastname:"",datalistHistory:[],sessionHistory:[],hotkeys:[],newCorpora:[],roles:[]}},{}],79:[function(a,b,c){function d(a){try{if(a.trashed&&a.trashed.indexOf("deleted")>-1)return;var b,c,d=a.fields||a.datumFields||[];if(!d||!d.length)return;var e=3,f="@",g=/[#?!.,\/\s]+/g,h=/[-=]+/g,i=/^[\\\",.;\(\[\{-]/,j=/[.,;!\\\"\)\]\}-]$/,k=function(a){return a.split(g)},l=function(a){if(a){var b=a.replace(/\(\*[^)]*\)/g,"");b=b.replace(/\*\(([^)]*)\)/,"$1");var c=b.replace(/[(*)]/g,""),d=b.replace(/\([^)]*\)/g,"");return c!==d?[d,c]:[c]}},m=function q(a,b,c){if(a&&a.length){if(!b){b=[];for(var d=1;e>d;d++)b.push(f),a.push(f)}var g=a.shift();b.push(g),"@-@-@"!==b.join("-")&&emit(b.join("-"),c),b.splice(0,1),q(a,b,c)}},n=function(a){if(a){var b=k(a);if(b&&b.length){var c=[];if(b.map(function(b){var d=l(b.toLocaleLowerCase());d[0]=d[0].replace(i,"").replace(j,""),d[0]&&c.push(d[0]),d.length>1&&(n(a.replace(b,d[1])),a=a.replace(b,d[0]))}),c&&c.length){var d=(f+"-"+c.join("-"+f+"-")+"-"+f).split(h);m(d,null,a)}}}};for(b in d)if(c="label",c=d[b].id&&d[b].id.length>0?"id":"label","morphemes"===d[b][c]){var o=d[b].mask?d[b].mask.trim():"";if(o||(o=d[b].value?d[b].value.trim():""),!o||0===o.indexOf("*"))return;n(o)}}catch(p){emit(p,a)}}try{c.morpheme_n_grams=d}catch(e){}},{}],80:[function(a,b,c){function d(a){var b={delimiter:" ",pattern:/\s+/g,collapseCase:!1,removeSententialPunctuation:!0,punctuationToRemoveAfterTokenization:null},c={delimiter:" ",pattern:/\s+/g,collapseCase:!1,removeSententialPunctuation:!0,punctuationToRemoveAfterTokenization:/[#!.,;:\\\\"\/\(\)\*\#0-9]+/g},d=(JSON.parse(JSON.stringify(c)),{delimiter:" ",pattern:/[\-=\s]+/g,collapseCase:!1,removeSententialPunctuation:!0,punctuationToRemoveAfterTokenization:null}),e=function(a,b){if(!a)return[];a+="",b||(b=c),b.collapseCase&&(a=a.toLocaleLowerCase());var d=[];return a.replace(b.pattern,b.delimiter).trim().split(b.delimiter).map(function(a){b.punctuationToRemoveAfterTokenization&&(a=a.replace(b.punctuationToRemoveAfterTokenization,"")),a=a.trim(),b.removeSententialPunctuation&&(a=a.replace(/[.,;!\\\"\)\]\}\-]$/g,"").replace(/^[\-\\\",.;\(\[\{]/g,"")),a&&d.push(a)}),d},f=function(a,b,c){emit({error:"This datum might need cleaning, one or more of the lines has more 'words' than it should for an IGT"},{reason:{fieldwhichHasMoreUnitsThanExpected:c.length,expectedUnits:b.length},potentiallyInaccurateData:b,id:a._id})},g=function(b){if(b){var c=b.morphemes||b.gloss||b.context;if(c=c.length){var d,e,g=[],h={size:0},j="";for(d=0;c>d;d++){for(e in b)!b.hasOwnProperty(e)||i.indexOf(e)>-1||(g[d]=g[d]||{confidence:b.confidence||1,fieldCount:0},b[e][d]?(g[d][e]=b[e][d],g[d].fieldCount++):-1===i.indexOf(e)&&(h[e]=b[e],h[e].size++));b.context&&b.context[d]?(g[d].context=b.context[d],j=b.context[d]):g[d].context=j}return h.size&&(g[d].confidence=g[d].confidence*g[d].fieldCount/(g[d].fieldCount+h.size),f(a,g,h)),g}}},h=function(a){var c,f,h,i=[];for(c=0;c<a.length;c++){h=a[c];for(f in h)h.hasOwnProperty(f)&&"confidence"!==f&&("gloss"===f?(b.pattern=d.pattern,h[f]=e(h[f],b)):h[f]=e(h[f],d));h=g(h),h&&(i.push({morphemes:"@"}),i=i.concat(h))}return i.push({morphemes:"@"}),i},i=["context","utterance","orthography","translation"],j=["morphemes","gloss","allomorphs","phonetic","ipa","utterance","orthography","syntacticCategory"],k=function(a){if(!a.session)return void emit({error:"non-datum",id:a._id},a._id);var c=a.fields||a.datumFields;if(c&&c.length){var d,f,i,k={confidence:1},l=!0;for(i=0;i<c.length;i++){if(f=c[i],d=f.id&&f.id.length>0?f.id:f.label,("judgement"===d||"utterance"===d)&&f.mask&&(f.mask=f.mask.trim(),"*"===f.mask[0]||"#"===f.mask[0]||"?"===f.mask[0]))return;"gloss"===d?f.tokenizer=b:f.mask&&"IGT"===f.type&&j.push(d),f.mask&&j.indexOf(d)>-1&&(f.mask=f.mask.trim(),k[d]=e(f.mask,f.tokenizer),k[d].length&&(l=!1))}if(k.morphemes&&!k.utterance&&(k.utterance=k.morphemes.map(function(a){return a.replace(/-=/g,"")})),!k.morphemes&&k.utterance&&k.gloss&&(k.morphemes=k.utterance),k.context||(k.context=k.utterance||k.orthography,delete k.utterance,delete k.orthography),!l){var m=h(g(k));return m}}},l=function(a){try{if(a.trashed&&a.trashed.indexOf("deleted")>-1)return;var b=k(a);if(!b)return;b.map(function(a){if(a&&"@"!==a.morphemes&&(a.gloss||a.morphemes)&&a.fieldCount&&!(a.fieldCount<2)){delete a.fieldCount;var b=a.context;delete a.context,emit(a,b)}})}catch(c){emit({error:""+c,stack:c.stack},a._id)}};l(a)}try{c.lexiconNodes=d}catch(e){}},{}],81:[function(a,b,c){function d(a){}try{c.morphemesPrecedenceContext=d}catch(e){}},{}],82:[function(a,b,c){var d=c;d.bignum=a("bn.js"),d.define=a("./asn1/api").define,d.base=a("./asn1/base"),d.constants=a("./asn1/constants"),d.decoders=a("./asn1/decoders"),d.encoders=a("./asn1/encoders")},{"./asn1/api":83,"./asn1/base":85,"./asn1/constants":89,"./asn1/decoders":91,"./asn1/encoders":94,"bn.js":99}],83:[function(a,b,c){function d(a,b){this.name=a,this.body=b,this.decoders={},this.encoders={}}var e=a("../asn1"),f=a("inherits"),g=c;g.define=function(a,b){return new d(a,b)},d.prototype._createNamed=function(b){var c;try{c=a("vm").runInThisContext("(function "+this.name+"(entity) {\n  this._initNamed(entity);\n})")}catch(d){c=function(a){this._initNamed(a)}}return f(c,b),c.prototype._initNamed=function(a){b.call(this,a)},new c(this)},d.prototype._getDecoder=function(a){return a=a||"der",this.decoders.hasOwnProperty(a)||(this.decoders[a]=this._createNamed(e.decoders[a])),this.decoders[a]},d.prototype.decode=function(a,b,c){return this._getDecoder(b).decode(a,c)},d.prototype._getEncoder=function(a){return a=a||"der",this.encoders.hasOwnProperty(a)||(this.encoders[a]=this._createNamed(e.encoders[a])),this.encoders[a]},d.prototype.encode=function(a,b,c){return this._getEncoder(b).encode(a,c)}},{"../asn1":82,inherits:196,vm:258}],84:[function(a,b,c){function d(a,b){return g.call(this,b),h.isBuffer(a)?(this.base=a,this.offset=0,void(this.length=a.length)):void this.error("Input not Buffer")}function e(a,b){if(Array.isArray(a))this.length=0,this.value=a.map(function(a){return a instanceof e||(a=new e(a,b)),this.length+=a.length,a},this);else if("number"==typeof a){if(!(a>=0&&255>=a))return b.error("non-byte EncoderBuffer value");this.value=a,this.length=1}else if("string"==typeof a)this.value=a,this.length=h.byteLength(a);else{if(!h.isBuffer(a))return b.error("Unsupported type: "+typeof a);this.value=a,this.length=a.length}}var f=a("inherits"),g=a("../base").Reporter,h=a("buffer").Buffer;f(d,g),c.DecoderBuffer=d,d.prototype.save=function(){return{offset:this.offset,reporter:g.prototype.save.call(this)}},d.prototype.restore=function(a){var b=new d(this.base);return b.offset=a.offset,b.length=this.offset,this.offset=a.offset,g.prototype.restore.call(this,a.reporter),b},d.prototype.isEmpty=function(){return this.offset===this.length},d.prototype.readUInt8=function(a){return this.offset+1<=this.length?this.base.readUInt8(this.offset++,!0):this.error(a||"DecoderBuffer overrun")},d.prototype.skip=function(a,b){if(!(this.offset+a<=this.length))return this.error(b||"DecoderBuffer overrun");var c=new d(this.base);return c._reporterState=this._reporterState,c.offset=this.offset,c.length=this.offset+a,this.offset+=a,c},d.prototype.raw=function(a){return this.base.slice(a?a.offset:this.offset,this.length)},c.EncoderBuffer=e,e.prototype.join=function(a,b){return a||(a=new h(this.length)),b||(b=0),0===this.length?a:(Array.isArray(this.value)?this.value.forEach(function(c){c.join(a,b),b+=c.length}):("number"==typeof this.value?a[b]=this.value:"string"==typeof this.value?a.write(this.value,b):h.isBuffer(this.value)&&this.value.copy(a,b),b+=this.length),a)}},{"../base":85,buffer:130,inherits:196}],85:[function(a,b,c){var d=c;d.Reporter=a("./reporter").Reporter,d.DecoderBuffer=a("./buffer").DecoderBuffer,d.EncoderBuffer=a("./buffer").EncoderBuffer,d.Node=a("./node")},{"./buffer":84,"./node":86,"./reporter":87}],86:[function(a,b,c){function d(a,b){var c={};this._baseState=c,c.enc=a,c.parent=b||null,c.children=null,c.tag=null,c.args=null,c.reverseArgs=null,c.choice=null,c.optional=!1,c.any=!1,c.obj=!1,c.use=null,c.useDecoder=null,c.key=null,c["default"]=null,c.explicit=null,c.implicit=null,c.contains=null,c.parent||(c.children=[],this._wrap())}var e=a("../base").Reporter,f=a("../base").EncoderBuffer,g=a("../base").DecoderBuffer,h=a("minimalistic-assert"),i=["seq","seqof","set","setof","objid","bool","gentime","utctime","null_","enum","int","objDesc","bitstr","bmpstr","charstr","genstr","graphstr","ia5str","iso646str","numstr","octstr","printstr","t61str","unistr","utf8str","videostr"],j=["key","obj","use","optional","explicit","implicit","def","choice","any","contains"].concat(i),k=["_peekTag","_decodeTag","_use","_decodeStr","_decodeObjid","_decodeTime","_decodeNull","_decodeInt","_decodeBool","_decodeList","_encodeComposite","_encodeStr","_encodeObjid","_encodeTime","_encodeNull","_encodeInt","_encodeBool"];
b.exports=d;var l=["enc","parent","children","tag","args","reverseArgs","choice","optional","any","obj","use","alteredUse","key","default","explicit","implicit","contains"];d.prototype.clone=function(){var a=this._baseState,b={};l.forEach(function(c){b[c]=a[c]});var c=new this.constructor(b.parent);return c._baseState=b,c},d.prototype._wrap=function(){var a=this._baseState;j.forEach(function(b){this[b]=function(){var c=new this.constructor(this);return a.children.push(c),c[b].apply(c,arguments)}},this)},d.prototype._init=function(a){var b=this._baseState;h(null===b.parent),a.call(this),b.children=b.children.filter(function(a){return a._baseState.parent===this},this),h.equal(b.children.length,1,"Root node can have only one child")},d.prototype._useArgs=function(a){var b=this._baseState,c=a.filter(function(a){return a instanceof this.constructor},this);a=a.filter(function(a){return!(a instanceof this.constructor)},this),0!==c.length&&(h(null===b.children),b.children=c,c.forEach(function(a){a._baseState.parent=this},this)),0!==a.length&&(h(null===b.args),b.args=a,b.reverseArgs=a.map(function(a){if("object"!=typeof a||a.constructor!==Object)return a;var b={};return Object.keys(a).forEach(function(c){c==(0|c)&&(c|=0);var d=a[c];b[d]=c}),b}))},k.forEach(function(a){d.prototype[a]=function(){var b=this._baseState;throw new Error(a+" not implemented for encoding: "+b.enc)}}),i.forEach(function(a){d.prototype[a]=function(){var b=this._baseState,c=Array.prototype.slice.call(arguments);return h(null===b.tag),b.tag=a,this._useArgs(c),this}}),d.prototype.use=function(a){h(a);var b=this._baseState;return h(null===b.use),b.use=a,this},d.prototype.optional=function(){var a=this._baseState;return a.optional=!0,this},d.prototype.def=function(a){var b=this._baseState;return h(null===b["default"]),b["default"]=a,b.optional=!0,this},d.prototype.explicit=function(a){var b=this._baseState;return h(null===b.explicit&&null===b.implicit),b.explicit=a,this},d.prototype.implicit=function(a){var b=this._baseState;return h(null===b.explicit&&null===b.implicit),b.implicit=a,this},d.prototype.obj=function(){var a=this._baseState,b=Array.prototype.slice.call(arguments);return a.obj=!0,0!==b.length&&this._useArgs(b),this},d.prototype.key=function(a){var b=this._baseState;return h(null===b.key),b.key=a,this},d.prototype.any=function(){var a=this._baseState;return a.any=!0,this},d.prototype.choice=function(a){var b=this._baseState;return h(null===b.choice),b.choice=a,this._useArgs(Object.keys(a).map(function(b){return a[b]})),this},d.prototype.contains=function(a){var b=this._baseState;return h(null===b.use),b.contains=a,this},d.prototype._decode=function(a,b){var c=this._baseState;if(null===c.parent)return a.wrapResult(c.children[0]._decode(a,b));var d=c["default"],e=!0,f=null;if(null!==c.key&&(f=a.enterKey(c.key)),c.optional){var h=null;if(null!==c.explicit?h=c.explicit:null!==c.implicit?h=c.implicit:null!==c.tag&&(h=c.tag),null!==h||c.any){if(e=this._peekTag(a,h,c.any),a.isError(e))return e}else{var i=a.save();try{null===c.choice?this._decodeGeneric(c.tag,a,b):this._decodeChoice(a,b),e=!0}catch(j){e=!1}a.restore(i)}}var k;if(c.obj&&e&&(k=a.enterObject()),e){if(null!==c.explicit){var l=this._decodeTag(a,c.explicit);if(a.isError(l))return l;a=l}var m=a.offset;if(null===c.use&&null===c.choice){if(c.any)var i=a.save();var n=this._decodeTag(a,null!==c.implicit?c.implicit:c.tag,c.any);if(a.isError(n))return n;c.any?d=a.raw(i):a=n}if(b&&b.track&&null!==c.tag&&b.track(a.path(),m,a.length,"tagged"),b&&b.track&&null!==c.tag&&b.track(a.path(),a.offset,a.length,"content"),d=c.any?d:null===c.choice?this._decodeGeneric(c.tag,a,b):this._decodeChoice(a,b),a.isError(d))return d;if(c.any||null!==c.choice||null===c.children||c.children.forEach(function(c){c._decode(a,b)}),c.contains&&("octstr"===c.tag||"bitstr"===c.tag)){var o=new g(d);d=this._getUse(c.contains,a._reporterState.obj)._decode(o,b)}}return c.obj&&e&&(d=a.leaveObject(k)),null===c.key||null===d&&e!==!0?null!==f&&a.exitKey(f):a.leaveKey(f,c.key,d),d},d.prototype._decodeGeneric=function(a,b,c){var d=this._baseState;return"seq"===a||"set"===a?null:"seqof"===a||"setof"===a?this._decodeList(b,a,d.args[0],c):/str$/.test(a)?this._decodeStr(b,a,c):"objid"===a&&d.args?this._decodeObjid(b,d.args[0],d.args[1],c):"objid"===a?this._decodeObjid(b,null,null,c):"gentime"===a||"utctime"===a?this._decodeTime(b,a,c):"null_"===a?this._decodeNull(b,c):"bool"===a?this._decodeBool(b,c):"objDesc"===a?this._decodeStr(b,a,c):"int"===a||"enum"===a?this._decodeInt(b,d.args&&d.args[0],c):null!==d.use?this._getUse(d.use,b._reporterState.obj)._decode(b,c):b.error("unknown tag: "+a)},d.prototype._getUse=function(a,b){var c=this._baseState;return c.useDecoder=this._use(a,b),h(null===c.useDecoder._baseState.parent),c.useDecoder=c.useDecoder._baseState.children[0],c.implicit!==c.useDecoder._baseState.implicit&&(c.useDecoder=c.useDecoder.clone(),c.useDecoder._baseState.implicit=c.implicit),c.useDecoder},d.prototype._decodeChoice=function(a,b){var c=this._baseState,d=null,e=!1;return Object.keys(c.choice).some(function(f){var g=a.save(),h=c.choice[f];try{var i=h._decode(a,b);if(a.isError(i))return!1;d={type:f,value:i},e=!0}catch(j){return a.restore(g),!1}return!0},this),e?d:a.error("Choice not matched")},d.prototype._createEncoderBuffer=function(a){return new f(a,this.reporter)},d.prototype._encode=function(a,b,c){var d=this._baseState;if(null===d["default"]||d["default"]!==a){var e=this._encodeValue(a,b,c);if(void 0!==e&&!this._skipDefault(e,b,c))return e}},d.prototype._encodeValue=function(a,b,c){var d=this._baseState;if(null===d.parent)return d.children[0]._encode(a,b||new e);var f=null;if(this.reporter=b,d.optional&&void 0===a){if(null===d["default"])return;a=d["default"]}var g=null,h=!1;if(d.any)f=this._createEncoderBuffer(a);else if(d.choice)f=this._encodeChoice(a,b);else if(d.contains)g=this._getUse(d.contains,c)._encode(a,b),h=!0;else if(d.children)g=d.children.map(function(c){if("null_"===c._baseState.tag)return c._encode(null,b,a);if(null===c._baseState.key)return b.error("Child should have a key");var d=b.enterKey(c._baseState.key);if("object"!=typeof a)return b.error("Child expected, but input is not object");var e=c._encode(a[c._baseState.key],b,a);return b.leaveKey(d),e},this).filter(function(a){return a}),g=this._createEncoderBuffer(g);else if("seqof"===d.tag||"setof"===d.tag){if(!d.args||1!==d.args.length)return b.error("Too many args for : "+d.tag);if(!Array.isArray(a))return b.error("seqof/setof, but data is not Array");var i=this.clone();i._baseState.implicit=null,g=this._createEncoderBuffer(a.map(function(c){var d=this._baseState;return this._getUse(d.args[0],a)._encode(c,b)},i))}else null!==d.use?f=this._getUse(d.use,c)._encode(a,b):(g=this._encodePrimitive(d.tag,a),h=!0);var f;if(!d.any&&null===d.choice){var j=null!==d.implicit?d.implicit:d.tag,k=null===d.implicit?"universal":"context";null===j?null===d.use&&b.error("Tag could be ommited only for .use()"):null===d.use&&(f=this._encodeComposite(j,h,k,g))}return null!==d.explicit&&(f=this._encodeComposite(d.explicit,!1,"context",f)),f},d.prototype._encodeChoice=function(a,b){var c=this._baseState,d=c.choice[a.type];return d||h(!1,a.type+" not found in "+JSON.stringify(Object.keys(c.choice))),d._encode(a.value,b)},d.prototype._encodePrimitive=function(a,b){var c=this._baseState;if(/str$/.test(a))return this._encodeStr(b,a);if("objid"===a&&c.args)return this._encodeObjid(b,c.reverseArgs[0],c.args[1]);if("objid"===a)return this._encodeObjid(b,null,null);if("gentime"===a||"utctime"===a)return this._encodeTime(b,a);if("null_"===a)return this._encodeNull();if("int"===a||"enum"===a)return this._encodeInt(b,c.args&&c.reverseArgs[0]);if("bool"===a)return this._encodeBool(b);if("objDesc"===a)return this._encodeStr(b,a);throw new Error("Unsupported tag: "+a)},d.prototype._isNumstr=function(a){return/^[0-9 ]*$/.test(a)},d.prototype._isPrintstr=function(a){return/^[A-Za-z0-9 '\(\)\+,\-\.\/:=\?]*$/.test(a)}},{"../base":85,"minimalistic-assert":200}],87:[function(a,b,c){function d(a){this._reporterState={obj:null,path:[],options:a||{},errors:[]}}function e(a,b){this.path=a,this.rethrow(b)}var f=a("inherits");c.Reporter=d,d.prototype.isError=function(a){return a instanceof e},d.prototype.save=function(){var a=this._reporterState;return{obj:a.obj,pathLen:a.path.length}},d.prototype.restore=function(a){var b=this._reporterState;b.obj=a.obj,b.path=b.path.slice(0,a.pathLen)},d.prototype.enterKey=function(a){return this._reporterState.path.push(a)},d.prototype.exitKey=function(a){var b=this._reporterState;b.path=b.path.slice(0,a-1)},d.prototype.leaveKey=function(a,b,c){var d=this._reporterState;this.exitKey(a),null!==d.obj&&(d.obj[b]=c)},d.prototype.path=function(){return this._reporterState.path.join("/")},d.prototype.enterObject=function(){var a=this._reporterState,b=a.obj;return a.obj={},b},d.prototype.leaveObject=function(a){var b=this._reporterState,c=b.obj;return b.obj=a,c},d.prototype.error=function(a){var b,c=this._reporterState,d=a instanceof e;if(b=d?a:new e(c.path.map(function(a){return"["+JSON.stringify(a)+"]"}).join(""),a.message||a,a.stack),!c.options.partial)throw b;return d||c.errors.push(b),b},d.prototype.wrapResult=function(a){var b=this._reporterState;return b.options.partial?{result:this.isError(a)?null:a,errors:b.errors}:a},f(e,Error),e.prototype.rethrow=function(a){if(this.message=a+" at: "+(this.path||"(shallow)"),Error.captureStackTrace&&Error.captureStackTrace(this,e),!this.stack)try{throw new Error(this.message)}catch(b){this.stack=b.stack}return this}},{inherits:196}],88:[function(a,b,c){var d=a("../constants");c.tagClass={0:"universal",1:"application",2:"context",3:"private"},c.tagClassByName=d._reverse(c.tagClass),c.tag={0:"end",1:"bool",2:"int",3:"bitstr",4:"octstr",5:"null_",6:"objid",7:"objDesc",8:"external",9:"real",10:"enum",11:"embed",12:"utf8str",13:"relativeOid",16:"seq",17:"set",18:"numstr",19:"printstr",20:"t61str",21:"videostr",22:"ia5str",23:"utctime",24:"gentime",25:"graphstr",26:"iso646str",27:"genstr",28:"unistr",29:"charstr",30:"bmpstr"},c.tagByName=d._reverse(c.tag)},{"../constants":89}],89:[function(a,b,c){var d=c;d._reverse=function(a){var b={};return Object.keys(a).forEach(function(c){(0|c)==c&&(c=0|c);var d=a[c];b[d]=c}),b},d.der=a("./der")},{"./der":88}],90:[function(a,b,c){function d(a){this.enc="der",this.name=a.name,this.entity=a,this.tree=new e,this.tree._init(a.body)}function e(a){j.Node.call(this,"der",a)}function f(a,b){var c=a.readUInt8(b);if(a.isError(c))return c;var d=l.tagClass[c>>6],e=0===(32&c);if(31===(31&c)){var f=c;for(c=0;128===(128&f);){if(f=a.readUInt8(b),a.isError(f))return f;c<<=7,c|=127&f}}else c&=31;var g=l.tag[c];return{cls:d,primitive:e,tag:c,tagStr:g}}function g(a,b,c){var d=a.readUInt8(c);if(a.isError(d))return d;if(!b&&128===d)return null;if(0===(128&d))return d;var e=127&d;if(e>4)return a.error("length octect is too long");d=0;for(var f=0;e>f;f++){d<<=8;var g=a.readUInt8(c);if(a.isError(g))return g;d|=g}return d}var h=a("inherits"),i=a("../../asn1"),j=i.base,k=i.bignum,l=i.constants.der;b.exports=d,d.prototype.decode=function(a,b){return a instanceof j.DecoderBuffer||(a=new j.DecoderBuffer(a,b)),this.tree._decode(a,b)},h(e,j.Node),e.prototype._peekTag=function(a,b,c){if(a.isEmpty())return!1;var d=a.save(),e=f(a,'Failed to peek tag: "'+b+'"');return a.isError(e)?e:(a.restore(d),e.tag===b||e.tagStr===b||e.tagStr+"of"===b||c)},e.prototype._decodeTag=function(a,b,c){var d=f(a,'Failed to decode tag of "'+b+'"');if(a.isError(d))return d;var e=g(a,d.primitive,'Failed to get length of "'+b+'"');if(a.isError(e))return e;if(!c&&d.tag!==b&&d.tagStr!==b&&d.tagStr+"of"!==b)return a.error('Failed to match tag: "'+b+'"');if(d.primitive||null!==e)return a.skip(e,'Failed to match body of: "'+b+'"');var h=a.save(),i=this._skipUntilEnd(a,'Failed to skip indefinite length body: "'+this.tag+'"');return a.isError(i)?i:(e=a.offset-h.offset,a.restore(h),a.skip(e,'Failed to match body of: "'+b+'"'))},e.prototype._skipUntilEnd=function(a,b){for(;;){var c=f(a,b);if(a.isError(c))return c;var d=g(a,c.primitive,b);if(a.isError(d))return d;var e;if(e=c.primitive||null!==d?a.skip(d):this._skipUntilEnd(a,b),a.isError(e))return e;if("end"===c.tagStr)break}},e.prototype._decodeList=function(a,b,c,d){for(var e=[];!a.isEmpty();){var f=this._peekTag(a,"end");if(a.isError(f))return f;var g=c.decode(a,"der",d);if(a.isError(g)&&f)break;e.push(g)}return e},e.prototype._decodeStr=function(a,b){if("bitstr"===b){var c=a.readUInt8();return a.isError(c)?c:{unused:c,data:a.raw()}}if("bmpstr"===b){var d=a.raw();if(d.length%2===1)return a.error("Decoding of string type: bmpstr length mismatch");for(var e="",f=0;f<d.length/2;f++)e+=String.fromCharCode(d.readUInt16BE(2*f));return e}if("numstr"===b){var g=a.raw().toString("ascii");return this._isNumstr(g)?g:a.error("Decoding of string type: numstr unsupported characters")}if("octstr"===b)return a.raw();if("objDesc"===b)return a.raw();if("printstr"===b){var h=a.raw().toString("ascii");return this._isPrintstr(h)?h:a.error("Decoding of string type: printstr unsupported characters")}return/str$/.test(b)?a.raw().toString():a.error("Decoding of string type: "+b+" unsupported")},e.prototype._decodeObjid=function(a,b,c){for(var d,e=[],f=0;!a.isEmpty();){var g=a.readUInt8();f<<=7,f|=127&g,0===(128&g)&&(e.push(f),f=0)}128&g&&e.push(f);var h=e[0]/40|0,i=e[0]%40;if(d=c?e:[h,i].concat(e.slice(1)),b){var j=b[d.join(" ")];void 0===j&&(j=b[d.join(".")]),void 0!==j&&(d=j)}return d},e.prototype._decodeTime=function(a,b){var c=a.raw().toString();if("gentime"===b)var d=0|c.slice(0,4),e=0|c.slice(4,6),f=0|c.slice(6,8),g=0|c.slice(8,10),h=0|c.slice(10,12),i=0|c.slice(12,14);else{if("utctime"!==b)return a.error("Decoding "+b+" time is not supported yet");var d=0|c.slice(0,2),e=0|c.slice(2,4),f=0|c.slice(4,6),g=0|c.slice(6,8),h=0|c.slice(8,10),i=0|c.slice(10,12);d=70>d?2e3+d:1900+d}return Date.UTC(d,e-1,f,g,h,i,0)},e.prototype._decodeNull=function(a){return null},e.prototype._decodeBool=function(a){var b=a.readUInt8();return a.isError(b)?b:0!==b},e.prototype._decodeInt=function(a,b){var c=a.raw(),d=new k(c);return b&&(d=b[d.toString(10)]||d),d},e.prototype._use=function(a,b){return"function"==typeof a&&(a=a(b)),a._getDecoder("der").tree}},{"../../asn1":82,inherits:196}],91:[function(a,b,c){var d=c;d.der=a("./der"),d.pem=a("./pem")},{"./der":90,"./pem":92}],92:[function(a,b,c){function d(a){g.call(this,a),this.enc="pem"}var e=a("inherits"),f=a("buffer").Buffer,g=a("./der");e(d,g),b.exports=d,d.prototype.decode=function(a,b){for(var c=a.toString().split(/[\r\n]+/g),d=b.label.toUpperCase(),e=/^-----(BEGIN|END) ([^-]+)-----$/,h=-1,i=-1,j=0;j<c.length;j++){var k=c[j].match(e);if(null!==k&&k[2]===d){if(-1!==h){if("END"!==k[1])break;i=j;break}if("BEGIN"!==k[1])break;h=j}}if(-1===h||-1===i)throw new Error("PEM section not found for: "+d);var l=c.slice(h+1,i).join("");l.replace(/[^a-z0-9\+\/=]+/gi,"");var m=new f(l,"base64");return g.prototype.decode.call(this,m,b)}},{"./der":90,buffer:130,inherits:196}],93:[function(a,b,c){function d(a){this.enc="der",this.name=a.name,this.entity=a,this.tree=new e,this.tree._init(a.body)}function e(a){k.Node.call(this,"der",a)}function f(a){return 10>a?"0"+a:a}function g(a,b,c,d){var e;if("seqof"===a?a="seq":"setof"===a&&(a="set"),l.tagByName.hasOwnProperty(a))e=l.tagByName[a];else{if("number"!=typeof a||(0|a)!==a)return d.error("Unknown tag: "+a);e=a}return e>=31?d.error("Multi-octet tag encoding unsupported"):(b||(e|=32),e|=l.tagClassByName[c||"universal"]<<6)}var h=a("inherits"),i=a("buffer").Buffer,j=a("../../asn1"),k=j.base,l=j.constants.der;b.exports=d,d.prototype.encode=function(a,b){return this.tree._encode(a,b).join()},h(e,k.Node),e.prototype._encodeComposite=function(a,b,c,d){var e=g(a,b,c,this.reporter);if(d.length<128){var f=new i(2);return f[0]=e,f[1]=d.length,this._createEncoderBuffer([f,d])}for(var h=1,j=d.length;j>=256;j>>=8)h++;var f=new i(2+h);f[0]=e,f[1]=128|h;for(var j=1+h,k=d.length;k>0;j--,k>>=8)f[j]=255&k;return this._createEncoderBuffer([f,d])},e.prototype._encodeStr=function(a,b){if("bitstr"===b)return this._createEncoderBuffer([0|a.unused,a.data]);if("bmpstr"===b){for(var c=new i(2*a.length),d=0;d<a.length;d++)c.writeUInt16BE(a.charCodeAt(d),2*d);return this._createEncoderBuffer(c)}return"numstr"===b?this._isNumstr(a)?this._createEncoderBuffer(a):this.reporter.error("Encoding of string type: numstr supports only digits and space"):"printstr"===b?this._isPrintstr(a)?this._createEncoderBuffer(a):this.reporter.error("Encoding of string type: printstr supports only latin upper and lower case letters, digits, space, apostrophe, left and rigth parenthesis, plus sign, comma, hyphen, dot, slash, colon, equal sign, question mark"):/str$/.test(b)?this._createEncoderBuffer(a):"objDesc"===b?this._createEncoderBuffer(a):this.reporter.error("Encoding of string type: "+b+" unsupported")},e.prototype._encodeObjid=function(a,b,c){if("string"==typeof a){if(!b)return this.reporter.error("string objid given, but no values map found");if(!b.hasOwnProperty(a))return this.reporter.error("objid not found in values map");a=b[a].split(/[\s\.]+/g);for(var d=0;d<a.length;d++)a[d]|=0}else if(Array.isArray(a)){a=a.slice();for(var d=0;d<a.length;d++)a[d]|=0}if(!Array.isArray(a))return this.reporter.error("objid() should be either array or string, got: "+JSON.stringify(a));if(!c){if(a[1]>=40)return this.reporter.error("Second objid identifier OOB");a.splice(0,2,40*a[0]+a[1])}for(var e=0,d=0;d<a.length;d++){var f=a[d];for(e++;f>=128;f>>=7)e++}for(var g=new i(e),h=g.length-1,d=a.length-1;d>=0;d--){var f=a[d];for(g[h--]=127&f;(f>>=7)>0;)g[h--]=128|127&f}return this._createEncoderBuffer(g)},e.prototype._encodeTime=function(a,b){var c,d=new Date(a);return"gentime"===b?c=[f(d.getFullYear()),f(d.getUTCMonth()+1),f(d.getUTCDate()),f(d.getUTCHours()),f(d.getUTCMinutes()),f(d.getUTCSeconds()),"Z"].join(""):"utctime"===b?c=[f(d.getFullYear()%100),f(d.getUTCMonth()+1),f(d.getUTCDate()),f(d.getUTCHours()),f(d.getUTCMinutes()),f(d.getUTCSeconds()),"Z"].join(""):this.reporter.error("Encoding "+b+" time is not supported yet"),this._encodeStr(c,"octstr")},e.prototype._encodeNull=function(){return this._createEncoderBuffer("")},e.prototype._encodeInt=function(a,b){if("string"==typeof a){if(!b)return this.reporter.error("String int or enum given, but no values map");if(!b.hasOwnProperty(a))return this.reporter.error("Values map doesn't contain: "+JSON.stringify(a));a=b[a]}if("number"!=typeof a&&!i.isBuffer(a)){var c=a.toArray();!a.sign&&128&c[0]&&c.unshift(0),a=new i(c)}if(i.isBuffer(a)){var d=a.length;0===a.length&&d++;var e=new i(d);return a.copy(e),0===a.length&&(e[0]=0),this._createEncoderBuffer(e)}if(128>a)return this._createEncoderBuffer(a);if(256>a)return this._createEncoderBuffer([0,a]);for(var d=1,f=a;f>=256;f>>=8)d++;for(var e=new Array(d),f=e.length-1;f>=0;f--)e[f]=255&a,a>>=8;return 128&e[0]&&e.unshift(0),this._createEncoderBuffer(new i(e))},e.prototype._encodeBool=function(a){return this._createEncoderBuffer(a?255:0)},e.prototype._use=function(a,b){return"function"==typeof a&&(a=a(b)),a._getEncoder("der").tree},e.prototype._skipDefault=function(a,b,c){var d,e=this._baseState;if(null===e["default"])return!1;var f=a.join();if(void 0===e.defaultBuffer&&(e.defaultBuffer=this._encodeValue(e["default"],b,c).join()),f.length!==e.defaultBuffer.length)return!1;for(d=0;d<f.length;d++)if(f[d]!==e.defaultBuffer[d])return!1;return!0}},{"../../asn1":82,buffer:130,inherits:196}],94:[function(a,b,c){var d=c;d.der=a("./der"),d.pem=a("./pem")},{"./der":93,"./pem":95}],95:[function(a,b,c){function d(a){f.call(this,a),this.enc="pem"}var e=a("inherits"),f=a("./der");e(d,f),b.exports=d,d.prototype.encode=function(a,b){for(var c=f.prototype.encode.call(this,a),d=c.toString("base64"),e=["-----BEGIN "+b.label+"-----"],g=0;g<d.length;g+=64)e.push(d.slice(g,g+64));return e.push("-----END "+b.label+"-----"),e.join("\n")}},{"./der":93,inherits:196}],96:[function(a,b,c){(function(a){!function(){"use strict";function c(b){return new a(b,"base64").toString("binary")}b.exports=c}()}).call(this,a("buffer").Buffer)},{buffer:130}],97:[function(a,b,c){var d="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";!function(a){"use strict";function b(a){var b=a.charCodeAt(0);return b===g||b===l?62:b===h||b===m?63:i>b?-1:i+10>b?b-i+26+26:k+26>b?b-k:j+26>b?b-j+26:void 0}function c(a){function c(a){j[l++]=a}var d,e,g,h,i,j;if(a.length%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var k=a.length;i="="===a.charAt(k-2)?2:"="===a.charAt(k-1)?1:0,j=new f(3*a.length/4-i),g=i>0?a.length-4:a.length;var l=0;for(d=0,e=0;g>d;d+=4,e+=3)h=b(a.charAt(d))<<18|b(a.charAt(d+1))<<12|b(a.charAt(d+2))<<6|b(a.charAt(d+3)),c((16711680&h)>>16),c((65280&h)>>8),c(255&h);return 2===i?(h=b(a.charAt(d))<<2|b(a.charAt(d+1))>>4,c(255&h)):1===i&&(h=b(a.charAt(d))<<10|b(a.charAt(d+1))<<4|b(a.charAt(d+2))>>2,c(h>>8&255),c(255&h)),j}function e(a){function b(a){return d.charAt(a)}function c(a){return b(a>>18&63)+b(a>>12&63)+b(a>>6&63)+b(63&a)}var e,f,g,h=a.length%3,i="";for(e=0,g=a.length-h;g>e;e+=3)f=(a[e]<<16)+(a[e+1]<<8)+a[e+2],i+=c(f);switch(h){case 1:f=a[a.length-1],i+=b(f>>2),i+=b(f<<4&63),i+="==";break;case 2:f=(a[a.length-2]<<8)+a[a.length-1],i+=b(f>>10),i+=b(f>>4&63),i+=b(f<<2&63),i+="="}return i}var f="undefined"!=typeof Uint8Array?Uint8Array:Array,g="+".charCodeAt(0),h="/".charCodeAt(0),i="0".charCodeAt(0),j="a".charCodeAt(0),k="A".charCodeAt(0),l="-".charCodeAt(0),m="_".charCodeAt(0);a.toByteArray=c,a.fromByteArray=e}("undefined"==typeof c?this.base64js={}:c)},{}],98:[function(a,b,c){(function(c){!function(c,d){"function"==typeof define&&define.amd?define([],d):"function"==typeof a&&"object"==typeof b&&b&&b.exports?b.exports=d():(c.dcodeIO=c.dcodeIO||{}).bcrypt=d()}(this,function(){"use strict";function d(c){if("undefined"!=typeof b&&b&&b.exports)try{return a("crypto").randomBytes(c)}catch(d){}try{var e;return(self.crypto||self.msCrypto).getRandomValues(e=new Uint32Array(c)),Array.prototype.slice.call(e)}catch(d){}if(!p)throw Error("Neither WebCryptoAPI nor a crypto module is available. Use bcrypt.setRandomFallback to set an alternative");return p(c)}function e(a,b){for(var c=0,d=0,e=0,f=a.length;f>e;++e)a.charCodeAt(e)===b.charCodeAt(e)?++c:++d;return 0>c?!1:0===d}function f(a){var b=[],c=0;return w.encodeUTF16toUTF8(function(){return c>=a.length?null:a.charCodeAt(c++)},function(a){b.push(a)}),b}function g(a,b){var c,d,e=0,f=[];if(0>=b||b>a.length)throw Error("Illegal len: "+b);for(;b>e;){if(c=255&a[e++],f.push(t[c>>2&63]),c=(3&c)<<4,e>=b){f.push(t[63&c]);break}if(d=255&a[e++],c|=d>>4&15,f.push(t[63&c]),c=(15&d)<<2,e>=b){f.push(t[63&c]);break}d=255&a[e++],c|=d>>6&3,f.push(t[63&c]),f.push(t[63&d])}return f.join("")}function h(a,b){var c,d,e,f,g,h,i=0,j=a.length,k=0,l=[];if(0>=b)throw Error("Illegal len: "+b);for(;j-1>i&&b>k&&(h=a.charCodeAt(i++),c=h<u.length?u[h]:-1,h=a.charCodeAt(i++),d=h<u.length?u[h]:-1,-1!=c&&-1!=d)&&(g=c<<2>>>0,g|=(48&d)>>4,l.push(v(g)),!(++k>=b||i>=j))&&(h=a.charCodeAt(i++),e=h<u.length?u[h]:-1,-1!=e)&&(g=(15&d)<<4>>>0,g|=(60&e)>>2,l.push(v(g)),!(++k>=b||i>=j));)h=a.charCodeAt(i++),f=h<u.length?u[h]:-1,g=(3&e)<<6>>>0,g|=f,l.push(v(g)),++k;var m=[];for(i=0;k>i;i++)m.push(l[i].charCodeAt(0));return m}function i(a,b,c,d){var e,f=a[b],g=a[b+1];return f^=c[0],e=d[f>>>24],e+=d[256|f>>16&255],e^=d[512|f>>8&255],e+=d[768|255&f],g^=e^c[1],e=d[g>>>24],e+=d[256|g>>16&255],e^=d[512|g>>8&255],e+=d[768|255&g],f^=e^c[2],e=d[f>>>24],e+=d[256|f>>16&255],e^=d[512|f>>8&255],e+=d[768|255&f],g^=e^c[3],e=d[g>>>24],e+=d[256|g>>16&255],e^=d[512|g>>8&255],e+=d[768|255&g],f^=e^c[4],e=d[f>>>24],e+=d[256|f>>16&255],e^=d[512|f>>8&255],e+=d[768|255&f],g^=e^c[5],e=d[g>>>24],e+=d[256|g>>16&255],e^=d[512|g>>8&255],e+=d[768|255&g],f^=e^c[6],e=d[f>>>24],e+=d[256|f>>16&255],e^=d[512|f>>8&255],e+=d[768|255&f],g^=e^c[7],e=d[g>>>24],e+=d[256|g>>16&255],e^=d[512|g>>8&255],e+=d[768|255&g],f^=e^c[8],e=d[f>>>24],e+=d[256|f>>16&255],e^=d[512|f>>8&255],e+=d[768|255&f],g^=e^c[9],e=d[g>>>24],e+=d[256|g>>16&255],e^=d[512|g>>8&255],e+=d[768|255&g],f^=e^c[10],e=d[f>>>24],e+=d[256|f>>16&255],e^=d[512|f>>8&255],e+=d[768|255&f],g^=e^c[11],e=d[g>>>24],e+=d[256|g>>16&255],e^=d[512|g>>8&255],e+=d[768|255&g],f^=e^c[12],e=d[f>>>24],e+=d[256|f>>16&255],e^=d[512|f>>8&255],e+=d[768|255&f],g^=e^c[13],e=d[g>>>24],e+=d[256|g>>16&255],e^=d[512|g>>8&255],e+=d[768|255&g],f^=e^c[14],e=d[f>>>24],e+=d[256|f>>16&255],e^=d[512|f>>8&255],e+=d[768|255&f],g^=e^c[15],e=d[g>>>24],e+=d[256|g>>16&255],e^=d[512|g>>8&255],e+=d[768|255&g],f^=e^c[16],a[b]=g^c[z+1],a[b+1]=f,a}function j(a,b){for(var c=0,d=0;4>c;++c)d=d<<8|255&a[b],b=(b+1)%a.length;return{key:d,offp:b}}function k(a,b,c){for(var d,e=0,f=[0,0],g=b.length,h=c.length,k=0;g>k;k++)d=j(a,e),e=d.offp,b[k]=b[k]^d.key;for(k=0;g>k;k+=2)f=i(f,0,b,c),b[k]=f[0],b[k+1]=f[1];for(k=0;h>k;k+=2)f=i(f,0,b,c),c[k]=f[0],c[k+1]=f[1]}function l(a,b,c,d){for(var e,f=0,g=[0,0],h=c.length,k=d.length,l=0;h>l;l++)e=j(b,f),f=e.offp,c[l]=c[l]^e.key;for(f=0,l=0;h>l;l+=2)e=j(a,f),f=e.offp,g[0]^=e.key,e=j(a,f),f=e.offp,g[1]^=e.key,g=i(g,0,c,d),c[l]=g[0],c[l+1]=g[1];for(l=0;k>l;l+=2)e=j(a,f),f=e.offp,g[0]^=e.key,e=j(a,f),f=e.offp,g[1]^=e.key,g=i(g,0,c,d),d[l]=g[0],d[l+1]=g[1]}function m(a,b,c,d,e){function f(){if(e&&e(p/c),!(c>p)){for(p=0;64>p;p++)for(o=0;j>>1>o;o++)i(h,o<<1,m,n);var g=[];for(p=0;j>p;p++)g.push((h[p]>>24&255)>>>0),g.push((h[p]>>16&255)>>>0),g.push((h[p]>>8&255)>>>0),g.push((255&h[p])>>>0);return d?void d(null,g):g}for(var l=Date.now();c>p&&(p+=1,k(a,m,n),k(b,m,n),!(Date.now()-l>A)););d&&s(f)}var g,h=D.slice(),j=h.length;if(4>c||c>31){if(g=Error("Illegal number of rounds (4-31): "+c),d)return void s(d.bind(this,g));throw g}if(b.length!==x){if(g=Error("Illegal salt length: "+b.length+" != "+x),d)return void s(d.bind(this,g));throw g}c=1<<c>>>0;var m,n,o,p=0;if(Int32Array?(m=new Int32Array(B),n=new Int32Array(C)):(m=B.slice(),n=C.slice()),l(b,a,m,n),"undefined"!=typeof d)f();else for(var q;;)if("undefined"!=typeof(q=f()))return q||[]}function n(a,b,c,d){function e(a){var b=[];return b.push("$2"),j>="a"&&b.push(j),b.push("$"),10>o&&b.push("0"),b.push(o.toString()),b.push("$"),b.push(g(r,r.length)),b.push(g(a,4*D.length-1)),b.join("")}var i;if("string"!=typeof a||"string"!=typeof b){if(i=Error("Invalid string / salt: Not a string"),c)return void s(c.bind(this,i));throw i}var j,k;if("$"!==b.charAt(0)||"2"!==b.charAt(1)){if(i=Error("Invalid salt version: "+b.substring(0,2)),c)return void s(c.bind(this,i));throw i}if("$"===b.charAt(2))j=String.fromCharCode(0),k=3;else{if(j=b.charAt(2),"a"!==j&&"b"!==j&&"y"!==j||"$"!==b.charAt(3)){if(i=Error("Invalid salt revision: "+b.substring(2,4)),c)return void s(c.bind(this,i));throw i}k=4}if(b.charAt(k+2)>"$"){if(i=Error("Missing salt rounds"),c)return void s(c.bind(this,i));throw i}var l=10*parseInt(b.substring(k,k+1),10),n=parseInt(b.substring(k+1,k+2),10),o=l+n,p=b.substring(k+3,k+25);a+=j>="a"?"\x00":"";var q=f(a),r=h(p,x);return"undefined"==typeof c?e(m(q,r,o)):void m(q,r,o,function(a,b){a?c(a,null):c(null,e(b))},d)}var o={},p=null,q=!1;try{d(1),q=!0}catch(r){}p=null,o.setRandomFallback=function(a){p=a},o.genSaltSync=function(a,b){if(a=a||y,"number"!=typeof a)throw Error("Illegal arguments: "+typeof a+", "+typeof b);4>a?a=4:a>31&&(a=31);var c=[];return c.push("$2a$"),10>a&&c.push("0"),c.push(a.toString()),c.push("$"),c.push(g(d(x),x)),c.join("")},o.genSalt=function(a,b,c){function d(b){s(function(){try{b(null,o.genSaltSync(a))}catch(c){b(c)}})}if("function"==typeof b&&(c=b,b=void 0),"function"==typeof a&&(c=a,a=void 0),"undefined"==typeof a)a=y;else if("number"!=typeof a)throw Error("illegal arguments: "+typeof a);if(!c)return new Promise(function(a,b){d(function(c,d){return c?void b(c):void a(d)})});if("function"!=typeof c)throw Error("Illegal callback: "+typeof c);d(c)},o.hashSync=function(a,b){if("undefined"==typeof b&&(b=y),"number"==typeof b&&(b=o.genSaltSync(b)),"string"!=typeof a||"string"!=typeof b)throw Error("Illegal arguments: "+typeof a+", "+typeof b);return n(a,b)},o.hash=function(a,b,c,d){function e(c){"string"==typeof a&&"number"==typeof b?o.genSalt(b,function(b,e){n(a,e,c,d)}):"string"==typeof a&&"string"==typeof b?n(a,b,c,d):s(c.bind(this,Error("Illegal arguments: "+typeof a+", "+typeof b)))}if(!c)return new Promise(function(a,b){e(function(c,d){return c?void b(c):void a(d)})});if("function"!=typeof c)throw Error("Illegal callback: "+typeof c);e(c)},o.compareSync=function(a,b){if("string"!=typeof a||"string"!=typeof b)throw Error("Illegal arguments: "+typeof a+", "+typeof b);return 60!==b.length?!1:e(o.hashSync(a,b.substr(0,b.length-31)),b)},o.compare=function(a,b,c,d){function f(c){return"string"!=typeof a||"string"!=typeof b?void s(c.bind(this,Error("Illegal arguments: "+typeof a+", "+typeof b))):60!==b.length?void s(c.bind(this,null,!1)):void o.hash(a,b.substr(0,29),function(a,d){a?c(a):c(null,e(d,b))},d)}if(!c)return new Promise(function(a,b){f(function(c,d){return c?void b(c):void a(d)})});if("function"!=typeof c)throw Error("Illegal callback: "+typeof c);f(c)},o.getRounds=function(a){if("string"!=typeof a)throw Error("Illegal arguments: "+typeof a);return parseInt(a.split("$")[2],10)},o.getSalt=function(a){if("string"!=typeof a)throw Error("Illegal arguments: "+typeof a);if(60!==a.length)throw Error("Illegal hash length: "+a.length+" != 60");return a.substring(0,29)};var s="undefined"!=typeof c&&c&&"function"==typeof c.nextTick?"function"==typeof setImmediate?setImmediate:c.nextTick:setTimeout,t="./ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789".split(""),u=[-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,0,1,54,55,56,57,58,59,60,61,62,63,-1,-1,-1,-1,-1,-1,-1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,-1,-1,-1,-1,-1,-1,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,-1,-1,-1,-1,-1],v=String.fromCharCode,w=function(){var a={};return a.MAX_CODEPOINT=1114111,a.encodeUTF8=function(a,b){var c=null;for("number"==typeof a&&(c=a,a=function(){return null});null!==c||null!==(c=a());)128>c?b(127&c):2048>c?(b(c>>6&31|192),b(63&c|128)):65536>c?(b(c>>12&15|224),b(c>>6&63|128),b(63&c|128)):(b(c>>18&7|240),b(c>>12&63|128),b(c>>6&63|128),b(63&c|128)),c=null},a.decodeUTF8=function(a,b){for(var c,d,e,f,g=function(a){a=a.slice(0,a.indexOf(null));var b=Error(a.toString());throw b.name="TruncatedError",b.bytes=a,b};null!==(c=a());)if(0===(128&c))b(c);else if(192===(224&c))null===(d=a())&&g([c,d]),b((31&c)<<6|63&d);else if(224===(240&c))(null===(d=a())||null===(e=a()))&&g([c,d,e]),b((15&c)<<12|(63&d)<<6|63&e);else{if(240!==(248&c))throw RangeError("Illegal starting byte: "+c);(null===(d=a())||null===(e=a())||null===(f=a()))&&g([c,d,e,f]),b((7&c)<<18|(63&d)<<12|(63&e)<<6|63&f)}},a.UTF16toUTF8=function(a,b){for(var c,d=null;;){if(null===(c=null!==d?d:a()))break;c>=55296&&57343>=c&&null!==(d=a())&&d>=56320&&57343>=d?(b(1024*(c-55296)+d-56320+65536),d=null):b(c)}null!==d&&b(d)},a.UTF8toUTF16=function(a,b){var c=null;for("number"==typeof a&&(c=a,a=function(){return null});null!==c||null!==(c=a());)65535>=c?b(c):(c-=65536,b((c>>10)+55296),b(c%1024+56320)),c=null},a.encodeUTF16toUTF8=function(b,c){a.UTF16toUTF8(b,function(b){a.encodeUTF8(b,c)})},a.decodeUTF8toUTF16=function(b,c){a.decodeUTF8(b,function(b){a.UTF8toUTF16(b,c)})},a.calculateCodePoint=function(a){return 128>a?1:2048>a?2:65536>a?3:4},a.calculateUTF8=function(b){for(var c,d=0;null!==(c=b());)d+=a.calculateCodePoint(c);return d},a.calculateUTF16asUTF8=function(b){var c=0,d=0;return a.UTF16toUTF8(b,function(b){++c,d+=a.calculateCodePoint(b)}),[c,d]},a}();Date.now=Date.now||function(){return+new Date};var x=16,y=10,z=16,A=100,B=[608135816,2242054355,320440878,57701188,2752067618,698298832,137296536,3964562569,1160258022,953160567,3193202383,887688300,3232508343,3380367581,1065670069,3041331479,2450970073,2306472731],C=[3509652390,2564797868,805139163,3491422135,3101798381,1780907670,3128725573,4046225305,614570311,3012652279,134345442,2240740374,1667834072,1901547113,2757295779,4103290238,227898511,1921955416,1904987480,2182433518,2069144605,3260701109,2620446009,720527379,3318853667,677414384,3393288472,3101374703,2390351024,1614419982,1822297739,2954791486,3608508353,3174124327,2024746970,1432378464,3864339955,2857741204,1464375394,1676153920,1439316330,715854006,3033291828,289532110,2706671279,2087905683,3018724369,1668267050,732546397,1947742710,3462151702,2609353502,2950085171,1814351708,2050118529,680887927,999245976,1800124847,3300911131,1713906067,1641548236,4213287313,1216130144,1575780402,4018429277,3917837745,3693486850,3949271944,596196993,3549867205,258830323,2213823033,772490370,2760122372,1774776394,2652871518,566650946,4142492826,1728879713,2882767088,1783734482,3629395816,2517608232,2874225571,1861159788,326777828,3124490320,2130389656,2716951837,967770486,1724537150,2185432712,2364442137,1164943284,2105845187,998989502,3765401048,2244026483,1075463327,1455516326,1322494562,910128902,469688178,1117454909,936433444,3490320968,3675253459,1240580251,122909385,2157517691,634681816,4142456567,3825094682,3061402683,2540495037,79693498,3249098678,1084186820,1583128258,426386531,1761308591,1047286709,322548459,995290223,1845252383,2603652396,3431023940,2942221577,3202600964,3727903485,1712269319,422464435,3234572375,1170764815,3523960633,3117677531,1434042557,442511882,3600875718,1076654713,1738483198,4213154764,2393238008,3677496056,1014306527,4251020053,793779912,2902807211,842905082,4246964064,1395751752,1040244610,2656851899,3396308128,445077038,3742853595,3577915638,679411651,2892444358,2354009459,1767581616,3150600392,3791627101,3102740896,284835224,4246832056,1258075500,768725851,2589189241,3069724005,3532540348,1274779536,3789419226,2764799539,1660621633,3471099624,4011903706,913787905,3497959166,737222580,2514213453,2928710040,3937242737,1804850592,3499020752,2949064160,2386320175,2390070455,2415321851,4061277028,2290661394,2416832540,1336762016,1754252060,3520065937,3014181293,791618072,3188594551,3933548030,2332172193,3852520463,3043980520,413987798,3465142937,3030929376,4245938359,2093235073,3534596313,375366246,2157278981,2479649556,555357303,3870105701,2008414854,3344188149,4221384143,3956125452,2067696032,3594591187,2921233993,2428461,544322398,577241275,1471733935,610547355,4027169054,1432588573,1507829418,2025931657,3646575487,545086370,48609733,2200306550,1653985193,298326376,1316178497,3007786442,2064951626,458293330,2589141269,3591329599,3164325604,727753846,2179363840,146436021,1461446943,4069977195,705550613,3059967265,3887724982,4281599278,3313849956,1404054877,2845806497,146425753,1854211946,1266315497,3048417604,3681880366,3289982499,290971e4,1235738493,2632868024,2414719590,3970600049,1771706367,1449415276,3266420449,422970021,1963543593,2690192192,3826793022,1062508698,1531092325,1804592342,2583117782,2714934279,4024971509,1294809318,4028980673,1289560198,2221992742,1669523910,35572830,157838143,1052438473,1016535060,1802137761,1753167236,1386275462,3080475397,2857371447,1040679964,2145300060,2390574316,1461121720,2956646967,4031777805,4028374788,33600511,2920084762,1018524850,629373528,3691585981,3515945977,2091462646,2486323059,586499841,988145025,935516892,3367335476,2599673255,2839830854,265290510,3972581182,2759138881,3795373465,1005194799,847297441,406762289,1314163512,1332590856,1866599683,4127851711,750260880,613907577,1450815602,3165620655,3734664991,3650291728,3012275730,3704569646,1427272223,778793252,1343938022,2676280711,2052605720,1946737175,3164576444,3914038668,3967478842,3682934266,1661551462,3294938066,4011595847,840292616,3712170807,616741398,312560963,711312465,1351876610,322626781,1910503582,271666773,2175563734,1594956187,70604529,3617834859,1007753275,1495573769,4069517037,2549218298,2663038764,504708206,2263041392,3941167025,2249088522,1514023603,1998579484,1312622330,694541497,2582060303,2151582166,1382467621,776784248,2618340202,3323268794,2497899128,2784771155,503983604,4076293799,907881277,423175695,432175456,1378068232,4145222326,3954048622,3938656102,3820766613,2793130115,2977904593,26017576,3274890735,3194772133,1700274565,1756076034,4006520079,3677328699,720338349,1533947780,354530856,688349552,3973924725,1637815568,332179504,3949051286,53804574,2852348879,3044236432,1282449977,3583942155,3416972820,4006381244,1617046695,2628476075,3002303598,1686838959,431878346,2686675385,1700445008,1080580658,1009431731,832498133,3223435511,2605976345,2271191193,2516031870,1648197032,4164389018,2548247927,300782431,375919233,238389289,3353747414,2531188641,2019080857,1475708069,455242339,2609103871,448939670,3451063019,1395535956,2413381860,1841049896,1491858159,885456874,4264095073,4001119347,1565136089,3898914787,1108368660,540939232,1173283510,2745871338,3681308437,4207628240,3343053890,4016749493,1699691293,1103962373,3625875870,2256883143,3830138730,1031889488,3479347698,1535977030,4236805024,3251091107,2132092099,1774941330,1199868427,1452454533,157007616,2904115357,342012276,595725824,1480756522,206960106,497939518,591360097,863170706,2375253569,3596610801,1814182875,2094937945,3421402208,1082520231,3463918190,2785509508,435703966,3908032597,1641649973,2842273706,3305899714,1510255612,2148256476,2655287854,3276092548,4258621189,236887753,3681803219,274041037,1734335097,3815195456,3317970021,1899903192,1026095262,4050517792,356393447,2410691914,3873677099,3682840055,3913112168,2491498743,4132185628,2489919796,1091903735,1979897079,3170134830,3567386728,3557303409,857797738,1136121015,1342202287,507115054,2535736646,337727348,3213592640,1301675037,2528481711,1895095763,1721773893,3216771564,62756741,2142006736,835421444,2531993523,1442658625,3659876326,2882144922,676362277,1392781812,170690266,3921047035,1759253602,3611846912,1745797284,664899054,1329594018,3901205900,3045908486,2062866102,2865634940,3543621612,3464012697,1080764994,553557557,3656615353,3996768171,991055499,499776247,1265440854,648242737,3940784050,980351604,3713745714,1749149687,3396870395,4211799374,3640570775,1161844396,3125318951,1431517754,545492359,4268468663,3499529547,1437099964,2702547544,3433638243,2581715763,2787789398,1060185593,1593081372,2418618748,4260947970,69676912,2159744348,86519011,2512459080,3838209314,1220612927,3339683548,133810670,1090789135,1078426020,1569222167,845107691,3583754449,4072456591,1091646820,628848692,1613405280,3757631651,526609435,236106946,48312990,2942717905,3402727701,1797494240,859738849,992217954,4005476642,2243076622,3870952857,3732016268,765654824,3490871365,2511836413,1685915746,3888969200,1414112111,2273134842,3281911079,4080962846,172450625,2569994100,980381355,4109958455,2819808352,2716589560,2568741196,3681446669,3329971472,1835478071,660984891,3704678404,4045999559,3422617507,3040415634,1762651403,1719377915,3470491036,2693910283,3642056355,3138596744,1364962596,2073328063,1983633131,926494387,3423689081,2150032023,4096667949,1749200295,3328846651,309677260,2016342300,1779581495,3079819751,111262694,1274766160,443224088,298511866,1025883608,3806446537,1145181785,168956806,3641502830,3584813610,1689216846,3666258015,3200248200,1692713982,2646376535,4042768518,1618508792,1610833997,3523052358,4130873264,2001055236,3610705100,2202168115,4028541809,2961195399,1006657119,2006996926,3186142756,1430667929,3210227297,1314452623,4074634658,4101304120,2273951170,1399257539,3367210612,3027628629,1190975929,2062231137,2333990788,2221543033,2438960610,1181637006,548689776,2362791313,3372408396,3104550113,3145860560,296247880,1970579870,3078560182,3769228297,1714227617,3291629107,3898220290,166772364,1251581989,493813264,448347421,195405023,2709975567,677966185,3703036547,1463355134,2715995803,1338867538,1343315457,2802222074,2684532164,233230375,2599980071,2000651841,3277868038,1638401717,4028070440,3237316320,6314154,819756386,300326615,590932579,1405279636,3267499572,3150704214,2428286686,3959192993,3461946742,1862657033,1266418056,963775037,2089974820,2263052895,1917689273,448879540,3550394620,3981727096,150775221,3627908307,1303187396,508620638,2975983352,2726630617,1817252668,1876281319,1457606340,908771278,3720792119,3617206836,2455994898,1729034894,1080033504,976866871,3556439503,2881648439,1522871579,1555064734,1336096578,3548522304,2579274686,3574697629,3205460757,3593280638,3338716283,3079412587,564236357,2993598910,1781952180,1464380207,3163844217,3332601554,1699332808,1393555694,1183702653,3581086237,1288719814,691649499,2847557200,2895455976,3193889540,2717570544,1781354906,1676643554,2592534050,3230253752,1126444790,2770207658,2633158820,2210423226,2615765581,2414155088,3127139286,673620729,2805611233,1269405062,4015350505,3341807571,4149409754,1057255273,2012875353,2162469141,2276492801,2601117357,993977747,3918593370,2654263191,753973209,36408145,2530585658,25011837,3520020182,2088578344,530523599,2918365339,1524020338,1518925132,3760827505,3759777254,1202760957,3985898139,3906192525,674977740,4174734889,2031300136,2019492241,3983892565,4153806404,3822280332,352677332,2297720250,60907813,90501309,3286998549,1016092578,2535922412,2839152426,457141659,509813237,4120667899,652014361,1966332200,2975202805,55981186,2327461051,676427537,3255491064,2882294119,3433927263,1307055953,942726286,933058658,2468411793,3933900994,4215176142,1361170020,2001714738,2830558078,3274259782,1222529897,1679025792,2729314320,3714953764,1770335741,151462246,3013232138,1682292957,1483529935,471910574,1539241949,458788160,3436315007,1807016891,3718408830,978976581,1043663428,3165965781,1927990952,4200891579,2372276910,3208408903,3533431907,1412390302,2931980059,4132332400,1947078029,3881505623,4168226417,2941484381,1077988104,1320477388,886195818,18198404,3786409e3,2509781533,112762804,3463356488,1866414978,891333506,18488651,661792760,1628790961,3885187036,3141171499,876946877,2693282273,1372485963,791857591,2686433993,3759982718,3167212022,3472953795,2716379847,445679433,3561995674,3504004811,3574258232,54117162,3331405415,2381918588,3769707343,4154350007,1140177722,4074052095,668550556,3214352940,367459370,261225585,2610173221,4209349473,3468074219,3265815641,314222801,3066103646,3808782860,282218597,3406013506,3773591054,379116347,1285071038,846784868,2669647154,3771962079,3550491691,2305946142,453669953,1268987020,3317592352,3279303384,3744833421,2610507566,3859509063,266596637,3847019092,517658769,3462560207,3443424879,370717030,4247526661,2224018117,4143653529,4112773975,2788324899,2477274417,1456262402,2901442914,1517677493,1846949527,2295493580,3734397586,2176403920,1280348187,1908823572,3871786941,846861322,1172426758,3287448474,3383383037,1655181056,3139813346,901632758,1897031941,2986607138,3066810236,3447102507,1393639104,373351379,950779232,625454576,3124240540,4148612726,2007998917,544563296,2244738638,2330496472,2058025392,1291430526,424198748,50039436,29584100,3605783033,2429876329,2791104160,1057563949,3255363231,3075367218,3463963227,1469046755,985887462],D=[1332899944,1700884034,1701343084,1684370003,1668446532,1869963892];
return o.encodeBase64=g,o.decodeBase64=h,o})}).call(this,a("_process"))},{_process:215,crypto:142}],99:[function(a,b,c){!function(b,c){"use strict";function d(a,b){if(!a)throw new Error(b||"Assertion failed")}function e(a,b){a.super_=b;var c=function(){};c.prototype=b.prototype,a.prototype=new c,a.prototype.constructor=a}function f(a,b,c){return f.isBN(a)?a:(this.negative=0,this.words=null,this.length=0,this.red=null,void(null!==a&&(("le"===b||"be"===b)&&(c=b,b=10),this._init(a||0,b||10,c||"be"))))}function g(a,b,c){for(var d=0,e=Math.min(a.length,c),f=b;e>f;f++){var g=a.charCodeAt(f)-48;d<<=4,d|=g>=49&&54>=g?g-49+10:g>=17&&22>=g?g-17+10:15&g}return d}function h(a,b,c,d){for(var e=0,f=Math.min(a.length,c),g=b;f>g;g++){var h=a.charCodeAt(g)-48;e*=d,e+=h>=49?h-49+10:h>=17?h-17+10:h}return e}function i(a){for(var b=new Array(a.bitLength()),c=0;c<b.length;c++){var d=c/26|0,e=c%26;b[c]=(a.words[d]&1<<e)>>>e}return b}function j(a,b,c){c.negative=b.negative^a.negative;var d=a.length+b.length|0;c.length=d,d=d-1|0;var e=0|a.words[0],f=0|b.words[0],g=e*f,h=67108863&g,i=g/67108864|0;c.words[0]=h;for(var j=1;d>j;j++){for(var k=i>>>26,l=67108863&i,m=Math.min(j,b.length-1),n=Math.max(0,j-a.length+1);m>=n;n++){var o=j-n|0;e=0|a.words[o],f=0|b.words[n],g=e*f+l,k+=g/67108864|0,l=67108863&g}c.words[j]=0|l,i=0|k}return 0!==i?c.words[j]=0|i:c.length--,c.strip()}function k(a,b,c){c.negative=b.negative^a.negative,c.length=a.length+b.length;for(var d=0,e=0,f=0;f<c.length-1;f++){var g=e;e=0;for(var h=67108863&d,i=Math.min(f,b.length-1),j=Math.max(0,f-a.length+1);i>=j;j++){var k=f-j,l=0|a.words[k],m=0|b.words[j],n=l*m,o=67108863&n;g=g+(n/67108864|0)|0,o=o+h|0,h=67108863&o,g=g+(o>>>26)|0,e+=g>>>26,g&=67108863}c.words[f]=h,d=g,g=e}return 0!==d?c.words[f]=d:c.length--,c.strip()}function l(a,b,c){var d=new m;return d.mulp(a,b,c)}function m(a,b){this.x=a,this.y=b}function n(a,b){this.name=a,this.p=new f(b,16),this.n=this.p.bitLength(),this.k=new f(1).iushln(this.n).isub(this.p),this.tmp=this._tmp()}function o(){n.call(this,"k256","ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe fffffc2f")}function p(){n.call(this,"p224","ffffffff ffffffff ffffffff ffffffff 00000000 00000000 00000001")}function q(){n.call(this,"p192","ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff")}function r(){n.call(this,"25519","7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed")}function s(a){if("string"==typeof a){var b=f._prime(a);this.m=b.p,this.prime=b}else d(a.gtn(1),"modulus must be greater than 1"),this.m=a,this.prime=null}function t(a){s.call(this,a),this.shift=this.m.bitLength(),this.shift%26!==0&&(this.shift+=26-this.shift%26),this.r=new f(1).iushln(this.shift),this.r2=this.imod(this.r.sqr()),this.rinv=this.r._invmp(this.m),this.minv=this.rinv.mul(this.r).isubn(1).div(this.m),this.minv=this.minv.umod(this.r),this.minv=this.r.sub(this.minv)}"object"==typeof b?b.exports=f:c.BN=f,f.BN=f,f.wordSize=26;var u;try{u=a("buffer").Buffer}catch(v){}f.isBN=function(a){return a instanceof f?!0:null!==a&&"object"==typeof a&&a.constructor.wordSize===f.wordSize&&Array.isArray(a.words)},f.max=function(a,b){return a.cmp(b)>0?a:b},f.min=function(a,b){return a.cmp(b)<0?a:b},f.prototype._init=function(a,b,c){if("number"==typeof a)return this._initNumber(a,b,c);if("object"==typeof a)return this._initArray(a,b,c);"hex"===b&&(b=16),d(b===(0|b)&&b>=2&&36>=b),a=a.toString().replace(/\s+/g,"");var e=0;"-"===a[0]&&e++,16===b?this._parseHex(a,e):this._parseBase(a,b,e),"-"===a[0]&&(this.negative=1),this.strip(),"le"===c&&this._initArray(this.toArray(),b,c)},f.prototype._initNumber=function(a,b,c){0>a&&(this.negative=1,a=-a),67108864>a?(this.words=[67108863&a],this.length=1):4503599627370496>a?(this.words=[67108863&a,a/67108864&67108863],this.length=2):(d(9007199254740992>a),this.words=[67108863&a,a/67108864&67108863,1],this.length=3),"le"===c&&this._initArray(this.toArray(),b,c)},f.prototype._initArray=function(a,b,c){if(d("number"==typeof a.length),a.length<=0)return this.words=[0],this.length=1,this;this.length=Math.ceil(a.length/3),this.words=new Array(this.length);for(var e=0;e<this.length;e++)this.words[e]=0;var f,g,h=0;if("be"===c)for(e=a.length-1,f=0;e>=0;e-=3)g=a[e]|a[e-1]<<8|a[e-2]<<16,this.words[f]|=g<<h&67108863,this.words[f+1]=g>>>26-h&67108863,h+=24,h>=26&&(h-=26,f++);else if("le"===c)for(e=0,f=0;e<a.length;e+=3)g=a[e]|a[e+1]<<8|a[e+2]<<16,this.words[f]|=g<<h&67108863,this.words[f+1]=g>>>26-h&67108863,h+=24,h>=26&&(h-=26,f++);return this.strip()},f.prototype._parseHex=function(a,b){this.length=Math.ceil((a.length-b)/6),this.words=new Array(this.length);for(var c=0;c<this.length;c++)this.words[c]=0;var d,e,f=0;for(c=a.length-6,d=0;c>=b;c-=6)e=g(a,c,c+6),this.words[d]|=e<<f&67108863,this.words[d+1]|=e>>>26-f&4194303,f+=24,f>=26&&(f-=26,d++);c+6!==b&&(e=g(a,b,c+6),this.words[d]|=e<<f&67108863,this.words[d+1]|=e>>>26-f&4194303),this.strip()},f.prototype._parseBase=function(a,b,c){this.words=[0],this.length=1;for(var d=0,e=1;67108863>=e;e*=b)d++;d--,e=e/b|0;for(var f=a.length-c,g=f%d,i=Math.min(f,f-g)+c,j=0,k=c;i>k;k+=d)j=h(a,k,k+d,b),this.imuln(e),this.words[0]+j<67108864?this.words[0]+=j:this._iaddn(j);if(0!==g){var l=1;for(j=h(a,k,a.length,b),k=0;g>k;k++)l*=b;this.imuln(l),this.words[0]+j<67108864?this.words[0]+=j:this._iaddn(j)}},f.prototype.copy=function(a){a.words=new Array(this.length);for(var b=0;b<this.length;b++)a.words[b]=this.words[b];a.length=this.length,a.negative=this.negative,a.red=this.red},f.prototype.clone=function(){var a=new f(null);return this.copy(a),a},f.prototype._expand=function(a){for(;this.length<a;)this.words[this.length++]=0;return this},f.prototype.strip=function(){for(;this.length>1&&0===this.words[this.length-1];)this.length--;return this._normSign()},f.prototype._normSign=function(){return 1===this.length&&0===this.words[0]&&(this.negative=0),this},f.prototype.inspect=function(){return(this.red?"<BN-R: ":"<BN: ")+this.toString(16)+">"};var w=["","0","00","000","0000","00000","000000","0000000","00000000","000000000","0000000000","00000000000","000000000000","0000000000000","00000000000000","000000000000000","0000000000000000","00000000000000000","000000000000000000","0000000000000000000","00000000000000000000","000000000000000000000","0000000000000000000000","00000000000000000000000","000000000000000000000000","0000000000000000000000000"],x=[0,0,25,16,12,11,10,9,8,8,7,7,7,7,6,6,6,6,6,6,6,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5],y=[0,0,33554432,43046721,16777216,48828125,60466176,40353607,16777216,43046721,1e7,19487171,35831808,62748517,7529536,11390625,16777216,24137569,34012224,47045881,64e6,4084101,5153632,6436343,7962624,9765625,11881376,14348907,17210368,20511149,243e5,28629151,33554432,39135393,45435424,52521875,60466176];f.prototype.toString=function(a,b){a=a||10,b=0|b||1;var c;if(16===a||"hex"===a){c="";for(var e=0,f=0,g=0;g<this.length;g++){var h=this.words[g],i=(16777215&(h<<e|f)).toString(16);f=h>>>24-e&16777215,c=0!==f||g!==this.length-1?w[6-i.length]+i+c:i+c,e+=2,e>=26&&(e-=26,g--)}for(0!==f&&(c=f.toString(16)+c);c.length%b!==0;)c="0"+c;return 0!==this.negative&&(c="-"+c),c}if(a===(0|a)&&a>=2&&36>=a){var j=x[a],k=y[a];c="";var l=this.clone();for(l.negative=0;!l.isZero();){var m=l.modn(k).toString(a);l=l.idivn(k),c=l.isZero()?m+c:w[j-m.length]+m+c}for(this.isZero()&&(c="0"+c);c.length%b!==0;)c="0"+c;return 0!==this.negative&&(c="-"+c),c}d(!1,"Base should be between 2 and 36")},f.prototype.toNumber=function(){var a=this.words[0];return 2===this.length?a+=67108864*this.words[1]:3===this.length&&1===this.words[2]?a+=4503599627370496+67108864*this.words[1]:this.length>2&&d(!1,"Number can only safely store up to 53 bits"),0!==this.negative?-a:a},f.prototype.toJSON=function(){return this.toString(16)},f.prototype.toBuffer=function(a,b){return d("undefined"!=typeof u),this.toArrayLike(u,a,b)},f.prototype.toArray=function(a,b){return this.toArrayLike(Array,a,b)},f.prototype.toArrayLike=function(a,b,c){var e=this.byteLength(),f=c||Math.max(1,e);d(f>=e,"byte array longer than desired length"),d(f>0,"Requested array length <= 0"),this.strip();var g,h,i="le"===b,j=new a(f),k=this.clone();if(i){for(h=0;!k.isZero();h++)g=k.andln(255),k.iushrn(8),j[h]=g;for(;f>h;h++)j[h]=0}else{for(h=0;f-e>h;h++)j[h]=0;for(h=0;!k.isZero();h++)g=k.andln(255),k.iushrn(8),j[f-h-1]=g}return j},Math.clz32?f.prototype._countBits=function(a){return 32-Math.clz32(a)}:f.prototype._countBits=function(a){var b=a,c=0;return b>=4096&&(c+=13,b>>>=13),b>=64&&(c+=7,b>>>=7),b>=8&&(c+=4,b>>>=4),b>=2&&(c+=2,b>>>=2),c+b},f.prototype._zeroBits=function(a){if(0===a)return 26;var b=a,c=0;return 0===(8191&b)&&(c+=13,b>>>=13),0===(127&b)&&(c+=7,b>>>=7),0===(15&b)&&(c+=4,b>>>=4),0===(3&b)&&(c+=2,b>>>=2),0===(1&b)&&c++,c},f.prototype.bitLength=function(){var a=this.words[this.length-1],b=this._countBits(a);return 26*(this.length-1)+b},f.prototype.zeroBits=function(){if(this.isZero())return 0;for(var a=0,b=0;b<this.length;b++){var c=this._zeroBits(this.words[b]);if(a+=c,26!==c)break}return a},f.prototype.byteLength=function(){return Math.ceil(this.bitLength()/8)},f.prototype.toTwos=function(a){return 0!==this.negative?this.abs().inotn(a).iaddn(1):this.clone()},f.prototype.fromTwos=function(a){return this.testn(a-1)?this.notn(a).iaddn(1).ineg():this.clone()},f.prototype.isNeg=function(){return 0!==this.negative},f.prototype.neg=function(){return this.clone().ineg()},f.prototype.ineg=function(){return this.isZero()||(this.negative^=1),this},f.prototype.iuor=function(a){for(;this.length<a.length;)this.words[this.length++]=0;for(var b=0;b<a.length;b++)this.words[b]=this.words[b]|a.words[b];return this.strip()},f.prototype.ior=function(a){return d(0===(this.negative|a.negative)),this.iuor(a)},f.prototype.or=function(a){return this.length>a.length?this.clone().ior(a):a.clone().ior(this)},f.prototype.uor=function(a){return this.length>a.length?this.clone().iuor(a):a.clone().iuor(this)},f.prototype.iuand=function(a){var b;b=this.length>a.length?a:this;for(var c=0;c<b.length;c++)this.words[c]=this.words[c]&a.words[c];return this.length=b.length,this.strip()},f.prototype.iand=function(a){return d(0===(this.negative|a.negative)),this.iuand(a)},f.prototype.and=function(a){return this.length>a.length?this.clone().iand(a):a.clone().iand(this)},f.prototype.uand=function(a){return this.length>a.length?this.clone().iuand(a):a.clone().iuand(this)},f.prototype.iuxor=function(a){var b,c;this.length>a.length?(b=this,c=a):(b=a,c=this);for(var d=0;d<c.length;d++)this.words[d]=b.words[d]^c.words[d];if(this!==b)for(;d<b.length;d++)this.words[d]=b.words[d];return this.length=b.length,this.strip()},f.prototype.ixor=function(a){return d(0===(this.negative|a.negative)),this.iuxor(a)},f.prototype.xor=function(a){return this.length>a.length?this.clone().ixor(a):a.clone().ixor(this)},f.prototype.uxor=function(a){return this.length>a.length?this.clone().iuxor(a):a.clone().iuxor(this)},f.prototype.inotn=function(a){d("number"==typeof a&&a>=0);var b=0|Math.ceil(a/26),c=a%26;this._expand(b),c>0&&b--;for(var e=0;b>e;e++)this.words[e]=67108863&~this.words[e];return c>0&&(this.words[e]=~this.words[e]&67108863>>26-c),this.strip()},f.prototype.notn=function(a){return this.clone().inotn(a)},f.prototype.setn=function(a,b){d("number"==typeof a&&a>=0);var c=a/26|0,e=a%26;return this._expand(c+1),b?this.words[c]=this.words[c]|1<<e:this.words[c]=this.words[c]&~(1<<e),this.strip()},f.prototype.iadd=function(a){var b;if(0!==this.negative&&0===a.negative)return this.negative=0,b=this.isub(a),this.negative^=1,this._normSign();if(0===this.negative&&0!==a.negative)return a.negative=0,b=this.isub(a),a.negative=1,b._normSign();var c,d;this.length>a.length?(c=this,d=a):(c=a,d=this);for(var e=0,f=0;f<d.length;f++)b=(0|c.words[f])+(0|d.words[f])+e,this.words[f]=67108863&b,e=b>>>26;for(;0!==e&&f<c.length;f++)b=(0|c.words[f])+e,this.words[f]=67108863&b,e=b>>>26;if(this.length=c.length,0!==e)this.words[this.length]=e,this.length++;else if(c!==this)for(;f<c.length;f++)this.words[f]=c.words[f];return this},f.prototype.add=function(a){var b;return 0!==a.negative&&0===this.negative?(a.negative=0,b=this.sub(a),a.negative^=1,b):0===a.negative&&0!==this.negative?(this.negative=0,b=a.sub(this),this.negative=1,b):this.length>a.length?this.clone().iadd(a):a.clone().iadd(this)},f.prototype.isub=function(a){if(0!==a.negative){a.negative=0;var b=this.iadd(a);return a.negative=1,b._normSign()}if(0!==this.negative)return this.negative=0,this.iadd(a),this.negative=1,this._normSign();var c=this.cmp(a);if(0===c)return this.negative=0,this.length=1,this.words[0]=0,this;var d,e;c>0?(d=this,e=a):(d=a,e=this);for(var f=0,g=0;g<e.length;g++)b=(0|d.words[g])-(0|e.words[g])+f,f=b>>26,this.words[g]=67108863&b;for(;0!==f&&g<d.length;g++)b=(0|d.words[g])+f,f=b>>26,this.words[g]=67108863&b;if(0===f&&g<d.length&&d!==this)for(;g<d.length;g++)this.words[g]=d.words[g];return this.length=Math.max(this.length,g),d!==this&&(this.negative=1),this.strip()},f.prototype.sub=function(a){return this.clone().isub(a)};var z=function(a,b,c){var d,e,f,g=a.words,h=b.words,i=c.words,j=0,k=0|g[0],l=8191&k,m=k>>>13,n=0|g[1],o=8191&n,p=n>>>13,q=0|g[2],r=8191&q,s=q>>>13,t=0|g[3],u=8191&t,v=t>>>13,w=0|g[4],x=8191&w,y=w>>>13,z=0|g[5],A=8191&z,B=z>>>13,C=0|g[6],D=8191&C,E=C>>>13,F=0|g[7],G=8191&F,H=F>>>13,I=0|g[8],J=8191&I,K=I>>>13,L=0|g[9],M=8191&L,N=L>>>13,O=0|h[0],P=8191&O,Q=O>>>13,R=0|h[1],S=8191&R,T=R>>>13,U=0|h[2],V=8191&U,W=U>>>13,X=0|h[3],Y=8191&X,Z=X>>>13,$=0|h[4],_=8191&$,aa=$>>>13,ba=0|h[5],ca=8191&ba,da=ba>>>13,ea=0|h[6],fa=8191&ea,ga=ea>>>13,ha=0|h[7],ia=8191&ha,ja=ha>>>13,ka=0|h[8],la=8191&ka,ma=ka>>>13,na=0|h[9],oa=8191&na,pa=na>>>13;c.negative=a.negative^b.negative,c.length=19,d=Math.imul(l,P),e=Math.imul(l,Q),e=e+Math.imul(m,P)|0,f=Math.imul(m,Q);var qa=(j+d|0)+((8191&e)<<13)|0;j=(f+(e>>>13)|0)+(qa>>>26)|0,qa&=67108863,d=Math.imul(o,P),e=Math.imul(o,Q),e=e+Math.imul(p,P)|0,f=Math.imul(p,Q),d=d+Math.imul(l,S)|0,e=e+Math.imul(l,T)|0,e=e+Math.imul(m,S)|0,f=f+Math.imul(m,T)|0;var ra=(j+d|0)+((8191&e)<<13)|0;j=(f+(e>>>13)|0)+(ra>>>26)|0,ra&=67108863,d=Math.imul(r,P),e=Math.imul(r,Q),e=e+Math.imul(s,P)|0,f=Math.imul(s,Q),d=d+Math.imul(o,S)|0,e=e+Math.imul(o,T)|0,e=e+Math.imul(p,S)|0,f=f+Math.imul(p,T)|0,d=d+Math.imul(l,V)|0,e=e+Math.imul(l,W)|0,e=e+Math.imul(m,V)|0,f=f+Math.imul(m,W)|0;var sa=(j+d|0)+((8191&e)<<13)|0;j=(f+(e>>>13)|0)+(sa>>>26)|0,sa&=67108863,d=Math.imul(u,P),e=Math.imul(u,Q),e=e+Math.imul(v,P)|0,f=Math.imul(v,Q),d=d+Math.imul(r,S)|0,e=e+Math.imul(r,T)|0,e=e+Math.imul(s,S)|0,f=f+Math.imul(s,T)|0,d=d+Math.imul(o,V)|0,e=e+Math.imul(o,W)|0,e=e+Math.imul(p,V)|0,f=f+Math.imul(p,W)|0,d=d+Math.imul(l,Y)|0,e=e+Math.imul(l,Z)|0,e=e+Math.imul(m,Y)|0,f=f+Math.imul(m,Z)|0;var ta=(j+d|0)+((8191&e)<<13)|0;j=(f+(e>>>13)|0)+(ta>>>26)|0,ta&=67108863,d=Math.imul(x,P),e=Math.imul(x,Q),e=e+Math.imul(y,P)|0,f=Math.imul(y,Q),d=d+Math.imul(u,S)|0,e=e+Math.imul(u,T)|0,e=e+Math.imul(v,S)|0,f=f+Math.imul(v,T)|0,d=d+Math.imul(r,V)|0,e=e+Math.imul(r,W)|0,e=e+Math.imul(s,V)|0,f=f+Math.imul(s,W)|0,d=d+Math.imul(o,Y)|0,e=e+Math.imul(o,Z)|0,e=e+Math.imul(p,Y)|0,f=f+Math.imul(p,Z)|0,d=d+Math.imul(l,_)|0,e=e+Math.imul(l,aa)|0,e=e+Math.imul(m,_)|0,f=f+Math.imul(m,aa)|0;var ua=(j+d|0)+((8191&e)<<13)|0;j=(f+(e>>>13)|0)+(ua>>>26)|0,ua&=67108863,d=Math.imul(A,P),e=Math.imul(A,Q),e=e+Math.imul(B,P)|0,f=Math.imul(B,Q),d=d+Math.imul(x,S)|0,e=e+Math.imul(x,T)|0,e=e+Math.imul(y,S)|0,f=f+Math.imul(y,T)|0,d=d+Math.imul(u,V)|0,e=e+Math.imul(u,W)|0,e=e+Math.imul(v,V)|0,f=f+Math.imul(v,W)|0,d=d+Math.imul(r,Y)|0,e=e+Math.imul(r,Z)|0,e=e+Math.imul(s,Y)|0,f=f+Math.imul(s,Z)|0,d=d+Math.imul(o,_)|0,e=e+Math.imul(o,aa)|0,e=e+Math.imul(p,_)|0,f=f+Math.imul(p,aa)|0,d=d+Math.imul(l,ca)|0,e=e+Math.imul(l,da)|0,e=e+Math.imul(m,ca)|0,f=f+Math.imul(m,da)|0;var va=(j+d|0)+((8191&e)<<13)|0;j=(f+(e>>>13)|0)+(va>>>26)|0,va&=67108863,d=Math.imul(D,P),e=Math.imul(D,Q),e=e+Math.imul(E,P)|0,f=Math.imul(E,Q),d=d+Math.imul(A,S)|0,e=e+Math.imul(A,T)|0,e=e+Math.imul(B,S)|0,f=f+Math.imul(B,T)|0,d=d+Math.imul(x,V)|0,e=e+Math.imul(x,W)|0,e=e+Math.imul(y,V)|0,f=f+Math.imul(y,W)|0,d=d+Math.imul(u,Y)|0,e=e+Math.imul(u,Z)|0,e=e+Math.imul(v,Y)|0,f=f+Math.imul(v,Z)|0,d=d+Math.imul(r,_)|0,e=e+Math.imul(r,aa)|0,e=e+Math.imul(s,_)|0,f=f+Math.imul(s,aa)|0,d=d+Math.imul(o,ca)|0,e=e+Math.imul(o,da)|0,e=e+Math.imul(p,ca)|0,f=f+Math.imul(p,da)|0,d=d+Math.imul(l,fa)|0,e=e+Math.imul(l,ga)|0,e=e+Math.imul(m,fa)|0,f=f+Math.imul(m,ga)|0;var wa=(j+d|0)+((8191&e)<<13)|0;j=(f+(e>>>13)|0)+(wa>>>26)|0,wa&=67108863,d=Math.imul(G,P),e=Math.imul(G,Q),e=e+Math.imul(H,P)|0,f=Math.imul(H,Q),d=d+Math.imul(D,S)|0,e=e+Math.imul(D,T)|0,e=e+Math.imul(E,S)|0,f=f+Math.imul(E,T)|0,d=d+Math.imul(A,V)|0,e=e+Math.imul(A,W)|0,e=e+Math.imul(B,V)|0,f=f+Math.imul(B,W)|0,d=d+Math.imul(x,Y)|0,e=e+Math.imul(x,Z)|0,e=e+Math.imul(y,Y)|0,f=f+Math.imul(y,Z)|0,d=d+Math.imul(u,_)|0,e=e+Math.imul(u,aa)|0,e=e+Math.imul(v,_)|0,f=f+Math.imul(v,aa)|0,d=d+Math.imul(r,ca)|0,e=e+Math.imul(r,da)|0,e=e+Math.imul(s,ca)|0,f=f+Math.imul(s,da)|0,d=d+Math.imul(o,fa)|0,e=e+Math.imul(o,ga)|0,e=e+Math.imul(p,fa)|0,f=f+Math.imul(p,ga)|0,d=d+Math.imul(l,ia)|0,e=e+Math.imul(l,ja)|0,e=e+Math.imul(m,ia)|0,f=f+Math.imul(m,ja)|0;var xa=(j+d|0)+((8191&e)<<13)|0;j=(f+(e>>>13)|0)+(xa>>>26)|0,xa&=67108863,d=Math.imul(J,P),e=Math.imul(J,Q),e=e+Math.imul(K,P)|0,f=Math.imul(K,Q),d=d+Math.imul(G,S)|0,e=e+Math.imul(G,T)|0,e=e+Math.imul(H,S)|0,f=f+Math.imul(H,T)|0,d=d+Math.imul(D,V)|0,e=e+Math.imul(D,W)|0,e=e+Math.imul(E,V)|0,f=f+Math.imul(E,W)|0,d=d+Math.imul(A,Y)|0,e=e+Math.imul(A,Z)|0,e=e+Math.imul(B,Y)|0,f=f+Math.imul(B,Z)|0,d=d+Math.imul(x,_)|0,e=e+Math.imul(x,aa)|0,e=e+Math.imul(y,_)|0,f=f+Math.imul(y,aa)|0,d=d+Math.imul(u,ca)|0,e=e+Math.imul(u,da)|0,e=e+Math.imul(v,ca)|0,f=f+Math.imul(v,da)|0,d=d+Math.imul(r,fa)|0,e=e+Math.imul(r,ga)|0,e=e+Math.imul(s,fa)|0,f=f+Math.imul(s,ga)|0,d=d+Math.imul(o,ia)|0,e=e+Math.imul(o,ja)|0,e=e+Math.imul(p,ia)|0,f=f+Math.imul(p,ja)|0,d=d+Math.imul(l,la)|0,e=e+Math.imul(l,ma)|0,e=e+Math.imul(m,la)|0,f=f+Math.imul(m,ma)|0;var ya=(j+d|0)+((8191&e)<<13)|0;j=(f+(e>>>13)|0)+(ya>>>26)|0,ya&=67108863,d=Math.imul(M,P),e=Math.imul(M,Q),e=e+Math.imul(N,P)|0,f=Math.imul(N,Q),d=d+Math.imul(J,S)|0,e=e+Math.imul(J,T)|0,e=e+Math.imul(K,S)|0,f=f+Math.imul(K,T)|0,d=d+Math.imul(G,V)|0,e=e+Math.imul(G,W)|0,e=e+Math.imul(H,V)|0,f=f+Math.imul(H,W)|0,d=d+Math.imul(D,Y)|0,e=e+Math.imul(D,Z)|0,e=e+Math.imul(E,Y)|0,f=f+Math.imul(E,Z)|0,d=d+Math.imul(A,_)|0,e=e+Math.imul(A,aa)|0,e=e+Math.imul(B,_)|0,f=f+Math.imul(B,aa)|0,d=d+Math.imul(x,ca)|0,e=e+Math.imul(x,da)|0,e=e+Math.imul(y,ca)|0,f=f+Math.imul(y,da)|0,d=d+Math.imul(u,fa)|0,e=e+Math.imul(u,ga)|0,e=e+Math.imul(v,fa)|0,f=f+Math.imul(v,ga)|0,d=d+Math.imul(r,ia)|0,e=e+Math.imul(r,ja)|0,e=e+Math.imul(s,ia)|0,f=f+Math.imul(s,ja)|0,d=d+Math.imul(o,la)|0,e=e+Math.imul(o,ma)|0,e=e+Math.imul(p,la)|0,f=f+Math.imul(p,ma)|0,d=d+Math.imul(l,oa)|0,e=e+Math.imul(l,pa)|0,e=e+Math.imul(m,oa)|0,f=f+Math.imul(m,pa)|0;var za=(j+d|0)+((8191&e)<<13)|0;j=(f+(e>>>13)|0)+(za>>>26)|0,za&=67108863,d=Math.imul(M,S),e=Math.imul(M,T),e=e+Math.imul(N,S)|0,f=Math.imul(N,T),d=d+Math.imul(J,V)|0,e=e+Math.imul(J,W)|0,e=e+Math.imul(K,V)|0,f=f+Math.imul(K,W)|0,d=d+Math.imul(G,Y)|0,e=e+Math.imul(G,Z)|0,e=e+Math.imul(H,Y)|0,f=f+Math.imul(H,Z)|0,d=d+Math.imul(D,_)|0,e=e+Math.imul(D,aa)|0,e=e+Math.imul(E,_)|0,f=f+Math.imul(E,aa)|0,d=d+Math.imul(A,ca)|0,e=e+Math.imul(A,da)|0,e=e+Math.imul(B,ca)|0,f=f+Math.imul(B,da)|0,d=d+Math.imul(x,fa)|0,e=e+Math.imul(x,ga)|0,e=e+Math.imul(y,fa)|0,f=f+Math.imul(y,ga)|0,d=d+Math.imul(u,ia)|0,e=e+Math.imul(u,ja)|0,e=e+Math.imul(v,ia)|0,f=f+Math.imul(v,ja)|0,d=d+Math.imul(r,la)|0,e=e+Math.imul(r,ma)|0,e=e+Math.imul(s,la)|0,f=f+Math.imul(s,ma)|0,d=d+Math.imul(o,oa)|0,e=e+Math.imul(o,pa)|0,e=e+Math.imul(p,oa)|0,f=f+Math.imul(p,pa)|0;var Aa=(j+d|0)+((8191&e)<<13)|0;j=(f+(e>>>13)|0)+(Aa>>>26)|0,Aa&=67108863,d=Math.imul(M,V),e=Math.imul(M,W),e=e+Math.imul(N,V)|0,f=Math.imul(N,W),d=d+Math.imul(J,Y)|0,e=e+Math.imul(J,Z)|0,e=e+Math.imul(K,Y)|0,f=f+Math.imul(K,Z)|0,d=d+Math.imul(G,_)|0,e=e+Math.imul(G,aa)|0,e=e+Math.imul(H,_)|0,f=f+Math.imul(H,aa)|0,d=d+Math.imul(D,ca)|0,e=e+Math.imul(D,da)|0,e=e+Math.imul(E,ca)|0,f=f+Math.imul(E,da)|0,d=d+Math.imul(A,fa)|0,e=e+Math.imul(A,ga)|0,e=e+Math.imul(B,fa)|0,f=f+Math.imul(B,ga)|0,d=d+Math.imul(x,ia)|0,e=e+Math.imul(x,ja)|0,e=e+Math.imul(y,ia)|0,f=f+Math.imul(y,ja)|0,d=d+Math.imul(u,la)|0,e=e+Math.imul(u,ma)|0,e=e+Math.imul(v,la)|0,f=f+Math.imul(v,ma)|0,d=d+Math.imul(r,oa)|0,e=e+Math.imul(r,pa)|0,e=e+Math.imul(s,oa)|0,f=f+Math.imul(s,pa)|0;var Ba=(j+d|0)+((8191&e)<<13)|0;j=(f+(e>>>13)|0)+(Ba>>>26)|0,Ba&=67108863,d=Math.imul(M,Y),e=Math.imul(M,Z),e=e+Math.imul(N,Y)|0,f=Math.imul(N,Z),d=d+Math.imul(J,_)|0,e=e+Math.imul(J,aa)|0,e=e+Math.imul(K,_)|0,f=f+Math.imul(K,aa)|0,d=d+Math.imul(G,ca)|0,e=e+Math.imul(G,da)|0,e=e+Math.imul(H,ca)|0,f=f+Math.imul(H,da)|0,d=d+Math.imul(D,fa)|0,e=e+Math.imul(D,ga)|0,e=e+Math.imul(E,fa)|0,f=f+Math.imul(E,ga)|0,d=d+Math.imul(A,ia)|0,e=e+Math.imul(A,ja)|0,e=e+Math.imul(B,ia)|0,f=f+Math.imul(B,ja)|0,d=d+Math.imul(x,la)|0,e=e+Math.imul(x,ma)|0,e=e+Math.imul(y,la)|0,f=f+Math.imul(y,ma)|0,d=d+Math.imul(u,oa)|0,e=e+Math.imul(u,pa)|0,e=e+Math.imul(v,oa)|0,f=f+Math.imul(v,pa)|0;var Ca=(j+d|0)+((8191&e)<<13)|0;j=(f+(e>>>13)|0)+(Ca>>>26)|0,Ca&=67108863,d=Math.imul(M,_),e=Math.imul(M,aa),e=e+Math.imul(N,_)|0,f=Math.imul(N,aa),d=d+Math.imul(J,ca)|0,e=e+Math.imul(J,da)|0,e=e+Math.imul(K,ca)|0,f=f+Math.imul(K,da)|0,d=d+Math.imul(G,fa)|0,e=e+Math.imul(G,ga)|0,e=e+Math.imul(H,fa)|0,f=f+Math.imul(H,ga)|0,d=d+Math.imul(D,ia)|0,e=e+Math.imul(D,ja)|0,e=e+Math.imul(E,ia)|0,f=f+Math.imul(E,ja)|0,d=d+Math.imul(A,la)|0,e=e+Math.imul(A,ma)|0,e=e+Math.imul(B,la)|0,f=f+Math.imul(B,ma)|0,d=d+Math.imul(x,oa)|0,e=e+Math.imul(x,pa)|0,e=e+Math.imul(y,oa)|0,f=f+Math.imul(y,pa)|0;var Da=(j+d|0)+((8191&e)<<13)|0;j=(f+(e>>>13)|0)+(Da>>>26)|0,Da&=67108863,d=Math.imul(M,ca),e=Math.imul(M,da),e=e+Math.imul(N,ca)|0,f=Math.imul(N,da),d=d+Math.imul(J,fa)|0,e=e+Math.imul(J,ga)|0,e=e+Math.imul(K,fa)|0,f=f+Math.imul(K,ga)|0,d=d+Math.imul(G,ia)|0,e=e+Math.imul(G,ja)|0,e=e+Math.imul(H,ia)|0,f=f+Math.imul(H,ja)|0,d=d+Math.imul(D,la)|0,e=e+Math.imul(D,ma)|0,e=e+Math.imul(E,la)|0,f=f+Math.imul(E,ma)|0,d=d+Math.imul(A,oa)|0,e=e+Math.imul(A,pa)|0,e=e+Math.imul(B,oa)|0,f=f+Math.imul(B,pa)|0;var Ea=(j+d|0)+((8191&e)<<13)|0;j=(f+(e>>>13)|0)+(Ea>>>26)|0,Ea&=67108863,d=Math.imul(M,fa),e=Math.imul(M,ga),e=e+Math.imul(N,fa)|0,f=Math.imul(N,ga),d=d+Math.imul(J,ia)|0,e=e+Math.imul(J,ja)|0,e=e+Math.imul(K,ia)|0,f=f+Math.imul(K,ja)|0,d=d+Math.imul(G,la)|0,e=e+Math.imul(G,ma)|0,e=e+Math.imul(H,la)|0,f=f+Math.imul(H,ma)|0,d=d+Math.imul(D,oa)|0,e=e+Math.imul(D,pa)|0,e=e+Math.imul(E,oa)|0,f=f+Math.imul(E,pa)|0;var Fa=(j+d|0)+((8191&e)<<13)|0;j=(f+(e>>>13)|0)+(Fa>>>26)|0,Fa&=67108863,d=Math.imul(M,ia),e=Math.imul(M,ja),e=e+Math.imul(N,ia)|0,f=Math.imul(N,ja),d=d+Math.imul(J,la)|0,e=e+Math.imul(J,ma)|0,e=e+Math.imul(K,la)|0,f=f+Math.imul(K,ma)|0,d=d+Math.imul(G,oa)|0,e=e+Math.imul(G,pa)|0,e=e+Math.imul(H,oa)|0,f=f+Math.imul(H,pa)|0;var Ga=(j+d|0)+((8191&e)<<13)|0;j=(f+(e>>>13)|0)+(Ga>>>26)|0,Ga&=67108863,d=Math.imul(M,la),e=Math.imul(M,ma),e=e+Math.imul(N,la)|0,f=Math.imul(N,ma),d=d+Math.imul(J,oa)|0,e=e+Math.imul(J,pa)|0,e=e+Math.imul(K,oa)|0,f=f+Math.imul(K,pa)|0;var Ha=(j+d|0)+((8191&e)<<13)|0;j=(f+(e>>>13)|0)+(Ha>>>26)|0,Ha&=67108863,d=Math.imul(M,oa),e=Math.imul(M,pa),e=e+Math.imul(N,oa)|0,f=Math.imul(N,pa);var Ia=(j+d|0)+((8191&e)<<13)|0;return j=(f+(e>>>13)|0)+(Ia>>>26)|0,Ia&=67108863,i[0]=qa,i[1]=ra,i[2]=sa,i[3]=ta,i[4]=ua,i[5]=va,i[6]=wa,i[7]=xa,i[8]=ya,i[9]=za,i[10]=Aa,i[11]=Ba,i[12]=Ca,i[13]=Da,i[14]=Ea,i[15]=Fa,i[16]=Ga,i[17]=Ha,i[18]=Ia,0!==j&&(i[19]=j,c.length++),c};Math.imul||(z=j),f.prototype.mulTo=function(a,b){var c,d=this.length+a.length;return c=10===this.length&&10===a.length?z(this,a,b):63>d?j(this,a,b):1024>d?k(this,a,b):l(this,a,b)},m.prototype.makeRBT=function(a){for(var b=new Array(a),c=f.prototype._countBits(a)-1,d=0;a>d;d++)b[d]=this.revBin(d,c,a);return b},m.prototype.revBin=function(a,b,c){if(0===a||a===c-1)return a;for(var d=0,e=0;b>e;e++)d|=(1&a)<<b-e-1,a>>=1;return d},m.prototype.permute=function(a,b,c,d,e,f){for(var g=0;f>g;g++)d[g]=b[a[g]],e[g]=c[a[g]]},m.prototype.transform=function(a,b,c,d,e,f){this.permute(f,a,b,c,d,e);for(var g=1;e>g;g<<=1)for(var h=g<<1,i=Math.cos(2*Math.PI/h),j=Math.sin(2*Math.PI/h),k=0;e>k;k+=h)for(var l=i,m=j,n=0;g>n;n++){var o=c[k+n],p=d[k+n],q=c[k+n+g],r=d[k+n+g],s=l*q-m*r;r=l*r+m*q,q=s,c[k+n]=o+q,d[k+n]=p+r,c[k+n+g]=o-q,d[k+n+g]=p-r,n!==h&&(s=i*l-j*m,m=i*m+j*l,l=s)}},m.prototype.guessLen13b=function(a,b){var c=1|Math.max(b,a),d=1&c,e=0;for(c=c/2|0;c;c>>>=1)e++;return 1<<e+1+d},m.prototype.conjugate=function(a,b,c){if(!(1>=c))for(var d=0;c/2>d;d++){var e=a[d];a[d]=a[c-d-1],a[c-d-1]=e,e=b[d],b[d]=-b[c-d-1],b[c-d-1]=-e}},m.prototype.normalize13b=function(a,b){for(var c=0,d=0;b/2>d;d++){var e=8192*Math.round(a[2*d+1]/b)+Math.round(a[2*d]/b)+c;a[d]=67108863&e,c=67108864>e?0:e/67108864|0}return a},m.prototype.convert13b=function(a,b,c,e){for(var f=0,g=0;b>g;g++)f+=0|a[g],c[2*g]=8191&f,f>>>=13,c[2*g+1]=8191&f,f>>>=13;for(g=2*b;e>g;++g)c[g]=0;d(0===f),d(0===(-8192&f))},m.prototype.stub=function(a){for(var b=new Array(a),c=0;a>c;c++)b[c]=0;return b},m.prototype.mulp=function(a,b,c){var d=2*this.guessLen13b(a.length,b.length),e=this.makeRBT(d),f=this.stub(d),g=new Array(d),h=new Array(d),i=new Array(d),j=new Array(d),k=new Array(d),l=new Array(d),m=c.words;m.length=d,this.convert13b(a.words,a.length,g,d),this.convert13b(b.words,b.length,j,d),this.transform(g,f,h,i,d,e),this.transform(j,f,k,l,d,e);for(var n=0;d>n;n++){var o=h[n]*k[n]-i[n]*l[n];i[n]=h[n]*l[n]+i[n]*k[n],h[n]=o}return this.conjugate(h,i,d),this.transform(h,i,m,f,d,e),this.conjugate(m,f,d),this.normalize13b(m,d),c.negative=a.negative^b.negative,c.length=a.length+b.length,c.strip()},f.prototype.mul=function(a){var b=new f(null);return b.words=new Array(this.length+a.length),this.mulTo(a,b)},f.prototype.mulf=function(a){var b=new f(null);return b.words=new Array(this.length+a.length),l(this,a,b)},f.prototype.imul=function(a){return this.clone().mulTo(a,this)},f.prototype.imuln=function(a){d("number"==typeof a),d(67108864>a);for(var b=0,c=0;c<this.length;c++){var e=(0|this.words[c])*a,f=(67108863&e)+(67108863&b);b>>=26,b+=e/67108864|0,b+=f>>>26,this.words[c]=67108863&f}return 0!==b&&(this.words[c]=b,this.length++),this},f.prototype.muln=function(a){return this.clone().imuln(a)},f.prototype.sqr=function(){return this.mul(this)},f.prototype.isqr=function(){return this.imul(this.clone())},f.prototype.pow=function(a){var b=i(a);if(0===b.length)return new f(1);for(var c=this,d=0;d<b.length&&0===b[d];d++,c=c.sqr());if(++d<b.length)for(var e=c.sqr();d<b.length;d++,e=e.sqr())0!==b[d]&&(c=c.mul(e));return c},f.prototype.iushln=function(a){d("number"==typeof a&&a>=0);var b,c=a%26,e=(a-c)/26,f=67108863>>>26-c<<26-c;if(0!==c){var g=0;for(b=0;b<this.length;b++){var h=this.words[b]&f,i=(0|this.words[b])-h<<c;this.words[b]=i|g,g=h>>>26-c}g&&(this.words[b]=g,this.length++)}if(0!==e){for(b=this.length-1;b>=0;b--)this.words[b+e]=this.words[b];for(b=0;e>b;b++)this.words[b]=0;this.length+=e}return this.strip()},f.prototype.ishln=function(a){return d(0===this.negative),this.iushln(a)},f.prototype.iushrn=function(a,b,c){d("number"==typeof a&&a>=0);var e;e=b?(b-b%26)/26:0;var f=a%26,g=Math.min((a-f)/26,this.length),h=67108863^67108863>>>f<<f,i=c;if(e-=g,e=Math.max(0,e),i){for(var j=0;g>j;j++)i.words[j]=this.words[j];i.length=g}if(0===g);else if(this.length>g)for(this.length-=g,j=0;j<this.length;j++)this.words[j]=this.words[j+g];else this.words[0]=0,this.length=1;var k=0;for(j=this.length-1;j>=0&&(0!==k||j>=e);j--){var l=0|this.words[j];this.words[j]=k<<26-f|l>>>f,k=l&h}return i&&0!==k&&(i.words[i.length++]=k),0===this.length&&(this.words[0]=0,this.length=1),this.strip()},f.prototype.ishrn=function(a,b,c){return d(0===this.negative),this.iushrn(a,b,c)},f.prototype.shln=function(a){return this.clone().ishln(a)},f.prototype.ushln=function(a){return this.clone().iushln(a)},f.prototype.shrn=function(a){return this.clone().ishrn(a)},f.prototype.ushrn=function(a){return this.clone().iushrn(a)},f.prototype.testn=function(a){d("number"==typeof a&&a>=0);var b=a%26,c=(a-b)/26,e=1<<b;if(this.length<=c)return!1;var f=this.words[c];return!!(f&e)},f.prototype.imaskn=function(a){d("number"==typeof a&&a>=0);var b=a%26,c=(a-b)/26;if(d(0===this.negative,"imaskn works only with positive numbers"),this.length<=c)return this;if(0!==b&&c++,this.length=Math.min(c,this.length),0!==b){var e=67108863^67108863>>>b<<b;this.words[this.length-1]&=e}return this.strip()},f.prototype.maskn=function(a){return this.clone().imaskn(a)},f.prototype.iaddn=function(a){return d("number"==typeof a),d(67108864>a),0>a?this.isubn(-a):0!==this.negative?1===this.length&&(0|this.words[0])<a?(this.words[0]=a-(0|this.words[0]),this.negative=0,this):(this.negative=0,this.isubn(a),this.negative=1,this):this._iaddn(a)},f.prototype._iaddn=function(a){this.words[0]+=a;for(var b=0;b<this.length&&this.words[b]>=67108864;b++)this.words[b]-=67108864,b===this.length-1?this.words[b+1]=1:this.words[b+1]++;return this.length=Math.max(this.length,b+1),this},f.prototype.isubn=function(a){if(d("number"==typeof a),d(67108864>a),0>a)return this.iaddn(-a);if(0!==this.negative)return this.negative=0,this.iaddn(a),this.negative=1,this;if(this.words[0]-=a,1===this.length&&this.words[0]<0)this.words[0]=-this.words[0],this.negative=1;else for(var b=0;b<this.length&&this.words[b]<0;b++)this.words[b]+=67108864,this.words[b+1]-=1;return this.strip()},f.prototype.addn=function(a){return this.clone().iaddn(a)},f.prototype.subn=function(a){return this.clone().isubn(a)},f.prototype.iabs=function(){return this.negative=0,this},f.prototype.abs=function(){return this.clone().iabs()},f.prototype._ishlnsubmul=function(a,b,c){var e,f=a.length+c;this._expand(f);var g,h=0;for(e=0;e<a.length;e++){g=(0|this.words[e+c])+h;var i=(0|a.words[e])*b;g-=67108863&i,h=(g>>26)-(i/67108864|0),this.words[e+c]=67108863&g}for(;e<this.length-c;e++)g=(0|this.words[e+c])+h,h=g>>26,this.words[e+c]=67108863&g;if(0===h)return this.strip();for(d(-1===h),h=0,e=0;e<this.length;e++)g=-(0|this.words[e])+h,h=g>>26,this.words[e]=67108863&g;return this.negative=1,this.strip()},f.prototype._wordDiv=function(a,b){var c=this.length-a.length,d=this.clone(),e=a,g=0|e.words[e.length-1],h=this._countBits(g);c=26-h,0!==c&&(e=e.ushln(c),d.iushln(c),g=0|e.words[e.length-1]);var i,j=d.length-e.length;if("mod"!==b){i=new f(null),i.length=j+1,i.words=new Array(i.length);for(var k=0;k<i.length;k++)i.words[k]=0}var l=d.clone()._ishlnsubmul(e,1,j);0===l.negative&&(d=l,i&&(i.words[j]=1));for(var m=j-1;m>=0;m--){var n=67108864*(0|d.words[e.length+m])+(0|d.words[e.length+m-1]);for(n=Math.min(n/g|0,67108863),d._ishlnsubmul(e,n,m);0!==d.negative;)n--,d.negative=0,d._ishlnsubmul(e,1,m),d.isZero()||(d.negative^=1);i&&(i.words[m]=n)}return i&&i.strip(),d.strip(),"div"!==b&&0!==c&&d.iushrn(c),{div:i||null,mod:d}},f.prototype.divmod=function(a,b,c){if(d(!a.isZero()),this.isZero())return{div:new f(0),mod:new f(0)};var e,g,h;return 0!==this.negative&&0===a.negative?(h=this.neg().divmod(a,b),"mod"!==b&&(e=h.div.neg()),"div"!==b&&(g=h.mod.neg(),c&&0!==g.negative&&g.iadd(a)),{div:e,mod:g}):0===this.negative&&0!==a.negative?(h=this.divmod(a.neg(),b),"mod"!==b&&(e=h.div.neg()),{div:e,mod:h.mod}):0!==(this.negative&a.negative)?(h=this.neg().divmod(a.neg(),b),"div"!==b&&(g=h.mod.neg(),c&&0!==g.negative&&g.isub(a)),{div:h.div,mod:g}):a.length>this.length||this.cmp(a)<0?{div:new f(0),mod:this}:1===a.length?"div"===b?{div:this.divn(a.words[0]),mod:null}:"mod"===b?{div:null,mod:new f(this.modn(a.words[0]))}:{div:this.divn(a.words[0]),mod:new f(this.modn(a.words[0]))}:this._wordDiv(a,b)},f.prototype.div=function(a){return this.divmod(a,"div",!1).div},f.prototype.mod=function(a){return this.divmod(a,"mod",!1).mod},f.prototype.umod=function(a){return this.divmod(a,"mod",!0).mod},f.prototype.divRound=function(a){
var b=this.divmod(a);if(b.mod.isZero())return b.div;var c=0!==b.div.negative?b.mod.isub(a):b.mod,d=a.ushrn(1),e=a.andln(1),f=c.cmp(d);return 0>f||1===e&&0===f?b.div:0!==b.div.negative?b.div.isubn(1):b.div.iaddn(1)},f.prototype.modn=function(a){d(67108863>=a);for(var b=(1<<26)%a,c=0,e=this.length-1;e>=0;e--)c=(b*c+(0|this.words[e]))%a;return c},f.prototype.idivn=function(a){d(67108863>=a);for(var b=0,c=this.length-1;c>=0;c--){var e=(0|this.words[c])+67108864*b;this.words[c]=e/a|0,b=e%a}return this.strip()},f.prototype.divn=function(a){return this.clone().idivn(a)},f.prototype.egcd=function(a){d(0===a.negative),d(!a.isZero());var b=this,c=a.clone();b=0!==b.negative?b.umod(a):b.clone();for(var e=new f(1),g=new f(0),h=new f(0),i=new f(1),j=0;b.isEven()&&c.isEven();)b.iushrn(1),c.iushrn(1),++j;for(var k=c.clone(),l=b.clone();!b.isZero();){for(var m=0,n=1;0===(b.words[0]&n)&&26>m;++m,n<<=1);if(m>0)for(b.iushrn(m);m-->0;)(e.isOdd()||g.isOdd())&&(e.iadd(k),g.isub(l)),e.iushrn(1),g.iushrn(1);for(var o=0,p=1;0===(c.words[0]&p)&&26>o;++o,p<<=1);if(o>0)for(c.iushrn(o);o-->0;)(h.isOdd()||i.isOdd())&&(h.iadd(k),i.isub(l)),h.iushrn(1),i.iushrn(1);b.cmp(c)>=0?(b.isub(c),e.isub(h),g.isub(i)):(c.isub(b),h.isub(e),i.isub(g))}return{a:h,b:i,gcd:c.iushln(j)}},f.prototype._invmp=function(a){d(0===a.negative),d(!a.isZero());var b=this,c=a.clone();b=0!==b.negative?b.umod(a):b.clone();for(var e=new f(1),g=new f(0),h=c.clone();b.cmpn(1)>0&&c.cmpn(1)>0;){for(var i=0,j=1;0===(b.words[0]&j)&&26>i;++i,j<<=1);if(i>0)for(b.iushrn(i);i-->0;)e.isOdd()&&e.iadd(h),e.iushrn(1);for(var k=0,l=1;0===(c.words[0]&l)&&26>k;++k,l<<=1);if(k>0)for(c.iushrn(k);k-->0;)g.isOdd()&&g.iadd(h),g.iushrn(1);b.cmp(c)>=0?(b.isub(c),e.isub(g)):(c.isub(b),g.isub(e))}var m;return m=0===b.cmpn(1)?e:g,m.cmpn(0)<0&&m.iadd(a),m},f.prototype.gcd=function(a){if(this.isZero())return a.abs();if(a.isZero())return this.abs();var b=this.clone(),c=a.clone();b.negative=0,c.negative=0;for(var d=0;b.isEven()&&c.isEven();d++)b.iushrn(1),c.iushrn(1);for(;;){for(;b.isEven();)b.iushrn(1);for(;c.isEven();)c.iushrn(1);var e=b.cmp(c);if(0>e){var f=b;b=c,c=f}else if(0===e||0===c.cmpn(1))break;b.isub(c)}return c.iushln(d)},f.prototype.invm=function(a){return this.egcd(a).a.umod(a)},f.prototype.isEven=function(){return 0===(1&this.words[0])},f.prototype.isOdd=function(){return 1===(1&this.words[0])},f.prototype.andln=function(a){return this.words[0]&a},f.prototype.bincn=function(a){d("number"==typeof a);var b=a%26,c=(a-b)/26,e=1<<b;if(this.length<=c)return this._expand(c+1),this.words[c]|=e,this;for(var f=e,g=c;0!==f&&g<this.length;g++){var h=0|this.words[g];h+=f,f=h>>>26,h&=67108863,this.words[g]=h}return 0!==f&&(this.words[g]=f,this.length++),this},f.prototype.isZero=function(){return 1===this.length&&0===this.words[0]},f.prototype.cmpn=function(a){var b=0>a;if(0!==this.negative&&!b)return-1;if(0===this.negative&&b)return 1;this.strip();var c;if(this.length>1)c=1;else{b&&(a=-a),d(67108863>=a,"Number is too big");var e=0|this.words[0];c=e===a?0:a>e?-1:1}return 0!==this.negative?0|-c:c},f.prototype.cmp=function(a){if(0!==this.negative&&0===a.negative)return-1;if(0===this.negative&&0!==a.negative)return 1;var b=this.ucmp(a);return 0!==this.negative?0|-b:b},f.prototype.ucmp=function(a){if(this.length>a.length)return 1;if(this.length<a.length)return-1;for(var b=0,c=this.length-1;c>=0;c--){var d=0|this.words[c],e=0|a.words[c];if(d!==e){e>d?b=-1:d>e&&(b=1);break}}return b},f.prototype.gtn=function(a){return 1===this.cmpn(a)},f.prototype.gt=function(a){return 1===this.cmp(a)},f.prototype.gten=function(a){return this.cmpn(a)>=0},f.prototype.gte=function(a){return this.cmp(a)>=0},f.prototype.ltn=function(a){return-1===this.cmpn(a)},f.prototype.lt=function(a){return-1===this.cmp(a)},f.prototype.lten=function(a){return this.cmpn(a)<=0},f.prototype.lte=function(a){return this.cmp(a)<=0},f.prototype.eqn=function(a){return 0===this.cmpn(a)},f.prototype.eq=function(a){return 0===this.cmp(a)},f.red=function(a){return new s(a)},f.prototype.toRed=function(a){return d(!this.red,"Already a number in reduction context"),d(0===this.negative,"red works only with positives"),a.convertTo(this)._forceRed(a)},f.prototype.fromRed=function(){return d(this.red,"fromRed works only with numbers in reduction context"),this.red.convertFrom(this)},f.prototype._forceRed=function(a){return this.red=a,this},f.prototype.forceRed=function(a){return d(!this.red,"Already a number in reduction context"),this._forceRed(a)},f.prototype.redAdd=function(a){return d(this.red,"redAdd works only with red numbers"),this.red.add(this,a)},f.prototype.redIAdd=function(a){return d(this.red,"redIAdd works only with red numbers"),this.red.iadd(this,a)},f.prototype.redSub=function(a){return d(this.red,"redSub works only with red numbers"),this.red.sub(this,a)},f.prototype.redISub=function(a){return d(this.red,"redISub works only with red numbers"),this.red.isub(this,a)},f.prototype.redShl=function(a){return d(this.red,"redShl works only with red numbers"),this.red.shl(this,a)},f.prototype.redMul=function(a){return d(this.red,"redMul works only with red numbers"),this.red._verify2(this,a),this.red.mul(this,a)},f.prototype.redIMul=function(a){return d(this.red,"redMul works only with red numbers"),this.red._verify2(this,a),this.red.imul(this,a)},f.prototype.redSqr=function(){return d(this.red,"redSqr works only with red numbers"),this.red._verify1(this),this.red.sqr(this)},f.prototype.redISqr=function(){return d(this.red,"redISqr works only with red numbers"),this.red._verify1(this),this.red.isqr(this)},f.prototype.redSqrt=function(){return d(this.red,"redSqrt works only with red numbers"),this.red._verify1(this),this.red.sqrt(this)},f.prototype.redInvm=function(){return d(this.red,"redInvm works only with red numbers"),this.red._verify1(this),this.red.invm(this)},f.prototype.redNeg=function(){return d(this.red,"redNeg works only with red numbers"),this.red._verify1(this),this.red.neg(this)},f.prototype.redPow=function(a){return d(this.red&&!a.red,"redPow(normalNum)"),this.red._verify1(this),this.red.pow(this,a)};var A={k256:null,p224:null,p192:null,p25519:null};n.prototype._tmp=function(){var a=new f(null);return a.words=new Array(Math.ceil(this.n/13)),a},n.prototype.ireduce=function(a){var b,c=a;do this.split(c,this.tmp),c=this.imulK(c),c=c.iadd(this.tmp),b=c.bitLength();while(b>this.n);var d=b<this.n?-1:c.ucmp(this.p);return 0===d?(c.words[0]=0,c.length=1):d>0?c.isub(this.p):c.strip(),c},n.prototype.split=function(a,b){a.iushrn(this.n,0,b)},n.prototype.imulK=function(a){return a.imul(this.k)},e(o,n),o.prototype.split=function(a,b){for(var c=4194303,d=Math.min(a.length,9),e=0;d>e;e++)b.words[e]=a.words[e];if(b.length=d,a.length<=9)return a.words[0]=0,void(a.length=1);var f=a.words[9];for(b.words[b.length++]=f&c,e=10;e<a.length;e++){var g=0|a.words[e];a.words[e-10]=(g&c)<<4|f>>>22,f=g}f>>>=22,a.words[e-10]=f,0===f&&a.length>10?a.length-=10:a.length-=9},o.prototype.imulK=function(a){a.words[a.length]=0,a.words[a.length+1]=0,a.length+=2;for(var b=0,c=0;c<a.length;c++){var d=0|a.words[c];b+=977*d,a.words[c]=67108863&b,b=64*d+(b/67108864|0)}return 0===a.words[a.length-1]&&(a.length--,0===a.words[a.length-1]&&a.length--),a},e(p,n),e(q,n),e(r,n),r.prototype.imulK=function(a){for(var b=0,c=0;c<a.length;c++){var d=19*(0|a.words[c])+b,e=67108863&d;d>>>=26,a.words[c]=e,b=d}return 0!==b&&(a.words[a.length++]=b),a},f._prime=function B(a){if(A[a])return A[a];var B;if("k256"===a)B=new o;else if("p224"===a)B=new p;else if("p192"===a)B=new q;else{if("p25519"!==a)throw new Error("Unknown prime "+a);B=new r}return A[a]=B,B},s.prototype._verify1=function(a){d(0===a.negative,"red works only with positives"),d(a.red,"red works only with red numbers")},s.prototype._verify2=function(a,b){d(0===(a.negative|b.negative),"red works only with positives"),d(a.red&&a.red===b.red,"red works only with red numbers")},s.prototype.imod=function(a){return this.prime?this.prime.ireduce(a)._forceRed(this):a.umod(this.m)._forceRed(this)},s.prototype.neg=function(a){return a.isZero()?a.clone():this.m.sub(a)._forceRed(this)},s.prototype.add=function(a,b){this._verify2(a,b);var c=a.add(b);return c.cmp(this.m)>=0&&c.isub(this.m),c._forceRed(this)},s.prototype.iadd=function(a,b){this._verify2(a,b);var c=a.iadd(b);return c.cmp(this.m)>=0&&c.isub(this.m),c},s.prototype.sub=function(a,b){this._verify2(a,b);var c=a.sub(b);return c.cmpn(0)<0&&c.iadd(this.m),c._forceRed(this)},s.prototype.isub=function(a,b){this._verify2(a,b);var c=a.isub(b);return c.cmpn(0)<0&&c.iadd(this.m),c},s.prototype.shl=function(a,b){return this._verify1(a),this.imod(a.ushln(b))},s.prototype.imul=function(a,b){return this._verify2(a,b),this.imod(a.imul(b))},s.prototype.mul=function(a,b){return this._verify2(a,b),this.imod(a.mul(b))},s.prototype.isqr=function(a){return this.imul(a,a.clone())},s.prototype.sqr=function(a){return this.mul(a,a)},s.prototype.sqrt=function(a){if(a.isZero())return a.clone();var b=this.m.andln(3);if(d(b%2===1),3===b){var c=this.m.add(new f(1)).iushrn(2);return this.pow(a,c)}for(var e=this.m.subn(1),g=0;!e.isZero()&&0===e.andln(1);)g++,e.iushrn(1);d(!e.isZero());var h=new f(1).toRed(this),i=h.redNeg(),j=this.m.subn(1).iushrn(1),k=this.m.bitLength();for(k=new f(2*k*k).toRed(this);0!==this.pow(k,j).cmp(i);)k.redIAdd(i);for(var l=this.pow(k,e),m=this.pow(a,e.addn(1).iushrn(1)),n=this.pow(a,e),o=g;0!==n.cmp(h);){for(var p=n,q=0;0!==p.cmp(h);q++)p=p.redSqr();d(o>q);var r=this.pow(l,new f(1).iushln(o-q-1));m=m.redMul(r),l=r.redSqr(),n=n.redMul(l),o=q}return m},s.prototype.invm=function(a){var b=a._invmp(this.m);return 0!==b.negative?(b.negative=0,this.imod(b).redNeg()):this.imod(b)},s.prototype.pow=function(a,b){if(b.isZero())return new f(1).toRed(this);if(0===b.cmpn(1))return a.clone();var c=4,d=new Array(1<<c);d[0]=new f(1).toRed(this),d[1]=a;for(var e=2;e<d.length;e++)d[e]=this.mul(d[e-1],a);var g=d[0],h=0,i=0,j=b.bitLength()%26;for(0===j&&(j=26),e=b.length-1;e>=0;e--){for(var k=b.words[e],l=j-1;l>=0;l--){var m=k>>l&1;g!==d[0]&&(g=this.sqr(g)),0!==m||0!==h?(h<<=1,h|=m,i++,(i===c||0===e&&0===l)&&(g=this.mul(g,d[h]),i=0,h=0)):i=0}j=26}return g},s.prototype.convertTo=function(a){var b=a.umod(this.m);return b===a?b.clone():b},s.prototype.convertFrom=function(a){var b=a.clone();return b.red=null,b},f.mont=function(a){return new t(a)},e(t,s),t.prototype.convertTo=function(a){return this.imod(a.ushln(this.shift))},t.prototype.convertFrom=function(a){var b=this.imod(a.mul(this.rinv));return b.red=null,b},t.prototype.imul=function(a,b){if(a.isZero()||b.isZero())return a.words[0]=0,a.length=1,a;var c=a.imul(b),d=c.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),e=c.isub(d).iushrn(this.shift),f=e;return e.cmp(this.m)>=0?f=e.isub(this.m):e.cmpn(0)<0&&(f=e.iadd(this.m)),f._forceRed(this)},t.prototype.mul=function(a,b){if(a.isZero()||b.isZero())return new f(0)._forceRed(this);var c=a.mul(b),d=c.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),e=c.isub(d).iushrn(this.shift),g=e;return e.cmp(this.m)>=0?g=e.isub(this.m):e.cmpn(0)<0&&(g=e.iadd(this.m)),g._forceRed(this)},t.prototype.invm=function(a){var b=this.imod(a._invmp(this.m).mul(this.r2));return b._forceRed(this)}}("undefined"==typeof b||b,this)},{}],100:[function(a,b,c){function d(a){this.rand=a}var e;if(b.exports=function(a){return e||(e=new d(null)),e.generate(a)},b.exports.Rand=d,d.prototype.generate=function(a){return this._rand(a)},d.prototype._rand=function(a){if(this.rand.getBytes)return this.rand.getBytes(a);for(var b=new Uint8Array(a),c=0;c<b.length;c++)b[c]=this.rand.getByte();return b},"object"==typeof self)self.crypto&&self.crypto.getRandomValues?d.prototype._rand=function(a){var b=new Uint8Array(a);return self.crypto.getRandomValues(b),b}:self.msCrypto&&self.msCrypto.getRandomValues?d.prototype._rand=function(a){var b=new Uint8Array(a);return self.msCrypto.getRandomValues(b),b}:"object"==typeof window&&(d.prototype._rand=function(){throw new Error("Not implemented yet")});else try{var f=a("crypto");if("function"!=typeof f.randomBytes)throw new Error("Not supported");d.prototype._rand=function(a){return f.randomBytes(a)}}catch(g){}},{crypto:101}],101:[function(a,b,c){},{}],102:[function(a,b,c){(function(a){function b(a){var b,c;return b=a>h||0>a?(c=Math.abs(a)%h,0>a?h-c:c):a}function d(a){for(var b=0;b<a.length;a++)a[b]=0;return!1}function e(){this.SBOX=[],this.INV_SBOX=[],this.SUB_MIX=[[],[],[],[]],this.INV_SUB_MIX=[[],[],[],[]],this.init(),this.RCON=[0,1,2,4,8,16,32,64,128,27,54]}function f(a){for(var b=a.length/4,c=new Array(b),d=-1;++d<b;)c[d]=a.readUInt32BE(4*d);return c}function g(a){this._key=f(a),this._doReset()}var h=Math.pow(2,32);e.prototype.init=function(){var a,b,c,d,e,f,g,h,i,j;for(a=function(){var a,c;for(c=[],b=a=0;256>a;b=++a)128>b?c.push(b<<1):c.push(b<<1^283);return c}(),e=0,i=0,b=j=0;256>j;b=++j)c=i^i<<1^i<<2^i<<3^i<<4,c=c>>>8^255&c^99,this.SBOX[e]=c,this.INV_SBOX[c]=e,f=a[e],g=a[f],h=a[g],d=257*a[c]^16843008*c,this.SUB_MIX[0][e]=d<<24|d>>>8,this.SUB_MIX[1][e]=d<<16|d>>>16,this.SUB_MIX[2][e]=d<<8|d>>>24,this.SUB_MIX[3][e]=d,d=16843009*h^65537*g^257*f^16843008*e,this.INV_SUB_MIX[0][c]=d<<24|d>>>8,this.INV_SUB_MIX[1][c]=d<<16|d>>>16,this.INV_SUB_MIX[2][c]=d<<8|d>>>24,this.INV_SUB_MIX[3][c]=d,0===e?e=i=1:(e=f^a[a[a[h^f]]],i^=a[a[i]]);return!0};var i=new e;g.blockSize=16,g.prototype.blockSize=g.blockSize,g.keySize=32,g.prototype.keySize=g.keySize,g.prototype._doReset=function(){var a,b,c,d,e,f;for(c=this._key,b=c.length,this._nRounds=b+6,e=4*(this._nRounds+1),this._keySchedule=[],d=0;e>d;d++)this._keySchedule[d]=b>d?c[d]:(f=this._keySchedule[d-1],d%b===0?(f=f<<8|f>>>24,f=i.SBOX[f>>>24]<<24|i.SBOX[f>>>16&255]<<16|i.SBOX[f>>>8&255]<<8|i.SBOX[255&f],f^=i.RCON[d/b|0]<<24):b>6&&d%b===4?f=i.SBOX[f>>>24]<<24|i.SBOX[f>>>16&255]<<16|i.SBOX[f>>>8&255]<<8|i.SBOX[255&f]:void 0,this._keySchedule[d-b]^f);for(this._invKeySchedule=[],a=0;e>a;a++)d=e-a,f=this._keySchedule[d-(a%4?0:4)],this._invKeySchedule[a]=4>a||4>=d?f:i.INV_SUB_MIX[0][i.SBOX[f>>>24]]^i.INV_SUB_MIX[1][i.SBOX[f>>>16&255]]^i.INV_SUB_MIX[2][i.SBOX[f>>>8&255]]^i.INV_SUB_MIX[3][i.SBOX[255&f]];return!0},g.prototype.encryptBlock=function(b){b=f(new a(b));var c=this._doCryptBlock(b,this._keySchedule,i.SUB_MIX,i.SBOX),d=new a(16);return d.writeUInt32BE(c[0],0),d.writeUInt32BE(c[1],4),d.writeUInt32BE(c[2],8),d.writeUInt32BE(c[3],12),d},g.prototype.decryptBlock=function(b){b=f(new a(b));var c=[b[3],b[1]];b[1]=c[0],b[3]=c[1];var d=this._doCryptBlock(b,this._invKeySchedule,i.INV_SUB_MIX,i.INV_SBOX),e=new a(16);return e.writeUInt32BE(d[0],0),e.writeUInt32BE(d[3],4),e.writeUInt32BE(d[2],8),e.writeUInt32BE(d[1],12),e},g.prototype.scrub=function(){d(this._keySchedule),d(this._invKeySchedule),d(this._key)},g.prototype._doCryptBlock=function(a,c,d,e){var f,g,h,i,j,k,l,m,n;g=a[0]^c[0],h=a[1]^c[1],i=a[2]^c[2],j=a[3]^c[3],f=4;for(var o=1;o<this._nRounds;o++)k=d[0][g>>>24]^d[1][h>>>16&255]^d[2][i>>>8&255]^d[3][255&j]^c[f++],l=d[0][h>>>24]^d[1][i>>>16&255]^d[2][j>>>8&255]^d[3][255&g]^c[f++],m=d[0][i>>>24]^d[1][j>>>16&255]^d[2][g>>>8&255]^d[3][255&h]^c[f++],n=d[0][j>>>24]^d[1][g>>>16&255]^d[2][h>>>8&255]^d[3][255&i]^c[f++],g=k,h=l,i=m,j=n;return k=(e[g>>>24]<<24|e[h>>>16&255]<<16|e[i>>>8&255]<<8|e[255&j])^c[f++],l=(e[h>>>24]<<24|e[i>>>16&255]<<16|e[j>>>8&255]<<8|e[255&g])^c[f++],m=(e[i>>>24]<<24|e[j>>>16&255]<<16|e[g>>>8&255]<<8|e[255&h])^c[f++],n=(e[j>>>24]<<24|e[g>>>16&255]<<16|e[h>>>8&255]<<8|e[255&i])^c[f++],[b(k),b(l),b(m),b(n)]},c.AES=g}).call(this,a("buffer").Buffer)},{buffer:130}],103:[function(a,b,c){(function(c){function d(a,b,e,h){if(!(this instanceof d))return new d(a,b,e);g.call(this),this._finID=c.concat([e,new c([0,0,0,1])]),e=c.concat([e,new c([0,0,0,2])]),this._cipher=new f.AES(b),this._prev=new c(e.length),this._cache=new c(""),this._secCache=new c(""),this._decrypt=h,this._alen=0,this._len=0,e.copy(this._prev),this._mode=a;var j=new c(4);j.fill(0),this._ghash=new i(this._cipher.encryptBlock(j)),this._authTag=null,this._called=!1}function e(a,b){var c=0;a.length!==b.length&&c++;for(var d=Math.min(a.length,b.length),e=-1;++e<d;)c+=a[e]^b[e];return c}var f=a("./aes"),g=a("cipher-base"),h=a("inherits"),i=a("./ghash"),j=a("buffer-xor");h(d,g),b.exports=d,d.prototype._update=function(a){if(!this._called&&this._alen){var b=16-this._alen%16;16>b&&(b=new c(b),b.fill(0),this._ghash.update(b))}this._called=!0;var d=this._mode.encrypt(this,a);return this._decrypt?this._ghash.update(a):this._ghash.update(d),this._len+=a.length,d},d.prototype._final=function(){if(this._decrypt&&!this._authTag)throw new Error("Unsupported state or unable to authenticate data");var a=j(this._ghash["final"](8*this._alen,8*this._len),this._cipher.encryptBlock(this._finID));if(this._decrypt){if(e(a,this._authTag))throw new Error("Unsupported state or unable to authenticate data")}else this._authTag=a;this._cipher.scrub()},d.prototype.getAuthTag=function(){if(!this._decrypt&&c.isBuffer(this._authTag))return this._authTag;throw new Error("Attempting to get auth tag in unsupported state")},d.prototype.setAuthTag=function(a){if(!this._decrypt)throw new Error("Attempting to set auth tag in unsupported state");this._authTag=a},d.prototype.setAAD=function(a){if(this._called)throw new Error("Attempting to set AAD in unsupported state");this._ghash.update(a),this._alen+=a.length}}).call(this,a("buffer").Buffer)},{"./aes":102,"./ghash":107,buffer:130,"buffer-xor":129,"cipher-base":133,inherits:196}],104:[function(a,b,c){function d(){return Object.keys(g)}var e=a("./encrypter");c.createCipher=c.Cipher=e.createCipher,c.createCipheriv=c.Cipheriv=e.createCipheriv;var f=a("./decrypter");c.createDecipher=c.Decipher=f.createDecipher,c.createDecipheriv=c.Decipheriv=f.createDecipheriv;var g=a("./modes");c.listCiphers=c.getCiphers=d},{"./decrypter":105,"./encrypter":106,"./modes":108}],105:[function(a,b,c){(function(b){function d(a,c,f){return this instanceof d?(j.call(this),this._cache=new e,this._last=void 0,this._cipher=new i.AES(c),this._prev=new b(f.length),f.copy(this._prev),this._mode=a,void(this._autopadding=!0)):new d(a,c,f)}function e(){return this instanceof e?void(this.cache=new b("")):new e}function f(a){for(var b=a[15],c=-1;++c<b;)if(a[c+(16-b)]!==b)throw new Error("unable to decrypt data");return 16!==b?a.slice(0,16-b):void 0}function g(a,c,e){var f=l[a.toLowerCase()];if(!f)throw new TypeError("invalid suite type");if("string"==typeof e&&(e=new b(e)),"string"==typeof c&&(c=new b(c)),c.length!==f.key/8)throw new TypeError("invalid key length "+c.length);if(e.length!==f.iv)throw new TypeError("invalid iv length "+e.length);return"stream"===f.type?new m(p[f.mode],c,e,!0):"auth"===f.type?new n(p[f.mode],c,e,!0):new d(p[f.mode],c,e)}function h(a,b){var c=l[a.toLowerCase()];if(!c)throw new TypeError("invalid suite type");var d=o(b,!1,c.key,c.iv);return g(a,d.key,d.iv)}var i=a("./aes"),j=a("cipher-base"),k=a("inherits"),l=a("./modes"),m=a("./streamCipher"),n=a("./authCipher"),o=a("evp_bytestokey");k(d,j),d.prototype._update=function(a){this._cache.add(a);for(var c,d,e=[];c=this._cache.get(this._autopadding);)d=this._mode.decrypt(this,c),e.push(d);return b.concat(e)},d.prototype._final=function(){var a=this._cache.flush();if(this._autopadding)return f(this._mode.decrypt(this,a));if(a)throw new Error("data not multiple of block length")},d.prototype.setAutoPadding=function(a){return this._autopadding=!!a,this},e.prototype.add=function(a){this.cache=b.concat([this.cache,a])},e.prototype.get=function(a){var b;if(a){if(this.cache.length>16)return b=this.cache.slice(0,16),this.cache=this.cache.slice(16),b}else if(this.cache.length>=16)return b=this.cache.slice(0,16),this.cache=this.cache.slice(16),b;return null},e.prototype.flush=function(){return this.cache.length?this.cache:void 0};var p={ECB:a("./modes/ecb"),CBC:a("./modes/cbc"),CFB:a("./modes/cfb"),CFB8:a("./modes/cfb8"),CFB1:a("./modes/cfb1"),OFB:a("./modes/ofb"),CTR:a("./modes/ctr"),GCM:a("./modes/ctr")};c.createDecipher=h,c.createDecipheriv=g}).call(this,a("buffer").Buffer)},{"./aes":102,"./authCipher":103,"./modes":108,"./modes/cbc":109,"./modes/cfb":110,"./modes/cfb1":111,"./modes/cfb8":112,"./modes/ctr":113,"./modes/ecb":114,"./modes/ofb":115,"./streamCipher":116,buffer:130,"cipher-base":133,evp_bytestokey:170,inherits:196}],106:[function(a,b,c){(function(b){function d(a,c,f){return this instanceof d?(i.call(this),this._cache=new e,this._cipher=new h.AES(c),this._prev=new b(f.length),f.copy(this._prev),this._mode=a,void(this._autopadding=!0)):new d(a,c,f)}function e(){return this instanceof e?void(this.cache=new b("")):new e}function f(a,c,e){var f=k[a.toLowerCase()];if(!f)throw new TypeError("invalid suite type");if("string"==typeof e&&(e=new b(e)),"string"==typeof c&&(c=new b(c)),c.length!==f.key/8)throw new TypeError("invalid key length "+c.length);if(e.length!==f.iv)throw new TypeError("invalid iv length "+e.length);return"stream"===f.type?new m(o[f.mode],c,e):"auth"===f.type?new n(o[f.mode],c,e):new d(o[f.mode],c,e)}function g(a,b){var c=k[a.toLowerCase()];if(!c)throw new TypeError("invalid suite type");var d=l(b,!1,c.key,c.iv);return f(a,d.key,d.iv)}var h=a("./aes"),i=a("cipher-base"),j=a("inherits"),k=a("./modes"),l=a("evp_bytestokey"),m=a("./streamCipher"),n=a("./authCipher");j(d,i),d.prototype._update=function(a){this._cache.add(a);for(var c,d,e=[];c=this._cache.get();)d=this._mode.encrypt(this,c),e.push(d);return b.concat(e)},d.prototype._final=function(){var a=this._cache.flush();if(this._autopadding)return a=this._mode.encrypt(this,a),this._cipher.scrub(),a;if("10101010101010101010101010101010"!==a.toString("hex"))throw this._cipher.scrub(),new Error("data not multiple of block length")},d.prototype.setAutoPadding=function(a){return this._autopadding=!!a,this},e.prototype.add=function(a){this.cache=b.concat([this.cache,a])},e.prototype.get=function(){if(this.cache.length>15){var a=this.cache.slice(0,16);return this.cache=this.cache.slice(16),a}return null},e.prototype.flush=function(){for(var a=16-this.cache.length,c=new b(a),d=-1;++d<a;)c.writeUInt8(a,d);var e=b.concat([this.cache,c]);return e};var o={ECB:a("./modes/ecb"),CBC:a("./modes/cbc"),CFB:a("./modes/cfb"),CFB8:a("./modes/cfb8"),CFB1:a("./modes/cfb1"),OFB:a("./modes/ofb"),CTR:a("./modes/ctr"),GCM:a("./modes/ctr")};c.createCipheriv=f,c.createCipher=g}).call(this,a("buffer").Buffer)},{"./aes":102,"./authCipher":103,"./modes":108,"./modes/cbc":109,"./modes/cfb":110,"./modes/cfb1":111,"./modes/cfb8":112,"./modes/ctr":113,"./modes/ecb":114,"./modes/ofb":115,"./streamCipher":116,buffer:130,"cipher-base":133,evp_bytestokey:170,inherits:196}],107:[function(a,b,c){(function(a){function c(b){this.h=b,this.state=new a(16),this.state.fill(0),this.cache=new a("")}function d(a){return[a.readUInt32BE(0),a.readUInt32BE(4),a.readUInt32BE(8),a.readUInt32BE(12)]}function e(b){b=b.map(f);var c=new a(16);return c.writeUInt32BE(b[0],0),c.writeUInt32BE(b[1],4),c.writeUInt32BE(b[2],8),c.writeUInt32BE(b[3],12),c}function f(a){var b,c;return b=a>i||0>a?(c=Math.abs(a)%i,0>a?i-c:c):a}function g(a,b){return[a[0]^b[0],a[1]^b[1],a[2]^b[2],a[3]^b[3]]}var h=new a(16);h.fill(0),b.exports=c,c.prototype.ghash=function(a){for(var b=-1;++b<a.length;)this.state[b]^=a[b];this._multiply()},c.prototype._multiply=function(){for(var a,b,c,f=d(this.h),h=[0,0,0,0],i=-1;++i<128;){for(b=0!==(this.state[~~(i/8)]&1<<7-i%8),b&&(h=g(h,f)),c=0!==(1&f[3]),a=3;a>0;a--)f[a]=f[a]>>>1|(1&f[a-1])<<31;f[0]=f[0]>>>1,c&&(f[0]=f[0]^225<<24)}this.state=e(h)},c.prototype.update=function(b){this.cache=a.concat([this.cache,b]);for(var c;this.cache.length>=16;)c=this.cache.slice(0,16),this.cache=this.cache.slice(16),this.ghash(c)},c.prototype["final"]=function(b,c){return this.cache.length&&this.ghash(a.concat([this.cache,h],16)),this.ghash(e([0,b,0,c])),this.state};var i=Math.pow(2,32)}).call(this,a("buffer").Buffer)},{buffer:130}],108:[function(a,b,c){c["aes-128-ecb"]={cipher:"AES",key:128,iv:0,mode:"ECB",type:"block"},c["aes-192-ecb"]={cipher:"AES",key:192,iv:0,mode:"ECB",type:"block"},c["aes-256-ecb"]={cipher:"AES",key:256,iv:0,mode:"ECB",type:"block"},c["aes-128-cbc"]={cipher:"AES",key:128,iv:16,mode:"CBC",type:"block"},c["aes-192-cbc"]={cipher:"AES",key:192,iv:16,mode:"CBC",type:"block"},c["aes-256-cbc"]={cipher:"AES",key:256,iv:16,mode:"CBC",type:"block"},c.aes128=c["aes-128-cbc"],c.aes192=c["aes-192-cbc"],c.aes256=c["aes-256-cbc"],c["aes-128-cfb"]={cipher:"AES",key:128,iv:16,mode:"CFB",type:"stream"},c["aes-192-cfb"]={cipher:"AES",key:192,iv:16,mode:"CFB",type:"stream"},c["aes-256-cfb"]={cipher:"AES",key:256,iv:16,mode:"CFB",type:"stream"},c["aes-128-cfb8"]={cipher:"AES",key:128,iv:16,mode:"CFB8",type:"stream"},c["aes-192-cfb8"]={cipher:"AES",key:192,iv:16,mode:"CFB8",type:"stream"},c["aes-256-cfb8"]={cipher:"AES",key:256,iv:16,mode:"CFB8",type:"stream"},c["aes-128-cfb1"]={cipher:"AES",key:128,iv:16,mode:"CFB1",type:"stream"},c["aes-192-cfb1"]={cipher:"AES",key:192,iv:16,mode:"CFB1",type:"stream"},c["aes-256-cfb1"]={cipher:"AES",key:256,iv:16,mode:"CFB1",type:"stream"},c["aes-128-ofb"]={cipher:"AES",key:128,iv:16,mode:"OFB",type:"stream"},c["aes-192-ofb"]={cipher:"AES",key:192,iv:16,mode:"OFB",type:"stream"},c["aes-256-ofb"]={cipher:"AES",key:256,iv:16,mode:"OFB",type:"stream"},c["aes-128-ctr"]={cipher:"AES",key:128,iv:16,mode:"CTR",type:"stream"},c["aes-192-ctr"]={cipher:"AES",key:192,iv:16,mode:"CTR",type:"stream"},c["aes-256-ctr"]={cipher:"AES",key:256,iv:16,mode:"CTR",type:"stream"},c["aes-128-gcm"]={cipher:"AES",key:128,iv:12,mode:"GCM",type:"auth"},c["aes-192-gcm"]={cipher:"AES",key:192,iv:12,mode:"GCM",type:"auth"},c["aes-256-gcm"]={cipher:"AES",key:256,iv:12,mode:"GCM",type:"auth"}},{}],109:[function(a,b,c){var d=a("buffer-xor");c.encrypt=function(a,b){var c=d(b,a._prev);return a._prev=a._cipher.encryptBlock(c),a._prev},c.decrypt=function(a,b){var c=a._prev;a._prev=b;var e=a._cipher.decryptBlock(b);return d(e,c)}},{"buffer-xor":129}],110:[function(a,b,c){(function(b){function d(a,c,d){var f=c.length,g=e(c,a._cache);return a._cache=a._cache.slice(f),a._prev=b.concat([a._prev,d?c:g]),g}var e=a("buffer-xor");c.encrypt=function(a,c,e){for(var f,g=new b("");c.length;){if(0===a._cache.length&&(a._cache=a._cipher.encryptBlock(a._prev),a._prev=new b("")),!(a._cache.length<=c.length)){g=b.concat([g,d(a,c,e)]);break}f=a._cache.length,g=b.concat([g,d(a,c.slice(0,f),e)]),c=c.slice(f)}return g}}).call(this,a("buffer").Buffer)},{buffer:130,"buffer-xor":129}],111:[function(a,b,c){(function(a){function b(a,b,c){for(var e,f,g,h=-1,i=8,j=0;++h<i;)e=a._cipher.encryptBlock(a._prev),f=b&1<<7-h?128:0,g=e[0]^f,j+=(128&g)>>h%8,a._prev=d(a._prev,c?f:g);return j}function d(b,c){var d=b.length,e=-1,f=new a(b.length);for(b=a.concat([b,new a([c])]);++e<d;)f[e]=b[e]<<1|b[e+1]>>7;return f}c.encrypt=function(c,d,e){for(var f=d.length,g=new a(f),h=-1;++h<f;)g[h]=b(c,d[h],e);return g}}).call(this,a("buffer").Buffer)},{buffer:130}],112:[function(a,b,c){(function(a){function b(b,c,d){var e=b._cipher.encryptBlock(b._prev),f=e[0]^c;return b._prev=a.concat([b._prev.slice(1),new a([d?c:f])]),f}c.encrypt=function(c,d,e){for(var f=d.length,g=new a(f),h=-1;++h<f;)g[h]=b(c,d[h],e);return g}}).call(this,a("buffer").Buffer)},{buffer:130}],113:[function(a,b,c){(function(b){function d(a){for(var b,c=a.length;c--;){if(b=a.readUInt8(c),255!==b){b++,a.writeUInt8(b,c);break}a.writeUInt8(0,c)}}function e(a){var b=a._cipher.encryptBlock(a._prev);return d(a._prev),b}var f=a("buffer-xor");c.encrypt=function(a,c){for(;a._cache.length<c.length;)a._cache=b.concat([a._cache,e(a)]);var d=a._cache.slice(0,c.length);return a._cache=a._cache.slice(c.length),f(c,d)}}).call(this,a("buffer").Buffer)},{buffer:130,"buffer-xor":129}],114:[function(a,b,c){c.encrypt=function(a,b){return a._cipher.encryptBlock(b)},c.decrypt=function(a,b){return a._cipher.decryptBlock(b)}},{}],115:[function(a,b,c){(function(b){function d(a){return a._prev=a._cipher.encryptBlock(a._prev),a._prev}var e=a("buffer-xor");c.encrypt=function(a,c){for(;a._cache.length<c.length;)a._cache=b.concat([a._cache,d(a)]);var f=a._cache.slice(0,c.length);return a._cache=a._cache.slice(c.length),e(c,f)}}).call(this,a("buffer").Buffer)},{buffer:130,"buffer-xor":129}],116:[function(a,b,c){(function(c){function d(a,b,g,h){return this instanceof d?(f.call(this),this._cipher=new e.AES(b),this._prev=new c(g.length),this._cache=new c(""),this._secCache=new c(""),this._decrypt=h,g.copy(this._prev),void(this._mode=a)):new d(a,b,g)}var e=a("./aes"),f=a("cipher-base"),g=a("inherits");g(d,f),b.exports=d,d.prototype._update=function(a){return this._mode.encrypt(this,a,this._decrypt)},d.prototype._final=function(){this._cipher.scrub()}}).call(this,a("buffer").Buffer)},{"./aes":102,buffer:130,"cipher-base":133,inherits:196}],117:[function(a,b,c){function d(a,b){var c,d;if(a=a.toLowerCase(),m[a])c=m[a].key,d=m[a].iv;else{if(!l[a])throw new TypeError("invalid suite type");c=8*l[a].key,d=l[a].iv}var e=i(b,!1,c,d);return f(a,e.key,e.iv)}function e(a,b){var c,d;if(a=a.toLowerCase(),m[a])c=m[a].key,d=m[a].iv;else{if(!l[a])throw new TypeError("invalid suite type");c=8*l[a].key,d=l[a].iv}var e=i(b,!1,c,d);return g(a,e.key,e.iv)}function f(a,b,c){if(a=a.toLowerCase(),m[a])return j.createCipheriv(a,b,c);if(l[a])return new k({key:b,iv:c,mode:a});throw new TypeError("invalid suite type")}function g(a,b,c){if(a=a.toLowerCase(),m[a])return j.createDecipheriv(a,b,c);if(l[a])return new k({key:b,iv:c,mode:a,decrypt:!0});throw new TypeError("invalid suite type")}function h(){return Object.keys(l).concat(j.getCiphers())}var i=a("evp_bytestokey"),j=a("browserify-aes/browser"),k=a("browserify-des"),l=a("browserify-des/modes"),m=a("browserify-aes/modes");c.createCipher=c.Cipher=d,c.createCipheriv=c.Cipheriv=f,c.createDecipher=c.Decipher=e,c.createDecipheriv=c.Decipheriv=g,c.listCiphers=c.getCiphers=h},{"browserify-aes/browser":104,"browserify-aes/modes":108,"browserify-des":118,"browserify-des/modes":119,evp_bytestokey:170}],118:[function(a,b,c){(function(c){function d(a){e.call(this);var b,d=a.mode.toLowerCase(),f=h[d];b=a.decrypt?"decrypt":"encrypt";var g=a.key;("des-ede"===d||"des-ede-cbc"===d)&&(g=c.concat([g,g.slice(0,8)]));var i=a.iv;this._des=f.create({key:g,iv:i,type:b})}var e=a("cipher-base"),f=a("des.js"),g=a("inherits"),h={"des-ede3-cbc":f.CBC.instantiate(f.EDE),"des-ede3":f.EDE,"des-ede-cbc":f.CBC.instantiate(f.EDE),"des-ede":f.EDE,"des-cbc":f.CBC.instantiate(f.DES),"des-ecb":f.DES};h.des=h["des-cbc"],h.des3=h["des-ede3-cbc"],b.exports=d,g(d,e),d.prototype._update=function(a){return new c(this._des.update(a))},d.prototype._final=function(){return new c(this._des["final"]())}}).call(this,a("buffer").Buffer)},{buffer:130,"cipher-base":133,"des.js":143,inherits:196}],119:[function(a,b,c){c["des-ecb"]={key:8,iv:0},c["des-cbc"]=c.des={key:8,iv:8},c["des-ede3-cbc"]=c.des3={key:24,iv:8},c["des-ede3"]={key:24,iv:0},c["des-ede-cbc"]={key:16,iv:8},c["des-ede"]={key:16,iv:0}},{}],120:[function(a,b,c){"use strict";var d=b.exports={lookup:function(a,b){var c=a.replace(/.*[\.\/]/,"").toLowerCase();return this.types[c]||b||this.default_type},default_type:"application/octet-stream",types:{123:"application/vnd.lotus-1-2-3",ez:"application/andrew-inset",aw:"application/applixware",atom:"application/atom+xml",atomcat:"application/atomcat+xml",atomsvc:"application/atomsvc+xml",ccxml:"application/ccxml+xml",cdmia:"application/cdmi-capability",cdmic:"application/cdmi-container",cdmid:"application/cdmi-domain",cdmio:"application/cdmi-object",cdmiq:"application/cdmi-queue",cu:"application/cu-seeme",davmount:"application/davmount+xml",dbk:"application/docbook+xml",dssc:"application/dssc+der",xdssc:"application/dssc+xml",ecma:"application/ecmascript",emma:"application/emma+xml",epub:"application/epub+zip",exi:"application/exi",pfr:"application/font-tdpfr",gml:"application/gml+xml",gpx:"application/gpx+xml",gxf:"application/gxf",stk:"application/hyperstudio",ink:"application/inkml+xml",inkml:"application/inkml+xml",ipfix:"application/ipfix",jar:"application/java-archive",
ser:"application/java-serialized-object","class":"application/java-vm",js:"application/javascript",json:"application/json",jsonml:"application/jsonml+json",lostxml:"application/lost+xml",hqx:"application/mac-binhex40",cpt:"application/mac-compactpro",mads:"application/mads+xml",mrc:"application/marc",mrcx:"application/marcxml+xml",ma:"application/mathematica",nb:"application/mathematica",mb:"application/mathematica",mathml:"application/mathml+xml",mbox:"application/mbox",mscml:"application/mediaservercontrol+xml",metalink:"application/metalink+xml",meta4:"application/metalink4+xml",mets:"application/mets+xml",mods:"application/mods+xml",m21:"application/mp21",mp21:"application/mp21",mp4s:"application/mp4",doc:"application/msword",dot:"application/msword",mxf:"application/mxf",bin:"application/octet-stream",dms:"application/octet-stream",lrf:"application/octet-stream",mar:"application/octet-stream",so:"application/octet-stream",dist:"application/octet-stream",distz:"application/octet-stream",pkg:"application/octet-stream",bpk:"application/octet-stream",dump:"application/octet-stream",elc:"application/octet-stream",deploy:"application/octet-stream",oda:"application/oda",opf:"application/oebps-package+xml",ogx:"application/ogg",omdoc:"application/omdoc+xml",onetoc:"application/onenote",onetoc2:"application/onenote",onetmp:"application/onenote",onepkg:"application/onenote",oxps:"application/oxps",xer:"application/patch-ops-error+xml",pdf:"application/pdf",pgp:"application/pgp-encrypted",asc:"application/pgp-signature",sig:"application/pgp-signature",prf:"application/pics-rules",p10:"application/pkcs10",p7m:"application/pkcs7-mime",p7c:"application/pkcs7-mime",p7s:"application/pkcs7-signature",p8:"application/pkcs8",ac:"application/pkix-attr-cert",cer:"application/pkix-cert",crl:"application/pkix-crl",pkipath:"application/pkix-pkipath",pki:"application/pkixcmp",pls:"application/pls+xml",ai:"application/postscript",eps:"application/postscript",ps:"application/postscript",cww:"application/prs.cww",pskcxml:"application/pskc+xml",rdf:"application/rdf+xml",rif:"application/reginfo+xml",rnc:"application/relax-ng-compact-syntax",rl:"application/resource-lists+xml",rld:"application/resource-lists-diff+xml",rs:"application/rls-services+xml",gbr:"application/rpki-ghostbusters",mft:"application/rpki-manifest",roa:"application/rpki-roa",rsd:"application/rsd+xml",rss:"application/rss+xml",rtf:"application/rtf",sbml:"application/sbml+xml",scq:"application/scvp-cv-request",scs:"application/scvp-cv-response",spq:"application/scvp-vp-request",spp:"application/scvp-vp-response",sdp:"application/sdp",setpay:"application/set-payment-initiation",setreg:"application/set-registration-initiation",shf:"application/shf+xml",smi:"application/smil+xml",smil:"application/smil+xml",rq:"application/sparql-query",srx:"application/sparql-results+xml",gram:"application/srgs",grxml:"application/srgs+xml",sru:"application/sru+xml",ssdl:"application/ssdl+xml",ssml:"application/ssml+xml",tei:"application/tei+xml",teicorpus:"application/tei+xml",tfi:"application/thraud+xml",tsd:"application/timestamped-data",plb:"application/vnd.3gpp.pic-bw-large",psb:"application/vnd.3gpp.pic-bw-small",pvb:"application/vnd.3gpp.pic-bw-var",tcap:"application/vnd.3gpp2.tcap",pwn:"application/vnd.3m.post-it-notes",aso:"application/vnd.accpac.simply.aso",imp:"application/vnd.accpac.simply.imp",acu:"application/vnd.acucobol",atc:"application/vnd.acucorp",acutc:"application/vnd.acucorp",air:"application/vnd.adobe.air-application-installer-package+zip",fcdt:"application/vnd.adobe.formscentral.fcdt",fxp:"application/vnd.adobe.fxp",fxpl:"application/vnd.adobe.fxp",xdp:"application/vnd.adobe.xdp+xml",xfdf:"application/vnd.adobe.xfdf",ahead:"application/vnd.ahead.space",azf:"application/vnd.airzip.filesecure.azf",azs:"application/vnd.airzip.filesecure.azs",azw:"application/vnd.amazon.ebook",acc:"application/vnd.americandynamics.acc",ami:"application/vnd.amiga.ami",apk:"application/vnd.android.package-archive",cii:"application/vnd.anser-web-certificate-issue-initiation",fti:"application/vnd.anser-web-funds-transfer-initiation",atx:"application/vnd.antix.game-component",mpkg:"application/vnd.apple.installer+xml",m3u8:"application/vnd.apple.mpegurl",swi:"application/vnd.aristanetworks.swi",iota:"application/vnd.astraea-software.iota",aep:"application/vnd.audiograph",mpm:"application/vnd.blueice.multipass",bmi:"application/vnd.bmi",rep:"application/vnd.businessobjects",cdxml:"application/vnd.chemdraw+xml",mmd:"application/vnd.chipnuts.karaoke-mmd",cdy:"application/vnd.cinderella",cla:"application/vnd.claymore",rp9:"application/vnd.cloanto.rp9",c4g:"application/vnd.clonk.c4group",c4d:"application/vnd.clonk.c4group",c4f:"application/vnd.clonk.c4group",c4p:"application/vnd.clonk.c4group",c4u:"application/vnd.clonk.c4group",c11amc:"application/vnd.cluetrust.cartomobile-config",c11amz:"application/vnd.cluetrust.cartomobile-config-pkg",csp:"application/vnd.commonspace",cdbcmsg:"application/vnd.contact.cmsg",cmc:"application/vnd.cosmocaller",clkx:"application/vnd.crick.clicker",clkk:"application/vnd.crick.clicker.keyboard",clkp:"application/vnd.crick.clicker.palette",clkt:"application/vnd.crick.clicker.template",clkw:"application/vnd.crick.clicker.wordbank",wbs:"application/vnd.criticaltools.wbs+xml",pml:"application/vnd.ctc-posml",ppd:"application/vnd.cups-ppd",car:"application/vnd.curl.car",pcurl:"application/vnd.curl.pcurl",dart:"application/vnd.dart",rdz:"application/vnd.data-vision.rdz",uvf:"application/vnd.dece.data",uvvf:"application/vnd.dece.data",uvd:"application/vnd.dece.data",uvvd:"application/vnd.dece.data",uvt:"application/vnd.dece.ttml+xml",uvvt:"application/vnd.dece.ttml+xml",uvx:"application/vnd.dece.unspecified",uvvx:"application/vnd.dece.unspecified",uvz:"application/vnd.dece.zip",uvvz:"application/vnd.dece.zip",fe_launch:"application/vnd.denovo.fcselayout-link",dna:"application/vnd.dna",mlp:"application/vnd.dolby.mlp",dpg:"application/vnd.dpgraph",dfac:"application/vnd.dreamfactory",kpxx:"application/vnd.ds-keypoint",ait:"application/vnd.dvb.ait",svc:"application/vnd.dvb.service",geo:"application/vnd.dynageo",mag:"application/vnd.ecowin.chart",nml:"application/vnd.enliven",esf:"application/vnd.epson.esf",msf:"application/vnd.epson.msf",qam:"application/vnd.epson.quickanime",slt:"application/vnd.epson.salt",ssf:"application/vnd.epson.ssf",es3:"application/vnd.eszigno3+xml",et3:"application/vnd.eszigno3+xml",ez2:"application/vnd.ezpix-album",ez3:"application/vnd.ezpix-package",fdf:"application/vnd.fdf",mseed:"application/vnd.fdsn.mseed",seed:"application/vnd.fdsn.seed",dataless:"application/vnd.fdsn.seed",gph:"application/vnd.flographit",ftc:"application/vnd.fluxtime.clip",fm:"application/vnd.framemaker",frame:"application/vnd.framemaker",maker:"application/vnd.framemaker",book:"application/vnd.framemaker",fnc:"application/vnd.frogans.fnc",ltf:"application/vnd.frogans.ltf",fsc:"application/vnd.fsc.weblaunch",oas:"application/vnd.fujitsu.oasys",oa2:"application/vnd.fujitsu.oasys2",oa3:"application/vnd.fujitsu.oasys3",fg5:"application/vnd.fujitsu.oasysgp",bh2:"application/vnd.fujitsu.oasysprs",ddd:"application/vnd.fujixerox.ddd",xdw:"application/vnd.fujixerox.docuworks",xbd:"application/vnd.fujixerox.docuworks.binder",fzs:"application/vnd.fuzzysheet",txd:"application/vnd.genomatix.tuxedo",ggb:"application/vnd.geogebra.file",ggt:"application/vnd.geogebra.tool",gex:"application/vnd.geometry-explorer",gre:"application/vnd.geometry-explorer",gxt:"application/vnd.geonext",g2w:"application/vnd.geoplan",g3w:"application/vnd.geospace",gmx:"application/vnd.gmx",kml:"application/vnd.google-earth.kml+xml",kmz:"application/vnd.google-earth.kmz",gqf:"application/vnd.grafeq",gqs:"application/vnd.grafeq",gac:"application/vnd.groove-account",ghf:"application/vnd.groove-help",gim:"application/vnd.groove-identity-message",grv:"application/vnd.groove-injector",gtm:"application/vnd.groove-tool-message",tpl:"application/vnd.groove-tool-template",vcg:"application/vnd.groove-vcard",hal:"application/vnd.hal+xml",zmm:"application/vnd.handheld-entertainment+xml",hbci:"application/vnd.hbci",les:"application/vnd.hhe.lesson-player",hpgl:"application/vnd.hp-hpgl",hpid:"application/vnd.hp-hpid",hps:"application/vnd.hp-hps",jlt:"application/vnd.hp-jlyt",pcl:"application/vnd.hp-pcl",pclxl:"application/vnd.hp-pclxl","sfd-hdstx":"application/vnd.hydrostatix.sof-data",mpy:"application/vnd.ibm.minipay",afp:"application/vnd.ibm.modcap",listafp:"application/vnd.ibm.modcap",list3820:"application/vnd.ibm.modcap",irm:"application/vnd.ibm.rights-management",sc:"application/vnd.ibm.secure-container",icc:"application/vnd.iccprofile",icm:"application/vnd.iccprofile",igl:"application/vnd.igloader",ivp:"application/vnd.immervision-ivp",ivu:"application/vnd.immervision-ivu",igm:"application/vnd.insors.igm",xpw:"application/vnd.intercon.formnet",xpx:"application/vnd.intercon.formnet",i2g:"application/vnd.intergeo",qbo:"application/vnd.intu.qbo",qfx:"application/vnd.intu.qfx",rcprofile:"application/vnd.ipunplugged.rcprofile",irp:"application/vnd.irepository.package+xml",xpr:"application/vnd.is-xpr",fcs:"application/vnd.isac.fcs",jam:"application/vnd.jam",rms:"application/vnd.jcp.javame.midlet-rms",jisp:"application/vnd.jisp",joda:"application/vnd.joost.joda-archive",ktz:"application/vnd.kahootz",ktr:"application/vnd.kahootz",karbon:"application/vnd.kde.karbon",chrt:"application/vnd.kde.kchart",kfo:"application/vnd.kde.kformula",flw:"application/vnd.kde.kivio",kon:"application/vnd.kde.kontour",kpr:"application/vnd.kde.kpresenter",kpt:"application/vnd.kde.kpresenter",ksp:"application/vnd.kde.kspread",kwd:"application/vnd.kde.kword",kwt:"application/vnd.kde.kword",htke:"application/vnd.kenameaapp",kia:"application/vnd.kidspiration",kne:"application/vnd.kinar",knp:"application/vnd.kinar",skp:"application/vnd.koan",skd:"application/vnd.koan",skt:"application/vnd.koan",skm:"application/vnd.koan",sse:"application/vnd.kodak-descriptor",lasxml:"application/vnd.las.las+xml",lbd:"application/vnd.llamagraphics.life-balance.desktop",lbe:"application/vnd.llamagraphics.life-balance.exchange+xml",apr:"application/vnd.lotus-approach",pre:"application/vnd.lotus-freelance",nsf:"application/vnd.lotus-notes",org:"application/vnd.lotus-organizer",scm:"application/vnd.lotus-screencam",lwp:"application/vnd.lotus-wordpro",portpkg:"application/vnd.macports.portpkg",mcd:"application/vnd.mcd",mc1:"application/vnd.medcalcdata",cdkey:"application/vnd.mediastation.cdkey",mwf:"application/vnd.mfer",mfm:"application/vnd.mfmp",flo:"application/vnd.micrografx.flo",igx:"application/vnd.micrografx.igx",mif:"application/vnd.mif",daf:"application/vnd.mobius.daf",dis:"application/vnd.mobius.dis",mbk:"application/vnd.mobius.mbk",mqy:"application/vnd.mobius.mqy",msl:"application/vnd.mobius.msl",plc:"application/vnd.mobius.plc",txf:"application/vnd.mobius.txf",mpn:"application/vnd.mophun.application",mpc:"application/vnd.mophun.certificate",xul:"application/vnd.mozilla.xul+xml",cil:"application/vnd.ms-artgalry",cab:"application/vnd.ms-cab-compressed",xls:"application/vnd.ms-excel",xlm:"application/vnd.ms-excel",xla:"application/vnd.ms-excel",xlc:"application/vnd.ms-excel",xlt:"application/vnd.ms-excel",xlw:"application/vnd.ms-excel",xlam:"application/vnd.ms-excel.addin.macroenabled.12",xlsb:"application/vnd.ms-excel.sheet.binary.macroenabled.12",xlsm:"application/vnd.ms-excel.sheet.macroenabled.12",xltm:"application/vnd.ms-excel.template.macroenabled.12",eot:"application/vnd.ms-fontobject",chm:"application/vnd.ms-htmlhelp",ims:"application/vnd.ms-ims",lrm:"application/vnd.ms-lrm",thmx:"application/vnd.ms-officetheme",cat:"application/vnd.ms-pki.seccat",stl:"application/vnd.ms-pki.stl",ppt:"application/vnd.ms-powerpoint",pps:"application/vnd.ms-powerpoint",pot:"application/vnd.ms-powerpoint",ppam:"application/vnd.ms-powerpoint.addin.macroenabled.12",pptm:"application/vnd.ms-powerpoint.presentation.macroenabled.12",sldm:"application/vnd.ms-powerpoint.slide.macroenabled.12",ppsm:"application/vnd.ms-powerpoint.slideshow.macroenabled.12",potm:"application/vnd.ms-powerpoint.template.macroenabled.12",mpp:"application/vnd.ms-project",mpt:"application/vnd.ms-project",docm:"application/vnd.ms-word.document.macroenabled.12",dotm:"application/vnd.ms-word.template.macroenabled.12",wps:"application/vnd.ms-works",wks:"application/vnd.ms-works",wcm:"application/vnd.ms-works",wdb:"application/vnd.ms-works",wpl:"application/vnd.ms-wpl",xps:"application/vnd.ms-xpsdocument",mseq:"application/vnd.mseq",mus:"application/vnd.musician",msty:"application/vnd.muvee.style",taglet:"application/vnd.mynfc",nlu:"application/vnd.neurolanguage.nlu",ntf:"application/vnd.nitf",nitf:"application/vnd.nitf",nnd:"application/vnd.noblenet-directory",nns:"application/vnd.noblenet-sealer",nnw:"application/vnd.noblenet-web",ngdat:"application/vnd.nokia.n-gage.data","n-gage":"application/vnd.nokia.n-gage.symbian.install",rpst:"application/vnd.nokia.radio-preset",rpss:"application/vnd.nokia.radio-presets",edm:"application/vnd.novadigm.edm",edx:"application/vnd.novadigm.edx",ext:"application/vnd.novadigm.ext",odc:"application/vnd.oasis.opendocument.chart",otc:"application/vnd.oasis.opendocument.chart-template",odb:"application/vnd.oasis.opendocument.database",odf:"application/vnd.oasis.opendocument.formula",odft:"application/vnd.oasis.opendocument.formula-template",odg:"application/vnd.oasis.opendocument.graphics",otg:"application/vnd.oasis.opendocument.graphics-template",odi:"application/vnd.oasis.opendocument.image",oti:"application/vnd.oasis.opendocument.image-template",odp:"application/vnd.oasis.opendocument.presentation",otp:"application/vnd.oasis.opendocument.presentation-template",ods:"application/vnd.oasis.opendocument.spreadsheet",ots:"application/vnd.oasis.opendocument.spreadsheet-template",odt:"application/vnd.oasis.opendocument.text",odm:"application/vnd.oasis.opendocument.text-master",ott:"application/vnd.oasis.opendocument.text-template",oth:"application/vnd.oasis.opendocument.text-web",xo:"application/vnd.olpc-sugar",dd2:"application/vnd.oma.dd2+xml",oxt:"application/vnd.openofficeorg.extension",pptx:"application/vnd.openxmlformats-officedocument.presentationml.presentation",sldx:"application/vnd.openxmlformats-officedocument.presentationml.slide",ppsx:"application/vnd.openxmlformats-officedocument.presentationml.slideshow",potx:"application/vnd.openxmlformats-officedocument.presentationml.template",xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template",docx:"application/vnd.openxmlformats-officedocument.wordprocessingml.document",dotx:"application/vnd.openxmlformats-officedocument.wordprocessingml.template",mgp:"application/vnd.osgeo.mapguide.package",dp:"application/vnd.osgi.dp",esa:"application/vnd.osgi.subsystem",pdb:"application/vnd.palm",pqa:"application/vnd.palm",oprc:"application/vnd.palm",paw:"application/vnd.pawaafile",str:"application/vnd.pg.format",ei6:"application/vnd.pg.osasli",efif:"application/vnd.picsel",wg:"application/vnd.pmi.widget",plf:"application/vnd.pocketlearn",pbd:"application/vnd.powerbuilder6",box:"application/vnd.previewsystems.box",mgz:"application/vnd.proteus.magazine",qps:"application/vnd.publishare-delta-tree",ptid:"application/vnd.pvi.ptid1",qxd:"application/vnd.quark.quarkxpress",qxt:"application/vnd.quark.quarkxpress",qwd:"application/vnd.quark.quarkxpress",qwt:"application/vnd.quark.quarkxpress",qxl:"application/vnd.quark.quarkxpress",qxb:"application/vnd.quark.quarkxpress",bed:"application/vnd.realvnc.bed",mxl:"application/vnd.recordare.musicxml",musicxml:"application/vnd.recordare.musicxml+xml",cryptonote:"application/vnd.rig.cryptonote",cod:"application/vnd.rim.cod",rm:"application/vnd.rn-realmedia",rmvb:"application/vnd.rn-realmedia-vbr",link66:"application/vnd.route66.link66+xml",st:"application/vnd.sailingtracker.track",see:"application/vnd.seemail",sema:"application/vnd.sema",semd:"application/vnd.semd",semf:"application/vnd.semf",ifm:"application/vnd.shana.informed.formdata",itp:"application/vnd.shana.informed.formtemplate",iif:"application/vnd.shana.informed.interchange",ipk:"application/vnd.shana.informed.package",twd:"application/vnd.simtech-mindmapper",twds:"application/vnd.simtech-mindmapper",mmf:"application/vnd.smaf",teacher:"application/vnd.smart.teacher",sdkm:"application/vnd.solent.sdkm+xml",sdkd:"application/vnd.solent.sdkm+xml",dxp:"application/vnd.spotfire.dxp",sfs:"application/vnd.spotfire.sfs",sdc:"application/vnd.stardivision.calc",sda:"application/vnd.stardivision.draw",sdd:"application/vnd.stardivision.impress",smf:"application/vnd.stardivision.math",sdw:"application/vnd.stardivision.writer",vor:"application/vnd.stardivision.writer",sgl:"application/vnd.stardivision.writer-global",smzip:"application/vnd.stepmania.package",sm:"application/vnd.stepmania.stepchart",sxc:"application/vnd.sun.xml.calc",stc:"application/vnd.sun.xml.calc.template",sxd:"application/vnd.sun.xml.draw",std:"application/vnd.sun.xml.draw.template",sxi:"application/vnd.sun.xml.impress",sti:"application/vnd.sun.xml.impress.template",sxm:"application/vnd.sun.xml.math",sxw:"application/vnd.sun.xml.writer",sxg:"application/vnd.sun.xml.writer.global",stw:"application/vnd.sun.xml.writer.template",sus:"application/vnd.sus-calendar",susp:"application/vnd.sus-calendar",svd:"application/vnd.svd",sis:"application/vnd.symbian.install",sisx:"application/vnd.symbian.install",xsm:"application/vnd.syncml+xml",bdm:"application/vnd.syncml.dm+wbxml",xdm:"application/vnd.syncml.dm+xml",tao:"application/vnd.tao.intent-module-archive",pcap:"application/vnd.tcpdump.pcap",cap:"application/vnd.tcpdump.pcap",dmp:"application/vnd.tcpdump.pcap",tmo:"application/vnd.tmobile-livetv",tpt:"application/vnd.trid.tpt",mxs:"application/vnd.triscape.mxs",tra:"application/vnd.trueapp",ufd:"application/vnd.ufdl",ufdl:"application/vnd.ufdl",utz:"application/vnd.uiq.theme",umj:"application/vnd.umajin",unityweb:"application/vnd.unity",uoml:"application/vnd.uoml+xml",vcx:"application/vnd.vcx",vsd:"application/vnd.visio",vst:"application/vnd.visio",vss:"application/vnd.visio",vsw:"application/vnd.visio",vis:"application/vnd.visionary",vsf:"application/vnd.vsf",wbxml:"application/vnd.wap.wbxml",wmlc:"application/vnd.wap.wmlc",wmlsc:"application/vnd.wap.wmlscriptc",wtb:"application/vnd.webturbo",nbp:"application/vnd.wolfram.player",wpd:"application/vnd.wordperfect",wqd:"application/vnd.wqd",stf:"application/vnd.wt.stf",xar:"application/vnd.xara",xfdl:"application/vnd.xfdl",hvd:"application/vnd.yamaha.hv-dic",hvs:"application/vnd.yamaha.hv-script",hvp:"application/vnd.yamaha.hv-voice",osf:"application/vnd.yamaha.openscoreformat",osfpvg:"application/vnd.yamaha.openscoreformat.osfpvg+xml",saf:"application/vnd.yamaha.smaf-audio",spf:"application/vnd.yamaha.smaf-phrase",cmp:"application/vnd.yellowriver-custom-menu",zir:"application/vnd.zul",zirz:"application/vnd.zul",zaz:"application/vnd.zzazz.deck+xml",vxml:"application/voicexml+xml",wgt:"application/widget",hlp:"application/winhlp",wsdl:"application/wsdl+xml",wspolicy:"application/wspolicy+xml","7z":"application/x-7z-compressed",abw:"application/x-abiword",ace:"application/x-ace-compressed",dmg:"application/x-apple-diskimage",aab:"application/x-authorware-bin",x32:"application/x-authorware-bin",u32:"application/x-authorware-bin",vox:"application/x-authorware-bin",aam:"application/x-authorware-map",aas:"application/x-authorware-seg",bcpio:"application/x-bcpio",torrent:"application/x-bittorrent",blb:"application/x-blorb",blorb:"application/x-blorb",bz:"application/x-bzip",bz2:"application/x-bzip2",boz:"application/x-bzip2",cbr:"application/x-cbr",cba:"application/x-cbr",cbt:"application/x-cbr",cbz:"application/x-cbr",cb7:"application/x-cbr",vcd:"application/x-cdlink",cfs:"application/x-cfs-compressed",chat:"application/x-chat",pgn:"application/x-chess-pgn",nsc:"application/x-conference",cpio:"application/x-cpio",csh:"application/x-csh",deb:"application/x-debian-package",udeb:"application/x-debian-package",dgc:"application/x-dgc-compressed",dir:"application/x-director",dcr:"application/x-director",dxr:"application/x-director",cst:"application/x-director",cct:"application/x-director",cxt:"application/x-director",w3d:"application/x-director",fgd:"application/x-director",swa:"application/x-director",wad:"application/x-doom",ncx:"application/x-dtbncx+xml",dtb:"application/x-dtbook+xml",res:"application/x-dtbresource+xml",dvi:"application/x-dvi",evy:"application/x-envoy",eva:"application/x-eva",bdf:"application/x-font-bdf",gsf:"application/x-font-ghostscript",psf:"application/x-font-linux-psf",otf:"application/x-font-otf",pcf:"application/x-font-pcf",snf:"application/x-font-snf",ttf:"application/x-font-ttf",ttc:"application/x-font-ttf",pfa:"application/x-font-type1",pfb:"application/x-font-type1",pfm:"application/x-font-type1",afm:"application/x-font-type1",woff:"application/x-font-woff",arc:"application/x-freearc",spl:"application/x-futuresplash",gca:"application/x-gca-compressed",ulx:"application/x-glulx",gnumeric:"application/x-gnumeric",gramps:"application/x-gramps-xml",gtar:"application/x-gtar",hdf:"application/x-hdf",install:"application/x-install-instructions",iso:"application/x-iso9660-image",jnlp:"application/x-java-jnlp-file",latex:"application/x-latex",lzh:"application/x-lzh-compressed",lha:"application/x-lzh-compressed",mie:"application/x-mie",prc:"application/x-mobipocket-ebook",mobi:"application/x-mobipocket-ebook",application:"application/x-ms-application",lnk:"application/x-ms-shortcut",wmd:"application/x-ms-wmd",wmz:"application/x-msmetafile",xbap:"application/x-ms-xbap",mdb:"application/x-msaccess",obd:"application/x-msbinder",crd:"application/x-mscardfile",clp:"application/x-msclip",exe:"application/x-msdownload",dll:"application/x-msdownload",com:"application/x-msdownload",bat:"application/x-msdownload",msi:"application/x-msdownload",mvb:"application/x-msmediaview",m13:"application/x-msmediaview",m14:"application/x-msmediaview",wmf:"application/x-msmetafile",emf:"application/x-msmetafile",emz:"application/x-msmetafile",mny:"application/x-msmoney",pub:"application/x-mspublisher",scd:"application/x-msschedule",trm:"application/x-msterminal",wri:"application/x-mswrite",nc:"application/x-netcdf",cdf:"application/x-netcdf",nzb:"application/x-nzb",p12:"application/x-pkcs12",pfx:"application/x-pkcs12",p7b:"application/x-pkcs7-certificates",spc:"application/x-pkcs7-certificates",p7r:"application/x-pkcs7-certreqresp",rar:"application/x-rar-compressed",ris:"application/x-research-info-systems",sh:"application/x-sh",shar:"application/x-shar",swf:"application/x-shockwave-flash",xap:"application/x-silverlight-app",sql:"application/x-sql",sit:"application/x-stuffit",sitx:"application/x-stuffitx",srt:"application/x-subrip",sv4cpio:"application/x-sv4cpio",sv4crc:"application/x-sv4crc",t3:"application/x-t3vm-image",gam:"application/x-tads",tar:"application/x-tar",tcl:"application/x-tcl",tex:"application/x-tex",tfm:"application/x-tex-tfm",texinfo:"application/x-texinfo",texi:"application/x-texinfo",obj:"application/x-tgif",ustar:"application/x-ustar",src:"application/x-wais-source",der:"application/x-x509-ca-cert",crt:"application/x-x509-ca-cert",fig:"application/x-xfig",xlf:"application/x-xliff+xml",xpi:"application/x-xpinstall",xz:"application/x-xz",z1:"application/x-zmachine",z2:"application/x-zmachine",z3:"application/x-zmachine",z4:"application/x-zmachine",z5:"application/x-zmachine",z6:"application/x-zmachine",z7:"application/x-zmachine",z8:"application/x-zmachine",xaml:"application/xaml+xml",xdf:"application/xcap-diff+xml",xenc:"application/xenc+xml",xhtml:"application/xhtml+xml",xht:"application/xhtml+xml",xml:"application/xml",xsl:"application/xml",dtd:"application/xml-dtd",xop:"application/xop+xml",xpl:"application/xproc+xml",xslt:"application/xslt+xml",xspf:"application/xspf+xml",mxml:"application/xv+xml",xhvml:"application/xv+xml",xvml:"application/xv+xml",xvm:"application/xv+xml",yang:"application/yang",yin:"application/yin+xml",zip:"application/zip",adp:"audio/adpcm",au:"audio/basic",snd:"audio/basic",mid:"audio/midi",midi:"audio/midi",kar:"audio/midi",rmi:"audio/midi",mp4a:"audio/mp4",mpga:"audio/mpeg",mp2:"audio/mpeg",mp2a:"audio/mpeg",mp3:"audio/mpeg",m2a:"audio/mpeg",m3a:"audio/mpeg",oga:"audio/ogg",ogg:"audio/ogg",spx:"audio/ogg",s3m:"audio/s3m",sil:"audio/silk",uva:"audio/vnd.dece.audio",uvva:"audio/vnd.dece.audio",eol:"audio/vnd.digital-winds",dra:"audio/vnd.dra",dts:"audio/vnd.dts",dtshd:"audio/vnd.dts.hd",lvp:"audio/vnd.lucent.voice",pya:"audio/vnd.ms-playready.media.pya",ecelp4800:"audio/vnd.nuera.ecelp4800",ecelp7470:"audio/vnd.nuera.ecelp7470",ecelp9600:"audio/vnd.nuera.ecelp9600",rip:"audio/vnd.rip",weba:"audio/webm",aac:"audio/x-aac",aif:"audio/x-aiff",aiff:"audio/x-aiff",aifc:"audio/x-aiff",caf:"audio/x-caf",flac:"audio/x-flac",mka:"audio/x-matroska",m3u:"audio/x-mpegurl",wax:"audio/x-ms-wax",wma:"audio/x-ms-wma",ram:"audio/x-pn-realaudio",ra:"audio/x-pn-realaudio",rmp:"audio/x-pn-realaudio-plugin",wav:"audio/x-wav",xm:"audio/xm",cdx:"chemical/x-cdx",cif:"chemical/x-cif",cmdf:"chemical/x-cmdf",cml:"chemical/x-cml",csml:"chemical/x-csml",xyz:"chemical/x-xyz",bmp:"image/bmp",cgm:"image/cgm",g3:"image/g3fax",gif:"image/gif",ief:"image/ief",jpeg:"image/jpeg",jpg:"image/jpeg",jpe:"image/jpeg",ktx:"image/ktx",png:"image/png",btif:"image/prs.btif",sgi:"image/sgi",svg:"image/svg+xml",svgz:"image/svg+xml",tiff:"image/tiff",tif:"image/tiff",psd:"image/vnd.adobe.photoshop",uvi:"image/vnd.dece.graphic",uvvi:"image/vnd.dece.graphic",uvg:"image/vnd.dece.graphic",uvvg:"image/vnd.dece.graphic",sub:"text/vnd.dvb.subtitle",djvu:"image/vnd.djvu",djv:"image/vnd.djvu",dwg:"image/vnd.dwg",dxf:"image/vnd.dxf",fbs:"image/vnd.fastbidsheet",fpx:"image/vnd.fpx",fst:"image/vnd.fst",mmr:"image/vnd.fujixerox.edmics-mmr",rlc:"image/vnd.fujixerox.edmics-rlc",mdi:"image/vnd.ms-modi",wdp:"image/vnd.ms-photo",npx:"image/vnd.net-fpx",wbmp:"image/vnd.wap.wbmp",xif:"image/vnd.xiff",webp:"image/webp","3ds":"image/x-3ds",ras:"image/x-cmu-raster",cmx:"image/x-cmx",fh:"image/x-freehand",fhc:"image/x-freehand",fh4:"image/x-freehand",fh5:"image/x-freehand",fh7:"image/x-freehand",ico:"image/x-icon",sid:"image/x-mrsid-image",pcx:"image/x-pcx",pic:"image/x-pict",pct:"image/x-pict",pnm:"image/x-portable-anymap",pbm:"image/x-portable-bitmap",pgm:"image/x-portable-graymap",ppm:"image/x-portable-pixmap",rgb:"image/x-rgb",tga:"image/x-tga",xbm:"image/x-xbitmap",xpm:"image/x-xpixmap",xwd:"image/x-xwindowdump",eml:"message/rfc822",mime:"message/rfc822",igs:"model/iges",iges:"model/iges",msh:"model/mesh",mesh:"model/mesh",silo:"model/mesh",dae:"model/vnd.collada+xml",dwf:"model/vnd.dwf",gdl:"model/vnd.gdl",gtw:"model/vnd.gtw",mts:"model/vnd.mts",vtu:"model/vnd.vtu",wrl:"model/vrml",vrml:"model/vrml",x3db:"model/x3d+binary",x3dbz:"model/x3d+binary",x3dv:"model/x3d+vrml",x3dvz:"model/x3d+vrml",x3d:"model/x3d+xml",x3dz:"model/x3d+xml",appcache:"text/cache-manifest",ics:"text/calendar",ifb:"text/calendar",css:"text/css",csv:"text/csv",html:"text/html",htm:"text/html",n3:"text/n3",txt:"text/plain",text:"text/plain",conf:"text/plain",def:"text/plain",list:"text/plain",log:"text/plain","in":"text/plain",dsc:"text/prs.lines.tag",rtx:"text/richtext",sgml:"text/sgml",sgm:"text/sgml",tsv:"text/tab-separated-values",t:"text/troff",tr:"text/troff",roff:"text/troff",man:"text/troff",me:"text/troff",ms:"text/troff",ttl:"text/turtle",uri:"text/uri-list",uris:"text/uri-list",urls:"text/uri-list",vcard:"text/vcard",curl:"text/vnd.curl",dcurl:"text/vnd.curl.dcurl",scurl:"text/vnd.curl.scurl",mcurl:"text/vnd.curl.mcurl",fly:"text/vnd.fly",flx:"text/vnd.fmi.flexstor",gv:"text/vnd.graphviz","3dml":"text/vnd.in3d.3dml",spot:"text/vnd.in3d.spot",jad:"text/vnd.sun.j2me.app-descriptor",wml:"text/vnd.wap.wml",wmls:"text/vnd.wap.wmlscript",s:"text/x-asm",asm:"text/x-asm",c:"text/x-c",cc:"text/x-c",cxx:"text/x-c",cpp:"text/x-c",h:"text/x-c",hh:"text/x-c",dic:"text/x-c",f:"text/x-fortran","for":"text/x-fortran",f77:"text/x-fortran",f90:"text/x-fortran",java:"text/x-java-source",opml:"text/x-opml",p:"text/x-pascal",pas:"text/x-pascal",nfo:"text/x-nfo",etx:"text/x-setext",sfv:"text/x-sfv",uu:"text/x-uuencode",vcs:"text/x-vcalendar",vcf:"text/x-vcard","3gp":"video/3gpp","3g2":"video/3gpp2",h261:"video/h261",h263:"video/h263",h264:"video/h264",jpgv:"video/jpeg",jpm:"video/jpm",jpgm:"video/jpm",mj2:"video/mj2",mjp2:"video/mj2",mp4:"video/mp4",mp4v:"video/mp4",mpg4:"video/mp4",mpeg:"video/mpeg",mpg:"video/mpeg",mpe:"video/mpeg",m1v:"video/mpeg",m2v:"video/mpeg",ogv:"video/ogg",qt:"video/quicktime",mov:"video/quicktime",uvh:"video/vnd.dece.hd",uvvh:"video/vnd.dece.hd",uvm:"video/vnd.dece.mobile",uvvm:"video/vnd.dece.mobile",uvp:"video/vnd.dece.pd",uvvp:"video/vnd.dece.pd",uvs:"video/vnd.dece.sd",uvvs:"video/vnd.dece.sd",uvv:"video/vnd.dece.video",uvvv:"video/vnd.dece.video",dvb:"video/vnd.dvb.file",fvt:"video/vnd.fvt",mxu:"video/vnd.mpegurl",m4u:"video/vnd.mpegurl",pyv:"video/vnd.ms-playready.media.pyv",uvu:"video/vnd.uvvu.mp4",uvvu:"video/vnd.uvvu.mp4",viv:"video/vnd.vivo",webm:"video/webm",f4v:"video/x-f4v",fli:"video/x-fli",flv:"video/x-flv",m4v:"video/x-m4v",mkv:"video/x-matroska",mk3d:"video/x-matroska",mks:"video/x-matroska",mng:"video/x-mng",asf:"video/x-ms-asf",asx:"video/x-ms-asf",vob:"video/x-ms-vob",wm:"video/x-ms-wm",wmv:"video/x-ms-wmv",wmx:"video/x-ms-wmx",wvx:"video/x-ms-wvx",avi:"video/x-msvideo",movie:"video/x-sgi-movie",smv:"video/x-smv",ice:"x-conference/x-cooltalk",vtt:"text/vtt",crx:"application/x-chrome-extension",htc:"text/x-component",manifest:"text/cache-manifest",buffer:"application/octet-stream",m4p:"application/mp4",m4a:"audio/mp4",ts:"video/MP2T","event-stream":"text/event-stream",webapp:"application/x-web-app-manifest+json",lua:"text/x-lua",luac:"application/x-lua-bytecode",markdown:"text/x-markdown",md:"text/x-markdown",mkd:"text/x-markdown"},extensions:{"application/andrew-inset":"ez","application/applixware":"aw","application/atom+xml":"atom","application/atomcat+xml":"atomcat","application/atomsvc+xml":"atomsvc","application/ccxml+xml":"ccxml","application/cdmi-capability":"cdmia","application/cdmi-container":"cdmic","application/cdmi-domain":"cdmid","application/cdmi-object":"cdmio","application/cdmi-queue":"cdmiq","application/cu-seeme":"cu","application/davmount+xml":"davmount","application/docbook+xml":"dbk","application/dssc+der":"dssc","application/dssc+xml":"xdssc","application/ecmascript":"ecma","application/emma+xml":"emma","application/epub+zip":"epub","application/exi":"exi","application/font-tdpfr":"pfr","application/gml+xml":"gml","application/gpx+xml":"gpx","application/gxf":"gxf","application/hyperstudio":"stk","application/inkml+xml":"ink","application/ipfix":"ipfix","application/java-archive":"jar","application/java-serialized-object":"ser","application/java-vm":"class","application/javascript":"js","application/json":"json","application/jsonml+json":"jsonml","application/lost+xml":"lostxml","application/mac-binhex40":"hqx","application/mac-compactpro":"cpt","application/mads+xml":"mads","application/marc":"mrc","application/marcxml+xml":"mrcx","application/mathematica":"ma","application/mathml+xml":"mathml","application/mbox":"mbox","application/mediaservercontrol+xml":"mscml","application/metalink+xml":"metalink","application/metalink4+xml":"meta4","application/mets+xml":"mets","application/mods+xml":"mods","application/mp21":"m21","application/mp4":"mp4s","application/msword":"doc","application/mxf":"mxf","application/octet-stream":"bin","application/oda":"oda","application/oebps-package+xml":"opf","application/ogg":"ogx","application/omdoc+xml":"omdoc","application/onenote":"onetoc","application/oxps":"oxps","application/patch-ops-error+xml":"xer","application/pdf":"pdf","application/pgp-encrypted":"pgp","application/pgp-signature":"asc","application/pics-rules":"prf",
"application/pkcs10":"p10","application/pkcs7-mime":"p7m","application/pkcs7-signature":"p7s","application/pkcs8":"p8","application/pkix-attr-cert":"ac","application/pkix-cert":"cer","application/pkix-crl":"crl","application/pkix-pkipath":"pkipath","application/pkixcmp":"pki","application/pls+xml":"pls","application/postscript":"ai","application/prs.cww":"cww","application/pskc+xml":"pskcxml","application/rdf+xml":"rdf","application/reginfo+xml":"rif","application/relax-ng-compact-syntax":"rnc","application/resource-lists+xml":"rl","application/resource-lists-diff+xml":"rld","application/rls-services+xml":"rs","application/rpki-ghostbusters":"gbr","application/rpki-manifest":"mft","application/rpki-roa":"roa","application/rsd+xml":"rsd","application/rss+xml":"rss","application/rtf":"rtf","application/sbml+xml":"sbml","application/scvp-cv-request":"scq","application/scvp-cv-response":"scs","application/scvp-vp-request":"spq","application/scvp-vp-response":"spp","application/sdp":"sdp","application/set-payment-initiation":"setpay","application/set-registration-initiation":"setreg","application/shf+xml":"shf","application/smil+xml":"smi","application/sparql-query":"rq","application/sparql-results+xml":"srx","application/srgs":"gram","application/srgs+xml":"grxml","application/sru+xml":"sru","application/ssdl+xml":"ssdl","application/ssml+xml":"ssml","application/tei+xml":"tei","application/thraud+xml":"tfi","application/timestamped-data":"tsd","application/vnd.3gpp.pic-bw-large":"plb","application/vnd.3gpp.pic-bw-small":"psb","application/vnd.3gpp.pic-bw-var":"pvb","application/vnd.3gpp2.tcap":"tcap","application/vnd.3m.post-it-notes":"pwn","application/vnd.accpac.simply.aso":"aso","application/vnd.accpac.simply.imp":"imp","application/vnd.acucobol":"acu","application/vnd.acucorp":"atc","application/vnd.adobe.air-application-installer-package+zip":"air","application/vnd.adobe.formscentral.fcdt":"fcdt","application/vnd.adobe.fxp":"fxp","application/vnd.adobe.xdp+xml":"xdp","application/vnd.adobe.xfdf":"xfdf","application/vnd.ahead.space":"ahead","application/vnd.airzip.filesecure.azf":"azf","application/vnd.airzip.filesecure.azs":"azs","application/vnd.amazon.ebook":"azw","application/vnd.americandynamics.acc":"acc","application/vnd.amiga.ami":"ami","application/vnd.android.package-archive":"apk","application/vnd.anser-web-certificate-issue-initiation":"cii","application/vnd.anser-web-funds-transfer-initiation":"fti","application/vnd.antix.game-component":"atx","application/vnd.apple.installer+xml":"mpkg","application/vnd.apple.mpegurl":"m3u8","application/vnd.aristanetworks.swi":"swi","application/vnd.astraea-software.iota":"iota","application/vnd.audiograph":"aep","application/vnd.blueice.multipass":"mpm","application/vnd.bmi":"bmi","application/vnd.businessobjects":"rep","application/vnd.chemdraw+xml":"cdxml","application/vnd.chipnuts.karaoke-mmd":"mmd","application/vnd.cinderella":"cdy","application/vnd.claymore":"cla","application/vnd.cloanto.rp9":"rp9","application/vnd.clonk.c4group":"c4g","application/vnd.cluetrust.cartomobile-config":"c11amc","application/vnd.cluetrust.cartomobile-config-pkg":"c11amz","application/vnd.commonspace":"csp","application/vnd.contact.cmsg":"cdbcmsg","application/vnd.cosmocaller":"cmc","application/vnd.crick.clicker":"clkx","application/vnd.crick.clicker.keyboard":"clkk","application/vnd.crick.clicker.palette":"clkp","application/vnd.crick.clicker.template":"clkt","application/vnd.crick.clicker.wordbank":"clkw","application/vnd.criticaltools.wbs+xml":"wbs","application/vnd.ctc-posml":"pml","application/vnd.cups-ppd":"ppd","application/vnd.curl.car":"car","application/vnd.curl.pcurl":"pcurl","application/vnd.dart":"dart","application/vnd.data-vision.rdz":"rdz","application/vnd.dece.data":"uvf","application/vnd.dece.ttml+xml":"uvt","application/vnd.dece.unspecified":"uvx","application/vnd.dece.zip":"uvz","application/vnd.denovo.fcselayout-link":"fe_launch","application/vnd.dna":"dna","application/vnd.dolby.mlp":"mlp","application/vnd.dpgraph":"dpg","application/vnd.dreamfactory":"dfac","application/vnd.ds-keypoint":"kpxx","application/vnd.dvb.ait":"ait","application/vnd.dvb.service":"svc","application/vnd.dynageo":"geo","application/vnd.ecowin.chart":"mag","application/vnd.enliven":"nml","application/vnd.epson.esf":"esf","application/vnd.epson.msf":"msf","application/vnd.epson.quickanime":"qam","application/vnd.epson.salt":"slt","application/vnd.epson.ssf":"ssf","application/vnd.eszigno3+xml":"es3","application/vnd.ezpix-album":"ez2","application/vnd.ezpix-package":"ez3","application/vnd.fdf":"fdf","application/vnd.fdsn.mseed":"mseed","application/vnd.fdsn.seed":"seed","application/vnd.flographit":"gph","application/vnd.fluxtime.clip":"ftc","application/vnd.framemaker":"fm","application/vnd.frogans.fnc":"fnc","application/vnd.frogans.ltf":"ltf","application/vnd.fsc.weblaunch":"fsc","application/vnd.fujitsu.oasys":"oas","application/vnd.fujitsu.oasys2":"oa2","application/vnd.fujitsu.oasys3":"oa3","application/vnd.fujitsu.oasysgp":"fg5","application/vnd.fujitsu.oasysprs":"bh2","application/vnd.fujixerox.ddd":"ddd","application/vnd.fujixerox.docuworks":"xdw","application/vnd.fujixerox.docuworks.binder":"xbd","application/vnd.fuzzysheet":"fzs","application/vnd.genomatix.tuxedo":"txd","application/vnd.geogebra.file":"ggb","application/vnd.geogebra.tool":"ggt","application/vnd.geometry-explorer":"gex","application/vnd.geonext":"gxt","application/vnd.geoplan":"g2w","application/vnd.geospace":"g3w","application/vnd.gmx":"gmx","application/vnd.google-earth.kml+xml":"kml","application/vnd.google-earth.kmz":"kmz","application/vnd.grafeq":"gqf","application/vnd.groove-account":"gac","application/vnd.groove-help":"ghf","application/vnd.groove-identity-message":"gim","application/vnd.groove-injector":"grv","application/vnd.groove-tool-message":"gtm","application/vnd.groove-tool-template":"tpl","application/vnd.groove-vcard":"vcg","application/vnd.hal+xml":"hal","application/vnd.handheld-entertainment+xml":"zmm","application/vnd.hbci":"hbci","application/vnd.hhe.lesson-player":"les","application/vnd.hp-hpgl":"hpgl","application/vnd.hp-hpid":"hpid","application/vnd.hp-hps":"hps","application/vnd.hp-jlyt":"jlt","application/vnd.hp-pcl":"pcl","application/vnd.hp-pclxl":"pclxl","application/vnd.hydrostatix.sof-data":"sfd-hdstx","application/vnd.ibm.minipay":"mpy","application/vnd.ibm.modcap":"afp","application/vnd.ibm.rights-management":"irm","application/vnd.ibm.secure-container":"sc","application/vnd.iccprofile":"icc","application/vnd.igloader":"igl","application/vnd.immervision-ivp":"ivp","application/vnd.immervision-ivu":"ivu","application/vnd.insors.igm":"igm","application/vnd.intercon.formnet":"xpw","application/vnd.intergeo":"i2g","application/vnd.intu.qbo":"qbo","application/vnd.intu.qfx":"qfx","application/vnd.ipunplugged.rcprofile":"rcprofile","application/vnd.irepository.package+xml":"irp","application/vnd.is-xpr":"xpr","application/vnd.isac.fcs":"fcs","application/vnd.jam":"jam","application/vnd.jcp.javame.midlet-rms":"rms","application/vnd.jisp":"jisp","application/vnd.joost.joda-archive":"joda","application/vnd.kahootz":"ktz","application/vnd.kde.karbon":"karbon","application/vnd.kde.kchart":"chrt","application/vnd.kde.kformula":"kfo","application/vnd.kde.kivio":"flw","application/vnd.kde.kontour":"kon","application/vnd.kde.kpresenter":"kpr","application/vnd.kde.kspread":"ksp","application/vnd.kde.kword":"kwd","application/vnd.kenameaapp":"htke","application/vnd.kidspiration":"kia","application/vnd.kinar":"kne","application/vnd.koan":"skp","application/vnd.kodak-descriptor":"sse","application/vnd.las.las+xml":"lasxml","application/vnd.llamagraphics.life-balance.desktop":"lbd","application/vnd.llamagraphics.life-balance.exchange+xml":"lbe","application/vnd.lotus-1-2-3":"123","application/vnd.lotus-approach":"apr","application/vnd.lotus-freelance":"pre","application/vnd.lotus-notes":"nsf","application/vnd.lotus-organizer":"org","application/vnd.lotus-screencam":"scm","application/vnd.lotus-wordpro":"lwp","application/vnd.macports.portpkg":"portpkg","application/vnd.mcd":"mcd","application/vnd.medcalcdata":"mc1","application/vnd.mediastation.cdkey":"cdkey","application/vnd.mfer":"mwf","application/vnd.mfmp":"mfm","application/vnd.micrografx.flo":"flo","application/vnd.micrografx.igx":"igx","application/vnd.mif":"mif","application/vnd.mobius.daf":"daf","application/vnd.mobius.dis":"dis","application/vnd.mobius.mbk":"mbk","application/vnd.mobius.mqy":"mqy","application/vnd.mobius.msl":"msl","application/vnd.mobius.plc":"plc","application/vnd.mobius.txf":"txf","application/vnd.mophun.application":"mpn","application/vnd.mophun.certificate":"mpc","application/vnd.mozilla.xul+xml":"xul","application/vnd.ms-artgalry":"cil","application/vnd.ms-cab-compressed":"cab","application/vnd.ms-excel":"xls","application/vnd.ms-excel.addin.macroenabled.12":"xlam","application/vnd.ms-excel.sheet.binary.macroenabled.12":"xlsb","application/vnd.ms-excel.sheet.macroenabled.12":"xlsm","application/vnd.ms-excel.template.macroenabled.12":"xltm","application/vnd.ms-fontobject":"eot","application/vnd.ms-htmlhelp":"chm","application/vnd.ms-ims":"ims","application/vnd.ms-lrm":"lrm","application/vnd.ms-officetheme":"thmx","application/vnd.ms-pki.seccat":"cat","application/vnd.ms-pki.stl":"stl","application/vnd.ms-powerpoint":"ppt","application/vnd.ms-powerpoint.addin.macroenabled.12":"ppam","application/vnd.ms-powerpoint.presentation.macroenabled.12":"pptm","application/vnd.ms-powerpoint.slide.macroenabled.12":"sldm","application/vnd.ms-powerpoint.slideshow.macroenabled.12":"ppsm","application/vnd.ms-powerpoint.template.macroenabled.12":"potm","application/vnd.ms-project":"mpp","application/vnd.ms-word.document.macroenabled.12":"docm","application/vnd.ms-word.template.macroenabled.12":"dotm","application/vnd.ms-works":"wps","application/vnd.ms-wpl":"wpl","application/vnd.ms-xpsdocument":"xps","application/vnd.mseq":"mseq","application/vnd.musician":"mus","application/vnd.muvee.style":"msty","application/vnd.mynfc":"taglet","application/vnd.neurolanguage.nlu":"nlu","application/vnd.nitf":"ntf","application/vnd.noblenet-directory":"nnd","application/vnd.noblenet-sealer":"nns","application/vnd.noblenet-web":"nnw","application/vnd.nokia.n-gage.data":"ngdat","application/vnd.nokia.n-gage.symbian.install":"n-gage","application/vnd.nokia.radio-preset":"rpst","application/vnd.nokia.radio-presets":"rpss","application/vnd.novadigm.edm":"edm","application/vnd.novadigm.edx":"edx","application/vnd.novadigm.ext":"ext","application/vnd.oasis.opendocument.chart":"odc","application/vnd.oasis.opendocument.chart-template":"otc","application/vnd.oasis.opendocument.database":"odb","application/vnd.oasis.opendocument.formula":"odf","application/vnd.oasis.opendocument.formula-template":"odft","application/vnd.oasis.opendocument.graphics":"odg","application/vnd.oasis.opendocument.graphics-template":"otg","application/vnd.oasis.opendocument.image":"odi","application/vnd.oasis.opendocument.image-template":"oti","application/vnd.oasis.opendocument.presentation":"odp","application/vnd.oasis.opendocument.presentation-template":"otp","application/vnd.oasis.opendocument.spreadsheet":"ods","application/vnd.oasis.opendocument.spreadsheet-template":"ots","application/vnd.oasis.opendocument.text":"odt","application/vnd.oasis.opendocument.text-master":"odm","application/vnd.oasis.opendocument.text-template":"ott","application/vnd.oasis.opendocument.text-web":"oth","application/vnd.olpc-sugar":"xo","application/vnd.oma.dd2+xml":"dd2","application/vnd.openofficeorg.extension":"oxt","application/vnd.openxmlformats-officedocument.presentationml.presentation":"pptx","application/vnd.openxmlformats-officedocument.presentationml.slide":"sldx","application/vnd.openxmlformats-officedocument.presentationml.slideshow":"ppsx","application/vnd.openxmlformats-officedocument.presentationml.template":"potx","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet":"xlsx","application/vnd.openxmlformats-officedocument.spreadsheetml.template":"xltx","application/vnd.openxmlformats-officedocument.wordprocessingml.document":"docx","application/vnd.openxmlformats-officedocument.wordprocessingml.template":"dotx","application/vnd.osgeo.mapguide.package":"mgp","application/vnd.osgi.dp":"dp","application/vnd.osgi.subsystem":"esa","application/vnd.palm":"pdb","application/vnd.pawaafile":"paw","application/vnd.pg.format":"str","application/vnd.pg.osasli":"ei6","application/vnd.picsel":"efif","application/vnd.pmi.widget":"wg","application/vnd.pocketlearn":"plf","application/vnd.powerbuilder6":"pbd","application/vnd.previewsystems.box":"box","application/vnd.proteus.magazine":"mgz","application/vnd.publishare-delta-tree":"qps","application/vnd.pvi.ptid1":"ptid","application/vnd.quark.quarkxpress":"qxd","application/vnd.realvnc.bed":"bed","application/vnd.recordare.musicxml":"mxl","application/vnd.recordare.musicxml+xml":"musicxml","application/vnd.rig.cryptonote":"cryptonote","application/vnd.rim.cod":"cod","application/vnd.rn-realmedia":"rm","application/vnd.rn-realmedia-vbr":"rmvb","application/vnd.route66.link66+xml":"link66","application/vnd.sailingtracker.track":"st","application/vnd.seemail":"see","application/vnd.sema":"sema","application/vnd.semd":"semd","application/vnd.semf":"semf","application/vnd.shana.informed.formdata":"ifm","application/vnd.shana.informed.formtemplate":"itp","application/vnd.shana.informed.interchange":"iif","application/vnd.shana.informed.package":"ipk","application/vnd.simtech-mindmapper":"twd","application/vnd.smaf":"mmf","application/vnd.smart.teacher":"teacher","application/vnd.solent.sdkm+xml":"sdkm","application/vnd.spotfire.dxp":"dxp","application/vnd.spotfire.sfs":"sfs","application/vnd.stardivision.calc":"sdc","application/vnd.stardivision.draw":"sda","application/vnd.stardivision.impress":"sdd","application/vnd.stardivision.math":"smf","application/vnd.stardivision.writer":"sdw","application/vnd.stardivision.writer-global":"sgl","application/vnd.stepmania.package":"smzip","application/vnd.stepmania.stepchart":"sm","application/vnd.sun.xml.calc":"sxc","application/vnd.sun.xml.calc.template":"stc","application/vnd.sun.xml.draw":"sxd","application/vnd.sun.xml.draw.template":"std","application/vnd.sun.xml.impress":"sxi","application/vnd.sun.xml.impress.template":"sti","application/vnd.sun.xml.math":"sxm","application/vnd.sun.xml.writer":"sxw","application/vnd.sun.xml.writer.global":"sxg","application/vnd.sun.xml.writer.template":"stw","application/vnd.sus-calendar":"sus","application/vnd.svd":"svd","application/vnd.symbian.install":"sis","application/vnd.syncml+xml":"xsm","application/vnd.syncml.dm+wbxml":"bdm","application/vnd.syncml.dm+xml":"xdm","application/vnd.tao.intent-module-archive":"tao","application/vnd.tcpdump.pcap":"pcap","application/vnd.tmobile-livetv":"tmo","application/vnd.trid.tpt":"tpt","application/vnd.triscape.mxs":"mxs","application/vnd.trueapp":"tra","application/vnd.ufdl":"ufd","application/vnd.uiq.theme":"utz","application/vnd.umajin":"umj","application/vnd.unity":"unityweb","application/vnd.uoml+xml":"uoml","application/vnd.vcx":"vcx","application/vnd.visio":"vsd","application/vnd.visionary":"vis","application/vnd.vsf":"vsf","application/vnd.wap.wbxml":"wbxml","application/vnd.wap.wmlc":"wmlc","application/vnd.wap.wmlscriptc":"wmlsc","application/vnd.webturbo":"wtb","application/vnd.wolfram.player":"nbp","application/vnd.wordperfect":"wpd","application/vnd.wqd":"wqd","application/vnd.wt.stf":"stf","application/vnd.xara":"xar","application/vnd.xfdl":"xfdl","application/vnd.yamaha.hv-dic":"hvd","application/vnd.yamaha.hv-script":"hvs","application/vnd.yamaha.hv-voice":"hvp","application/vnd.yamaha.openscoreformat":"osf","application/vnd.yamaha.openscoreformat.osfpvg+xml":"osfpvg","application/vnd.yamaha.smaf-audio":"saf","application/vnd.yamaha.smaf-phrase":"spf","application/vnd.yellowriver-custom-menu":"cmp","application/vnd.zul":"zir","application/vnd.zzazz.deck+xml":"zaz","application/voicexml+xml":"vxml","application/widget":"wgt","application/winhlp":"hlp","application/wsdl+xml":"wsdl","application/wspolicy+xml":"wspolicy","application/x-7z-compressed":"7z","application/x-abiword":"abw","application/x-ace-compressed":"ace","application/x-apple-diskimage":"dmg","application/x-authorware-bin":"aab","application/x-authorware-map":"aam","application/x-authorware-seg":"aas","application/x-bcpio":"bcpio","application/x-bittorrent":"torrent","application/x-blorb":"blb","application/x-bzip":"bz","application/x-bzip2":"bz2","application/x-cbr":"cbr","application/x-cdlink":"vcd","application/x-cfs-compressed":"cfs","application/x-chat":"chat","application/x-chess-pgn":"pgn","application/x-conference":"nsc","application/x-cpio":"cpio","application/x-csh":"csh","application/x-debian-package":"deb","application/x-dgc-compressed":"dgc","application/x-director":"dir","application/x-doom":"wad","application/x-dtbncx+xml":"ncx","application/x-dtbook+xml":"dtb","application/x-dtbresource+xml":"res","application/x-dvi":"dvi","application/x-envoy":"evy","application/x-eva":"eva","application/x-font-bdf":"bdf","application/x-font-ghostscript":"gsf","application/x-font-linux-psf":"psf","application/x-font-otf":"otf","application/x-font-pcf":"pcf","application/x-font-snf":"snf","application/x-font-ttf":"ttf","application/x-font-type1":"pfa","application/x-font-woff":"woff","application/x-freearc":"arc","application/x-futuresplash":"spl","application/x-gca-compressed":"gca","application/x-glulx":"ulx","application/x-gnumeric":"gnumeric","application/x-gramps-xml":"gramps","application/x-gtar":"gtar","application/x-hdf":"hdf","application/x-install-instructions":"install","application/x-iso9660-image":"iso","application/x-java-jnlp-file":"jnlp","application/x-latex":"latex","application/x-lzh-compressed":"lzh","application/x-mie":"mie","application/x-mobipocket-ebook":"prc","application/x-ms-application":"application","application/x-ms-shortcut":"lnk","application/x-ms-wmd":"wmd","application/x-ms-wmz":"wmz","application/x-ms-xbap":"xbap","application/x-msaccess":"mdb","application/x-msbinder":"obd","application/x-mscardfile":"crd","application/x-msclip":"clp","application/x-msdownload":"exe","application/x-msmediaview":"mvb","application/x-msmetafile":"wmf","application/x-msmoney":"mny","application/x-mspublisher":"pub","application/x-msschedule":"scd","application/x-msterminal":"trm","application/x-mswrite":"wri","application/x-netcdf":"nc","application/x-nzb":"nzb","application/x-pkcs12":"p12","application/x-pkcs7-certificates":"p7b","application/x-pkcs7-certreqresp":"p7r","application/x-rar-compressed":"rar","application/x-research-info-systems":"ris","application/x-sh":"sh","application/x-shar":"shar","application/x-shockwave-flash":"swf","application/x-silverlight-app":"xap","application/x-sql":"sql","application/x-stuffit":"sit","application/x-stuffitx":"sitx","application/x-subrip":"srt","application/x-sv4cpio":"sv4cpio","application/x-sv4crc":"sv4crc","application/x-t3vm-image":"t3","application/x-tads":"gam","application/x-tar":"tar","application/x-tcl":"tcl","application/x-tex":"tex","application/x-tex-tfm":"tfm","application/x-texinfo":"texinfo","application/x-tgif":"obj","application/x-ustar":"ustar","application/x-wais-source":"src","application/x-x509-ca-cert":"der","application/x-xfig":"fig","application/x-xliff+xml":"xlf","application/x-xpinstall":"xpi","application/x-xz":"xz","application/x-zmachine":"z1","application/xaml+xml":"xaml","application/xcap-diff+xml":"xdf","application/xenc+xml":"xenc","application/xhtml+xml":"xhtml","application/xml":"xml","application/xml-dtd":"dtd","application/xop+xml":"xop","application/xproc+xml":"xpl","application/xslt+xml":"xslt","application/xspf+xml":"xspf","application/xv+xml":"mxml","application/yang":"yang","application/yin+xml":"yin","application/zip":"zip","audio/adpcm":"adp","audio/basic":"au","audio/midi":"mid","audio/mp4":"mp4a","audio/mpeg":"mpga","audio/ogg":"oga","audio/s3m":"s3m","audio/silk":"sil","audio/vnd.dece.audio":"uva","audio/vnd.digital-winds":"eol","audio/vnd.dra":"dra","audio/vnd.dts":"dts","audio/vnd.dts.hd":"dtshd","audio/vnd.lucent.voice":"lvp","audio/vnd.ms-playready.media.pya":"pya","audio/vnd.nuera.ecelp4800":"ecelp4800","audio/vnd.nuera.ecelp7470":"ecelp7470","audio/vnd.nuera.ecelp9600":"ecelp9600","audio/vnd.rip":"rip","audio/webm":"weba","audio/x-aac":"aac","audio/x-aiff":"aif","audio/x-caf":"caf","audio/x-flac":"flac","audio/x-matroska":"mka","audio/x-mpegurl":"m3u","audio/x-ms-wax":"wax","audio/x-ms-wma":"wma","audio/x-pn-realaudio":"ram","audio/x-pn-realaudio-plugin":"rmp","audio/x-wav":"wav","audio/xm":"xm","chemical/x-cdx":"cdx","chemical/x-cif":"cif","chemical/x-cmdf":"cmdf","chemical/x-cml":"cml","chemical/x-csml":"csml","chemical/x-xyz":"xyz","image/bmp":"bmp","image/cgm":"cgm","image/g3fax":"g3","image/gif":"gif","image/ief":"ief","image/jpeg":"jpeg","image/ktx":"ktx","image/png":"png","image/prs.btif":"btif","image/sgi":"sgi","image/svg+xml":"svg","image/tiff":"tiff","image/vnd.adobe.photoshop":"psd","image/vnd.dece.graphic":"uvi","image/vnd.dvb.subtitle":"sub","image/vnd.djvu":"djvu","image/vnd.dwg":"dwg","image/vnd.dxf":"dxf","image/vnd.fastbidsheet":"fbs","image/vnd.fpx":"fpx","image/vnd.fst":"fst","image/vnd.fujixerox.edmics-mmr":"mmr","image/vnd.fujixerox.edmics-rlc":"rlc","image/vnd.ms-modi":"mdi","image/vnd.ms-photo":"wdp","image/vnd.net-fpx":"npx","image/vnd.wap.wbmp":"wbmp","image/vnd.xiff":"xif","image/webp":"webp","image/x-3ds":"3ds","image/x-cmu-raster":"ras","image/x-cmx":"cmx","image/x-freehand":"fh","image/x-icon":"ico","image/x-mrsid-image":"sid","image/x-pcx":"pcx","image/x-pict":"pic","image/x-portable-anymap":"pnm","image/x-portable-bitmap":"pbm","image/x-portable-graymap":"pgm","image/x-portable-pixmap":"ppm","image/x-rgb":"rgb","image/x-tga":"tga","image/x-xbitmap":"xbm","image/x-xpixmap":"xpm","image/x-xwindowdump":"xwd","message/rfc822":"eml","model/iges":"igs","model/mesh":"msh","model/vnd.collada+xml":"dae","model/vnd.dwf":"dwf","model/vnd.gdl":"gdl","model/vnd.gtw":"gtw","model/vnd.mts":"mts","model/vnd.vtu":"vtu","model/vrml":"wrl","model/x3d+binary":"x3db","model/x3d+vrml":"x3dv","model/x3d+xml":"x3d","text/cache-manifest":"appcache","text/calendar":"ics","text/css":"css","text/csv":"csv","text/html":"html","text/n3":"n3","text/plain":"txt","text/prs.lines.tag":"dsc","text/richtext":"rtx","text/sgml":"sgml","text/tab-separated-values":"tsv","text/troff":"t","text/turtle":"ttl","text/uri-list":"uri","text/vcard":"vcard","text/vnd.curl":"curl","text/vnd.curl.dcurl":"dcurl","text/vnd.curl.scurl":"scurl","text/vnd.curl.mcurl":"mcurl","text/vnd.dvb.subtitle":"sub","text/vnd.fly":"fly","text/vnd.fmi.flexstor":"flx","text/vnd.graphviz":"gv","text/vnd.in3d.3dml":"3dml","text/vnd.in3d.spot":"spot","text/vnd.sun.j2me.app-descriptor":"jad","text/vnd.wap.wml":"wml","text/vnd.wap.wmlscript":"wmls","text/x-asm":"s","text/x-c":"c","text/x-fortran":"f","text/x-java-source":"java","text/x-opml":"opml","text/x-pascal":"p","text/x-nfo":"nfo","text/x-setext":"etx","text/x-sfv":"sfv","text/x-uuencode":"uu","text/x-vcalendar":"vcs","text/x-vcard":"vcf","video/3gpp":"3gp","video/3gpp2":"3g2","video/h261":"h261","video/h263":"h263","video/h264":"h264","video/jpeg":"jpgv","video/jpm":"jpm","video/mj2":"mj2","video/mp4":"mp4","video/mpeg":"mpeg","video/ogg":"ogv","video/quicktime":"qt","video/vnd.dece.hd":"uvh","video/vnd.dece.mobile":"uvm","video/vnd.dece.pd":"uvp","video/vnd.dece.sd":"uvs","video/vnd.dece.video":"uvv","video/vnd.dvb.file":"dvb","video/vnd.fvt":"fvt","video/vnd.mpegurl":"mxu","video/vnd.ms-playready.media.pyv":"pyv","video/vnd.uvvu.mp4":"uvu","video/vnd.vivo":"viv","video/webm":"webm","video/x-f4v":"f4v","video/x-fli":"fli","video/x-flv":"flv","video/x-m4v":"m4v","video/x-matroska":"mkv","video/x-mng":"mng","video/x-ms-asf":"asf","video/x-ms-vob":"vob","video/x-ms-wm":"wm","video/x-ms-wmv":"wmv","video/x-ms-wmx":"wmx","video/x-ms-wvx":"wvx","video/x-msvideo":"avi","video/x-sgi-movie":"movie","video/x-smv":"smv","x-conference/x-cooltalk":"ice","text/vtt":"vtt","application/x-chrome-extension":"crx","text/x-component":"htc","video/MP2T":"ts","text/event-stream":"event-stream","application/x-web-app-manifest+json":"webapp","text/x-lua":"lua","application/x-lua-bytecode":"luac","text/x-markdown":"markdown"},extension:function(a){var b=a.match(/^\s*([^;\s]*)(?:;|\s|$)/)[1].toLowerCase();return this.extensions[b]},define:function(a){for(var b in a){for(var c=a[b],d=0;d<c.length;d++)this.types[c[d]]=b;this.extensions[b]||(this.extensions[b]=c[0])}},charsets:{lookup:function(a,b){return/^text\//.test(a)?"UTF-8":b}}};d.types.constructor=void 0,d.extensions.constructor=void 0},{}],121:[function(a,b,c){(function(c){function d(a){var b=f(a),c=b.toRed(g.mont(a.modulus)).redPow(new g(a.publicExponent)).fromRed();return{blinder:c,unblinder:b.invm(a.modulus)}}function e(a,b){var e=d(b),f=b.modulus.byteLength(),h=(g.mont(b.modulus),new g(a).mul(e.blinder).umod(b.modulus)),i=h.toRed(g.mont(b.prime1)),j=h.toRed(g.mont(b.prime2)),k=b.coefficient,l=b.prime1,m=b.prime2,n=i.redPow(b.exponent1),o=j.redPow(b.exponent2);n=n.fromRed(),o=o.fromRed();var p=n.isub(o).imul(k).umod(l);return p.imul(m),o.iadd(p),new c(o.imul(e.unblinder).umod(b.modulus).toArray(!1,f))}function f(a){for(var b=a.modulus.byteLength(),c=new g(h(b));c.cmp(a.modulus)>=0||!c.umod(a.prime1)||!c.umod(a.prime2);)c=new g(h(b));return c}var g=a("bn.js"),h=a("randombytes");b.exports=e,e.getr=f}).call(this,a("buffer").Buffer)},{"bn.js":99,buffer:130,randombytes:227}],122:[function(a,b,c){b.exports=a("./browser/algorithms.json")},{"./browser/algorithms.json":123}],123:[function(a,b,c){b.exports={sha224WithRSAEncryption:{sign:"rsa",hash:"sha224",id:"302d300d06096086480165030402040500041c"},"RSA-SHA224":{sign:"ecdsa/rsa",hash:"sha224",id:"302d300d06096086480165030402040500041c"},sha256WithRSAEncryption:{sign:"rsa",hash:"sha256",id:"3031300d060960864801650304020105000420"},"RSA-SHA256":{sign:"ecdsa/rsa",hash:"sha256",id:"3031300d060960864801650304020105000420"},sha384WithRSAEncryption:{sign:"rsa",hash:"sha384",id:"3041300d060960864801650304020205000430"},"RSA-SHA384":{sign:"ecdsa/rsa",hash:"sha384",id:"3041300d060960864801650304020205000430"},sha512WithRSAEncryption:{sign:"rsa",hash:"sha512",id:"3051300d060960864801650304020305000440"},"RSA-SHA512":{sign:"ecdsa/rsa",hash:"sha512",id:"3051300d060960864801650304020305000440"},"RSA-SHA1":{sign:"rsa",hash:"sha1",id:"3021300906052b0e03021a05000414"},"ecdsa-with-SHA1":{sign:"ecdsa",hash:"sha1",id:""},sha256:{sign:"ecdsa",hash:"sha256",id:""},sha224:{sign:"ecdsa",hash:"sha224",id:""},sha384:{sign:"ecdsa",hash:"sha384",id:""},sha512:{sign:"ecdsa",hash:"sha512",id:""},"DSA-SHA":{sign:"dsa",hash:"sha1",id:""},"DSA-SHA1":{sign:"dsa",hash:"sha1",id:""},DSA:{sign:"dsa",hash:"sha1",id:""},"DSA-WITH-SHA224":{sign:"dsa",hash:"sha224",id:""},"DSA-SHA224":{sign:"dsa",hash:"sha224",id:""},"DSA-WITH-SHA256":{sign:"dsa",hash:"sha256",id:""},"DSA-SHA256":{sign:"dsa",hash:"sha256",id:""},"DSA-WITH-SHA384":{sign:"dsa",hash:"sha384",id:""},"DSA-SHA384":{sign:"dsa",hash:"sha384",id:""},"DSA-WITH-SHA512":{sign:"dsa",hash:"sha512",id:""},"DSA-SHA512":{sign:"dsa",hash:"sha512",id:""},"DSA-RIPEMD160":{sign:"dsa",hash:"rmd160",id:""},ripemd160WithRSA:{sign:"rsa",hash:"rmd160",id:"3021300906052b2403020105000414"},"RSA-RIPEMD160":{sign:"rsa",hash:"rmd160",id:"3021300906052b2403020105000414"},md5WithRSAEncryption:{sign:"rsa",hash:"md5",id:"3020300c06082a864886f70d020505000410"},"RSA-MD5":{sign:"rsa",hash:"md5",id:"3020300c06082a864886f70d020505000410"}}},{}],124:[function(a,b,c){b.exports={"1.3.132.0.10":"secp256k1","1.3.132.0.33":"p224","1.2.840.10045.3.1.1":"p192","1.2.840.10045.3.1.7":"p256","1.3.132.0.34":"p384","1.3.132.0.35":"p521"}},{}],125:[function(a,b,c){(function(c){function d(a){i.Writable.call(this);var b=m[a];if(!b)throw new Error("Unknown message digest");this._hashType=b.hash,this._hash=h(b.hash),this._tag=b.id,this._signType=b.sign}function e(a){i.Writable.call(this);var b=m[a];if(!b)throw new Error("Unknown message digest");this._hash=h(b.hash),this._tag=b.id,this._signType=b.sign}function f(a){return new d(a)}function g(a){return new e(a)}var h=a("create-hash"),i=a("stream"),j=a("inherits"),k=a("./sign"),l=a("./verify"),m=a("./algorithms.json");Object.keys(m).forEach(function(a){m[a].id=new c(m[a].id,"hex"),m[a.toLowerCase()]=m[a]}),j(d,i.Writable),d.prototype._write=function(a,b,c){this._hash.update(a),c()},d.prototype.update=function(a,b){return"string"==typeof a&&(a=new c(a,b)),this._hash.update(a),this},d.prototype.sign=function(a,b){this.end();var c=this._hash.digest(),d=k(c,a,this._hashType,this._signType,this._tag);return b?d.toString(b):d},j(e,i.Writable),e.prototype._write=function(a,b,c){this._hash.update(a),c()},e.prototype.update=function(a,b){return"string"==typeof a&&(a=new c(a,b)),this._hash.update(a),this},e.prototype.verify=function(a,b,d){"string"==typeof b&&(b=new c(b,d)),this.end();var e=this._hash.digest();return l(b,e,a,this._signType,this._tag)},b.exports={Sign:f,Verify:g,createSign:f,createVerify:g}}).call(this,a("buffer").Buffer)},{"./algorithms.json":123,"./sign":126,"./verify":127,buffer:130,"create-hash":136,inherits:196,stream:254}],126:[function(a,b,c){(function(c){function d(a,b,d,g,h){var i=q(b);if(i.curve){if("ecdsa"!==g&&"ecdsa/rsa"!==g)throw new Error("wrong private key type");return e(a,i)}if("dsa"===i.type){if("dsa"!==g)throw new Error("wrong private key type");return f(a,i,d)}if("rsa"!==g&&"ecdsa/rsa"!==g)throw new Error("wrong private key type");a=c.concat([h,a]);for(var j=i.modulus.byteLength(),k=[0,1];a.length+k.length+1<j;)k.push(255);k.push(0);for(var l=-1;++l<a.length;)k.push(a[l]);var m=n(k,i);return m}function e(a,b){var d=r[b.curve.join(".")];if(!d)throw new Error("unknown curve "+b.curve.join("."));var e=new o(d),f=e.keyFromPrivate(b.privateKey),g=f.sign(a);return new c(g.toDER())}function f(a,b,c){for(var d,e=b.params.priv_key,f=b.params.p,j=b.params.q,m=b.params.g,n=new p(0),o=i(a,j).mod(j),q=!1,r=h(e,j,a,c);q===!1;)d=k(j,r,c),n=l(m,d,f,j),q=d.invm(j).imul(o.add(e.mul(n))).mod(j),0===q.cmpn(0)&&(q=!1,n=new p(0));return g(n,q)}function g(a,b){a=a.toArray(),b=b.toArray(),128&a[0]&&(a=[0].concat(a)),128&b[0]&&(b=[0].concat(b));var d=a.length+b.length+4,e=[48,d,2,a.length];return e=e.concat(a,[2,b.length],b),new c(e)}function h(a,b,d,e){if(a=new c(a.toArray()),a.length<b.byteLength()){var f=new c(b.byteLength()-a.length);f.fill(0),a=c.concat([f,a])}var g=d.length,h=j(d,b),i=new c(g);i.fill(1);var k=new c(g);return k.fill(0),k=m(e,k).update(i).update(new c([0])).update(a).update(h).digest(),i=m(e,k).update(i).digest(),k=m(e,k).update(i).update(new c([1])).update(a).update(h).digest(),i=m(e,k).update(i).digest(),{k:k,v:i}}function i(a,b){var c=new p(a),d=(a.length<<3)-b.bitLength();return d>0&&c.ishrn(d),c}function j(a,b){a=i(a,b),a=a.mod(b);var d=new c(a.toArray());if(d.length<b.byteLength()){var e=new c(b.byteLength()-d.length);e.fill(0),d=c.concat([e,d])}return d}function k(a,b,d){var e,f;do{for(e=new c(0);8*e.length<a.bitLength();)b.v=m(d,b.k).update(b.v).digest(),e=c.concat([e,b.v]);f=i(e,a),b.k=m(d,b.k).update(b.v).update(new c([0])).digest(),b.v=m(d,b.k).update(b.v).digest()}while(-1!==f.cmp(a));return f}function l(a,b,c,d){return a.toRed(p.mont(c)).redPow(b).fromRed().mod(d)}var m=a("create-hmac"),n=a("browserify-rsa"),o=a("elliptic").ec,p=a("bn.js"),q=a("parse-asn1"),r=a("./curves.json");b.exports=d,b.exports.getKey=h,b.exports.makeKey=k}).call(this,a("buffer").Buffer)},{"./curves.json":124,"bn.js":99,"browserify-rsa":121,buffer:130,"create-hmac":139,elliptic:154,"parse-asn1":208}],127:[function(a,b,c){(function(c){function d(a,b,d,g,i){var k=j(d);if("ec"===k.type){if("ecdsa"!==g&&"ecdsa/rsa"!==g)throw new Error("wrong public key type");return e(a,b,k)}if("dsa"===k.type){
if("dsa"!==g)throw new Error("wrong public key type");return f(a,b,k)}if("rsa"!==g&&"ecdsa/rsa"!==g)throw new Error("wrong public key type");b=c.concat([i,b]);for(var l=k.modulus.byteLength(),m=[1],n=0;b.length+m.length+2<l;)m.push(255),n++;m.push(0);for(var o=-1;++o<b.length;)m.push(b[o]);m=new c(m);var p=h.mont(k.modulus);a=new h(a).toRed(p),a=a.redPow(new h(k.publicExponent)),a=new c(a.fromRed().toArray());var q=8>n?1:0;for(l=Math.min(a.length,m.length),a.length!==m.length&&(q=1),o=-1;++o<l;)q|=a[o]^m[o];return 0===q}function e(a,b,c){var d=k[c.data.algorithm.curve.join(".")];if(!d)throw new Error("unknown curve "+c.data.algorithm.curve.join("."));var e=new i(d),f=c.data.subjectPrivateKey.data;return e.verify(b,a,f)}function f(a,b,c){var d=c.data.p,e=c.data.q,f=c.data.g,i=c.data.pub_key,k=j.signature.decode(a,"der"),l=k.s,m=k.r;g(l,e),g(m,e);var n=h.mont(d),o=l.invm(e),p=f.toRed(n).redPow(new h(b).mul(o).mod(e)).fromRed().mul(i.toRed(n).redPow(m.mul(o).mod(e)).fromRed()).mod(d).mod(e);return 0===p.cmp(m)}function g(a,b){if(a.cmpn(0)<=0)throw new Error("invalid sig");if(a.cmp(b)>=b)throw new Error("invalid sig")}var h=a("bn.js"),i=a("elliptic").ec,j=a("parse-asn1"),k=a("./curves.json");b.exports=d}).call(this,a("buffer").Buffer)},{"./curves.json":124,"bn.js":99,buffer:130,elliptic:154,"parse-asn1":208}],128:[function(a,b,c){(function(a){!function(){"use strict";function c(b){var c;return c=b instanceof a?b:new a(b.toString(),"binary"),c.toString("base64")}b.exports=c}()}).call(this,a("buffer").Buffer)},{buffer:130}],129:[function(a,b,c){(function(a){b.exports=function(b,c){for(var d=Math.min(b.length,c.length),e=new a(d),f=0;d>f;++f)e[f]=b[f]^c[f];return e}}).call(this,a("buffer").Buffer)},{buffer:130}],130:[function(a,b,c){(function(b){"use strict";function d(){function a(){}try{var b=new Uint8Array(1);return b.foo=function(){return 42},b.constructor=a,42===b.foo()&&b.constructor===a&&"function"==typeof b.subarray&&0===b.subarray(1,1).byteLength}catch(c){return!1}}function e(){return f.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function f(a){return this instanceof f?(f.TYPED_ARRAY_SUPPORT||(this.length=0,this.parent=void 0),"number"==typeof a?g(this,a):"string"==typeof a?h(this,a,arguments.length>1?arguments[1]:"utf8"):i(this,a)):arguments.length>1?new f(a,arguments[1]):new f(a)}function g(a,b){if(a=p(a,0>b?0:0|q(b)),!f.TYPED_ARRAY_SUPPORT)for(var c=0;b>c;c++)a[c]=0;return a}function h(a,b,c){("string"!=typeof c||""===c)&&(c="utf8");var d=0|s(b,c);return a=p(a,d),a.write(b,c),a}function i(a,b){if(f.isBuffer(b))return j(a,b);if(Y(b))return k(a,b);if(null==b)throw new TypeError("must start with number, buffer, array or string");if("undefined"!=typeof ArrayBuffer){if(b.buffer instanceof ArrayBuffer)return l(a,b);if(b instanceof ArrayBuffer)return m(a,b)}return b.length?n(a,b):o(a,b)}function j(a,b){var c=0|q(b.length);return a=p(a,c),b.copy(a,0,0,c),a}function k(a,b){var c=0|q(b.length);a=p(a,c);for(var d=0;c>d;d+=1)a[d]=255&b[d];return a}function l(a,b){var c=0|q(b.length);a=p(a,c);for(var d=0;c>d;d+=1)a[d]=255&b[d];return a}function m(a,b){return f.TYPED_ARRAY_SUPPORT?(b.byteLength,a=f._augment(new Uint8Array(b))):a=l(a,new Uint8Array(b)),a}function n(a,b){var c=0|q(b.length);a=p(a,c);for(var d=0;c>d;d+=1)a[d]=255&b[d];return a}function o(a,b){var c,d=0;"Buffer"===b.type&&Y(b.data)&&(c=b.data,d=0|q(c.length)),a=p(a,d);for(var e=0;d>e;e+=1)a[e]=255&c[e];return a}function p(a,b){f.TYPED_ARRAY_SUPPORT?(a=f._augment(new Uint8Array(b)),a.__proto__=f.prototype):(a.length=b,a._isBuffer=!0);var c=0!==b&&b<=f.poolSize>>>1;return c&&(a.parent=Z),a}function q(a){if(a>=e())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+e().toString(16)+" bytes");return 0|a}function r(a,b){if(!(this instanceof r))return new r(a,b);var c=new f(a,b);return delete c.parent,c}function s(a,b){"string"!=typeof a&&(a=""+a);var c=a.length;if(0===c)return 0;for(var d=!1;;)switch(b){case"ascii":case"binary":case"raw":case"raws":return c;case"utf8":case"utf-8":return R(a).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*c;case"hex":return c>>>1;case"base64":return U(a).length;default:if(d)return R(a).length;b=(""+b).toLowerCase(),d=!0}}function t(a,b,c){var d=!1;if(b=0|b,c=void 0===c||c===1/0?this.length:0|c,a||(a="utf8"),0>b&&(b=0),c>this.length&&(c=this.length),b>=c)return"";for(;;)switch(a){case"hex":return F(this,b,c);case"utf8":case"utf-8":return B(this,b,c);case"ascii":return D(this,b,c);case"binary":return E(this,b,c);case"base64":return A(this,b,c);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return G(this,b,c);default:if(d)throw new TypeError("Unknown encoding: "+a);a=(a+"").toLowerCase(),d=!0}}function u(a,b,c,d){c=Number(c)||0;var e=a.length-c;d?(d=Number(d),d>e&&(d=e)):d=e;var f=b.length;if(f%2!==0)throw new Error("Invalid hex string");d>f/2&&(d=f/2);for(var g=0;d>g;g++){var h=parseInt(b.substr(2*g,2),16);if(isNaN(h))throw new Error("Invalid hex string");a[c+g]=h}return g}function v(a,b,c,d){return V(R(b,a.length-c),a,c,d)}function w(a,b,c,d){return V(S(b),a,c,d)}function x(a,b,c,d){return w(a,b,c,d)}function y(a,b,c,d){return V(U(b),a,c,d)}function z(a,b,c,d){return V(T(b,a.length-c),a,c,d)}function A(a,b,c){return 0===b&&c===a.length?W.fromByteArray(a):W.fromByteArray(a.slice(b,c))}function B(a,b,c){c=Math.min(a.length,c);for(var d=[],e=b;c>e;){var f=a[e],g=null,h=f>239?4:f>223?3:f>191?2:1;if(c>=e+h){var i,j,k,l;switch(h){case 1:128>f&&(g=f);break;case 2:i=a[e+1],128===(192&i)&&(l=(31&f)<<6|63&i,l>127&&(g=l));break;case 3:i=a[e+1],j=a[e+2],128===(192&i)&&128===(192&j)&&(l=(15&f)<<12|(63&i)<<6|63&j,l>2047&&(55296>l||l>57343)&&(g=l));break;case 4:i=a[e+1],j=a[e+2],k=a[e+3],128===(192&i)&&128===(192&j)&&128===(192&k)&&(l=(15&f)<<18|(63&i)<<12|(63&j)<<6|63&k,l>65535&&1114112>l&&(g=l))}}null===g?(g=65533,h=1):g>65535&&(g-=65536,d.push(g>>>10&1023|55296),g=56320|1023&g),d.push(g),e+=h}return C(d)}function C(a){var b=a.length;if($>=b)return String.fromCharCode.apply(String,a);for(var c="",d=0;b>d;)c+=String.fromCharCode.apply(String,a.slice(d,d+=$));return c}function D(a,b,c){var d="";c=Math.min(a.length,c);for(var e=b;c>e;e++)d+=String.fromCharCode(127&a[e]);return d}function E(a,b,c){var d="";c=Math.min(a.length,c);for(var e=b;c>e;e++)d+=String.fromCharCode(a[e]);return d}function F(a,b,c){var d=a.length;(!b||0>b)&&(b=0),(!c||0>c||c>d)&&(c=d);for(var e="",f=b;c>f;f++)e+=Q(a[f]);return e}function G(a,b,c){for(var d=a.slice(b,c),e="",f=0;f<d.length;f+=2)e+=String.fromCharCode(d[f]+256*d[f+1]);return e}function H(a,b,c){if(a%1!==0||0>a)throw new RangeError("offset is not uint");if(a+b>c)throw new RangeError("Trying to access beyond buffer length")}function I(a,b,c,d,e,g){if(!f.isBuffer(a))throw new TypeError("buffer must be a Buffer instance");if(b>e||g>b)throw new RangeError("value is out of bounds");if(c+d>a.length)throw new RangeError("index out of range")}function J(a,b,c,d){0>b&&(b=65535+b+1);for(var e=0,f=Math.min(a.length-c,2);f>e;e++)a[c+e]=(b&255<<8*(d?e:1-e))>>>8*(d?e:1-e)}function K(a,b,c,d){0>b&&(b=4294967295+b+1);for(var e=0,f=Math.min(a.length-c,4);f>e;e++)a[c+e]=b>>>8*(d?e:3-e)&255}function L(a,b,c,d,e,f){if(b>e||f>b)throw new RangeError("value is out of bounds");if(c+d>a.length)throw new RangeError("index out of range");if(0>c)throw new RangeError("index out of range")}function M(a,b,c,d,e){return e||L(a,b,c,4,3.4028234663852886e38,-3.4028234663852886e38),X.write(a,b,c,d,23,4),c+4}function N(a,b,c,d,e){return e||L(a,b,c,8,1.7976931348623157e308,-1.7976931348623157e308),X.write(a,b,c,d,52,8),c+8}function O(a){if(a=P(a).replace(aa,""),a.length<2)return"";for(;a.length%4!==0;)a+="=";return a}function P(a){return a.trim?a.trim():a.replace(/^\s+|\s+$/g,"")}function Q(a){return 16>a?"0"+a.toString(16):a.toString(16)}function R(a,b){b=b||1/0;for(var c,d=a.length,e=null,f=[],g=0;d>g;g++){if(c=a.charCodeAt(g),c>55295&&57344>c){if(!e){if(c>56319){(b-=3)>-1&&f.push(239,191,189);continue}if(g+1===d){(b-=3)>-1&&f.push(239,191,189);continue}e=c;continue}if(56320>c){(b-=3)>-1&&f.push(239,191,189),e=c;continue}c=(e-55296<<10|c-56320)+65536}else e&&(b-=3)>-1&&f.push(239,191,189);if(e=null,128>c){if((b-=1)<0)break;f.push(c)}else if(2048>c){if((b-=2)<0)break;f.push(c>>6|192,63&c|128)}else if(65536>c){if((b-=3)<0)break;f.push(c>>12|224,c>>6&63|128,63&c|128)}else{if(!(1114112>c))throw new Error("Invalid code point");if((b-=4)<0)break;f.push(c>>18|240,c>>12&63|128,c>>6&63|128,63&c|128)}}return f}function S(a){for(var b=[],c=0;c<a.length;c++)b.push(255&a.charCodeAt(c));return b}function T(a,b){for(var c,d,e,f=[],g=0;g<a.length&&!((b-=2)<0);g++)c=a.charCodeAt(g),d=c>>8,e=c%256,f.push(e),f.push(d);return f}function U(a){return W.toByteArray(O(a))}function V(a,b,c,d){for(var e=0;d>e&&!(e+c>=b.length||e>=a.length);e++)b[e+c]=a[e];return e}var W=a("base64-js"),X=a("ieee754"),Y=a("isarray");c.Buffer=f,c.SlowBuffer=r,c.INSPECT_MAX_BYTES=50,f.poolSize=8192;var Z={};f.TYPED_ARRAY_SUPPORT=void 0!==b.TYPED_ARRAY_SUPPORT?b.TYPED_ARRAY_SUPPORT:d(),f.TYPED_ARRAY_SUPPORT?(f.prototype.__proto__=Uint8Array.prototype,f.__proto__=Uint8Array):(f.prototype.length=void 0,f.prototype.parent=void 0),f.isBuffer=function(a){return!(null==a||!a._isBuffer)},f.compare=function(a,b){if(!f.isBuffer(a)||!f.isBuffer(b))throw new TypeError("Arguments must be Buffers");if(a===b)return 0;for(var c=a.length,d=b.length,e=0,g=Math.min(c,d);g>e&&a[e]===b[e];)++e;return e!==g&&(c=a[e],d=b[e]),d>c?-1:c>d?1:0},f.isEncoding=function(a){switch(String(a).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"raw":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},f.concat=function(a,b){if(!Y(a))throw new TypeError("list argument must be an Array of Buffers.");if(0===a.length)return new f(0);var c;if(void 0===b)for(b=0,c=0;c<a.length;c++)b+=a[c].length;var d=new f(b),e=0;for(c=0;c<a.length;c++){var g=a[c];g.copy(d,e),e+=g.length}return d},f.byteLength=s,f.prototype.toString=function(){var a=0|this.length;return 0===a?"":0===arguments.length?B(this,0,a):t.apply(this,arguments)},f.prototype.equals=function(a){if(!f.isBuffer(a))throw new TypeError("Argument must be a Buffer");return this===a?!0:0===f.compare(this,a)},f.prototype.inspect=function(){var a="",b=c.INSPECT_MAX_BYTES;return this.length>0&&(a=this.toString("hex",0,b).match(/.{2}/g).join(" "),this.length>b&&(a+=" ... ")),"<Buffer "+a+">"},f.prototype.compare=function(a){if(!f.isBuffer(a))throw new TypeError("Argument must be a Buffer");return this===a?0:f.compare(this,a)},f.prototype.indexOf=function(a,b){function c(a,b,c){for(var d=-1,e=0;c+e<a.length;e++)if(a[c+e]===b[-1===d?0:e-d]){if(-1===d&&(d=e),e-d+1===b.length)return c+d}else d=-1;return-1}if(b>2147483647?b=2147483647:-2147483648>b&&(b=-2147483648),b>>=0,0===this.length)return-1;if(b>=this.length)return-1;if(0>b&&(b=Math.max(this.length+b,0)),"string"==typeof a)return 0===a.length?-1:String.prototype.indexOf.call(this,a,b);if(f.isBuffer(a))return c(this,a,b);if("number"==typeof a)return f.TYPED_ARRAY_SUPPORT&&"function"===Uint8Array.prototype.indexOf?Uint8Array.prototype.indexOf.call(this,a,b):c(this,[a],b);throw new TypeError("val must be string, number or Buffer")},f.prototype.get=function(a){return console.log(".get() is deprecated. Access using array indexes instead."),this.readUInt8(a)},f.prototype.set=function(a,b){return console.log(".set() is deprecated. Access using array indexes instead."),this.writeUInt8(a,b)},f.prototype.write=function(a,b,c,d){if(void 0===b)d="utf8",c=this.length,b=0;else if(void 0===c&&"string"==typeof b)d=b,c=this.length,b=0;else if(isFinite(b))b=0|b,isFinite(c)?(c=0|c,void 0===d&&(d="utf8")):(d=c,c=void 0);else{var e=d;d=b,b=0|c,c=e}var f=this.length-b;if((void 0===c||c>f)&&(c=f),a.length>0&&(0>c||0>b)||b>this.length)throw new RangeError("attempt to write outside buffer bounds");d||(d="utf8");for(var g=!1;;)switch(d){case"hex":return u(this,a,b,c);case"utf8":case"utf-8":return v(this,a,b,c);case"ascii":return w(this,a,b,c);case"binary":return x(this,a,b,c);case"base64":return y(this,a,b,c);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return z(this,a,b,c);default:if(g)throw new TypeError("Unknown encoding: "+d);d=(""+d).toLowerCase(),g=!0}},f.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var $=4096;f.prototype.slice=function(a,b){var c=this.length;a=~~a,b=void 0===b?c:~~b,0>a?(a+=c,0>a&&(a=0)):a>c&&(a=c),0>b?(b+=c,0>b&&(b=0)):b>c&&(b=c),a>b&&(b=a);var d;if(f.TYPED_ARRAY_SUPPORT)d=f._augment(this.subarray(a,b));else{var e=b-a;d=new f(e,void 0);for(var g=0;e>g;g++)d[g]=this[g+a]}return d.length&&(d.parent=this.parent||this),d},f.prototype.readUIntLE=function(a,b,c){a=0|a,b=0|b,c||H(a,b,this.length);for(var d=this[a],e=1,f=0;++f<b&&(e*=256);)d+=this[a+f]*e;return d},f.prototype.readUIntBE=function(a,b,c){a=0|a,b=0|b,c||H(a,b,this.length);for(var d=this[a+--b],e=1;b>0&&(e*=256);)d+=this[a+--b]*e;return d},f.prototype.readUInt8=function(a,b){return b||H(a,1,this.length),this[a]},f.prototype.readUInt16LE=function(a,b){return b||H(a,2,this.length),this[a]|this[a+1]<<8},f.prototype.readUInt16BE=function(a,b){return b||H(a,2,this.length),this[a]<<8|this[a+1]},f.prototype.readUInt32LE=function(a,b){return b||H(a,4,this.length),(this[a]|this[a+1]<<8|this[a+2]<<16)+16777216*this[a+3]},f.prototype.readUInt32BE=function(a,b){return b||H(a,4,this.length),16777216*this[a]+(this[a+1]<<16|this[a+2]<<8|this[a+3])},f.prototype.readIntLE=function(a,b,c){a=0|a,b=0|b,c||H(a,b,this.length);for(var d=this[a],e=1,f=0;++f<b&&(e*=256);)d+=this[a+f]*e;return e*=128,d>=e&&(d-=Math.pow(2,8*b)),d},f.prototype.readIntBE=function(a,b,c){a=0|a,b=0|b,c||H(a,b,this.length);for(var d=b,e=1,f=this[a+--d];d>0&&(e*=256);)f+=this[a+--d]*e;return e*=128,f>=e&&(f-=Math.pow(2,8*b)),f},f.prototype.readInt8=function(a,b){return b||H(a,1,this.length),128&this[a]?-1*(255-this[a]+1):this[a]},f.prototype.readInt16LE=function(a,b){b||H(a,2,this.length);var c=this[a]|this[a+1]<<8;return 32768&c?4294901760|c:c},f.prototype.readInt16BE=function(a,b){b||H(a,2,this.length);var c=this[a+1]|this[a]<<8;return 32768&c?4294901760|c:c},f.prototype.readInt32LE=function(a,b){return b||H(a,4,this.length),this[a]|this[a+1]<<8|this[a+2]<<16|this[a+3]<<24},f.prototype.readInt32BE=function(a,b){return b||H(a,4,this.length),this[a]<<24|this[a+1]<<16|this[a+2]<<8|this[a+3]},f.prototype.readFloatLE=function(a,b){return b||H(a,4,this.length),X.read(this,a,!0,23,4)},f.prototype.readFloatBE=function(a,b){return b||H(a,4,this.length),X.read(this,a,!1,23,4)},f.prototype.readDoubleLE=function(a,b){return b||H(a,8,this.length),X.read(this,a,!0,52,8)},f.prototype.readDoubleBE=function(a,b){return b||H(a,8,this.length),X.read(this,a,!1,52,8)},f.prototype.writeUIntLE=function(a,b,c,d){a=+a,b=0|b,c=0|c,d||I(this,a,b,c,Math.pow(2,8*c),0);var e=1,f=0;for(this[b]=255&a;++f<c&&(e*=256);)this[b+f]=a/e&255;return b+c},f.prototype.writeUIntBE=function(a,b,c,d){a=+a,b=0|b,c=0|c,d||I(this,a,b,c,Math.pow(2,8*c),0);var e=c-1,f=1;for(this[b+e]=255&a;--e>=0&&(f*=256);)this[b+e]=a/f&255;return b+c},f.prototype.writeUInt8=function(a,b,c){return a=+a,b=0|b,c||I(this,a,b,1,255,0),f.TYPED_ARRAY_SUPPORT||(a=Math.floor(a)),this[b]=255&a,b+1},f.prototype.writeUInt16LE=function(a,b,c){return a=+a,b=0|b,c||I(this,a,b,2,65535,0),f.TYPED_ARRAY_SUPPORT?(this[b]=255&a,this[b+1]=a>>>8):J(this,a,b,!0),b+2},f.prototype.writeUInt16BE=function(a,b,c){return a=+a,b=0|b,c||I(this,a,b,2,65535,0),f.TYPED_ARRAY_SUPPORT?(this[b]=a>>>8,this[b+1]=255&a):J(this,a,b,!1),b+2},f.prototype.writeUInt32LE=function(a,b,c){return a=+a,b=0|b,c||I(this,a,b,4,4294967295,0),f.TYPED_ARRAY_SUPPORT?(this[b+3]=a>>>24,this[b+2]=a>>>16,this[b+1]=a>>>8,this[b]=255&a):K(this,a,b,!0),b+4},f.prototype.writeUInt32BE=function(a,b,c){return a=+a,b=0|b,c||I(this,a,b,4,4294967295,0),f.TYPED_ARRAY_SUPPORT?(this[b]=a>>>24,this[b+1]=a>>>16,this[b+2]=a>>>8,this[b+3]=255&a):K(this,a,b,!1),b+4},f.prototype.writeIntLE=function(a,b,c,d){if(a=+a,b=0|b,!d){var e=Math.pow(2,8*c-1);I(this,a,b,c,e-1,-e)}var f=0,g=1,h=0>a?1:0;for(this[b]=255&a;++f<c&&(g*=256);)this[b+f]=(a/g>>0)-h&255;return b+c},f.prototype.writeIntBE=function(a,b,c,d){if(a=+a,b=0|b,!d){var e=Math.pow(2,8*c-1);I(this,a,b,c,e-1,-e)}var f=c-1,g=1,h=0>a?1:0;for(this[b+f]=255&a;--f>=0&&(g*=256);)this[b+f]=(a/g>>0)-h&255;return b+c},f.prototype.writeInt8=function(a,b,c){return a=+a,b=0|b,c||I(this,a,b,1,127,-128),f.TYPED_ARRAY_SUPPORT||(a=Math.floor(a)),0>a&&(a=255+a+1),this[b]=255&a,b+1},f.prototype.writeInt16LE=function(a,b,c){return a=+a,b=0|b,c||I(this,a,b,2,32767,-32768),f.TYPED_ARRAY_SUPPORT?(this[b]=255&a,this[b+1]=a>>>8):J(this,a,b,!0),b+2},f.prototype.writeInt16BE=function(a,b,c){return a=+a,b=0|b,c||I(this,a,b,2,32767,-32768),f.TYPED_ARRAY_SUPPORT?(this[b]=a>>>8,this[b+1]=255&a):J(this,a,b,!1),b+2},f.prototype.writeInt32LE=function(a,b,c){return a=+a,b=0|b,c||I(this,a,b,4,2147483647,-2147483648),f.TYPED_ARRAY_SUPPORT?(this[b]=255&a,this[b+1]=a>>>8,this[b+2]=a>>>16,this[b+3]=a>>>24):K(this,a,b,!0),b+4},f.prototype.writeInt32BE=function(a,b,c){return a=+a,b=0|b,c||I(this,a,b,4,2147483647,-2147483648),0>a&&(a=4294967295+a+1),f.TYPED_ARRAY_SUPPORT?(this[b]=a>>>24,this[b+1]=a>>>16,this[b+2]=a>>>8,this[b+3]=255&a):K(this,a,b,!1),b+4},f.prototype.writeFloatLE=function(a,b,c){return M(this,a,b,!0,c)},f.prototype.writeFloatBE=function(a,b,c){return M(this,a,b,!1,c)},f.prototype.writeDoubleLE=function(a,b,c){return N(this,a,b,!0,c)},f.prototype.writeDoubleBE=function(a,b,c){return N(this,a,b,!1,c)},f.prototype.copy=function(a,b,c,d){if(c||(c=0),d||0===d||(d=this.length),b>=a.length&&(b=a.length),b||(b=0),d>0&&c>d&&(d=c),d===c)return 0;if(0===a.length||0===this.length)return 0;if(0>b)throw new RangeError("targetStart out of bounds");if(0>c||c>=this.length)throw new RangeError("sourceStart out of bounds");if(0>d)throw new RangeError("sourceEnd out of bounds");d>this.length&&(d=this.length),a.length-b<d-c&&(d=a.length-b+c);var e,g=d-c;if(this===a&&b>c&&d>b)for(e=g-1;e>=0;e--)a[e+b]=this[e+c];else if(1e3>g||!f.TYPED_ARRAY_SUPPORT)for(e=0;g>e;e++)a[e+b]=this[e+c];else a._set(this.subarray(c,c+g),b);return g},f.prototype.fill=function(a,b,c){if(a||(a=0),b||(b=0),c||(c=this.length),b>c)throw new RangeError("end < start");if(c!==b&&0!==this.length){if(0>b||b>=this.length)throw new RangeError("start out of bounds");if(0>c||c>this.length)throw new RangeError("end out of bounds");var d;if("number"==typeof a)for(d=b;c>d;d++)this[d]=a;else{var e=R(a.toString()),f=e.length;for(d=b;c>d;d++)this[d]=e[d%f]}return this}},f.prototype.toArrayBuffer=function(){if("undefined"!=typeof Uint8Array){if(f.TYPED_ARRAY_SUPPORT)return new f(this).buffer;for(var a=new Uint8Array(this.length),b=0,c=a.length;c>b;b+=1)a[b]=this[b];return a.buffer}throw new TypeError("Buffer.toArrayBuffer not supported in this browser")};var _=f.prototype;f._augment=function(a){return a.constructor=f,a._isBuffer=!0,a._set=a.set,a.get=_.get,a.set=_.set,a.write=_.write,a.toString=_.toString,a.toLocaleString=_.toString,a.toJSON=_.toJSON,a.equals=_.equals,a.compare=_.compare,a.indexOf=_.indexOf,a.copy=_.copy,a.slice=_.slice,a.readUIntLE=_.readUIntLE,a.readUIntBE=_.readUIntBE,a.readUInt8=_.readUInt8,a.readUInt16LE=_.readUInt16LE,a.readUInt16BE=_.readUInt16BE,a.readUInt32LE=_.readUInt32LE,a.readUInt32BE=_.readUInt32BE,a.readIntLE=_.readIntLE,a.readIntBE=_.readIntBE,a.readInt8=_.readInt8,a.readInt16LE=_.readInt16LE,a.readInt16BE=_.readInt16BE,a.readInt32LE=_.readInt32LE,a.readInt32BE=_.readInt32BE,a.readFloatLE=_.readFloatLE,a.readFloatBE=_.readFloatBE,a.readDoubleLE=_.readDoubleLE,a.readDoubleBE=_.readDoubleBE,a.writeUInt8=_.writeUInt8,a.writeUIntLE=_.writeUIntLE,a.writeUIntBE=_.writeUIntBE,a.writeUInt16LE=_.writeUInt16LE,a.writeUInt16BE=_.writeUInt16BE,a.writeUInt32LE=_.writeUInt32LE,a.writeUInt32BE=_.writeUInt32BE,a.writeIntLE=_.writeIntLE,a.writeIntBE=_.writeIntBE,a.writeInt8=_.writeInt8,a.writeInt16LE=_.writeInt16LE,a.writeInt16BE=_.writeInt16BE,a.writeInt32LE=_.writeInt32LE,a.writeInt32BE=_.writeInt32BE,a.writeFloatLE=_.writeFloatLE,a.writeFloatBE=_.writeFloatBE,a.writeDoubleLE=_.writeDoubleLE,a.writeDoubleBE=_.writeDoubleBE,a.fill=_.fill,a.inspect=_.inspect,a.toArrayBuffer=_.toArrayBuffer,a};var aa=/[^+\/0-9A-Za-z-_]/g}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"base64-js":97,ieee754:194,isarray:131}],131:[function(a,b,c){var d={}.toString;b.exports=Array.isArray||function(a){return"[object Array]"==d.call(a)}},{}],132:[function(a,b,c){var d={utf8:{stringToBytes:function(a){return d.bin.stringToBytes(unescape(encodeURIComponent(a)))},bytesToString:function(a){return decodeURIComponent(escape(d.bin.bytesToString(a)))}},bin:{stringToBytes:function(a){for(var b=[],c=0;c<a.length;c++)b.push(255&a.charCodeAt(c));return b},bytesToString:function(a){for(var b=[],c=0;c<a.length;c++)b.push(String.fromCharCode(a[c]));return b.join("")}}};b.exports=d},{}],133:[function(a,b,c){(function(c){function d(a){e.call(this),this.hashMode="string"==typeof a,this.hashMode?this[a]=this._finalOrDigest:this["final"]=this._finalOrDigest,this._decoder=null,this._encoding=null}var e=a("stream").Transform,f=a("inherits"),g=a("string_decoder").StringDecoder;b.exports=d,f(d,e),d.prototype.update=function(a,b,d){"string"==typeof a&&(a=new c(a,b));var e=this._update(a);return this.hashMode?this:(d&&(e=this._toString(e,d)),e)},d.prototype.setAutoPadding=function(){},d.prototype.getAuthTag=function(){throw new Error("trying to get auth tag in unsupported state")},d.prototype.setAuthTag=function(){throw new Error("trying to set auth tag in unsupported state")},d.prototype.setAAD=function(){throw new Error("trying to set aad in unsupported state")},d.prototype._transform=function(a,b,c){var d;try{this.hashMode?this._update(a):this.push(this._update(a))}catch(e){d=e}finally{c(d)}},d.prototype._flush=function(a){var b;try{this.push(this._final())}catch(c){b=c}finally{a(b)}},d.prototype._finalOrDigest=function(a){var b=this._final()||new c("");return a&&(b=this._toString(b,a,!0)),b},d.prototype._toString=function(a,b,c){if(this._decoder||(this._decoder=new g(b),this._encoding=b),this._encoding!==b)throw new Error("can't switch encodings");var d=this._decoder.write(a);return c&&(d+=this._decoder.end()),d}}).call(this,a("buffer").Buffer)},{buffer:130,inherits:196,stream:254,string_decoder:255}],134:[function(a,b,c){(function(a){function b(a){return Array.isArray?Array.isArray(a):"[object Array]"===q(a)}function d(a){return"boolean"==typeof a}function e(a){return null===a}function f(a){return null==a}function g(a){return"number"==typeof a}function h(a){return"string"==typeof a}function i(a){return"symbol"==typeof a}function j(a){return void 0===a}function k(a){return"[object RegExp]"===q(a)}function l(a){return"object"==typeof a&&null!==a}function m(a){return"[object Date]"===q(a)}function n(a){return"[object Error]"===q(a)||a instanceof Error}function o(a){return"function"==typeof a}function p(a){return null===a||"boolean"==typeof a||"number"==typeof a||"string"==typeof a||"symbol"==typeof a||"undefined"==typeof a}function q(a){return Object.prototype.toString.call(a)}c.isArray=b,c.isBoolean=d,c.isNull=e,c.isNullOrUndefined=f,c.isNumber=g,c.isString=h,c.isSymbol=i,c.isUndefined=j,c.isRegExp=k,c.isObject=l,c.isDate=m,c.isError=n,c.isFunction=o,c.isPrimitive=p,c.isBuffer=a.isBuffer}).call(this,{isBuffer:a("../../is-buffer/index.js")})},{"../../is-buffer/index.js":197}],135:[function(a,b,c){(function(c){function d(a){this.curveType=h[a],this.curveType||(this.curveType={name:a}),this.curve=new f.ec(this.curveType.name),this.keys=void 0}function e(a,b,d){Array.isArray(a)||(a=a.toArray());var e=new c(a);if(d&&e.length<d){var f=new c(d-e.length);f.fill(0),e=c.concat([f,e])}return b?e.toString(b):e}var f=a("elliptic"),g=a("bn.js");b.exports=function(a){return new d(a)};var h={secp256k1:{name:"secp256k1",byteLength:32},secp224r1:{name:"p224",byteLength:28},prime256v1:{name:"p256",byteLength:32},prime192v1:{name:"p192",byteLength:24},ed25519:{name:"ed25519",byteLength:32},secp384r1:{name:"p384",byteLength:48},secp521r1:{name:"p521",byteLength:66}};h.p224=h.secp224r1,h.p256=h.secp256r1=h.prime256v1,h.p192=h.secp192r1=h.prime192v1,h.p384=h.secp384r1,h.p521=h.secp521r1,d.prototype.generateKeys=function(a,b){return this.keys=this.curve.genKeyPair(),this.getPublicKey(a,b)},d.prototype.computeSecret=function(a,b,d){b=b||"utf8",c.isBuffer(a)||(a=new c(a,b));var f=this.curve.keyFromPublic(a).getPublic(),g=f.mul(this.keys.getPrivate()).getX();return e(g,d,this.curveType.byteLength)},d.prototype.getPublicKey=function(a,b){var c=this.keys.getPublic("compressed"===b,!0);return"hybrid"===b&&(c[c.length-1]%2?c[0]=7:c[0]=6),e(c,a)},d.prototype.getPrivateKey=function(a){return e(this.keys.getPrivate(),a)},d.prototype.setPublicKey=function(a,b){return b=b||"utf8",c.isBuffer(a)||(a=new c(a,b)),this.keys._importPublic(a),this},d.prototype.setPrivateKey=function(a,b){b=b||"utf8",c.isBuffer(a)||(a=new c(a,b));var d=new g(a);return d=d.toString(16),this.keys._importPrivate(d),this}}).call(this,a("buffer").Buffer)},{"bn.js":99,buffer:130,elliptic:154}],136:[function(a,b,c){(function(c){"use strict";function d(a){j.call(this,"digest"),this._hash=a,this.buffers=[]}function e(a){j.call(this,"digest"),this._hash=a}var f=a("inherits"),g=a("./md5"),h=a("ripemd160"),i=a("sha.js"),j=a("cipher-base");f(d,j),d.prototype._update=function(a){this.buffers.push(a)},d.prototype._final=function(){var a=c.concat(this.buffers),b=this._hash(a);return this.buffers=null,b},f(e,j),e.prototype._update=function(a){this._hash.update(a)},e.prototype._final=function(){return this._hash.digest()},b.exports=function(a){return a=a.toLowerCase(),"md5"===a?new d(g):new e("rmd160"===a||"ripemd160"===a?new h:i(a))}}).call(this,a("buffer").Buffer)},{"./md5":138,buffer:130,"cipher-base":133,inherits:196,ripemd160:244,"sha.js":247}],137:[function(a,b,c){(function(a){"use strict";function c(b){if(b.length%d!==0){var c=b.length+(d-b.length%d);b=a.concat([b,e],c)}for(var f=new Array(b.length>>>2),g=0,h=0;g<b.length;g+=d,h++)f[h]=b.readInt32LE(g);return f}var d=4,e=new a(d);e.fill(0);var f=8,g=16;b.exports=function(b,d){var e=d(c(b),b.length*f);b=new a(g);for(var h=0;h<e.length;h++)b.writeInt32LE(e[h],h<<2,!0);return b}}).call(this,a("buffer").Buffer)},{buffer:130}],138:[function(a,b,c){"use strict";function d(a,b){a[b>>5]|=128<<b%32,a[(b+64>>>9<<4)+14]=b;for(var c=1732584193,d=-271733879,e=-1732584194,k=271733878,l=0;l<a.length;l+=16){var m=c,n=d,o=e,p=k;c=f(c,d,e,k,a[l+0],7,-680876936),k=f(k,c,d,e,a[l+1],12,-389564586),e=f(e,k,c,d,a[l+2],17,606105819),d=f(d,e,k,c,a[l+3],22,-1044525330),c=f(c,d,e,k,a[l+4],7,-176418897),k=f(k,c,d,e,a[l+5],12,1200080426),e=f(e,k,c,d,a[l+6],17,-1473231341),d=f(d,e,k,c,a[l+7],22,-45705983),c=f(c,d,e,k,a[l+8],7,1770035416),k=f(k,c,d,e,a[l+9],12,-1958414417),e=f(e,k,c,d,a[l+10],17,-42063),d=f(d,e,k,c,a[l+11],22,-1990404162),c=f(c,d,e,k,a[l+12],7,1804603682),k=f(k,c,d,e,a[l+13],12,-40341101),e=f(e,k,c,d,a[l+14],17,-1502002290),d=f(d,e,k,c,a[l+15],22,1236535329),c=g(c,d,e,k,a[l+1],5,-165796510),k=g(k,c,d,e,a[l+6],9,-1069501632),e=g(e,k,c,d,a[l+11],14,643717713),d=g(d,e,k,c,a[l+0],20,-373897302),c=g(c,d,e,k,a[l+5],5,-701558691),k=g(k,c,d,e,a[l+10],9,38016083),e=g(e,k,c,d,a[l+15],14,-660478335),d=g(d,e,k,c,a[l+4],20,-405537848),c=g(c,d,e,k,a[l+9],5,568446438),k=g(k,c,d,e,a[l+14],9,-1019803690),e=g(e,k,c,d,a[l+3],14,-187363961),d=g(d,e,k,c,a[l+8],20,1163531501),c=g(c,d,e,k,a[l+13],5,-1444681467),k=g(k,c,d,e,a[l+2],9,-51403784),e=g(e,k,c,d,a[l+7],14,1735328473),d=g(d,e,k,c,a[l+12],20,-1926607734),c=h(c,d,e,k,a[l+5],4,-378558),k=h(k,c,d,e,a[l+8],11,-2022574463),e=h(e,k,c,d,a[l+11],16,1839030562),d=h(d,e,k,c,a[l+14],23,-35309556),c=h(c,d,e,k,a[l+1],4,-1530992060),k=h(k,c,d,e,a[l+4],11,1272893353),e=h(e,k,c,d,a[l+7],16,-155497632),d=h(d,e,k,c,a[l+10],23,-1094730640),c=h(c,d,e,k,a[l+13],4,681279174),k=h(k,c,d,e,a[l+0],11,-358537222),e=h(e,k,c,d,a[l+3],16,-722521979),d=h(d,e,k,c,a[l+6],23,76029189),c=h(c,d,e,k,a[l+9],4,-640364487),k=h(k,c,d,e,a[l+12],11,-421815835),e=h(e,k,c,d,a[l+15],16,530742520),d=h(d,e,k,c,a[l+2],23,-995338651),c=i(c,d,e,k,a[l+0],6,-198630844),k=i(k,c,d,e,a[l+7],10,1126891415),e=i(e,k,c,d,a[l+14],15,-1416354905),d=i(d,e,k,c,a[l+5],21,-57434055),c=i(c,d,e,k,a[l+12],6,1700485571),k=i(k,c,d,e,a[l+3],10,-1894986606),e=i(e,k,c,d,a[l+10],15,-1051523),d=i(d,e,k,c,a[l+1],21,-2054922799),c=i(c,d,e,k,a[l+8],6,1873313359),k=i(k,c,d,e,a[l+15],10,-30611744),e=i(e,k,c,d,a[l+6],15,-1560198380),d=i(d,e,k,c,a[l+13],21,1309151649),c=i(c,d,e,k,a[l+4],6,-145523070),k=i(k,c,d,e,a[l+11],10,-1120210379),e=i(e,k,c,d,a[l+2],15,718787259),d=i(d,e,k,c,a[l+9],21,-343485551),c=j(c,m),d=j(d,n),e=j(e,o),k=j(k,p)}return[c,d,e,k]}function e(a,b,c,d,e,f){return j(k(j(j(b,a),j(d,f)),e),c)}function f(a,b,c,d,f,g,h){return e(b&c|~b&d,a,b,f,g,h)}function g(a,b,c,d,f,g,h){return e(b&d|c&~d,a,b,f,g,h)}function h(a,b,c,d,f,g,h){return e(b^c^d,a,b,f,g,h)}function i(a,b,c,d,f,g,h){return e(c^(b|~d),a,b,f,g,h)}function j(a,b){var c=(65535&a)+(65535&b),d=(a>>16)+(b>>16)+(c>>16);return d<<16|65535&c}function k(a,b){return a<<b|a>>>32-b}var l=a("./make-hash");b.exports=function(a){return l(a,d)}},{"./make-hash":137}],139:[function(a,b,c){"use strict";function d(a,b){g.call(this,"digest"),"string"==typeof b&&(b=h.from(b));var c="sha512"===a||"sha384"===a?128:64;if(this._alg=a,this._key=b,b.length>c){var d="rmd160"===a?new j:k(a);b=d.update(b).digest()}else b.length<c&&(b=h.concat([b,l],c));for(var e=this._ipad=h.allocUnsafe(c),f=this._opad=h.allocUnsafe(c),i=0;c>i;i++)e[i]=54^b[i],f[i]=92^b[i];this._hash="rmd160"===a?new j:k(a),this._hash.update(e)}var e=a("inherits"),f=a("./legacy"),g=a("cipher-base"),h=a("safe-buffer").Buffer,i=a("create-hash/md5"),j=a("ripemd160"),k=a("sha.js"),l=h.alloc(128);e(d,g),d.prototype._update=function(a){this._hash.update(a)},d.prototype._final=function(){var a=this._hash.digest(),b="rmd160"===this._alg?new j:k(this._alg);return b.update(this._opad).update(a).digest()},b.exports=function(a,b){return a=a.toLowerCase(),"rmd160"===a||"ripemd160"===a?new d("rmd160",b):"md5"===a?new f(i,b):new d(a,b)}},{"./legacy":140,"cipher-base":133,"create-hash/md5":138,inherits:196,ripemd160:244,"safe-buffer":245,"sha.js":247}],140:[function(a,b,c){"use strict";function d(a,b){g.call(this,"digest"),"string"==typeof b&&(b=f.from(b)),this._alg=a,this._key=b,b.length>i?b=a(b):b.length<i&&(b=f.concat([b,h],i));for(var c=this._ipad=f.allocUnsafe(i),d=this._opad=f.allocUnsafe(i),e=0;i>e;e++)c[e]=54^b[e],d[e]=92^b[e];this._hash=[c]}var e=a("inherits"),f=a("safe-buffer").Buffer,g=a("cipher-base"),h=f.alloc(128),i=64;e(d,g),d.prototype._update=function(a){this._hash.push(a)},d.prototype._final=function(){var a=this._alg(f.concat(this._hash));return this._alg(f.concat([this._opad,a]))},b.exports=d},{"cipher-base":133,inherits:196,"safe-buffer":245}],141:[function(a,b,c){!function(){var a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",c={rotl:function(a,b){return a<<b|a>>>32-b},rotr:function(a,b){return a<<32-b|a>>>b},endian:function(a){if(a.constructor==Number)return 16711935&c.rotl(a,8)|4278255360&c.rotl(a,24);for(var b=0;b<a.length;b++)a[b]=c.endian(a[b]);return a},randomBytes:function(a){for(var b=[];a>0;a--)b.push(Math.floor(256*Math.random()));return b},bytesToWords:function(a){for(var b=[],c=0,d=0;c<a.length;c++,d+=8)b[d>>>5]|=a[c]<<24-d%32;return b},wordsToBytes:function(a){for(var b=[],c=0;c<32*a.length;c+=8)b.push(a[c>>>5]>>>24-c%32&255);return b},bytesToHex:function(a){for(var b=[],c=0;c<a.length;c++)b.push((a[c]>>>4).toString(16)),b.push((15&a[c]).toString(16));return b.join("")},hexToBytes:function(a){for(var b=[],c=0;c<a.length;c+=2)b.push(parseInt(a.substr(c,2),16));return b},bytesToBase64:function(b){for(var c=[],d=0;d<b.length;d+=3)for(var e=b[d]<<16|b[d+1]<<8|b[d+2],f=0;4>f;f++)8*d+6*f<=8*b.length?c.push(a.charAt(e>>>6*(3-f)&63)):c.push("=");
return c.join("")},base64ToBytes:function(b){b=b.replace(/[^A-Z0-9+\/]/gi,"");for(var c=[],d=0,e=0;d<b.length;e=++d%4)0!=e&&c.push((a.indexOf(b.charAt(d-1))&Math.pow(2,-2*e+8)-1)<<2*e|a.indexOf(b.charAt(d))>>>6-2*e);return c}};b.exports=c}()},{}],142:[function(a,b,c){"use strict";c.randomBytes=c.rng=c.pseudoRandomBytes=c.prng=a("randombytes"),c.createHash=c.Hash=a("create-hash"),c.createHmac=c.Hmac=a("create-hmac");var d=["sha1","sha224","sha256","sha384","sha512","md5","rmd160"].concat(Object.keys(a("browserify-sign/algos")));c.getHashes=function(){return d};var e=a("pbkdf2");c.pbkdf2=e.pbkdf2,c.pbkdf2Sync=e.pbkdf2Sync;var f=a("browserify-cipher");["Cipher","createCipher","Cipheriv","createCipheriv","Decipher","createDecipher","Decipheriv","createDecipheriv","getCiphers","listCiphers"].forEach(function(a){c[a]=f[a]});var g=a("diffie-hellman");["DiffieHellmanGroup","createDiffieHellmanGroup","getDiffieHellman","createDiffieHellman","DiffieHellman"].forEach(function(a){c[a]=g[a]});var h=a("browserify-sign");["createSign","Sign","createVerify","Verify"].forEach(function(a){c[a]=h[a]}),c.createECDH=a("create-ecdh");var i=a("public-encrypt");["publicEncrypt","privateEncrypt","publicDecrypt","privateDecrypt"].forEach(function(a){c[a]=i[a]}),["createCredentials"].forEach(function(a){c[a]=function(){throw new Error(["sorry, "+a+" is not implemented yet","we accept pull requests","https://github.com/crypto-browserify/crypto-browserify"].join("\n"))}})},{"browserify-cipher":117,"browserify-sign":125,"browserify-sign/algos":122,"create-ecdh":135,"create-hash":136,"create-hmac":139,"diffie-hellman":150,pbkdf2:209,"public-encrypt":216,randombytes:227}],143:[function(a,b,c){"use strict";c.utils=a("./des/utils"),c.Cipher=a("./des/cipher"),c.DES=a("./des/des"),c.CBC=a("./des/cbc"),c.EDE=a("./des/ede")},{"./des/cbc":144,"./des/cipher":145,"./des/des":146,"./des/ede":147,"./des/utils":148}],144:[function(a,b,c){"use strict";function d(a){f.equal(a.length,8,"Invalid IV length"),this.iv=new Array(8);for(var b=0;b<this.iv.length;b++)this.iv[b]=a[b]}function e(a){function b(b){a.call(this,b),this._cbcInit()}g(b,a);for(var c=Object.keys(h),d=0;d<c.length;d++){var e=c[d];b.prototype[e]=h[e]}return b.create=function(a){return new b(a)},b}var f=a("minimalistic-assert"),g=a("inherits"),h={};c.instantiate=e,h._cbcInit=function(){var a=new d(this.options.iv);this._cbcState=a},h._update=function(a,b,c,d){var e=this._cbcState,f=this.constructor.super_.prototype,g=e.iv;if("encrypt"===this.type){for(var h=0;h<this.blockSize;h++)g[h]^=a[b+h];f._update.call(this,g,0,c,d);for(var h=0;h<this.blockSize;h++)g[h]=c[d+h]}else{f._update.call(this,a,b,c,d);for(var h=0;h<this.blockSize;h++)c[d+h]^=g[h];for(var h=0;h<this.blockSize;h++)g[h]=a[b+h]}}},{inherits:196,"minimalistic-assert":200}],145:[function(a,b,c){"use strict";function d(a){this.options=a,this.type=this.options.type,this.blockSize=8,this._init(),this.buffer=new Array(this.blockSize),this.bufferOff=0}var e=a("minimalistic-assert");b.exports=d,d.prototype._init=function(){},d.prototype.update=function(a){return 0===a.length?[]:"decrypt"===this.type?this._updateDecrypt(a):this._updateEncrypt(a)},d.prototype._buffer=function(a,b){for(var c=Math.min(this.buffer.length-this.bufferOff,a.length-b),d=0;c>d;d++)this.buffer[this.bufferOff+d]=a[b+d];return this.bufferOff+=c,c},d.prototype._flushBuffer=function(a,b){return this._update(this.buffer,0,a,b),this.bufferOff=0,this.blockSize},d.prototype._updateEncrypt=function(a){var b=0,c=0,d=(this.bufferOff+a.length)/this.blockSize|0,e=new Array(d*this.blockSize);0!==this.bufferOff&&(b+=this._buffer(a,b),this.bufferOff===this.buffer.length&&(c+=this._flushBuffer(e,c)));for(var f=a.length-(a.length-b)%this.blockSize;f>b;b+=this.blockSize)this._update(a,b,e,c),c+=this.blockSize;for(;b<a.length;b++,this.bufferOff++)this.buffer[this.bufferOff]=a[b];return e},d.prototype._updateDecrypt=function(a){for(var b=0,c=0,d=Math.ceil((this.bufferOff+a.length)/this.blockSize)-1,e=new Array(d*this.blockSize);d>0;d--)b+=this._buffer(a,b),c+=this._flushBuffer(e,c);return b+=this._buffer(a,b),e},d.prototype["final"]=function(a){var b;a&&(b=this.update(a));var c;return c="encrypt"===this.type?this._finalEncrypt():this._finalDecrypt(),b?b.concat(c):c},d.prototype._pad=function(a,b){if(0===b)return!1;for(;b<a.length;)a[b++]=0;return!0},d.prototype._finalEncrypt=function(){if(!this._pad(this.buffer,this.bufferOff))return[];var a=new Array(this.blockSize);return this._update(this.buffer,0,a,0),a},d.prototype._unpad=function(a){return a},d.prototype._finalDecrypt=function(){e.equal(this.bufferOff,this.blockSize,"Not enough data to decrypt");var a=new Array(this.blockSize);return this._flushBuffer(a,0),this._unpad(a)}},{"minimalistic-assert":200}],146:[function(a,b,c){"use strict";function d(){this.tmp=new Array(2),this.keys=null}function e(a){j.call(this,a);var b=new d;this._desState=b,this.deriveKeys(b,a.key)}var f=a("minimalistic-assert"),g=a("inherits"),h=a("../des"),i=h.utils,j=h.Cipher;g(e,j),b.exports=e,e.create=function(a){return new e(a)};var k=[1,1,2,2,2,2,2,2,1,2,2,2,2,2,2,1];e.prototype.deriveKeys=function(a,b){a.keys=new Array(32),f.equal(b.length,this.blockSize,"Invalid key length");var c=i.readUInt32BE(b,0),d=i.readUInt32BE(b,4);i.pc1(c,d,a.tmp,0),c=a.tmp[0],d=a.tmp[1];for(var e=0;e<a.keys.length;e+=2){var g=k[e>>>1];c=i.r28shl(c,g),d=i.r28shl(d,g),i.pc2(c,d,a.keys,e)}},e.prototype._update=function(a,b,c,d){var e=this._desState,f=i.readUInt32BE(a,b),g=i.readUInt32BE(a,b+4);i.ip(f,g,e.tmp,0),f=e.tmp[0],g=e.tmp[1],"encrypt"===this.type?this._encrypt(e,f,g,e.tmp,0):this._decrypt(e,f,g,e.tmp,0),f=e.tmp[0],g=e.tmp[1],i.writeUInt32BE(c,f,d),i.writeUInt32BE(c,g,d+4)},e.prototype._pad=function(a,b){for(var c=a.length-b,d=b;d<a.length;d++)a[d]=c;return!0},e.prototype._unpad=function(a){for(var b=a[a.length-1],c=a.length-b;c<a.length;c++)f.equal(a[c],b);return a.slice(0,a.length-b)},e.prototype._encrypt=function(a,b,c,d,e){for(var f=b,g=c,h=0;h<a.keys.length;h+=2){var j=a.keys[h],k=a.keys[h+1];i.expand(g,a.tmp,0),j^=a.tmp[0],k^=a.tmp[1];var l=i.substitute(j,k),m=i.permute(l),n=g;g=(f^m)>>>0,f=n}i.rip(g,f,d,e)},e.prototype._decrypt=function(a,b,c,d,e){for(var f=c,g=b,h=a.keys.length-2;h>=0;h-=2){var j=a.keys[h],k=a.keys[h+1];i.expand(f,a.tmp,0),j^=a.tmp[0],k^=a.tmp[1];var l=i.substitute(j,k),m=i.permute(l),n=f;f=(g^m)>>>0,g=n}i.rip(f,g,d,e)}},{"../des":143,inherits:196,"minimalistic-assert":200}],147:[function(a,b,c){"use strict";function d(a,b){f.equal(b.length,24,"Invalid key length");var c=b.slice(0,8),d=b.slice(8,16),e=b.slice(16,24);"encrypt"===a?this.ciphers=[j.create({type:"encrypt",key:c}),j.create({type:"decrypt",key:d}),j.create({type:"encrypt",key:e})]:this.ciphers=[j.create({type:"decrypt",key:e}),j.create({type:"encrypt",key:d}),j.create({type:"decrypt",key:c})]}function e(a){i.call(this,a);var b=new d(this.type,this.options.key);this._edeState=b}var f=a("minimalistic-assert"),g=a("inherits"),h=a("../des"),i=h.Cipher,j=h.DES;g(e,i),b.exports=e,e.create=function(a){return new e(a)},e.prototype._update=function(a,b,c,d){var e=this._edeState;e.ciphers[0]._update(a,b,c,d),e.ciphers[1]._update(c,d,c,d),e.ciphers[2]._update(c,d,c,d)},e.prototype._pad=j.prototype._pad,e.prototype._unpad=j.prototype._unpad},{"../des":143,inherits:196,"minimalistic-assert":200}],148:[function(a,b,c){"use strict";c.readUInt32BE=function(a,b){var c=a[0+b]<<24|a[1+b]<<16|a[2+b]<<8|a[3+b];return c>>>0},c.writeUInt32BE=function(a,b,c){a[0+c]=b>>>24,a[1+c]=b>>>16&255,a[2+c]=b>>>8&255,a[3+c]=255&b},c.ip=function(a,b,c,d){for(var e=0,f=0,g=6;g>=0;g-=2){for(var h=0;24>=h;h+=8)e<<=1,e|=b>>>h+g&1;for(var h=0;24>=h;h+=8)e<<=1,e|=a>>>h+g&1}for(var g=6;g>=0;g-=2){for(var h=1;25>=h;h+=8)f<<=1,f|=b>>>h+g&1;for(var h=1;25>=h;h+=8)f<<=1,f|=a>>>h+g&1}c[d+0]=e>>>0,c[d+1]=f>>>0},c.rip=function(a,b,c,d){for(var e=0,f=0,g=0;4>g;g++)for(var h=24;h>=0;h-=8)e<<=1,e|=b>>>h+g&1,e<<=1,e|=a>>>h+g&1;for(var g=4;8>g;g++)for(var h=24;h>=0;h-=8)f<<=1,f|=b>>>h+g&1,f<<=1,f|=a>>>h+g&1;c[d+0]=e>>>0,c[d+1]=f>>>0},c.pc1=function(a,b,c,d){for(var e=0,f=0,g=7;g>=5;g--){for(var h=0;24>=h;h+=8)e<<=1,e|=b>>h+g&1;for(var h=0;24>=h;h+=8)e<<=1,e|=a>>h+g&1}for(var h=0;24>=h;h+=8)e<<=1,e|=b>>h+g&1;for(var g=1;3>=g;g++){for(var h=0;24>=h;h+=8)f<<=1,f|=b>>h+g&1;for(var h=0;24>=h;h+=8)f<<=1,f|=a>>h+g&1}for(var h=0;24>=h;h+=8)f<<=1,f|=a>>h+g&1;c[d+0]=e>>>0,c[d+1]=f>>>0},c.r28shl=function(a,b){return a<<b&268435455|a>>>28-b};var d=[14,11,17,4,27,23,25,0,13,22,7,18,5,9,16,24,2,20,12,21,1,8,15,26,15,4,25,19,9,1,26,16,5,11,23,8,12,7,17,0,22,3,10,14,6,20,27,24];c.pc2=function(a,b,c,e){for(var f=0,g=0,h=d.length>>>1,i=0;h>i;i++)f<<=1,f|=a>>>d[i]&1;for(var i=h;i<d.length;i++)g<<=1,g|=b>>>d[i]&1;c[e+0]=f>>>0,c[e+1]=g>>>0},c.expand=function(a,b,c){var d=0,e=0;d=(1&a)<<5|a>>>27;for(var f=23;f>=15;f-=4)d<<=6,d|=a>>>f&63;for(var f=11;f>=3;f-=4)e|=a>>>f&63,e<<=6;e|=(31&a)<<1|a>>>31,b[c+0]=d>>>0,b[c+1]=e>>>0};var e=[14,0,4,15,13,7,1,4,2,14,15,2,11,13,8,1,3,10,10,6,6,12,12,11,5,9,9,5,0,3,7,8,4,15,1,12,14,8,8,2,13,4,6,9,2,1,11,7,15,5,12,11,9,3,7,14,3,10,10,0,5,6,0,13,15,3,1,13,8,4,14,7,6,15,11,2,3,8,4,14,9,12,7,0,2,1,13,10,12,6,0,9,5,11,10,5,0,13,14,8,7,10,11,1,10,3,4,15,13,4,1,2,5,11,8,6,12,7,6,12,9,0,3,5,2,14,15,9,10,13,0,7,9,0,14,9,6,3,3,4,15,6,5,10,1,2,13,8,12,5,7,14,11,12,4,11,2,15,8,1,13,1,6,10,4,13,9,0,8,6,15,9,3,8,0,7,11,4,1,15,2,14,12,3,5,11,10,5,14,2,7,12,7,13,13,8,14,11,3,5,0,6,6,15,9,0,10,3,1,4,2,7,8,2,5,12,11,1,12,10,4,14,15,9,10,3,6,15,9,0,0,6,12,10,11,1,7,13,13,8,15,9,1,4,3,5,14,11,5,12,2,7,8,2,4,14,2,14,12,11,4,2,1,12,7,4,10,7,11,13,6,1,8,5,5,0,3,15,15,10,13,3,0,9,14,8,9,6,4,11,2,8,1,12,11,7,10,1,13,14,7,2,8,13,15,6,9,15,12,0,5,9,6,10,3,4,0,5,14,3,12,10,1,15,10,4,15,2,9,7,2,12,6,9,8,5,0,6,13,1,3,13,4,14,14,0,7,11,5,3,11,8,9,4,14,3,15,2,5,12,2,9,8,5,12,15,3,10,7,11,0,14,4,1,10,7,1,6,13,0,11,8,6,13,4,13,11,0,2,11,14,7,15,4,0,9,8,1,13,10,3,14,12,3,9,5,7,12,5,2,10,15,6,8,1,6,1,6,4,11,11,13,13,8,12,1,3,4,7,10,14,7,10,9,15,5,6,0,8,15,0,14,5,2,9,3,2,12,13,1,2,15,8,13,4,8,6,10,15,3,11,7,1,4,10,12,9,5,3,6,14,11,5,0,0,14,12,9,7,2,7,2,11,1,4,14,1,7,9,4,12,10,14,8,2,13,0,15,6,12,10,9,13,0,15,3,3,5,5,6,8,11];c.substitute=function(a,b){for(var c=0,d=0;4>d;d++){var f=a>>>18-6*d&63,g=e[64*d+f];c<<=4,c|=g}for(var d=0;4>d;d++){var f=b>>>18-6*d&63,g=e[256+64*d+f];c<<=4,c|=g}return c>>>0};var f=[16,25,12,11,3,20,4,15,31,17,9,6,27,14,1,22,30,24,8,18,0,5,29,23,13,19,2,26,10,21,28,7];c.permute=function(a){for(var b=0,c=0;c<f.length;c++)b<<=1,b|=a>>>f[c]&1;return b>>>0},c.padSplit=function(a,b,c){for(var d=a.toString(2);d.length<b;)d="0"+d;for(var e=[],f=0;b>f;f+=c)e.push(d.slice(f,f+c));return e.join(" ")}},{}],149:[function(a,b,c){function d(a){return a.replace(/[^\u0000-\u007e]/g,function(a){return f[a]||a})}c.remove=d;for(var e=[{base:" ",chars:""},{base:"0",chars:""},{base:"A",chars:""},{base:"AA",chars:""},{base:"AE",chars:""},{base:"AO",chars:""},{base:"AU",chars:""},{base:"AV",chars:""},{base:"AY",chars:""},{base:"B",chars:""},{base:"C",chars:"C"},{base:"D",chars:""},{base:"Dh",chars:""},{base:"DZ",chars:""},{base:"Dz",chars:""},{base:"E",chars:""},{base:"F",chars:""},{base:"G",chars:""},{base:"H",chars:""},{base:"I",chars:""},{base:"J",chars:""},{base:"K",chars:""},{base:"L",chars:""},{base:"LJ",chars:""},{base:"Lj",chars:""},{base:"M",chars:""},{base:"N",chars:""},{base:"NJ",chars:""},{base:"Nj",chars:""},{base:"O",chars:""},{base:"OE",chars:""},{base:"OI",chars:""},{base:"OO",chars:""},{base:"OU",chars:""},{base:"P",chars:""},{base:"Q",chars:""},{base:"R",chars:""},{base:"S",chars:""},{base:"T",chars:""},{base:"Th",chars:""},{base:"TZ",chars:""},{base:"U",chars:""},{base:"V",chars:""},{base:"VY",chars:""},{base:"W",chars:""},{base:"X",chars:""},{base:"Y",chars:""},{base:"Z",chars:""},{base:"a",chars:""},{base:"aa",chars:""},{base:"ae",chars:""},{base:"ao",chars:""},{base:"au",chars:""},{base:"av",chars:""},{base:"ay",chars:""},{base:"b",chars:""},{base:"c",chars:""},{base:"d",chars:""},{base:"dh",chars:""},{base:"dz",chars:""},{base:"e",chars:""},{base:"f",chars:""},{base:"ff",chars:""},{base:"fi",chars:""},{base:"fl",chars:""},{base:"ffi",chars:""},{base:"ffl",chars:""},{base:"g",chars:""},{base:"h",chars:""},{base:"hv",chars:""},{base:"i",chars:""},{base:"j",chars:""},{base:"k",chars:""},{base:"l",chars:""},{base:"lj",chars:""},{base:"m",chars:""},{base:"n",chars:""},{base:"nj",chars:""},{base:"o",chars:""},{base:"oe",chars:""},{base:"oi",chars:""},{base:"oo",chars:""},{base:"ou",chars:""},{base:"p",chars:""},{base:"q",chars:""},{base:"r",chars:""},{base:"s",chars:""},{base:"ss",chars:""},{base:"t",chars:""},{base:"th",chars:""},{base:"tz",chars:""},{base:"u",chars:""},{base:"v",chars:""},{base:"vy",chars:""},{base:"w",chars:""},{base:"x",chars:""},{base:"y",chars:""},{base:"z",chars:""}],f={},g=0;g<e.length;g+=1)for(var h=e[g].chars,i=0;i<h.length;i+=1)f[h[i]]=e[g].base;c.replacementList=e,c.diacriticsMap=f},{}],150:[function(a,b,c){(function(b){function d(a){var c=new b(g[a].prime,"hex"),d=new b(g[a].gen,"hex");return new h(c,d)}function e(a,c,d,g){return b.isBuffer(c)||void 0===i[c]?e(a,"binary",c,d):(c=c||"binary",g=g||"binary",d=d||new b([2]),b.isBuffer(d)||(d=new b(d,g)),"number"==typeof a?new h(f(a,d),d,!0):(b.isBuffer(a)||(a=new b(a,c)),new h(a,d,!0)))}var f=a("./lib/generatePrime"),g=a("./lib/primes.json"),h=a("./lib/dh"),i={binary:!0,hex:!0,base64:!0};c.DiffieHellmanGroup=c.createDiffieHellmanGroup=c.getDiffieHellman=d,c.createDiffieHellman=c.DiffieHellman=e}).call(this,a("buffer").Buffer)},{"./lib/dh":151,"./lib/generatePrime":152,"./lib/primes.json":153,buffer:130}],151:[function(a,b,c){(function(c){function d(a,b){return b=b||"utf8",c.isBuffer(a)||(a=new c(a,b)),this._pub=new i(a),this}function e(a,b){return b=b||"utf8",c.isBuffer(a)||(a=new c(a,b)),this._priv=new i(a),this}function f(a,b){var c=b.toString("hex"),d=[c,a.toString(16)].join("_");if(d in s)return s[d];var e=0;if(a.isEven()||!q.simpleSieve||!q.fermatTest(a)||!k.test(a))return e+=1,e+="02"===c||"05"===c?8:4,s[d]=e,e;k.test(a.shrn(1))||(e+=2);var f;switch(c){case"02":a.mod(l).cmp(m)&&(e+=8);break;case"05":f=a.mod(n),f.cmp(o)&&f.cmp(p)&&(e+=8);break;default:e+=4}return s[d]=e,e}function g(a,b,c){this.setGenerator(b),this.__prime=new i(a),this._prime=i.mont(this.__prime),this._primeLen=a.length,this._pub=void 0,this._priv=void 0,this._primeCode=void 0,c?(this.setPublicKey=d,this.setPrivateKey=e):this._primeCode=8}function h(a,b){var d=new c(a.toArray());return b?d.toString(b):d}var i=a("bn.js"),j=a("miller-rabin"),k=new j,l=new i(24),m=new i(11),n=new i(10),o=new i(3),p=new i(7),q=a("./generatePrime"),r=a("randombytes");b.exports=g;var s={};Object.defineProperty(g.prototype,"verifyError",{enumerable:!0,get:function(){return"number"!=typeof this._primeCode&&(this._primeCode=f(this.__prime,this.__gen)),this._primeCode}}),g.prototype.generateKeys=function(){return this._priv||(this._priv=new i(r(this._primeLen))),this._pub=this._gen.toRed(this._prime).redPow(this._priv).fromRed(),this.getPublicKey()},g.prototype.computeSecret=function(a){a=new i(a),a=a.toRed(this._prime);var b=a.redPow(this._priv).fromRed(),d=new c(b.toArray()),e=this.getPrime();if(d.length<e.length){var f=new c(e.length-d.length);f.fill(0),d=c.concat([f,d])}return d},g.prototype.getPublicKey=function(a){return h(this._pub,a)},g.prototype.getPrivateKey=function(a){return h(this._priv,a)},g.prototype.getPrime=function(a){return h(this.__prime,a)},g.prototype.getGenerator=function(a){return h(this._gen,a)},g.prototype.setGenerator=function(a,b){return b=b||"utf8",c.isBuffer(a)||(a=new c(a,b)),this.__gen=a,this._gen=new i(a),this}}).call(this,a("buffer").Buffer)},{"./generatePrime":152,"bn.js":99,buffer:130,"miller-rabin":199,randombytes:227}],152:[function(a,b,c){function d(){if(null!==t)return t;var a=1048576,b=[];b[0]=2;for(var c=1,d=3;a>d;d+=2){for(var e=Math.ceil(Math.sqrt(d)),f=0;c>f&&b[f]<=e&&d%b[f]!==0;f++);c!==f&&b[f]<=e||(b[c++]=d)}return t=b,b}function e(a){for(var b=d(),c=0;c<b.length;c++)if(0===a.modn(b[c]))return 0===a.cmpn(b[c])?!0:!1;return!0}function f(a){var b=i.mont(a);return 0===n.toRed(b).redPow(a.subn(1)).fromRed().cmpn(1)}function g(a,b){if(16>a)return new i(2===b||5===b?[140,123]:[140,39]);b=new i(b);for(var c,d;;){for(c=new i(h(Math.ceil(a/8)));c.bitLength()>a;)c.ishrn(1);if(c.isEven()&&c.iadd(m),c.testn(1)||c.iadd(n),b.cmp(n)){if(!b.cmp(o))for(;c.mod(p).cmp(q);)c.iadd(s)}else for(;c.mod(j).cmp(r);)c.iadd(s);if(d=c.shrn(1),e(d)&&e(c)&&f(d)&&f(c)&&l.test(d)&&l.test(c))return c}}var h=a("randombytes");b.exports=g,g.simpleSieve=e,g.fermatTest=f;var i=a("bn.js"),j=new i(24),k=a("miller-rabin"),l=new k,m=new i(1),n=new i(2),o=new i(5),p=(new i(16),new i(8),new i(10)),q=new i(3),r=(new i(7),new i(11)),s=new i(4),t=(new i(12),null)},{"bn.js":99,"miller-rabin":199,randombytes:227}],153:[function(a,b,c){b.exports={modp1:{gen:"02",prime:"ffffffffffffffffc90fdaa22168c234c4c6628b80dc1cd129024e088a67cc74020bbea63b139b22514a08798e3404ddef9519b3cd3a431b302b0a6df25f14374fe1356d6d51c245e485b576625e7ec6f44c42e9a63a3620ffffffffffffffff"},modp2:{gen:"02",prime:"ffffffffffffffffc90fdaa22168c234c4c6628b80dc1cd129024e088a67cc74020bbea63b139b22514a08798e3404ddef9519b3cd3a431b302b0a6df25f14374fe1356d6d51c245e485b576625e7ec6f44c42e9a637ed6b0bff5cb6f406b7edee386bfb5a899fa5ae9f24117c4b1fe649286651ece65381ffffffffffffffff"},modp5:{gen:"02",prime:"ffffffffffffffffc90fdaa22168c234c4c6628b80dc1cd129024e088a67cc74020bbea63b139b22514a08798e3404ddef9519b3cd3a431b302b0a6df25f14374fe1356d6d51c245e485b576625e7ec6f44c42e9a637ed6b0bff5cb6f406b7edee386bfb5a899fa5ae9f24117c4b1fe649286651ece45b3dc2007cb8a163bf0598da48361c55d39a69163fa8fd24cf5f83655d23dca3ad961c62f356208552bb9ed529077096966d670c354e4abc9804f1746c08ca237327ffffffffffffffff"},modp14:{gen:"02",prime:"ffffffffffffffffc90fdaa22168c234c4c6628b80dc1cd129024e088a67cc74020bbea63b139b22514a08798e3404ddef9519b3cd3a431b302b0a6df25f14374fe1356d6d51c245e485b576625e7ec6f44c42e9a637ed6b0bff5cb6f406b7edee386bfb5a899fa5ae9f24117c4b1fe649286651ece45b3dc2007cb8a163bf0598da48361c55d39a69163fa8fd24cf5f83655d23dca3ad961c62f356208552bb9ed529077096966d670c354e4abc9804f1746c08ca18217c32905e462e36ce3be39e772c180e86039b2783a2ec07a28fb5c55df06f4c52c9de2bcbf6955817183995497cea956ae515d2261898fa051015728e5a8aacaa68ffffffffffffffff"},modp15:{gen:"02",prime:"ffffffffffffffffc90fdaa22168c234c4c6628b80dc1cd129024e088a67cc74020bbea63b139b22514a08798e3404ddef9519b3cd3a431b302b0a6df25f14374fe1356d6d51c245e485b576625e7ec6f44c42e9a637ed6b0bff5cb6f406b7edee386bfb5a899fa5ae9f24117c4b1fe649286651ece45b3dc2007cb8a163bf0598da48361c55d39a69163fa8fd24cf5f83655d23dca3ad961c62f356208552bb9ed529077096966d670c354e4abc9804f1746c08ca18217c32905e462e36ce3be39e772c180e86039b2783a2ec07a28fb5c55df06f4c52c9de2bcbf6955817183995497cea956ae515d2261898fa051015728e5a8aaac42dad33170d04507a33a85521abdf1cba64ecfb850458dbef0a8aea71575d060c7db3970f85a6e1e4c7abf5ae8cdb0933d71e8c94e04a25619dcee3d2261ad2ee6bf12ffa06d98a0864d87602733ec86a64521f2b18177b200cbbe117577a615d6c770988c0bad946e208e24fa074e5ab3143db5bfce0fd108e4b82d120a93ad2caffffffffffffffff"},modp16:{gen:"02",prime:"ffffffffffffffffc90fdaa22168c234c4c6628b80dc1cd129024e088a67cc74020bbea63b139b22514a08798e3404ddef9519b3cd3a431b302b0a6df25f14374fe1356d6d51c245e485b576625e7ec6f44c42e9a637ed6b0bff5cb6f406b7edee386bfb5a899fa5ae9f24117c4b1fe649286651ece45b3dc2007cb8a163bf0598da48361c55d39a69163fa8fd24cf5f83655d23dca3ad961c62f356208552bb9ed529077096966d670c354e4abc9804f1746c08ca18217c32905e462e36ce3be39e772c180e86039b2783a2ec07a28fb5c55df06f4c52c9de2bcbf6955817183995497cea956ae515d2261898fa051015728e5a8aaac42dad33170d04507a33a85521abdf1cba64ecfb850458dbef0a8aea71575d060c7db3970f85a6e1e4c7abf5ae8cdb0933d71e8c94e04a25619dcee3d2261ad2ee6bf12ffa06d98a0864d87602733ec86a64521f2b18177b200cbbe117577a615d6c770988c0bad946e208e24fa074e5ab3143db5bfce0fd108e4b82d120a92108011a723c12a787e6d788719a10bdba5b2699c327186af4e23c1a946834b6150bda2583e9ca2ad44ce8dbbbc2db04de8ef92e8efc141fbecaa6287c59474e6bc05d99b2964fa090c3a2233ba186515be7ed1f612970cee2d7afb81bdd762170481cd0069127d5b05aa993b4ea988d8fddc186ffb7dc90a6c08f4df435c934063199ffffffffffffffff"},modp17:{gen:"02",prime:"ffffffffffffffffc90fdaa22168c234c4c6628b80dc1cd129024e088a67cc74020bbea63b139b22514a08798e3404ddef9519b3cd3a431b302b0a6df25f14374fe1356d6d51c245e485b576625e7ec6f44c42e9a637ed6b0bff5cb6f406b7edee386bfb5a899fa5ae9f24117c4b1fe649286651ece45b3dc2007cb8a163bf0598da48361c55d39a69163fa8fd24cf5f83655d23dca3ad961c62f356208552bb9ed529077096966d670c354e4abc9804f1746c08ca18217c32905e462e36ce3be39e772c180e86039b2783a2ec07a28fb5c55df06f4c52c9de2bcbf6955817183995497cea956ae515d2261898fa051015728e5a8aaac42dad33170d04507a33a85521abdf1cba64ecfb850458dbef0a8aea71575d060c7db3970f85a6e1e4c7abf5ae8cdb0933d71e8c94e04a25619dcee3d2261ad2ee6bf12ffa06d98a0864d87602733ec86a64521f2b18177b200cbbe117577a615d6c770988c0bad946e208e24fa074e5ab3143db5bfce0fd108e4b82d120a92108011a723c12a787e6d788719a10bdba5b2699c327186af4e23c1a946834b6150bda2583e9ca2ad44ce8dbbbc2db04de8ef92e8efc141fbecaa6287c59474e6bc05d99b2964fa090c3a2233ba186515be7ed1f612970cee2d7afb81bdd762170481cd0069127d5b05aa993b4ea988d8fddc186ffb7dc90a6c08f4df435c93402849236c3fab4d27c7026c1d4dcb2602646dec9751e763dba37bdf8ff9406ad9e530ee5db382f413001aeb06a53ed9027d831179727b0865a8918da3edbebcf9b14ed44ce6cbaced4bb1bdb7f1447e6cc254b332051512bd7af426fb8f401378cd2bf5983ca01c64b92ecf032ea15d1721d03f482d7ce6e74fef6d55e702f46980c82b5a84031900b1c9e59e7c97fbec7e8f323a97a7e36cc88be0f1d45b7ff585ac54bd407b22b4154aacc8f6d7ebf48e1d814cc5ed20f8037e0a79715eef29be32806a1d58bb7c5da76f550aa3d8a1fbff0eb19ccb1a313d55cda56c9ec2ef29632387fe8d76e3c0468043e8f663f4860ee12bf2d5b0b7474d6e694f91e6dcc4024ffffffffffffffff"},modp18:{gen:"02",prime:"ffffffffffffffffc90fdaa22168c234c4c6628b80dc1cd129024e088a67cc74020bbea63b139b22514a08798e3404ddef9519b3cd3a431b302b0a6df25f14374fe1356d6d51c245e485b576625e7ec6f44c42e9a637ed6b0bff5cb6f406b7edee386bfb5a899fa5ae9f24117c4b1fe649286651ece45b3dc2007cb8a163bf0598da48361c55d39a69163fa8fd24cf5f83655d23dca3ad961c62f356208552bb9ed529077096966d670c354e4abc9804f1746c08ca18217c32905e462e36ce3be39e772c180e86039b2783a2ec07a28fb5c55df06f4c52c9de2bcbf6955817183995497cea956ae515d2261898fa051015728e5a8aaac42dad33170d04507a33a85521abdf1cba64ecfb850458dbef0a8aea71575d060c7db3970f85a6e1e4c7abf5ae8cdb0933d71e8c94e04a25619dcee3d2261ad2ee6bf12ffa06d98a0864d87602733ec86a64521f2b18177b200cbbe117577a615d6c770988c0bad946e208e24fa074e5ab3143db5bfce0fd108e4b82d120a92108011a723c12a787e6d788719a10bdba5b2699c327186af4e23c1a946834b6150bda2583e9ca2ad44ce8dbbbc2db04de8ef92e8efc141fbecaa6287c59474e6bc05d99b2964fa090c3a2233ba186515be7ed1f612970cee2d7afb81bdd762170481cd0069127d5b05aa993b4ea988d8fddc186ffb7dc90a6c08f4df435c93402849236c3fab4d27c7026c1d4dcb2602646dec9751e763dba37bdf8ff9406ad9e530ee5db382f413001aeb06a53ed9027d831179727b0865a8918da3edbebcf9b14ed44ce6cbaced4bb1bdb7f1447e6cc254b332051512bd7af426fb8f401378cd2bf5983ca01c64b92ecf032ea15d1721d03f482d7ce6e74fef6d55e702f46980c82b5a84031900b1c9e59e7c97fbec7e8f323a97a7e36cc88be0f1d45b7ff585ac54bd407b22b4154aacc8f6d7ebf48e1d814cc5ed20f8037e0a79715eef29be32806a1d58bb7c5da76f550aa3d8a1fbff0eb19ccb1a313d55cda56c9ec2ef29632387fe8d76e3c0468043e8f663f4860ee12bf2d5b0b7474d6e694f91e6dbe115974a3926f12fee5e438777cb6a932df8cd8bec4d073b931ba3bc832b68d9dd300741fa7bf8afc47ed2576f6936ba424663aab639c5ae4f5683423b4742bf1c978238f16cbe39d652de3fdb8befc848ad922222e04a4037c0713eb57a81a23f0c73473fc646cea306b4bcbc8862f8385ddfa9d4b7fa2c087e879683303ed5bdd3a062b3cf5b3a278a66d2a13f83f44f82ddf310ee074ab6a364597e899a0255dc164f31cc50846851df9ab48195ded7ea1b1d510bd7ee74d73faf36bc31ecfa268359046f4eb879f924009438b481c6cd7889a002ed5ee382bc9190da6fc026e479558e4475677e9aa9e3050e2765694dfc81f56e880b96e7160c980dd98edd3dfffffffffffffffff"}}},{}],154:[function(a,b,c){"use strict";var d=c;d.version=a("../package.json").version,d.utils=a("./elliptic/utils"),d.rand=a("brorand"),d.curve=a("./elliptic/curve"),d.curves=a("./elliptic/curves"),d.ec=a("./elliptic/ec"),d.eddsa=a("./elliptic/eddsa")},{"../package.json":169,"./elliptic/curve":157,"./elliptic/curves":160,"./elliptic/ec":161,"./elliptic/eddsa":164,"./elliptic/utils":168,brorand:100}],155:[function(a,b,c){"use strict";function d(a,b){this.type=a,this.p=new f(b.p,16),this.red=b.prime?f.red(b.prime):f.mont(this.p),this.zero=new f(0).toRed(this.red),this.one=new f(1).toRed(this.red),this.two=new f(2).toRed(this.red),this.n=b.n&&new f(b.n,16),this.g=b.g&&this.pointFromJSON(b.g,b.gRed),this._wnafT1=new Array(4),this._wnafT2=new Array(4),this._wnafT3=new Array(4),this._wnafT4=new Array(4);var c=this.n&&this.p.div(this.n);!c||c.cmpn(100)>0?this.redN=null:(this._maxwellTrick=!0,this.redN=this.n.toRed(this.red))}function e(a,b){this.curve=a,this.type=b,this.precomputed=null}var f=a("bn.js"),g=a("../../elliptic"),h=g.utils,i=h.getNAF,j=h.getJSF,k=h.assert;b.exports=d,d.prototype.point=function(){throw new Error("Not implemented")},d.prototype.validate=function(){throw new Error("Not implemented")},d.prototype._fixedNafMul=function(a,b){k(a.precomputed);var c=a._getDoubles(),d=i(b,1),e=(1<<c.step+1)-(c.step%2===0?2:1);e/=3;for(var f=[],g=0;g<d.length;g+=c.step){for(var h=0,b=g+c.step-1;b>=g;b--)h=(h<<1)+d[b];f.push(h)}for(var j=this.jpoint(null,null,null),l=this.jpoint(null,null,null),m=e;m>0;m--){for(var g=0;g<f.length;g++){var h=f[g];h===m?l=l.mixedAdd(c.points[g]):h===-m&&(l=l.mixedAdd(c.points[g].neg()))}j=j.add(l)}return j.toP()},d.prototype._wnafMul=function(a,b){var c=4,d=a._getNAFPoints(c);c=d.wnd;for(var e=d.points,f=i(b,c),g=this.jpoint(null,null,null),h=f.length-1;h>=0;h--){for(var b=0;h>=0&&0===f[h];h--)b++;if(h>=0&&b++,g=g.dblp(b),0>h)break;var j=f[h];k(0!==j),g="affine"===a.type?j>0?g.mixedAdd(e[j-1>>1]):g.mixedAdd(e[-j-1>>1].neg()):j>0?g.add(e[j-1>>1]):g.add(e[-j-1>>1].neg())}return"affine"===a.type?g.toP():g},d.prototype._wnafMulAdd=function(a,b,c,d,e){for(var f=this._wnafT1,g=this._wnafT2,h=this._wnafT3,k=0,l=0;d>l;l++){var m=b[l],n=m._getNAFPoints(a);f[l]=n.wnd,g[l]=n.points}for(var l=d-1;l>=1;l-=2){var o=l-1,p=l;if(1===f[o]&&1===f[p]){var q=[b[o],null,null,b[p]];0===b[o].y.cmp(b[p].y)?(q[1]=b[o].add(b[p]),q[2]=b[o].toJ().mixedAdd(b[p].neg())):0===b[o].y.cmp(b[p].y.redNeg())?(q[1]=b[o].toJ().mixedAdd(b[p]),q[2]=b[o].add(b[p].neg())):(q[1]=b[o].toJ().mixedAdd(b[p]),q[2]=b[o].toJ().mixedAdd(b[p].neg()));var r=[-3,-1,-5,-7,0,7,5,1,3],s=j(c[o],c[p]);k=Math.max(s[0].length,k),h[o]=new Array(k),h[p]=new Array(k);for(var t=0;k>t;t++){var u=0|s[0][t],v=0|s[1][t];h[o][t]=r[3*(u+1)+(v+1)],h[p][t]=0,g[o]=q}}else h[o]=i(c[o],f[o]),h[p]=i(c[p],f[p]),k=Math.max(h[o].length,k),k=Math.max(h[p].length,k)}for(var w=this.jpoint(null,null,null),x=this._wnafT4,l=k;l>=0;l--){for(var y=0;l>=0;){for(var z=!0,t=0;d>t;t++)x[t]=0|h[t][l],0!==x[t]&&(z=!1);if(!z)break;y++,l--}if(l>=0&&y++,w=w.dblp(y),0>l)break;for(var t=0;d>t;t++){var m,A=x[t];0!==A&&(A>0?m=g[t][A-1>>1]:0>A&&(m=g[t][-A-1>>1].neg()),w="affine"===m.type?w.mixedAdd(m):w.add(m))}}for(var l=0;d>l;l++)g[l]=null;return e?w:w.toP()},d.BasePoint=e,e.prototype.eq=function(){throw new Error("Not implemented")},e.prototype.validate=function(){return this.curve.validate(this)},d.prototype.decodePoint=function(a,b){a=h.toArray(a,b);var c=this.p.byteLength();if((4===a[0]||6===a[0]||7===a[0])&&a.length-1===2*c){6===a[0]?k(a[a.length-1]%2===0):7===a[0]&&k(a[a.length-1]%2===1);var d=this.point(a.slice(1,1+c),a.slice(1+c,1+2*c));return d}if((2===a[0]||3===a[0])&&a.length-1===c)return this.pointFromX(a.slice(1,1+c),3===a[0]);throw new Error("Unknown point format")},e.prototype.encodeCompressed=function(a){return this.encode(a,!0)},e.prototype._encode=function(a){var b=this.curve.p.byteLength(),c=this.getX().toArray("be",b);return a?[this.getY().isEven()?2:3].concat(c):[4].concat(c,this.getY().toArray("be",b))},e.prototype.encode=function(a,b){return h.encode(this._encode(b),a)},e.prototype.precompute=function(a){if(this.precomputed)return this;var b={doubles:null,naf:null,beta:null};return b.naf=this._getNAFPoints(8),b.doubles=this._getDoubles(4,a),b.beta=this._getBeta(),this.precomputed=b,this},e.prototype._hasDoubles=function(a){if(!this.precomputed)return!1;var b=this.precomputed.doubles;return b?b.points.length>=Math.ceil((a.bitLength()+1)/b.step):!1},e.prototype._getDoubles=function(a,b){if(this.precomputed&&this.precomputed.doubles)return this.precomputed.doubles;for(var c=[this],d=this,e=0;b>e;e+=a){for(var f=0;a>f;f++)d=d.dbl();c.push(d)}return{step:a,points:c}},e.prototype._getNAFPoints=function(a){if(this.precomputed&&this.precomputed.naf)return this.precomputed.naf;for(var b=[this],c=(1<<a)-1,d=1===c?null:this.dbl(),e=1;c>e;e++)b[e]=b[e-1].add(d);return{wnd:a,points:b}},e.prototype._getBeta=function(){return null},e.prototype.dblp=function(a){for(var b=this,c=0;a>c;c++)b=b.dbl();return b}},{"../../elliptic":154,"bn.js":99}],156:[function(a,b,c){"use strict";function d(a){this.twisted=1!==(0|a.a),this.mOneA=this.twisted&&-1===(0|a.a),this.extended=this.mOneA,j.call(this,"edwards",a),this.a=new h(a.a,16).umod(this.red.m),this.a=this.a.toRed(this.red),this.c=new h(a.c,16).toRed(this.red),this.c2=this.c.redSqr(),this.d=new h(a.d,16).toRed(this.red),this.dd=this.d.redAdd(this.d),k(!this.twisted||0===this.c.fromRed().cmpn(1)),this.oneC=1===(0|a.c)}function e(a,b,c,d,e){j.BasePoint.call(this,a,"projective"),null===b&&null===c&&null===d?(this.x=this.curve.zero,this.y=this.curve.one,this.z=this.curve.one,this.t=this.curve.zero,this.zOne=!0):(this.x=new h(b,16),this.y=new h(c,16),this.z=d?new h(d,16):this.curve.one,this.t=e&&new h(e,16),this.x.red||(this.x=this.x.toRed(this.curve.red)),this.y.red||(this.y=this.y.toRed(this.curve.red)),this.z.red||(this.z=this.z.toRed(this.curve.red)),this.t&&!this.t.red&&(this.t=this.t.toRed(this.curve.red)),this.zOne=this.z===this.curve.one,this.curve.extended&&!this.t&&(this.t=this.x.redMul(this.y),this.zOne||(this.t=this.t.redMul(this.z.redInvm()))))}var f=a("../curve"),g=a("../../elliptic"),h=a("bn.js"),i=a("inherits"),j=f.base,k=g.utils.assert;i(d,j),b.exports=d,d.prototype._mulA=function(a){return this.mOneA?a.redNeg():this.a.redMul(a)},d.prototype._mulC=function(a){return this.oneC?a:this.c.redMul(a)},d.prototype.jpoint=function(a,b,c,d){return this.point(a,b,c,d)},d.prototype.pointFromX=function(a,b){a=new h(a,16),a.red||(a=a.toRed(this.red));var c=a.redSqr(),d=this.c2.redSub(this.a.redMul(c)),e=this.one.redSub(this.c2.redMul(this.d).redMul(c)),f=d.redMul(e.redInvm()),g=f.redSqrt();if(0!==g.redSqr().redSub(f).cmp(this.zero))throw new Error("invalid point");var i=g.fromRed().isOdd();return(b&&!i||!b&&i)&&(g=g.redNeg()),this.point(a,g)},d.prototype.pointFromY=function(a,b){a=new h(a,16),a.red||(a=a.toRed(this.red));var c=a.redSqr(),d=c.redSub(this.one),e=c.redMul(this.d).redAdd(this.one),f=d.redMul(e.redInvm());if(0===f.cmp(this.zero)){if(b)throw new Error("invalid point");return this.point(this.zero,a)}var g=f.redSqrt();if(0!==g.redSqr().redSub(f).cmp(this.zero))throw new Error("invalid point");return g.isOdd()!==b&&(g=g.redNeg()),this.point(g,a)},d.prototype.validate=function(a){if(a.isInfinity())return!0;a.normalize();var b=a.x.redSqr(),c=a.y.redSqr(),d=b.redMul(this.a).redAdd(c),e=this.c2.redMul(this.one.redAdd(this.d.redMul(b).redMul(c)));
return 0===d.cmp(e)},i(e,j.BasePoint),d.prototype.pointFromJSON=function(a){return e.fromJSON(this,a)},d.prototype.point=function(a,b,c,d){return new e(this,a,b,c,d)},e.fromJSON=function(a,b){return new e(a,b[0],b[1],b[2])},e.prototype.inspect=function(){return this.isInfinity()?"<EC Point Infinity>":"<EC Point x: "+this.x.fromRed().toString(16,2)+" y: "+this.y.fromRed().toString(16,2)+" z: "+this.z.fromRed().toString(16,2)+">"},e.prototype.isInfinity=function(){return 0===this.x.cmpn(0)&&0===this.y.cmp(this.z)},e.prototype._extDbl=function(){var a=this.x.redSqr(),b=this.y.redSqr(),c=this.z.redSqr();c=c.redIAdd(c);var d=this.curve._mulA(a),e=this.x.redAdd(this.y).redSqr().redISub(a).redISub(b),f=d.redAdd(b),g=f.redSub(c),h=d.redSub(b),i=e.redMul(g),j=f.redMul(h),k=e.redMul(h),l=g.redMul(f);return this.curve.point(i,j,l,k)},e.prototype._projDbl=function(){var a,b,c,d=this.x.redAdd(this.y).redSqr(),e=this.x.redSqr(),f=this.y.redSqr();if(this.curve.twisted){var g=this.curve._mulA(e),h=g.redAdd(f);if(this.zOne)a=d.redSub(e).redSub(f).redMul(h.redSub(this.curve.two)),b=h.redMul(g.redSub(f)),c=h.redSqr().redSub(h).redSub(h);else{var i=this.z.redSqr(),j=h.redSub(i).redISub(i);a=d.redSub(e).redISub(f).redMul(j),b=h.redMul(g.redSub(f)),c=h.redMul(j)}}else{var g=e.redAdd(f),i=this.curve._mulC(this.c.redMul(this.z)).redSqr(),j=g.redSub(i).redSub(i);a=this.curve._mulC(d.redISub(g)).redMul(j),b=this.curve._mulC(g).redMul(e.redISub(f)),c=g.redMul(j)}return this.curve.point(a,b,c)},e.prototype.dbl=function(){return this.isInfinity()?this:this.curve.extended?this._extDbl():this._projDbl()},e.prototype._extAdd=function(a){var b=this.y.redSub(this.x).redMul(a.y.redSub(a.x)),c=this.y.redAdd(this.x).redMul(a.y.redAdd(a.x)),d=this.t.redMul(this.curve.dd).redMul(a.t),e=this.z.redMul(a.z.redAdd(a.z)),f=c.redSub(b),g=e.redSub(d),h=e.redAdd(d),i=c.redAdd(b),j=f.redMul(g),k=h.redMul(i),l=f.redMul(i),m=g.redMul(h);return this.curve.point(j,k,m,l)},e.prototype._projAdd=function(a){var b,c,d=this.z.redMul(a.z),e=d.redSqr(),f=this.x.redMul(a.x),g=this.y.redMul(a.y),h=this.curve.d.redMul(f).redMul(g),i=e.redSub(h),j=e.redAdd(h),k=this.x.redAdd(this.y).redMul(a.x.redAdd(a.y)).redISub(f).redISub(g),l=d.redMul(i).redMul(k);return this.curve.twisted?(b=d.redMul(j).redMul(g.redSub(this.curve._mulA(f))),c=i.redMul(j)):(b=d.redMul(j).redMul(g.redSub(f)),c=this.curve._mulC(i).redMul(j)),this.curve.point(l,b,c)},e.prototype.add=function(a){return this.isInfinity()?a:a.isInfinity()?this:this.curve.extended?this._extAdd(a):this._projAdd(a)},e.prototype.mul=function(a){return this._hasDoubles(a)?this.curve._fixedNafMul(this,a):this.curve._wnafMul(this,a)},e.prototype.mulAdd=function(a,b,c){return this.curve._wnafMulAdd(1,[this,b],[a,c],2,!1)},e.prototype.jmulAdd=function(a,b,c){return this.curve._wnafMulAdd(1,[this,b],[a,c],2,!0)},e.prototype.normalize=function(){if(this.zOne)return this;var a=this.z.redInvm();return this.x=this.x.redMul(a),this.y=this.y.redMul(a),this.t&&(this.t=this.t.redMul(a)),this.z=this.curve.one,this.zOne=!0,this},e.prototype.neg=function(){return this.curve.point(this.x.redNeg(),this.y,this.z,this.t&&this.t.redNeg())},e.prototype.getX=function(){return this.normalize(),this.x.fromRed()},e.prototype.getY=function(){return this.normalize(),this.y.fromRed()},e.prototype.eq=function(a){return this===a||0===this.getX().cmp(a.getX())&&0===this.getY().cmp(a.getY())},e.prototype.eqXToP=function(a){var b=a.toRed(this.curve.red).redMul(this.z);if(0===this.x.cmp(b))return!0;for(var c=a.clone(),d=this.curve.redN.redMul(this.z);;){if(c.iadd(this.curve.n),c.cmp(this.curve.p)>=0)return!1;if(b.redIAdd(d),0===this.x.cmp(b))return!0}return!1},e.prototype.toP=e.prototype.normalize,e.prototype.mixedAdd=e.prototype.add},{"../../elliptic":154,"../curve":157,"bn.js":99,inherits:196}],157:[function(a,b,c){"use strict";var d=c;d.base=a("./base"),d["short"]=a("./short"),d.mont=a("./mont"),d.edwards=a("./edwards")},{"./base":155,"./edwards":156,"./mont":158,"./short":159}],158:[function(a,b,c){"use strict";function d(a){i.call(this,"mont",a),this.a=new g(a.a,16).toRed(this.red),this.b=new g(a.b,16).toRed(this.red),this.i4=new g(4).toRed(this.red).redInvm(),this.two=new g(2).toRed(this.red),this.a24=this.i4.redMul(this.a.redAdd(this.two))}function e(a,b,c){i.BasePoint.call(this,a,"projective"),null===b&&null===c?(this.x=this.curve.one,this.z=this.curve.zero):(this.x=new g(b,16),this.z=new g(c,16),this.x.red||(this.x=this.x.toRed(this.curve.red)),this.z.red||(this.z=this.z.toRed(this.curve.red)))}var f=a("../curve"),g=a("bn.js"),h=a("inherits"),i=f.base,j=a("../../elliptic"),k=j.utils;h(d,i),b.exports=d,d.prototype.validate=function(a){var b=a.normalize().x,c=b.redSqr(),d=c.redMul(b).redAdd(c.redMul(this.a)).redAdd(b),e=d.redSqrt();return 0===e.redSqr().cmp(d)},h(e,i.BasePoint),d.prototype.decodePoint=function(a,b){return this.point(k.toArray(a,b),1)},d.prototype.point=function(a,b){return new e(this,a,b)},d.prototype.pointFromJSON=function(a){return e.fromJSON(this,a)},e.prototype.precompute=function(){},e.prototype._encode=function(){return this.getX().toArray("be",this.curve.p.byteLength())},e.fromJSON=function(a,b){return new e(a,b[0],b[1]||a.one)},e.prototype.inspect=function(){return this.isInfinity()?"<EC Point Infinity>":"<EC Point x: "+this.x.fromRed().toString(16,2)+" z: "+this.z.fromRed().toString(16,2)+">"},e.prototype.isInfinity=function(){return 0===this.z.cmpn(0)},e.prototype.dbl=function(){var a=this.x.redAdd(this.z),b=a.redSqr(),c=this.x.redSub(this.z),d=c.redSqr(),e=b.redSub(d),f=b.redMul(d),g=e.redMul(d.redAdd(this.curve.a24.redMul(e)));return this.curve.point(f,g)},e.prototype.add=function(){throw new Error("Not supported on Montgomery curve")},e.prototype.diffAdd=function(a,b){var c=this.x.redAdd(this.z),d=this.x.redSub(this.z),e=a.x.redAdd(a.z),f=a.x.redSub(a.z),g=f.redMul(c),h=e.redMul(d),i=b.z.redMul(g.redAdd(h).redSqr()),j=b.x.redMul(g.redISub(h).redSqr());return this.curve.point(i,j)},e.prototype.mul=function(a){for(var b=a.clone(),c=this,d=this.curve.point(null,null),e=this,f=[];0!==b.cmpn(0);b.iushrn(1))f.push(b.andln(1));for(var g=f.length-1;g>=0;g--)0===f[g]?(c=c.diffAdd(d,e),d=d.dbl()):(d=c.diffAdd(d,e),c=c.dbl());return d},e.prototype.mulAdd=function(){throw new Error("Not supported on Montgomery curve")},e.prototype.jumlAdd=function(){throw new Error("Not supported on Montgomery curve")},e.prototype.eq=function(a){return 0===this.getX().cmp(a.getX())},e.prototype.normalize=function(){return this.x=this.x.redMul(this.z.redInvm()),this.z=this.curve.one,this},e.prototype.getX=function(){return this.normalize(),this.x.fromRed()}},{"../../elliptic":154,"../curve":157,"bn.js":99,inherits:196}],159:[function(a,b,c){"use strict";function d(a){k.call(this,"short",a),this.a=new i(a.a,16).toRed(this.red),this.b=new i(a.b,16).toRed(this.red),this.tinv=this.two.redInvm(),this.zeroA=0===this.a.fromRed().cmpn(0),this.threeA=0===this.a.fromRed().sub(this.p).cmpn(-3),this.endo=this._getEndomorphism(a),this._endoWnafT1=new Array(4),this._endoWnafT2=new Array(4)}function e(a,b,c,d){k.BasePoint.call(this,a,"affine"),null===b&&null===c?(this.x=null,this.y=null,this.inf=!0):(this.x=new i(b,16),this.y=new i(c,16),d&&(this.x.forceRed(this.curve.red),this.y.forceRed(this.curve.red)),this.x.red||(this.x=this.x.toRed(this.curve.red)),this.y.red||(this.y=this.y.toRed(this.curve.red)),this.inf=!1)}function f(a,b,c,d){k.BasePoint.call(this,a,"jacobian"),null===b&&null===c&&null===d?(this.x=this.curve.one,this.y=this.curve.one,this.z=new i(0)):(this.x=new i(b,16),this.y=new i(c,16),this.z=new i(d,16)),this.x.red||(this.x=this.x.toRed(this.curve.red)),this.y.red||(this.y=this.y.toRed(this.curve.red)),this.z.red||(this.z=this.z.toRed(this.curve.red)),this.zOne=this.z===this.curve.one}var g=a("../curve"),h=a("../../elliptic"),i=a("bn.js"),j=a("inherits"),k=g.base,l=h.utils.assert;j(d,k),b.exports=d,d.prototype._getEndomorphism=function(a){if(this.zeroA&&this.g&&this.n&&1===this.p.modn(3)){var b,c;if(a.beta)b=new i(a.beta,16).toRed(this.red);else{var d=this._getEndoRoots(this.p);b=d[0].cmp(d[1])<0?d[0]:d[1],b=b.toRed(this.red)}if(a.lambda)c=new i(a.lambda,16);else{var e=this._getEndoRoots(this.n);0===this.g.mul(e[0]).x.cmp(this.g.x.redMul(b))?c=e[0]:(c=e[1],l(0===this.g.mul(c).x.cmp(this.g.x.redMul(b))))}var f;return f=a.basis?a.basis.map(function(a){return{a:new i(a.a,16),b:new i(a.b,16)}}):this._getEndoBasis(c),{beta:b,lambda:c,basis:f}}},d.prototype._getEndoRoots=function(a){var b=a===this.p?this.red:i.mont(a),c=new i(2).toRed(b).redInvm(),d=c.redNeg(),e=new i(3).toRed(b).redNeg().redSqrt().redMul(c),f=d.redAdd(e).fromRed(),g=d.redSub(e).fromRed();return[f,g]},d.prototype._getEndoBasis=function(a){for(var b,c,d,e,f,g,h,j,k,l=this.n.ushrn(Math.floor(this.n.bitLength()/2)),m=a,n=this.n.clone(),o=new i(1),p=new i(0),q=new i(0),r=new i(1),s=0;0!==m.cmpn(0);){var t=n.div(m);j=n.sub(t.mul(m)),k=q.sub(t.mul(o));var u=r.sub(t.mul(p));if(!d&&j.cmp(l)<0)b=h.neg(),c=o,d=j.neg(),e=k;else if(d&&2===++s)break;h=j,n=m,m=j,q=o,o=k,r=p,p=u}f=j.neg(),g=k;var v=d.sqr().add(e.sqr()),w=f.sqr().add(g.sqr());return w.cmp(v)>=0&&(f=b,g=c),d.negative&&(d=d.neg(),e=e.neg()),f.negative&&(f=f.neg(),g=g.neg()),[{a:d,b:e},{a:f,b:g}]},d.prototype._endoSplit=function(a){var b=this.endo.basis,c=b[0],d=b[1],e=d.b.mul(a).divRound(this.n),f=c.b.neg().mul(a).divRound(this.n),g=e.mul(c.a),h=f.mul(d.a),i=e.mul(c.b),j=f.mul(d.b),k=a.sub(g).sub(h),l=i.add(j).neg();return{k1:k,k2:l}},d.prototype.pointFromX=function(a,b){a=new i(a,16),a.red||(a=a.toRed(this.red));var c=a.redSqr().redMul(a).redIAdd(a.redMul(this.a)).redIAdd(this.b),d=c.redSqrt();if(0!==d.redSqr().redSub(c).cmp(this.zero))throw new Error("invalid point");var e=d.fromRed().isOdd();return(b&&!e||!b&&e)&&(d=d.redNeg()),this.point(a,d)},d.prototype.validate=function(a){if(a.inf)return!0;var b=a.x,c=a.y,d=this.a.redMul(b),e=b.redSqr().redMul(b).redIAdd(d).redIAdd(this.b);return 0===c.redSqr().redISub(e).cmpn(0)},d.prototype._endoWnafMulAdd=function(a,b,c){for(var d=this._endoWnafT1,e=this._endoWnafT2,f=0;f<a.length;f++){var g=this._endoSplit(b[f]),h=a[f],i=h._getBeta();g.k1.negative&&(g.k1.ineg(),h=h.neg(!0)),g.k2.negative&&(g.k2.ineg(),i=i.neg(!0)),d[2*f]=h,d[2*f+1]=i,e[2*f]=g.k1,e[2*f+1]=g.k2}for(var j=this._wnafMulAdd(1,d,e,2*f,c),k=0;2*f>k;k++)d[k]=null,e[k]=null;return j},j(e,k.BasePoint),d.prototype.point=function(a,b,c){return new e(this,a,b,c)},d.prototype.pointFromJSON=function(a,b){return e.fromJSON(this,a,b)},e.prototype._getBeta=function(){if(this.curve.endo){var a=this.precomputed;if(a&&a.beta)return a.beta;var b=this.curve.point(this.x.redMul(this.curve.endo.beta),this.y);if(a){var c=this.curve,d=function(a){return c.point(a.x.redMul(c.endo.beta),a.y)};a.beta=b,b.precomputed={beta:null,naf:a.naf&&{wnd:a.naf.wnd,points:a.naf.points.map(d)},doubles:a.doubles&&{step:a.doubles.step,points:a.doubles.points.map(d)}}}return b}},e.prototype.toJSON=function(){return this.precomputed?[this.x,this.y,this.precomputed&&{doubles:this.precomputed.doubles&&{step:this.precomputed.doubles.step,points:this.precomputed.doubles.points.slice(1)},naf:this.precomputed.naf&&{wnd:this.precomputed.naf.wnd,points:this.precomputed.naf.points.slice(1)}}]:[this.x,this.y]},e.fromJSON=function(a,b,c){function d(b){return a.point(b[0],b[1],c)}"string"==typeof b&&(b=JSON.parse(b));var e=a.point(b[0],b[1],c);if(!b[2])return e;var f=b[2];return e.precomputed={beta:null,doubles:f.doubles&&{step:f.doubles.step,points:[e].concat(f.doubles.points.map(d))},naf:f.naf&&{wnd:f.naf.wnd,points:[e].concat(f.naf.points.map(d))}},e},e.prototype.inspect=function(){return this.isInfinity()?"<EC Point Infinity>":"<EC Point x: "+this.x.fromRed().toString(16,2)+" y: "+this.y.fromRed().toString(16,2)+">"},e.prototype.isInfinity=function(){return this.inf},e.prototype.add=function(a){if(this.inf)return a;if(a.inf)return this;if(this.eq(a))return this.dbl();if(this.neg().eq(a))return this.curve.point(null,null);if(0===this.x.cmp(a.x))return this.curve.point(null,null);var b=this.y.redSub(a.y);0!==b.cmpn(0)&&(b=b.redMul(this.x.redSub(a.x).redInvm()));var c=b.redSqr().redISub(this.x).redISub(a.x),d=b.redMul(this.x.redSub(c)).redISub(this.y);return this.curve.point(c,d)},e.prototype.dbl=function(){if(this.inf)return this;var a=this.y.redAdd(this.y);if(0===a.cmpn(0))return this.curve.point(null,null);var b=this.curve.a,c=this.x.redSqr(),d=a.redInvm(),e=c.redAdd(c).redIAdd(c).redIAdd(b).redMul(d),f=e.redSqr().redISub(this.x.redAdd(this.x)),g=e.redMul(this.x.redSub(f)).redISub(this.y);return this.curve.point(f,g)},e.prototype.getX=function(){return this.x.fromRed()},e.prototype.getY=function(){return this.y.fromRed()},e.prototype.mul=function(a){return a=new i(a,16),this._hasDoubles(a)?this.curve._fixedNafMul(this,a):this.curve.endo?this.curve._endoWnafMulAdd([this],[a]):this.curve._wnafMul(this,a)},e.prototype.mulAdd=function(a,b,c){var d=[this,b],e=[a,c];return this.curve.endo?this.curve._endoWnafMulAdd(d,e):this.curve._wnafMulAdd(1,d,e,2)},e.prototype.jmulAdd=function(a,b,c){var d=[this,b],e=[a,c];return this.curve.endo?this.curve._endoWnafMulAdd(d,e,!0):this.curve._wnafMulAdd(1,d,e,2,!0)},e.prototype.eq=function(a){return this===a||this.inf===a.inf&&(this.inf||0===this.x.cmp(a.x)&&0===this.y.cmp(a.y))},e.prototype.neg=function(a){if(this.inf)return this;var b=this.curve.point(this.x,this.y.redNeg());if(a&&this.precomputed){var c=this.precomputed,d=function(a){return a.neg()};b.precomputed={naf:c.naf&&{wnd:c.naf.wnd,points:c.naf.points.map(d)},doubles:c.doubles&&{step:c.doubles.step,points:c.doubles.points.map(d)}}}return b},e.prototype.toJ=function(){if(this.inf)return this.curve.jpoint(null,null,null);var a=this.curve.jpoint(this.x,this.y,this.curve.one);return a},j(f,k.BasePoint),d.prototype.jpoint=function(a,b,c){return new f(this,a,b,c)},f.prototype.toP=function(){if(this.isInfinity())return this.curve.point(null,null);var a=this.z.redInvm(),b=a.redSqr(),c=this.x.redMul(b),d=this.y.redMul(b).redMul(a);return this.curve.point(c,d)},f.prototype.neg=function(){return this.curve.jpoint(this.x,this.y.redNeg(),this.z)},f.prototype.add=function(a){if(this.isInfinity())return a;if(a.isInfinity())return this;var b=a.z.redSqr(),c=this.z.redSqr(),d=this.x.redMul(b),e=a.x.redMul(c),f=this.y.redMul(b.redMul(a.z)),g=a.y.redMul(c.redMul(this.z)),h=d.redSub(e),i=f.redSub(g);if(0===h.cmpn(0))return 0!==i.cmpn(0)?this.curve.jpoint(null,null,null):this.dbl();var j=h.redSqr(),k=j.redMul(h),l=d.redMul(j),m=i.redSqr().redIAdd(k).redISub(l).redISub(l),n=i.redMul(l.redISub(m)).redISub(f.redMul(k)),o=this.z.redMul(a.z).redMul(h);return this.curve.jpoint(m,n,o)},f.prototype.mixedAdd=function(a){if(this.isInfinity())return a.toJ();if(a.isInfinity())return this;var b=this.z.redSqr(),c=this.x,d=a.x.redMul(b),e=this.y,f=a.y.redMul(b).redMul(this.z),g=c.redSub(d),h=e.redSub(f);if(0===g.cmpn(0))return 0!==h.cmpn(0)?this.curve.jpoint(null,null,null):this.dbl();var i=g.redSqr(),j=i.redMul(g),k=c.redMul(i),l=h.redSqr().redIAdd(j).redISub(k).redISub(k),m=h.redMul(k.redISub(l)).redISub(e.redMul(j)),n=this.z.redMul(g);return this.curve.jpoint(l,m,n)},f.prototype.dblp=function(a){if(0===a)return this;if(this.isInfinity())return this;if(!a)return this.dbl();if(this.curve.zeroA||this.curve.threeA){for(var b=this,c=0;a>c;c++)b=b.dbl();return b}for(var d=this.curve.a,e=this.curve.tinv,f=this.x,g=this.y,h=this.z,i=h.redSqr().redSqr(),j=g.redAdd(g),c=0;a>c;c++){var k=f.redSqr(),l=j.redSqr(),m=l.redSqr(),n=k.redAdd(k).redIAdd(k).redIAdd(d.redMul(i)),o=f.redMul(l),p=n.redSqr().redISub(o.redAdd(o)),q=o.redISub(p),r=n.redMul(q);r=r.redIAdd(r).redISub(m);var s=j.redMul(h);a>c+1&&(i=i.redMul(m)),f=p,h=s,j=r}return this.curve.jpoint(f,j.redMul(e),h)},f.prototype.dbl=function(){return this.isInfinity()?this:this.curve.zeroA?this._zeroDbl():this.curve.threeA?this._threeDbl():this._dbl()},f.prototype._zeroDbl=function(){var a,b,c;if(this.zOne){var d=this.x.redSqr(),e=this.y.redSqr(),f=e.redSqr(),g=this.x.redAdd(e).redSqr().redISub(d).redISub(f);g=g.redIAdd(g);var h=d.redAdd(d).redIAdd(d),i=h.redSqr().redISub(g).redISub(g),j=f.redIAdd(f);j=j.redIAdd(j),j=j.redIAdd(j),a=i,b=h.redMul(g.redISub(i)).redISub(j),c=this.y.redAdd(this.y)}else{var k=this.x.redSqr(),l=this.y.redSqr(),m=l.redSqr(),n=this.x.redAdd(l).redSqr().redISub(k).redISub(m);n=n.redIAdd(n);var o=k.redAdd(k).redIAdd(k),p=o.redSqr(),q=m.redIAdd(m);q=q.redIAdd(q),q=q.redIAdd(q),a=p.redISub(n).redISub(n),b=o.redMul(n.redISub(a)).redISub(q),c=this.y.redMul(this.z),c=c.redIAdd(c)}return this.curve.jpoint(a,b,c)},f.prototype._threeDbl=function(){var a,b,c;if(this.zOne){var d=this.x.redSqr(),e=this.y.redSqr(),f=e.redSqr(),g=this.x.redAdd(e).redSqr().redISub(d).redISub(f);g=g.redIAdd(g);var h=d.redAdd(d).redIAdd(d).redIAdd(this.curve.a),i=h.redSqr().redISub(g).redISub(g);a=i;var j=f.redIAdd(f);j=j.redIAdd(j),j=j.redIAdd(j),b=h.redMul(g.redISub(i)).redISub(j),c=this.y.redAdd(this.y)}else{var k=this.z.redSqr(),l=this.y.redSqr(),m=this.x.redMul(l),n=this.x.redSub(k).redMul(this.x.redAdd(k));n=n.redAdd(n).redIAdd(n);var o=m.redIAdd(m);o=o.redIAdd(o);var p=o.redAdd(o);a=n.redSqr().redISub(p),c=this.y.redAdd(this.z).redSqr().redISub(l).redISub(k);var q=l.redSqr();q=q.redIAdd(q),q=q.redIAdd(q),q=q.redIAdd(q),b=n.redMul(o.redISub(a)).redISub(q)}return this.curve.jpoint(a,b,c)},f.prototype._dbl=function(){var a=this.curve.a,b=this.x,c=this.y,d=this.z,e=d.redSqr().redSqr(),f=b.redSqr(),g=c.redSqr(),h=f.redAdd(f).redIAdd(f).redIAdd(a.redMul(e)),i=b.redAdd(b);i=i.redIAdd(i);var j=i.redMul(g),k=h.redSqr().redISub(j.redAdd(j)),l=j.redISub(k),m=g.redSqr();m=m.redIAdd(m),m=m.redIAdd(m),m=m.redIAdd(m);var n=h.redMul(l).redISub(m),o=c.redAdd(c).redMul(d);return this.curve.jpoint(k,n,o)},f.prototype.trpl=function(){if(!this.curve.zeroA)return this.dbl().add(this);var a=this.x.redSqr(),b=this.y.redSqr(),c=this.z.redSqr(),d=b.redSqr(),e=a.redAdd(a).redIAdd(a),f=e.redSqr(),g=this.x.redAdd(b).redSqr().redISub(a).redISub(d);g=g.redIAdd(g),g=g.redAdd(g).redIAdd(g),g=g.redISub(f);var h=g.redSqr(),i=d.redIAdd(d);i=i.redIAdd(i),i=i.redIAdd(i),i=i.redIAdd(i);var j=e.redIAdd(g).redSqr().redISub(f).redISub(h).redISub(i),k=b.redMul(j);k=k.redIAdd(k),k=k.redIAdd(k);var l=this.x.redMul(h).redISub(k);l=l.redIAdd(l),l=l.redIAdd(l);var m=this.y.redMul(j.redMul(i.redISub(j)).redISub(g.redMul(h)));m=m.redIAdd(m),m=m.redIAdd(m),m=m.redIAdd(m);var n=this.z.redAdd(g).redSqr().redISub(c).redISub(h);return this.curve.jpoint(l,m,n)},f.prototype.mul=function(a,b){return a=new i(a,b),this.curve._wnafMul(this,a)},f.prototype.eq=function(a){if("affine"===a.type)return this.eq(a.toJ());if(this===a)return!0;var b=this.z.redSqr(),c=a.z.redSqr();if(0!==this.x.redMul(c).redISub(a.x.redMul(b)).cmpn(0))return!1;var d=b.redMul(this.z),e=c.redMul(a.z);return 0===this.y.redMul(e).redISub(a.y.redMul(d)).cmpn(0)},f.prototype.eqXToP=function(a){var b=this.z.redSqr(),c=a.toRed(this.curve.red).redMul(b);if(0===this.x.cmp(c))return!0;for(var d=a.clone(),e=this.curve.redN.redMul(b);;){if(d.iadd(this.curve.n),d.cmp(this.curve.p)>=0)return!1;if(c.redIAdd(e),0===this.x.cmp(c))return!0}return!1},f.prototype.inspect=function(){return this.isInfinity()?"<EC JPoint Infinity>":"<EC JPoint x: "+this.x.toString(16,2)+" y: "+this.y.toString(16,2)+" z: "+this.z.toString(16,2)+">"},f.prototype.isInfinity=function(){return 0===this.z.cmpn(0)}},{"../../elliptic":154,"../curve":157,"bn.js":99,inherits:196}],160:[function(a,b,c){"use strict";function d(a){"short"===a.type?this.curve=new h.curve["short"](a):"edwards"===a.type?this.curve=new h.curve.edwards(a):this.curve=new h.curve.mont(a),this.g=this.curve.g,this.n=this.curve.n,this.hash=a.hash,i(this.g.validate(),"Invalid curve"),i(this.g.mul(this.n).isInfinity(),"Invalid curve, G*N != O")}function e(a,b){Object.defineProperty(f,a,{configurable:!0,enumerable:!0,get:function(){var c=new d(b);return Object.defineProperty(f,a,{configurable:!0,enumerable:!0,value:c}),c}})}var f=c,g=a("hash.js"),h=a("../elliptic"),i=h.utils.assert;f.PresetCurve=d,e("p192",{type:"short",prime:"p192",p:"ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff",a:"ffffffff ffffffff ffffffff fffffffe ffffffff fffffffc",b:"64210519 e59c80e7 0fa7e9ab 72243049 feb8deec c146b9b1",n:"ffffffff ffffffff ffffffff 99def836 146bc9b1 b4d22831",hash:g.sha256,gRed:!1,g:["188da80e b03090f6 7cbf20eb 43a18800 f4ff0afd 82ff1012","07192b95 ffc8da78 631011ed 6b24cdd5 73f977a1 1e794811"]}),e("p224",{type:"short",prime:"p224",p:"ffffffff ffffffff ffffffff ffffffff 00000000 00000000 00000001",a:"ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff fffffffe",b:"b4050a85 0c04b3ab f5413256 5044b0b7 d7bfd8ba 270b3943 2355ffb4",n:"ffffffff ffffffff ffffffff ffff16a2 e0b8f03e 13dd2945 5c5c2a3d",hash:g.sha256,gRed:!1,g:["b70e0cbd 6bb4bf7f 321390b9 4a03c1d3 56c21122 343280d6 115c1d21","bd376388 b5f723fb 4c22dfe6 cd4375a0 5a074764 44d58199 85007e34"]}),e("p256",{type:"short",prime:null,p:"ffffffff 00000001 00000000 00000000 00000000 ffffffff ffffffff ffffffff",a:"ffffffff 00000001 00000000 00000000 00000000 ffffffff ffffffff fffffffc",b:"5ac635d8 aa3a93e7 b3ebbd55 769886bc 651d06b0 cc53b0f6 3bce3c3e 27d2604b",n:"ffffffff 00000000 ffffffff ffffffff bce6faad a7179e84 f3b9cac2 fc632551",hash:g.sha256,gRed:!1,g:["6b17d1f2 e12c4247 f8bce6e5 63a440f2 77037d81 2deb33a0 f4a13945 d898c296","4fe342e2 fe1a7f9b 8ee7eb4a 7c0f9e16 2bce3357 6b315ece cbb64068 37bf51f5"]}),e("p384",{type:"short",prime:null,p:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe ffffffff 00000000 00000000 ffffffff",a:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe ffffffff 00000000 00000000 fffffffc",b:"b3312fa7 e23ee7e4 988e056b e3f82d19 181d9c6e fe814112 0314088f 5013875a c656398d 8a2ed19d 2a85c8ed d3ec2aef",n:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff c7634d81 f4372ddf 581a0db2 48b0a77a ecec196a ccc52973",hash:g.sha384,gRed:!1,g:["aa87ca22 be8b0537 8eb1c71e f320ad74 6e1d3b62 8ba79b98 59f741e0 82542a38 5502f25d bf55296c 3a545e38 72760ab7","3617de4a 96262c6f 5d9e98bf 9292dc29 f8f41dbd 289a147c e9da3113 b5f0b8c0 0a60b1ce 1d7e819d 7a431d7c 90ea0e5f"]}),e("p521",{type:"short",prime:null,p:"000001ff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff",a:"000001ff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffc",b:"00000051 953eb961 8e1c9a1f 929a21a0 b68540ee a2da725b 99b315f3 b8b48991 8ef109e1 56193951 ec7e937b 1652c0bd 3bb1bf07 3573df88 3d2c34f1 ef451fd4 6b503f00",n:"000001ff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffa 51868783 bf2f966b 7fcc0148 f709a5d0 3bb5c9b8 899c47ae bb6fb71e 91386409",hash:g.sha512,gRed:!1,g:["000000c6 858e06b7 0404e9cd 9e3ecb66 2395b442 9c648139 053fb521 f828af60 6b4d3dba a14b5e77 efe75928 fe1dc127 a2ffa8de 3348b3c1 856a429b f97e7e31 c2e5bd66","00000118 39296a78 9a3bc004 5c8a5fb4 2c7d1bd9 98f54449 579b4468 17afbd17 273e662c 97ee7299 5ef42640 c550b901 3fad0761 353c7086 a272c240 88be9476 9fd16650"]}),e("curve25519",{type:"mont",prime:"p25519",p:"7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed",a:"76d06",b:"1",n:"1000000000000000 0000000000000000 14def9dea2f79cd6 5812631a5cf5d3ed",hash:g.sha256,gRed:!1,g:["9"]}),e("ed25519",{type:"edwards",prime:"p25519",p:"7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed",a:"-1",c:"1",d:"52036cee2b6ffe73 8cc740797779e898 00700a4d4141d8ab 75eb4dca135978a3",n:"1000000000000000 0000000000000000 14def9dea2f79cd6 5812631a5cf5d3ed",hash:g.sha256,gRed:!1,g:["216936d3cd6e53fec0a4e231fdd6dc5c692cc7609525a7b2c9562d608f25d51a","6666666666666666666666666666666666666666666666666666666666666658"]});var j;try{j=a("./precomputed/secp256k1")}catch(k){j=void 0}e("secp256k1",{type:"short",prime:"k256",p:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe fffffc2f",a:"0",b:"7",n:"ffffffff ffffffff ffffffff fffffffe baaedce6 af48a03b bfd25e8c d0364141",h:"1",hash:g.sha256,beta:"7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee",lambda:"5363ad4cc05c30e0a5261c028812645a122e22ea20816678df02967c1b23bd72",basis:[{a:"3086d221a7d46bcde86c90e49284eb15",b:"-e4437ed6010e88286f547fa90abfe4c3"},{a:"114ca50f7a8e2f3f657c1108d9d44cfd8",b:"3086d221a7d46bcde86c90e49284eb15"}],gRed:!1,g:["79be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798","483ada7726a3c4655da4fbfc0e1108a8fd17b448a68554199c47d08ffb10d4b8",j]})},{"../elliptic":154,"./precomputed/secp256k1":167,"hash.js":180}],161:[function(a,b,c){"use strict";function d(a){return this instanceof d?("string"==typeof a&&(i(g.curves.hasOwnProperty(a),"Unknown curve "+a),a=g.curves[a]),a instanceof g.curves.PresetCurve&&(a={curve:a}),this.curve=a.curve.curve,this.n=this.curve.n,this.nh=this.n.ushrn(1),this.g=this.curve.g,this.g=a.curve.g,this.g.precompute(a.curve.n.bitLength()+1),void(this.hash=a.hash||a.curve.hash)):new d(a)}var e=a("bn.js"),f=a("hmac-drbg"),g=a("../../elliptic"),h=g.utils,i=h.assert,j=a("./key"),k=a("./signature");b.exports=d,d.prototype.keyPair=function(a){return new j(this,a)},d.prototype.keyFromPrivate=function(a,b){return j.fromPrivate(this,a,b)},d.prototype.keyFromPublic=function(a,b){return j.fromPublic(this,a,b)},d.prototype.genKeyPair=function(a){a||(a={});for(var b=new f({hash:this.hash,pers:a.pers,persEnc:a.persEnc||"utf8",entropy:a.entropy||g.rand(this.hash.hmacStrength),entropyEnc:a.entropy&&a.entropyEnc||"utf8",nonce:this.n.toArray()}),c=this.n.byteLength(),d=this.n.sub(new e(2));;){var h=new e(b.generate(c));if(!(h.cmp(d)>0))return h.iaddn(1),this.keyFromPrivate(h)}},d.prototype._truncateToN=function(a,b){var c=8*a.byteLength()-this.n.bitLength();return c>0&&(a=a.ushrn(c)),!b&&a.cmp(this.n)>=0?a.sub(this.n):a},d.prototype.sign=function(a,b,c,d){"object"==typeof c&&(d=c,c=null),d||(d={}),b=this.keyFromPrivate(b,c),a=this._truncateToN(new e(a,16));for(var g=this.n.byteLength(),h=b.getPrivate().toArray("be",g),i=a.toArray("be",g),j=new f({hash:this.hash,entropy:h,nonce:i,pers:d.pers,persEnc:d.persEnc||"utf8"}),l=this.n.sub(new e(1)),m=0;!0;m++){var n=d.k?d.k(m):new e(j.generate(this.n.byteLength()));if(n=this._truncateToN(n,!0),!(n.cmpn(1)<=0||n.cmp(l)>=0)){var o=this.g.mul(n);if(!o.isInfinity()){var p=o.getX(),q=p.umod(this.n);if(0!==q.cmpn(0)){var r=n.invm(this.n).mul(q.mul(b.getPrivate()).iadd(a));if(r=r.umod(this.n),0!==r.cmpn(0)){var s=(o.getY().isOdd()?1:0)|(0!==p.cmp(q)?2:0);return d.canonical&&r.cmp(this.nh)>0&&(r=this.n.sub(r),s^=1),new k({r:q,s:r,recoveryParam:s})}}}}}},d.prototype.verify=function(a,b,c,d){a=this._truncateToN(new e(a,16)),c=this.keyFromPublic(c,d),b=new k(b,"hex");var f=b.r,g=b.s;if(f.cmpn(1)<0||f.cmp(this.n)>=0)return!1;if(g.cmpn(1)<0||g.cmp(this.n)>=0)return!1;var h=g.invm(this.n),i=h.mul(a).umod(this.n),j=h.mul(f).umod(this.n);if(!this.curve._maxwellTrick){var l=this.g.mulAdd(i,c.getPublic(),j);return l.isInfinity()?!1:0===l.getX().umod(this.n).cmp(f)}var l=this.g.jmulAdd(i,c.getPublic(),j);return l.isInfinity()?!1:l.eqXToP(f)},d.prototype.recoverPubKey=function(a,b,c,d){i((3&c)===c,"The recovery param is more than two bits"),b=new k(b,d);var f=this.n,g=new e(a),h=b.r,j=b.s,l=1&c,m=c>>1;if(h.cmp(this.curve.p.umod(this.curve.n))>=0&&m)throw new Error("Unable to find sencond key candinate");h=m?this.curve.pointFromX(h.add(this.curve.n),l):this.curve.pointFromX(h,l);var n=b.r.invm(f),o=f.sub(g).mul(n).umod(f),p=j.mul(n).umod(f);return this.g.mulAdd(o,h,p)},d.prototype.getKeyRecoveryParam=function(a,b,c,d){if(b=new k(b,d),null!==b.recoveryParam)return b.recoveryParam;for(var e=0;4>e;e++){var f;try{f=this.recoverPubKey(a,b,e)}catch(a){continue}if(f.eq(c))return e}throw new Error("Unable to find valid recovery factor")}},{"../../elliptic":154,"./key":162,"./signature":163,"bn.js":99,"hmac-drbg":192}],162:[function(a,b,c){"use strict";function d(a,b){this.ec=a,this.priv=null,this.pub=null,b.priv&&this._importPrivate(b.priv,b.privEnc),b.pub&&this._importPublic(b.pub,b.pubEnc)}var e=a("bn.js"),f=a("../../elliptic"),g=f.utils,h=g.assert;b.exports=d,d.fromPublic=function(a,b,c){return b instanceof d?b:new d(a,{pub:b,pubEnc:c})},d.fromPrivate=function(a,b,c){return b instanceof d?b:new d(a,{priv:b,privEnc:c})},d.prototype.validate=function(){var a=this.getPublic();return a.isInfinity()?{result:!1,reason:"Invalid public key"}:a.validate()?a.mul(this.ec.curve.n).isInfinity()?{result:!0,reason:null}:{result:!1,reason:"Public key * N != O"}:{result:!1,reason:"Public key is not a point"}},d.prototype.getPublic=function(a,b){return"string"==typeof a&&(b=a,a=null),this.pub||(this.pub=this.ec.g.mul(this.priv)),b?this.pub.encode(b,a):this.pub},d.prototype.getPrivate=function(a){return"hex"===a?this.priv.toString(16,2):this.priv},d.prototype._importPrivate=function(a,b){this.priv=new e(a,b||16),this.priv=this.priv.umod(this.ec.curve.n)},d.prototype._importPublic=function(a,b){return a.x||a.y?("mont"===this.ec.curve.type?h(a.x,"Need x coordinate"):("short"===this.ec.curve.type||"edwards"===this.ec.curve.type)&&h(a.x&&a.y,"Need both x and y coordinate"),void(this.pub=this.ec.curve.point(a.x,a.y))):void(this.pub=this.ec.curve.decodePoint(a,b))},d.prototype.derive=function(a){return a.mul(this.priv).getX()},d.prototype.sign=function(a,b,c){return this.ec.sign(a,this,b,c)},d.prototype.verify=function(a,b){return this.ec.verify(a,b,this)},d.prototype.inspect=function(){return"<Key priv: "+(this.priv&&this.priv.toString(16,2))+" pub: "+(this.pub&&this.pub.inspect())+" >"}},{"../../elliptic":154,"bn.js":99}],163:[function(a,b,c){"use strict";function d(a,b){return a instanceof d?a:void(this._importDER(a,b)||(l(a.r&&a.s,"Signature without r or s"),this.r=new i(a.r,16),this.s=new i(a.s,16),void 0===a.recoveryParam?this.recoveryParam=null:this.recoveryParam=a.recoveryParam))}function e(){this.place=0}function f(a,b){var c=a[b.place++];if(!(128&c))return c;for(var d=15&c,e=0,f=0,g=b.place;d>f;f++,g++)e<<=8,e|=a[g];return b.place=g,e}function g(a){for(var b=0,c=a.length-1;!a[b]&&!(128&a[b+1])&&c>b;)b++;return 0===b?a:a.slice(b)}function h(a,b){if(128>b)return void a.push(b);var c=1+(Math.log(b)/Math.LN2>>>3);for(a.push(128|c);--c;)a.push(b>>>(c<<3)&255);a.push(b)}var i=a("bn.js"),j=a("../../elliptic"),k=j.utils,l=k.assert;b.exports=d,d.prototype._importDER=function(a,b){a=k.toArray(a,b);var c=new e;if(48!==a[c.place++])return!1;var d=f(a,c);if(d+c.place!==a.length)return!1;if(2!==a[c.place++])return!1;var g=f(a,c),h=a.slice(c.place,g+c.place);if(c.place+=g,2!==a[c.place++])return!1;var j=f(a,c);if(a.length!==j+c.place)return!1;var l=a.slice(c.place,j+c.place);return 0===h[0]&&128&h[1]&&(h=h.slice(1)),0===l[0]&&128&l[1]&&(l=l.slice(1)),this.r=new i(h),this.s=new i(l),this.recoveryParam=null,!0},d.prototype.toDER=function(a){var b=this.r.toArray(),c=this.s.toArray();for(128&b[0]&&(b=[0].concat(b)),128&c[0]&&(c=[0].concat(c)),b=g(b),c=g(c);!(c[0]||128&c[1]);)c=c.slice(1);var d=[2];h(d,b.length),d=d.concat(b),d.push(2),h(d,c.length);var e=d.concat(c),f=[48];return h(f,e.length),f=f.concat(e),k.encode(f,a)}},{"../../elliptic":154,"bn.js":99}],164:[function(a,b,c){"use strict";function d(a){if(h("ed25519"===a,"only tested with ed25519 so far"),!(this instanceof d))return new d(a);var a=f.curves[a].curve;this.curve=a,this.g=a.g,this.g.precompute(a.n.bitLength()+1),this.pointClass=a.point().constructor,this.encodingLength=Math.ceil(a.n.bitLength()/8),this.hash=e.sha512}var e=a("hash.js"),f=a("../../elliptic"),g=f.utils,h=g.assert,i=g.parseBytes,j=a("./key"),k=a("./signature");b.exports=d,d.prototype.sign=function(a,b){a=i(a);var c=this.keyFromSecret(b),d=this.hashInt(c.messagePrefix(),a),e=this.g.mul(d),f=this.encodePoint(e),g=this.hashInt(f,c.pubBytes(),a).mul(c.priv()),h=d.add(g).umod(this.curve.n);return this.makeSignature({R:e,S:h,Rencoded:f})},d.prototype.verify=function(a,b,c){a=i(a),b=this.makeSignature(b);var d=this.keyFromPublic(c),e=this.hashInt(b.Rencoded(),d.pubBytes(),a),f=this.g.mul(b.S()),g=b.R().add(d.pub().mul(e));
return g.eq(f)},d.prototype.hashInt=function(){for(var a=this.hash(),b=0;b<arguments.length;b++)a.update(arguments[b]);return g.intFromLE(a.digest()).umod(this.curve.n)},d.prototype.keyFromPublic=function(a){return j.fromPublic(this,a)},d.prototype.keyFromSecret=function(a){return j.fromSecret(this,a)},d.prototype.makeSignature=function(a){return a instanceof k?a:new k(this,a)},d.prototype.encodePoint=function(a){var b=a.getY().toArray("le",this.encodingLength);return b[this.encodingLength-1]|=a.getX().isOdd()?128:0,b},d.prototype.decodePoint=function(a){a=g.parseBytes(a);var b=a.length-1,c=a.slice(0,b).concat(-129&a[b]),d=0!==(128&a[b]),e=g.intFromLE(c);return this.curve.pointFromY(e,d)},d.prototype.encodeInt=function(a){return a.toArray("le",this.encodingLength)},d.prototype.decodeInt=function(a){return g.intFromLE(a)},d.prototype.isPoint=function(a){return a instanceof this.pointClass}},{"../../elliptic":154,"./key":165,"./signature":166,"hash.js":180}],165:[function(a,b,c){"use strict";function d(a,b){this.eddsa=a,this._secret=h(b.secret),a.isPoint(b.pub)?this._pub=b.pub:this._pubBytes=h(b.pub)}var e=a("../../elliptic"),f=e.utils,g=f.assert,h=f.parseBytes,i=f.cachedProperty;d.fromPublic=function(a,b){return b instanceof d?b:new d(a,{pub:b})},d.fromSecret=function(a,b){return b instanceof d?b:new d(a,{secret:b})},d.prototype.secret=function(){return this._secret},i(d,"pubBytes",function(){return this.eddsa.encodePoint(this.pub())}),i(d,"pub",function(){return this._pubBytes?this.eddsa.decodePoint(this._pubBytes):this.eddsa.g.mul(this.priv())}),i(d,"privBytes",function(){var a=this.eddsa,b=this.hash(),c=a.encodingLength-1,d=b.slice(0,a.encodingLength);return d[0]&=248,d[c]&=127,d[c]|=64,d}),i(d,"priv",function(){return this.eddsa.decodeInt(this.privBytes())}),i(d,"hash",function(){return this.eddsa.hash().update(this.secret()).digest()}),i(d,"messagePrefix",function(){return this.hash().slice(this.eddsa.encodingLength)}),d.prototype.sign=function(a){return g(this._secret,"KeyPair can only verify"),this.eddsa.sign(a,this)},d.prototype.verify=function(a,b){return this.eddsa.verify(a,b,this)},d.prototype.getSecret=function(a){return g(this._secret,"KeyPair is public only"),f.encode(this.secret(),a)},d.prototype.getPublic=function(a){return f.encode(this.pubBytes(),a)},b.exports=d},{"../../elliptic":154}],166:[function(a,b,c){"use strict";function d(a,b){this.eddsa=a,"object"!=typeof b&&(b=j(b)),Array.isArray(b)&&(b={R:b.slice(0,a.encodingLength),S:b.slice(a.encodingLength)}),h(b.R&&b.S,"Signature without R or S"),a.isPoint(b.R)&&(this._R=b.R),b.S instanceof e&&(this._S=b.S),this._Rencoded=Array.isArray(b.R)?b.R:b.Rencoded,this._Sencoded=Array.isArray(b.S)?b.S:b.Sencoded}var e=a("bn.js"),f=a("../../elliptic"),g=f.utils,h=g.assert,i=g.cachedProperty,j=g.parseBytes;i(d,"S",function(){return this.eddsa.decodeInt(this.Sencoded())}),i(d,"R",function(){return this.eddsa.decodePoint(this.Rencoded())}),i(d,"Rencoded",function(){return this.eddsa.encodePoint(this.R())}),i(d,"Sencoded",function(){return this.eddsa.encodeInt(this.S())}),d.prototype.toBytes=function(){return this.Rencoded().concat(this.Sencoded())},d.prototype.toHex=function(){return g.encode(this.toBytes(),"hex").toUpperCase()},b.exports=d},{"../../elliptic":154,"bn.js":99}],167:[function(a,b,c){b.exports={doubles:{step:4,points:[["e60fce93b59e9ec53011aabc21c23e97b2a31369b87a5ae9c44ee89e2a6dec0a","f7e3507399e595929db99f34f57937101296891e44d23f0be1f32cce69616821"],["8282263212c609d9ea2a6e3e172de238d8c39cabd5ac1ca10646e23fd5f51508","11f8a8098557dfe45e8256e830b60ace62d613ac2f7b17bed31b6eaff6e26caf"],["175e159f728b865a72f99cc6c6fc846de0b93833fd2222ed73fce5b551e5b739","d3506e0d9e3c79eba4ef97a51ff71f5eacb5955add24345c6efa6ffee9fed695"],["363d90d447b00c9c99ceac05b6262ee053441c7e55552ffe526bad8f83ff4640","4e273adfc732221953b445397f3363145b9a89008199ecb62003c7f3bee9de9"],["8b4b5f165df3c2be8c6244b5b745638843e4a781a15bcd1b69f79a55dffdf80c","4aad0a6f68d308b4b3fbd7813ab0da04f9e336546162ee56b3eff0c65fd4fd36"],["723cbaa6e5db996d6bf771c00bd548c7b700dbffa6c0e77bcb6115925232fcda","96e867b5595cc498a921137488824d6e2660a0653779494801dc069d9eb39f5f"],["eebfa4d493bebf98ba5feec812c2d3b50947961237a919839a533eca0e7dd7fa","5d9a8ca3970ef0f269ee7edaf178089d9ae4cdc3a711f712ddfd4fdae1de8999"],["100f44da696e71672791d0a09b7bde459f1215a29b3c03bfefd7835b39a48db0","cdd9e13192a00b772ec8f3300c090666b7ff4a18ff5195ac0fbd5cd62bc65a09"],["e1031be262c7ed1b1dc9227a4a04c017a77f8d4464f3b3852c8acde6e534fd2d","9d7061928940405e6bb6a4176597535af292dd419e1ced79a44f18f29456a00d"],["feea6cae46d55b530ac2839f143bd7ec5cf8b266a41d6af52d5e688d9094696d","e57c6b6c97dce1bab06e4e12bf3ecd5c981c8957cc41442d3155debf18090088"],["da67a91d91049cdcb367be4be6ffca3cfeed657d808583de33fa978bc1ec6cb1","9bacaa35481642bc41f463f7ec9780e5dec7adc508f740a17e9ea8e27a68be1d"],["53904faa0b334cdda6e000935ef22151ec08d0f7bb11069f57545ccc1a37b7c0","5bc087d0bc80106d88c9eccac20d3c1c13999981e14434699dcb096b022771c8"],["8e7bcd0bd35983a7719cca7764ca906779b53a043a9b8bcaeff959f43ad86047","10b7770b2a3da4b3940310420ca9514579e88e2e47fd68b3ea10047e8460372a"],["385eed34c1cdff21e6d0818689b81bde71a7f4f18397e6690a841e1599c43862","283bebc3e8ea23f56701de19e9ebf4576b304eec2086dc8cc0458fe5542e5453"],["6f9d9b803ecf191637c73a4413dfa180fddf84a5947fbc9c606ed86c3fac3a7","7c80c68e603059ba69b8e2a30e45c4d47ea4dd2f5c281002d86890603a842160"],["3322d401243c4e2582a2147c104d6ecbf774d163db0f5e5313b7e0e742d0e6bd","56e70797e9664ef5bfb019bc4ddaf9b72805f63ea2873af624f3a2e96c28b2a0"],["85672c7d2de0b7da2bd1770d89665868741b3f9af7643397721d74d28134ab83","7c481b9b5b43b2eb6374049bfa62c2e5e77f17fcc5298f44c8e3094f790313a6"],["948bf809b1988a46b06c9f1919413b10f9226c60f668832ffd959af60c82a0a","53a562856dcb6646dc6b74c5d1c3418c6d4dff08c97cd2bed4cb7f88d8c8e589"],["6260ce7f461801c34f067ce0f02873a8f1b0e44dfc69752accecd819f38fd8e8","bc2da82b6fa5b571a7f09049776a1ef7ecd292238051c198c1a84e95b2b4ae17"],["e5037de0afc1d8d43d8348414bbf4103043ec8f575bfdc432953cc8d2037fa2d","4571534baa94d3b5f9f98d09fb990bddbd5f5b03ec481f10e0e5dc841d755bda"],["e06372b0f4a207adf5ea905e8f1771b4e7e8dbd1c6a6c5b725866a0ae4fce725","7a908974bce18cfe12a27bb2ad5a488cd7484a7787104870b27034f94eee31dd"],["213c7a715cd5d45358d0bbf9dc0ce02204b10bdde2a3f58540ad6908d0559754","4b6dad0b5ae462507013ad06245ba190bb4850f5f36a7eeddff2c27534b458f2"],["4e7c272a7af4b34e8dbb9352a5419a87e2838c70adc62cddf0cc3a3b08fbd53c","17749c766c9d0b18e16fd09f6def681b530b9614bff7dd33e0b3941817dcaae6"],["fea74e3dbe778b1b10f238ad61686aa5c76e3db2be43057632427e2840fb27b6","6e0568db9b0b13297cf674deccb6af93126b596b973f7b77701d3db7f23cb96f"],["76e64113f677cf0e10a2570d599968d31544e179b760432952c02a4417bdde39","c90ddf8dee4e95cf577066d70681f0d35e2a33d2b56d2032b4b1752d1901ac01"],["c738c56b03b2abe1e8281baa743f8f9a8f7cc643df26cbee3ab150242bcbb891","893fb578951ad2537f718f2eacbfbbbb82314eef7880cfe917e735d9699a84c3"],["d895626548b65b81e264c7637c972877d1d72e5f3a925014372e9f6588f6c14b","febfaa38f2bc7eae728ec60818c340eb03428d632bb067e179363ed75d7d991f"],["b8da94032a957518eb0f6433571e8761ceffc73693e84edd49150a564f676e03","2804dfa44805a1e4d7c99cc9762808b092cc584d95ff3b511488e4e74efdf6e7"],["e80fea14441fb33a7d8adab9475d7fab2019effb5156a792f1a11778e3c0df5d","eed1de7f638e00771e89768ca3ca94472d155e80af322ea9fcb4291b6ac9ec78"],["a301697bdfcd704313ba48e51d567543f2a182031efd6915ddc07bbcc4e16070","7370f91cfb67e4f5081809fa25d40f9b1735dbf7c0a11a130c0d1a041e177ea1"],["90ad85b389d6b936463f9d0512678de208cc330b11307fffab7ac63e3fb04ed4","e507a3620a38261affdcbd9427222b839aefabe1582894d991d4d48cb6ef150"],["8f68b9d2f63b5f339239c1ad981f162ee88c5678723ea3351b7b444c9ec4c0da","662a9f2dba063986de1d90c2b6be215dbbea2cfe95510bfdf23cbf79501fff82"],["e4f3fb0176af85d65ff99ff9198c36091f48e86503681e3e6686fd5053231e11","1e63633ad0ef4f1c1661a6d0ea02b7286cc7e74ec951d1c9822c38576feb73bc"],["8c00fa9b18ebf331eb961537a45a4266c7034f2f0d4e1d0716fb6eae20eae29e","efa47267fea521a1a9dc343a3736c974c2fadafa81e36c54e7d2a4c66702414b"],["e7a26ce69dd4829f3e10cec0a9e98ed3143d084f308b92c0997fddfc60cb3e41","2a758e300fa7984b471b006a1aafbb18d0a6b2c0420e83e20e8a9421cf2cfd51"],["b6459e0ee3662ec8d23540c223bcbdc571cbcb967d79424f3cf29eb3de6b80ef","67c876d06f3e06de1dadf16e5661db3c4b3ae6d48e35b2ff30bf0b61a71ba45"],["d68a80c8280bb840793234aa118f06231d6f1fc67e73c5a5deda0f5b496943e8","db8ba9fff4b586d00c4b1f9177b0e28b5b0e7b8f7845295a294c84266b133120"],["324aed7df65c804252dc0270907a30b09612aeb973449cea4095980fc28d3d5d","648a365774b61f2ff130c0c35aec1f4f19213b0c7e332843967224af96ab7c84"],["4df9c14919cde61f6d51dfdbe5fee5dceec4143ba8d1ca888e8bd373fd054c96","35ec51092d8728050974c23a1d85d4b5d506cdc288490192ebac06cad10d5d"],["9c3919a84a474870faed8a9c1cc66021523489054d7f0308cbfc99c8ac1f98cd","ddb84f0f4a4ddd57584f044bf260e641905326f76c64c8e6be7e5e03d4fc599d"],["6057170b1dd12fdf8de05f281d8e06bb91e1493a8b91d4cc5a21382120a959e5","9a1af0b26a6a4807add9a2daf71df262465152bc3ee24c65e899be932385a2a8"],["a576df8e23a08411421439a4518da31880cef0fba7d4df12b1a6973eecb94266","40a6bf20e76640b2c92b97afe58cd82c432e10a7f514d9f3ee8be11ae1b28ec8"],["7778a78c28dec3e30a05fe9629de8c38bb30d1f5cf9a3a208f763889be58ad71","34626d9ab5a5b22ff7098e12f2ff580087b38411ff24ac563b513fc1fd9f43ac"],["928955ee637a84463729fd30e7afd2ed5f96274e5ad7e5cb09eda9c06d903ac","c25621003d3f42a827b78a13093a95eeac3d26efa8a8d83fc5180e935bcd091f"],["85d0fef3ec6db109399064f3a0e3b2855645b4a907ad354527aae75163d82751","1f03648413a38c0be29d496e582cf5663e8751e96877331582c237a24eb1f962"],["ff2b0dce97eece97c1c9b6041798b85dfdfb6d8882da20308f5404824526087e","493d13fef524ba188af4c4dc54d07936c7b7ed6fb90e2ceb2c951e01f0c29907"],["827fbbe4b1e880ea9ed2b2e6301b212b57f1ee148cd6dd28780e5e2cf856e241","c60f9c923c727b0b71bef2c67d1d12687ff7a63186903166d605b68baec293ec"],["eaa649f21f51bdbae7be4ae34ce6e5217a58fdce7f47f9aa7f3b58fa2120e2b3","be3279ed5bbbb03ac69a80f89879aa5a01a6b965f13f7e59d47a5305ba5ad93d"],["e4a42d43c5cf169d9391df6decf42ee541b6d8f0c9a137401e23632dda34d24f","4d9f92e716d1c73526fc99ccfb8ad34ce886eedfa8d8e4f13a7f7131deba9414"],["1ec80fef360cbdd954160fadab352b6b92b53576a88fea4947173b9d4300bf19","aeefe93756b5340d2f3a4958a7abbf5e0146e77f6295a07b671cdc1cc107cefd"],["146a778c04670c2f91b00af4680dfa8bce3490717d58ba889ddb5928366642be","b318e0ec3354028add669827f9d4b2870aaa971d2f7e5ed1d0b297483d83efd0"],["fa50c0f61d22e5f07e3acebb1aa07b128d0012209a28b9776d76a8793180eef9","6b84c6922397eba9b72cd2872281a68a5e683293a57a213b38cd8d7d3f4f2811"],["da1d61d0ca721a11b1a5bf6b7d88e8421a288ab5d5bba5220e53d32b5f067ec2","8157f55a7c99306c79c0766161c91e2966a73899d279b48a655fba0f1ad836f1"],["a8e282ff0c9706907215ff98e8fd416615311de0446f1e062a73b0610d064e13","7f97355b8db81c09abfb7f3c5b2515888b679a3e50dd6bd6cef7c73111f4cc0c"],["174a53b9c9a285872d39e56e6913cab15d59b1fa512508c022f382de8319497c","ccc9dc37abfc9c1657b4155f2c47f9e6646b3a1d8cb9854383da13ac079afa73"],["959396981943785c3d3e57edf5018cdbe039e730e4918b3d884fdff09475b7ba","2e7e552888c331dd8ba0386a4b9cd6849c653f64c8709385e9b8abf87524f2fd"],["d2a63a50ae401e56d645a1153b109a8fcca0a43d561fba2dbb51340c9d82b151","e82d86fb6443fcb7565aee58b2948220a70f750af484ca52d4142174dcf89405"],["64587e2335471eb890ee7896d7cfdc866bacbdbd3839317b3436f9b45617e073","d99fcdd5bf6902e2ae96dd6447c299a185b90a39133aeab358299e5e9faf6589"],["8481bde0e4e4d885b3a546d3e549de042f0aa6cea250e7fd358d6c86dd45e458","38ee7b8cba5404dd84a25bf39cecb2ca900a79c42b262e556d64b1b59779057e"],["13464a57a78102aa62b6979ae817f4637ffcfed3c4b1ce30bcd6303f6caf666b","69be159004614580ef7e433453ccb0ca48f300a81d0942e13f495a907f6ecc27"],["bc4a9df5b713fe2e9aef430bcc1dc97a0cd9ccede2f28588cada3a0d2d83f366","d3a81ca6e785c06383937adf4b798caa6e8a9fbfa547b16d758d666581f33c1"],["8c28a97bf8298bc0d23d8c749452a32e694b65e30a9472a3954ab30fe5324caa","40a30463a3305193378fedf31f7cc0eb7ae784f0451cb9459e71dc73cbef9482"],["8ea9666139527a8c1dd94ce4f071fd23c8b350c5a4bb33748c4ba111faccae0","620efabbc8ee2782e24e7c0cfb95c5d735b783be9cf0f8e955af34a30e62b945"],["dd3625faef5ba06074669716bbd3788d89bdde815959968092f76cc4eb9a9787","7a188fa3520e30d461da2501045731ca941461982883395937f68d00c644a573"],["f710d79d9eb962297e4f6232b40e8f7feb2bc63814614d692c12de752408221e","ea98e67232d3b3295d3b535532115ccac8612c721851617526ae47a9c77bfc82"]]},naf:{wnd:7,points:[["f9308a019258c31049344f85f89d5229b531c845836f99b08601f113bce036f9","388f7b0f632de8140fe337e62a37f3566500a99934c2231b6cb9fd7584b8e672"],["2f8bde4d1a07209355b4a7250a5c5128e88b84bddc619ab7cba8d569b240efe4","d8ac222636e5e3d6d4dba9dda6c9c426f788271bab0d6840dca87d3aa6ac62d6"],["5cbdf0646e5db4eaa398f365f2ea7a0e3d419b7e0330e39ce92bddedcac4f9bc","6aebca40ba255960a3178d6d861a54dba813d0b813fde7b5a5082628087264da"],["acd484e2f0c7f65309ad178a9f559abde09796974c57e714c35f110dfc27ccbe","cc338921b0a7d9fd64380971763b61e9add888a4375f8e0f05cc262ac64f9c37"],["774ae7f858a9411e5ef4246b70c65aac5649980be5c17891bbec17895da008cb","d984a032eb6b5e190243dd56d7b7b365372db1e2dff9d6a8301d74c9c953c61b"],["f28773c2d975288bc7d1d205c3748651b075fbc6610e58cddeeddf8f19405aa8","ab0902e8d880a89758212eb65cdaf473a1a06da521fa91f29b5cb52db03ed81"],["d7924d4f7d43ea965a465ae3095ff41131e5946f3c85f79e44adbcf8e27e080e","581e2872a86c72a683842ec228cc6defea40af2bd896d3a5c504dc9ff6a26b58"],["defdea4cdb677750a420fee807eacf21eb9898ae79b9768766e4faa04a2d4a34","4211ab0694635168e997b0ead2a93daeced1f4a04a95c0f6cfb199f69e56eb77"],["2b4ea0a797a443d293ef5cff444f4979f06acfebd7e86d277475656138385b6c","85e89bc037945d93b343083b5a1c86131a01f60c50269763b570c854e5c09b7a"],["352bbf4a4cdd12564f93fa332ce333301d9ad40271f8107181340aef25be59d5","321eb4075348f534d59c18259dda3e1f4a1b3b2e71b1039c67bd3d8bcf81998c"],["2fa2104d6b38d11b0230010559879124e42ab8dfeff5ff29dc9cdadd4ecacc3f","2de1068295dd865b64569335bd5dd80181d70ecfc882648423ba76b532b7d67"],["9248279b09b4d68dab21a9b066edda83263c3d84e09572e269ca0cd7f5453714","73016f7bf234aade5d1aa71bdea2b1ff3fc0de2a887912ffe54a32ce97cb3402"],["daed4f2be3a8bf278e70132fb0beb7522f570e144bf615c07e996d443dee8729","a69dce4a7d6c98e8d4a1aca87ef8d7003f83c230f3afa726ab40e52290be1c55"],["c44d12c7065d812e8acf28d7cbb19f9011ecd9e9fdf281b0e6a3b5e87d22e7db","2119a460ce326cdc76c45926c982fdac0e106e861edf61c5a039063f0e0e6482"],["6a245bf6dc698504c89a20cfded60853152b695336c28063b61c65cbd269e6b4","e022cf42c2bd4a708b3f5126f16a24ad8b33ba48d0423b6efd5e6348100d8a82"],["1697ffa6fd9de627c077e3d2fe541084ce13300b0bec1146f95ae57f0d0bd6a5","b9c398f186806f5d27561506e4557433a2cf15009e498ae7adee9d63d01b2396"],["605bdb019981718b986d0f07e834cb0d9deb8360ffb7f61df982345ef27a7479","2972d2de4f8d20681a78d93ec96fe23c26bfae84fb14db43b01e1e9056b8c49"],["62d14dab4150bf497402fdc45a215e10dcb01c354959b10cfe31c7e9d87ff33d","80fc06bd8cc5b01098088a1950eed0db01aa132967ab472235f5642483b25eaf"],["80c60ad0040f27dade5b4b06c408e56b2c50e9f56b9b8b425e555c2f86308b6f","1c38303f1cc5c30f26e66bad7fe72f70a65eed4cbe7024eb1aa01f56430bd57a"],["7a9375ad6167ad54aa74c6348cc54d344cc5dc9487d847049d5eabb0fa03c8fb","d0e3fa9eca8726909559e0d79269046bdc59ea10c70ce2b02d499ec224dc7f7"],["d528ecd9b696b54c907a9ed045447a79bb408ec39b68df504bb51f459bc3ffc9","eecf41253136e5f99966f21881fd656ebc4345405c520dbc063465b521409933"],["49370a4b5f43412ea25f514e8ecdad05266115e4a7ecb1387231808f8b45963","758f3f41afd6ed428b3081b0512fd62a54c3f3afbb5b6764b653052a12949c9a"],["77f230936ee88cbbd73df930d64702ef881d811e0e1498e2f1c13eb1fc345d74","958ef42a7886b6400a08266e9ba1b37896c95330d97077cbbe8eb3c7671c60d6"],["f2dac991cc4ce4b9ea44887e5c7c0bce58c80074ab9d4dbaeb28531b7739f530","e0dedc9b3b2f8dad4da1f32dec2531df9eb5fbeb0598e4fd1a117dba703a3c37"],["463b3d9f662621fb1b4be8fbbe2520125a216cdfc9dae3debcba4850c690d45b","5ed430d78c296c3543114306dd8622d7c622e27c970a1de31cb377b01af7307e"],["f16f804244e46e2a09232d4aff3b59976b98fac14328a2d1a32496b49998f247","cedabd9b82203f7e13d206fcdf4e33d92a6c53c26e5cce26d6579962c4e31df6"],["caf754272dc84563b0352b7a14311af55d245315ace27c65369e15f7151d41d1","cb474660ef35f5f2a41b643fa5e460575f4fa9b7962232a5c32f908318a04476"],["2600ca4b282cb986f85d0f1709979d8b44a09c07cb86d7c124497bc86f082120","4119b88753c15bd6a693b03fcddbb45d5ac6be74ab5f0ef44b0be9475a7e4b40"],["7635ca72d7e8432c338ec53cd12220bc01c48685e24f7dc8c602a7746998e435","91b649609489d613d1d5e590f78e6d74ecfc061d57048bad9e76f302c5b9c61"],["754e3239f325570cdbbf4a87deee8a66b7f2b33479d468fbc1a50743bf56cc18","673fb86e5bda30fb3cd0ed304ea49a023ee33d0197a695d0c5d98093c536683"],["e3e6bd1071a1e96aff57859c82d570f0330800661d1c952f9fe2694691d9b9e8","59c9e0bba394e76f40c0aa58379a3cb6a5a2283993e90c4167002af4920e37f5"],["186b483d056a033826ae73d88f732985c4ccb1f32ba35f4b4cc47fdcf04aa6eb","3b952d32c67cf77e2e17446e204180ab21fb8090895138b4a4a797f86e80888b"],["df9d70a6b9876ce544c98561f4be4f725442e6d2b737d9c91a8321724ce0963f","55eb2dafd84d6ccd5f862b785dc39d4ab157222720ef9da217b8c45cf2ba2417"],["5edd5cc23c51e87a497ca815d5dce0f8ab52554f849ed8995de64c5f34ce7143","efae9c8dbc14130661e8cec030c89ad0c13c66c0d17a2905cdc706ab7399a868"],["290798c2b6476830da12fe02287e9e777aa3fba1c355b17a722d362f84614fba","e38da76dcd440621988d00bcf79af25d5b29c094db2a23146d003afd41943e7a"],["af3c423a95d9f5b3054754efa150ac39cd29552fe360257362dfdecef4053b45","f98a3fd831eb2b749a93b0e6f35cfb40c8cd5aa667a15581bc2feded498fd9c6"],["766dbb24d134e745cccaa28c99bf274906bb66b26dcf98df8d2fed50d884249a","744b1152eacbe5e38dcc887980da38b897584a65fa06cedd2c924f97cbac5996"],["59dbf46f8c94759ba21277c33784f41645f7b44f6c596a58ce92e666191abe3e","c534ad44175fbc300f4ea6ce648309a042ce739a7919798cd85e216c4a307f6e"],["f13ada95103c4537305e691e74e9a4a8dd647e711a95e73cb62dc6018cfd87b8","e13817b44ee14de663bf4bc808341f326949e21a6a75c2570778419bdaf5733d"],["7754b4fa0e8aced06d4167a2c59cca4cda1869c06ebadfb6488550015a88522c","30e93e864e669d82224b967c3020b8fa8d1e4e350b6cbcc537a48b57841163a2"],["948dcadf5990e048aa3874d46abef9d701858f95de8041d2a6828c99e2262519","e491a42537f6e597d5d28a3224b1bc25df9154efbd2ef1d2cbba2cae5347d57e"],["7962414450c76c1689c7b48f8202ec37fb224cf5ac0bfa1570328a8a3d7c77ab","100b610ec4ffb4760d5c1fc133ef6f6b12507a051f04ac5760afa5b29db83437"],["3514087834964b54b15b160644d915485a16977225b8847bb0dd085137ec47ca","ef0afbb2056205448e1652c48e8127fc6039e77c15c2378b7e7d15a0de293311"],["d3cc30ad6b483e4bc79ce2c9dd8bc54993e947eb8df787b442943d3f7b527eaf","8b378a22d827278d89c5e9be8f9508ae3c2ad46290358630afb34db04eede0a4"],["1624d84780732860ce1c78fcbfefe08b2b29823db913f6493975ba0ff4847610","68651cf9b6da903e0914448c6cd9d4ca896878f5282be4c8cc06e2a404078575"],["733ce80da955a8a26902c95633e62a985192474b5af207da6df7b4fd5fc61cd4","f5435a2bd2badf7d485a4d8b8db9fcce3e1ef8e0201e4578c54673bc1dc5ea1d"],["15d9441254945064cf1a1c33bbd3b49f8966c5092171e699ef258dfab81c045c","d56eb30b69463e7234f5137b73b84177434800bacebfc685fc37bbe9efe4070d"],["a1d0fcf2ec9de675b612136e5ce70d271c21417c9d2b8aaaac138599d0717940","edd77f50bcb5a3cab2e90737309667f2641462a54070f3d519212d39c197a629"],["e22fbe15c0af8ccc5780c0735f84dbe9a790badee8245c06c7ca37331cb36980","a855babad5cd60c88b430a69f53a1a7a38289154964799be43d06d77d31da06"],["311091dd9860e8e20ee13473c1155f5f69635e394704eaa74009452246cfa9b3","66db656f87d1f04fffd1f04788c06830871ec5a64feee685bd80f0b1286d8374"],["34c1fd04d301be89b31c0442d3e6ac24883928b45a9340781867d4232ec2dbdf","9414685e97b1b5954bd46f730174136d57f1ceeb487443dc5321857ba73abee"],["f219ea5d6b54701c1c14de5b557eb42a8d13f3abbcd08affcc2a5e6b049b8d63","4cb95957e83d40b0f73af4544cccf6b1f4b08d3c07b27fb8d8c2962a400766d1"],["d7b8740f74a8fbaab1f683db8f45de26543a5490bca627087236912469a0b448","fa77968128d9c92ee1010f337ad4717eff15db5ed3c049b3411e0315eaa4593b"],["32d31c222f8f6f0ef86f7c98d3a3335ead5bcd32abdd94289fe4d3091aa824bf","5f3032f5892156e39ccd3d7915b9e1da2e6dac9e6f26e961118d14b8462e1661"],["7461f371914ab32671045a155d9831ea8793d77cd59592c4340f86cbc18347b5","8ec0ba238b96bec0cbdddcae0aa442542eee1ff50c986ea6b39847b3cc092ff6"],["ee079adb1df1860074356a25aa38206a6d716b2c3e67453d287698bad7b2b2d6","8dc2412aafe3be5c4c5f37e0ecc5f9f6a446989af04c4e25ebaac479ec1c8c1e"],["16ec93e447ec83f0467b18302ee620f7e65de331874c9dc72bfd8616ba9da6b5","5e4631150e62fb40d0e8c2a7ca5804a39d58186a50e497139626778e25b0674d"],["eaa5f980c245f6f038978290afa70b6bd8855897f98b6aa485b96065d537bd99","f65f5d3e292c2e0819a528391c994624d784869d7e6ea67fb18041024edc07dc"],["78c9407544ac132692ee1910a02439958ae04877151342ea96c4b6b35a49f51","f3e0319169eb9b85d5404795539a5e68fa1fbd583c064d2462b675f194a3ddb4"],["494f4be219a1a77016dcd838431aea0001cdc8ae7a6fc688726578d9702857a5","42242a969283a5f339ba7f075e36ba2af925ce30d767ed6e55f4b031880d562c"],["a598a8030da6d86c6bc7f2f5144ea549d28211ea58faa70ebf4c1e665c1fe9b5","204b5d6f84822c307e4b4a7140737aec23fc63b65b35f86a10026dbd2d864e6b"],["c41916365abb2b5d09192f5f2dbeafec208f020f12570a184dbadc3e58595997","4f14351d0087efa49d245b328984989d5caf9450f34bfc0ed16e96b58fa9913"],["841d6063a586fa475a724604da03bc5b92a2e0d2e0a36acfe4c73a5514742881","73867f59c0659e81904f9a1c7543698e62562d6744c169ce7a36de01a8d6154"],["5e95bb399a6971d376026947f89bde2f282b33810928be4ded112ac4d70e20d5","39f23f366809085beebfc71181313775a99c9aed7d8ba38b161384c746012865"],["36e4641a53948fd476c39f8a99fd974e5ec07564b5315d8bf99471bca0ef2f66","d2424b1b1abe4eb8164227b085c9aa9456ea13493fd563e06fd51cf5694c78fc"],["336581ea7bfbbb290c191a2f507a41cf5643842170e914faeab27c2c579f726","ead12168595fe1be99252129b6e56b3391f7ab1410cd1e0ef3dcdcabd2fda224"],["8ab89816dadfd6b6a1f2634fcf00ec8403781025ed6890c4849742706bd43ede","6fdcef09f2f6d0a044e654aef624136f503d459c3e89845858a47a9129cdd24e"],["1e33f1a746c9c5778133344d9299fcaa20b0938e8acff2544bb40284b8c5fb94","60660257dd11b3aa9c8ed618d24edff2306d320f1d03010e33a7d2057f3b3b6"],["85b7c1dcb3cec1b7ee7f30ded79dd20a0ed1f4cc18cbcfcfa410361fd8f08f31","3d98a9cdd026dd43f39048f25a8847f4fcafad1895d7a633c6fed3c35e999511"],["29df9fbd8d9e46509275f4b125d6d45d7fbe9a3b878a7af872a2800661ac5f51","b4c4fe99c775a606e2d8862179139ffda61dc861c019e55cd2876eb2a27d84b"],["a0b1cae06b0a847a3fea6e671aaf8adfdfe58ca2f768105c8082b2e449fce252","ae434102edde0958ec4b19d917a6a28e6b72da1834aff0e650f049503a296cf2"],["4e8ceafb9b3e9a136dc7ff67e840295b499dfb3b2133e4ba113f2e4c0e121e5","cf2174118c8b6d7a4b48f6d534ce5c79422c086a63460502b827ce62a326683c"],["d24a44e047e19b6f5afb81c7ca2f69080a5076689a010919f42725c2b789a33b","6fb8d5591b466f8fc63db50f1c0f1c69013f996887b8244d2cdec417afea8fa3"],["ea01606a7a6c9cdd249fdfcfacb99584001edd28abbab77b5104e98e8e3b35d4","322af4908c7312b0cfbfe369f7a7b3cdb7d4494bc2823700cfd652188a3ea98d"],["af8addbf2b661c8a6c6328655eb96651252007d8c5ea31be4ad196de8ce2131f","6749e67c029b85f52a034eafd096836b2520818680e26ac8f3dfbcdb71749700"],["e3ae1974566ca06cc516d47e0fb165a674a3dabcfca15e722f0e3450f45889","2aeabe7e4531510116217f07bf4d07300de97e4874f81f533420a72eeb0bd6a4"],["591ee355313d99721cf6993ffed1e3e301993ff3ed258802075ea8ced397e246","b0ea558a113c30bea60fc4775460c7901ff0b053d25ca2bdeee98f1a4be5d196"],["11396d55fda54c49f19aa97318d8da61fa8584e47b084945077cf03255b52984","998c74a8cd45ac01289d5833a7beb4744ff536b01b257be4c5767bea93ea57a4"],["3c5d2a1ba39c5a1790000738c9e0c40b8dcdfd5468754b6405540157e017aa7a","b2284279995a34e2f9d4de7396fc18b80f9b8b9fdd270f6661f79ca4c81bd257"],["cc8704b8a60a0defa3a99a7299f2e9c3fbc395afb04ac078425ef8a1793cc030","bdd46039feed17881d1e0862db347f8cf395b74fc4bcdc4e940b74e3ac1f1b13"],["c533e4f7ea8555aacd9777ac5cad29b97dd4defccc53ee7ea204119b2889b197","6f0a256bc5efdf429a2fb6242f1a43a2d9b925bb4a4b3a26bb8e0f45eb596096"],["c14f8f2ccb27d6f109f6d08d03cc96a69ba8c34eec07bbcf566d48e33da6593","c359d6923bb398f7fd4473e16fe1c28475b740dd098075e6c0e8649113dc3a38"],["a6cbc3046bc6a450bac24789fa17115a4c9739ed75f8f21ce441f72e0b90e6ef","21ae7f4680e889bb130619e2c0f95a360ceb573c70603139862afd617fa9b9f"],["347d6d9a02c48927ebfb86c1359b1caf130a3c0267d11ce6344b39f99d43cc38","60ea7f61a353524d1c987f6ecec92f086d565ab687870cb12689ff1e31c74448"],["da6545d2181db8d983f7dcb375ef5866d47c67b1bf31c8cf855ef7437b72656a","49b96715ab6878a79e78f07ce5680c5d6673051b4935bd897fea824b77dc208a"],["c40747cc9d012cb1a13b8148309c6de7ec25d6945d657146b9d5994b8feb1111","5ca560753be2a12fc6de6caf2cb489565db936156b9514e1bb5e83037e0fa2d4"],["4e42c8ec82c99798ccf3a610be870e78338c7f713348bd34c8203ef4037f3502","7571d74ee5e0fb92a7a8b33a07783341a5492144cc54bcc40a94473693606437"],["3775ab7089bc6af823aba2e1af70b236d251cadb0c86743287522a1b3b0dedea","be52d107bcfa09d8bcb9736a828cfa7fac8db17bf7a76a2c42ad961409018cf7"],["cee31cbf7e34ec379d94fb814d3d775ad954595d1314ba8846959e3e82f74e26","8fd64a14c06b589c26b947ae2bcf6bfa0149ef0be14ed4d80f448a01c43b1c6d"],["b4f9eaea09b6917619f6ea6a4eb5464efddb58fd45b1ebefcdc1a01d08b47986","39e5c9925b5a54b07433a4f18c61726f8bb131c012ca542eb24a8ac07200682a"],["d4263dfc3d2df923a0179a48966d30ce84e2515afc3dccc1b77907792ebcc60e","62dfaf07a0f78feb30e30d6295853ce189e127760ad6cf7fae164e122a208d54"],["48457524820fa65a4f8d35eb6930857c0032acc0a4a2de422233eeda897612c4","25a748ab367979d98733c38a1fa1c2e7dc6cc07db2d60a9ae7a76aaa49bd0f77"],["dfeeef1881101f2cb11644f3a2afdfc2045e19919152923f367a1767c11cceda","ecfb7056cf1de042f9420bab396793c0c390bde74b4bbdff16a83ae09a9a7517"],["6d7ef6b17543f8373c573f44e1f389835d89bcbc6062ced36c82df83b8fae859","cd450ec335438986dfefa10c57fea9bcc521a0959b2d80bbf74b190dca712d10"],["e75605d59102a5a2684500d3b991f2e3f3c88b93225547035af25af66e04541f","f5c54754a8f71ee540b9b48728473e314f729ac5308b06938360990e2bfad125"],["eb98660f4c4dfaa06a2be453d5020bc99a0c2e60abe388457dd43fefb1ed620c","6cb9a8876d9cb8520609af3add26cd20a0a7cd8a9411131ce85f44100099223e"],["13e87b027d8514d35939f2e6892b19922154596941888336dc3563e3b8dba942","fef5a3c68059a6dec5d624114bf1e91aac2b9da568d6abeb2570d55646b8adf1"],["ee163026e9fd6fe017c38f06a5be6fc125424b371ce2708e7bf4491691e5764a","1acb250f255dd61c43d94ccc670d0f58f49ae3fa15b96623e5430da0ad6c62b2"],["b268f5ef9ad51e4d78de3a750c2dc89b1e626d43505867999932e5db33af3d80","5f310d4b3c99b9ebb19f77d41c1dee018cf0d34fd4191614003e945a1216e423"],["ff07f3118a9df035e9fad85eb6c7bfe42b02f01ca99ceea3bf7ffdba93c4750d","438136d603e858a3a5c440c38eccbaddc1d2942114e2eddd4740d098ced1f0d8"],["8d8b9855c7c052a34146fd20ffb658bea4b9f69e0d825ebec16e8c3ce2b526a1","cdb559eedc2d79f926baf44fb84ea4d44bcf50fee51d7ceb30e2e7f463036758"],["52db0b5384dfbf05bfa9d472d7ae26dfe4b851ceca91b1eba54263180da32b63","c3b997d050ee5d423ebaf66a6db9f57b3180c902875679de924b69d84a7b375"],["e62f9490d3d51da6395efd24e80919cc7d0f29c3f3fa48c6fff543becbd43352","6d89ad7ba4876b0b22c2ca280c682862f342c8591f1daf5170e07bfd9ccafa7d"],["7f30ea2476b399b4957509c88f77d0191afa2ff5cb7b14fd6d8e7d65aaab1193","ca5ef7d4b231c94c3b15389a5f6311e9daff7bb67b103e9880ef4bff637acaec"],["5098ff1e1d9f14fb46a210fada6c903fef0fb7b4a1dd1d9ac60a0361800b7a00","9731141d81fc8f8084d37c6e7542006b3ee1b40d60dfe5362a5b132fd17ddc0"],["32b78c7de9ee512a72895be6b9cbefa6e2f3c4ccce445c96b9f2c81e2778ad58","ee1849f513df71e32efc3896ee28260c73bb80547ae2275ba497237794c8753c"],["e2cb74fddc8e9fbcd076eef2a7c72b0ce37d50f08269dfc074b581550547a4f7","d3aa2ed71c9dd2247a62df062736eb0baddea9e36122d2be8641abcb005cc4a4"],["8438447566d4d7bedadc299496ab357426009a35f235cb141be0d99cd10ae3a8","c4e1020916980a4da5d01ac5e6ad330734ef0d7906631c4f2390426b2edd791f"],["4162d488b89402039b584c6fc6c308870587d9c46f660b878ab65c82c711d67e","67163e903236289f776f22c25fb8a3afc1732f2b84b4e95dbda47ae5a0852649"],["3fad3fa84caf0f34f0f89bfd2dcf54fc175d767aec3e50684f3ba4a4bf5f683d","cd1bc7cb6cc407bb2f0ca647c718a730cf71872e7d0d2a53fa20efcdfe61826"],["674f2600a3007a00568c1a7ce05d0816c1fb84bf1370798f1c69532faeb1a86b","299d21f9413f33b3edf43b257004580b70db57da0b182259e09eecc69e0d38a5"],["d32f4da54ade74abb81b815ad1fb3b263d82d6c692714bcff87d29bd5ee9f08f","f9429e738b8e53b968e99016c059707782e14f4535359d582fc416910b3eea87"],["30e4e670435385556e593657135845d36fbb6931f72b08cb1ed954f1e3ce3ff6","462f9bce619898638499350113bbc9b10a878d35da70740dc695a559eb88db7b"],["be2062003c51cc3004682904330e4dee7f3dcd10b01e580bf1971b04d4cad297","62188bc49d61e5428573d48a74e1c655b1c61090905682a0d5558ed72dccb9bc"],["93144423ace3451ed29e0fb9ac2af211cb6e84a601df5993c419859fff5df04a","7c10dfb164c3425f5c71a3f9d7992038f1065224f72bb9d1d902a6d13037b47c"],["b015f8044f5fcbdcf21ca26d6c34fb8197829205c7b7d2a7cb66418c157b112c","ab8c1e086d04e813744a655b2df8d5f83b3cdc6faa3088c1d3aea1454e3a1d5f"],["d5e9e1da649d97d89e4868117a465a3a4f8a18de57a140d36b3f2af341a21b52","4cb04437f391ed73111a13cc1d4dd0db1693465c2240480d8955e8592f27447a"],["d3ae41047dd7ca065dbf8ed77b992439983005cd72e16d6f996a5316d36966bb","bd1aeb21ad22ebb22a10f0303417c6d964f8cdd7df0aca614b10dc14d125ac46"],["463e2763d885f958fc66cdd22800f0a487197d0a82e377b49f80af87c897b065","bfefacdb0e5d0fd7df3a311a94de062b26b80c61fbc97508b79992671ef7ca7f"],["7985fdfd127c0567c6f53ec1bb63ec3158e597c40bfe747c83cddfc910641917","603c12daf3d9862ef2b25fe1de289aed24ed291e0ec6708703a5bd567f32ed03"],["74a1ad6b5f76e39db2dd249410eac7f99e74c59cb83d2d0ed5ff1543da7703e9","cc6157ef18c9c63cd6193d83631bbea0093e0968942e8c33d5737fd790e0db08"],["30682a50703375f602d416664ba19b7fc9bab42c72747463a71d0896b22f6da3","553e04f6b018b4fa6c8f39e7f311d3176290d0e0f19ca73f17714d9977a22ff8"],["9e2158f0d7c0d5f26c3791efefa79597654e7a2b2464f52b1ee6c1347769ef57","712fcdd1b9053f09003a3481fa7762e9ffd7c8ef35a38509e2fbf2629008373"],["176e26989a43c9cfeba4029c202538c28172e566e3c4fce7322857f3be327d66","ed8cc9d04b29eb877d270b4878dc43c19aefd31f4eee09ee7b47834c1fa4b1c3"],["75d46efea3771e6e68abb89a13ad747ecf1892393dfc4f1b7004788c50374da8","9852390a99507679fd0b86fd2b39a868d7efc22151346e1a3ca4726586a6bed8"],["809a20c67d64900ffb698c4c825f6d5f2310fb0451c869345b7319f645605721","9e994980d9917e22b76b061927fa04143d096ccc54963e6a5ebfa5f3f8e286c1"],["1b38903a43f7f114ed4500b4eac7083fdefece1cf29c63528d563446f972c180","4036edc931a60ae889353f77fd53de4a2708b26b6f5da72ad3394119daf408f9"]]}}},{}],168:[function(a,b,c){"use strict";function d(a,b){for(var c=[],d=1<<b+1,e=a.clone();e.cmpn(1)>=0;){var f;if(e.isOdd()){var g=e.andln(d-1);f=g>(d>>1)-1?(d>>1)-g:g,e.isubn(f)}else f=0;c.push(f);for(var h=0!==e.cmpn(0)&&0===e.andln(d-1)?b+1:1,i=1;h>i;i++)c.push(0);e.iushrn(h)}return c}function e(a,b){var c=[[],[]];a=a.clone(),b=b.clone();for(var d=0,e=0;a.cmpn(-d)>0||b.cmpn(-e)>0;){var f=a.andln(3)+d&3,g=b.andln(3)+e&3;3===f&&(f=-1),3===g&&(g=-1);var h;if(0===(1&f))h=0;else{var i=a.andln(7)+d&7;h=3!==i&&5!==i||2!==g?f:-f}c[0].push(h);var j;if(0===(1&g))j=0;else{var i=b.andln(7)+e&7;j=3!==i&&5!==i||2!==f?g:-g}c[1].push(j),2*d===h+1&&(d=1-d),2*e===j+1&&(e=1-e),a.iushrn(1),b.iushrn(1)}return c}function f(a,b,c){var d="_"+b;a.prototype[b]=function(){return void 0!==this[d]?this[d]:this[d]=c.call(this)}}function g(a){return"string"==typeof a?i.toArray(a,"hex"):a}function h(a){return new j(a,"hex","le")}var i=c,j=a("bn.js"),k=a("minimalistic-assert"),l=a("minimalistic-crypto-utils");i.assert=k,i.toArray=l.toArray,i.zero2=l.zero2,i.toHex=l.toHex,i.encode=l.encode,i.getNAF=d,i.getJSF=e,i.cachedProperty=f,i.parseBytes=g,i.intFromLE=h},{"bn.js":99,"minimalistic-assert":200,"minimalistic-crypto-utils":201}],169:[function(a,b,c){b.exports={name:"elliptic",version:"6.4.0",description:"EC cryptography",main:"lib/elliptic.js",files:["lib"],scripts:{jscs:"jscs benchmarks/*.js lib/*.js lib/**/*.js lib/**/**/*.js test/index.js",jshint:"jscs benchmarks/*.js lib/*.js lib/**/*.js lib/**/**/*.js test/index.js",lint:"npm run jscs && npm run jshint",unit:"istanbul test _mocha --reporter=spec test/index.js",test:"npm run lint && npm run unit",version:"grunt dist && git add dist/"},repository:{type:"git",url:"git@github.com:indutny/elliptic"},keywords:["EC","Elliptic","curve","Cryptography"],author:"Fedor Indutny <fedor@indutny.com>",license:"MIT",bugs:{url:"https://github.com/indutny/elliptic/issues"},homepage:"https://github.com/indutny/elliptic",devDependencies:{brfs:"^1.4.3",coveralls:"^2.11.3",grunt:"^0.4.5","grunt-browserify":"^5.0.0","grunt-cli":"^1.2.0","grunt-contrib-connect":"^1.0.0","grunt-contrib-copy":"^1.0.0","grunt-contrib-uglify":"^1.0.1","grunt-mocha-istanbul":"^3.0.1","grunt-saucelabs":"^8.6.2",istanbul:"^0.4.2",jscs:"^2.9.0",jshint:"^2.6.0",mocha:"^2.1.0"},dependencies:{"bn.js":"^4.4.0",brorand:"^1.0.1","hash.js":"^1.0.0","hmac-drbg":"^1.0.0",inherits:"^2.0.1","minimalistic-assert":"^1.0.0","minimalistic-crypto-utils":"^1.0.0"}}},{}],170:[function(a,b,c){(function(c){function d(a,b,d,f){c.isBuffer(a)||(a=new c(a,"binary")),
b&&!c.isBuffer(b)&&(b=new c(b,"binary")),d/=8,f=f||0;for(var g,h,i=0,j=0,k=new c(d),l=new c(f),m=0,n=[];;){if(m++>0&&n.push(g),n.push(a),b&&n.push(b),g=e(c.concat(n)),n=[],h=0,d>0)for(;;){if(0===d)break;if(h===g.length)break;k[i++]=g[h],d--,h++}if(f>0&&h!==g.length)for(;;){if(0===f)break;if(h===g.length)break;l[j++]=g[h],f--,h++}if(0===d&&0===f)break}for(h=0;h<g.length;h++)g[h]=0;return{key:k,iv:l}}var e=a("create-hash/md5");b.exports=d}).call(this,a("buffer").Buffer)},{buffer:130,"create-hash/md5":138}],171:[function(a,b,c){var d=Object.prototype.hasOwnProperty,e=Object.prototype.toString;b.exports=function(a,b,c){if("[object Function]"!==e.call(b))throw new TypeError("iterator must be a function");var f=a.length;if(f===+f)for(var g=0;f>g;g++)b.call(c,a[g],g,a);else for(var h in a)d.call(a,h)&&b.call(c,a[h],h,a)}},{}],172:[function(a,b,c){b.exports={100:"Continue",101:"Switching Protocols",102:"Processing",200:"OK",201:"Created",202:"Accepted",203:"Non-Authoritative Information",204:"No Content",205:"Reset Content",206:"Partial Content",207:"Multi-Status",300:"Multiple Choices",301:"Moved Permanently",302:"Moved Temporarily",303:"See Other",304:"Not Modified",305:"Use Proxy",307:"Temporary Redirect",308:"Permanent Redirect",400:"Bad Request",401:"Unauthorized",402:"Payment Required",403:"Forbidden",404:"Not Found",405:"Method Not Allowed",406:"Not Acceptable",407:"Proxy Authentication Required",408:"Request Time-out",409:"Conflict",410:"Gone",411:"Length Required",412:"Precondition Failed",413:"Request Entity Too Large",414:"Request-URI Too Large",415:"Unsupported Media Type",416:"Requested Range Not Satisfiable",417:"Expectation Failed",418:"I'm a teapot",422:"Unprocessable Entity",423:"Locked",424:"Failed Dependency",425:"Unordered Collection",426:"Upgrade Required",428:"Precondition Required",429:"Too Many Requests",431:"Request Header Fields Too Large",500:"Internal Server Error",501:"Not Implemented",502:"Bad Gateway",503:"Service Unavailable",504:"Gateway Time-out",505:"HTTP Version Not Supported",506:"Variant Also Negotiates",507:"Insufficient Storage",509:"Bandwidth Limit Exceeded",510:"Not Extended",511:"Network Authentication Required"}},{}],173:[function(a,b,c){function d(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}function e(a){return"function"==typeof a}function f(a){return"number"==typeof a}function g(a){return"object"==typeof a&&null!==a}function h(a){return void 0===a}b.exports=d,d.EventEmitter=d,d.prototype._events=void 0,d.prototype._maxListeners=void 0,d.defaultMaxListeners=10,d.prototype.setMaxListeners=function(a){if(!f(a)||0>a||isNaN(a))throw TypeError("n must be a positive number");return this._maxListeners=a,this},d.prototype.emit=function(a){var b,c,d,f,i,j;if(this._events||(this._events={}),"error"===a&&(!this._events.error||g(this._events.error)&&!this._events.error.length)){if(b=arguments[1],b instanceof Error)throw b;throw TypeError('Uncaught, unspecified "error" event.')}if(c=this._events[a],h(c))return!1;if(e(c))switch(arguments.length){case 1:c.call(this);break;case 2:c.call(this,arguments[1]);break;case 3:c.call(this,arguments[1],arguments[2]);break;default:for(d=arguments.length,f=new Array(d-1),i=1;d>i;i++)f[i-1]=arguments[i];c.apply(this,f)}else if(g(c)){for(d=arguments.length,f=new Array(d-1),i=1;d>i;i++)f[i-1]=arguments[i];for(j=c.slice(),d=j.length,i=0;d>i;i++)j[i].apply(this,f)}return!0},d.prototype.addListener=function(a,b){var c;if(!e(b))throw TypeError("listener must be a function");if(this._events||(this._events={}),this._events.newListener&&this.emit("newListener",a,e(b.listener)?b.listener:b),this._events[a]?g(this._events[a])?this._events[a].push(b):this._events[a]=[this._events[a],b]:this._events[a]=b,g(this._events[a])&&!this._events[a].warned){var c;c=h(this._maxListeners)?d.defaultMaxListeners:this._maxListeners,c&&c>0&&this._events[a].length>c&&(this._events[a].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[a].length),"function"==typeof console.trace&&console.trace())}return this},d.prototype.on=d.prototype.addListener,d.prototype.once=function(a,b){function c(){this.removeListener(a,c),d||(d=!0,b.apply(this,arguments))}if(!e(b))throw TypeError("listener must be a function");var d=!1;return c.listener=b,this.on(a,c),this},d.prototype.removeListener=function(a,b){var c,d,f,h;if(!e(b))throw TypeError("listener must be a function");if(!this._events||!this._events[a])return this;if(c=this._events[a],f=c.length,d=-1,c===b||e(c.listener)&&c.listener===b)delete this._events[a],this._events.removeListener&&this.emit("removeListener",a,b);else if(g(c)){for(h=f;h-->0;)if(c[h]===b||c[h].listener&&c[h].listener===b){d=h;break}if(0>d)return this;1===c.length?(c.length=0,delete this._events[a]):c.splice(d,1),this._events.removeListener&&this.emit("removeListener",a,b)}return this},d.prototype.removeAllListeners=function(a){var b,c;if(!this._events)return this;if(!this._events.removeListener)return 0===arguments.length?this._events={}:this._events[a]&&delete this._events[a],this;if(0===arguments.length){for(b in this._events)"removeListener"!==b&&this.removeAllListeners(b);return this.removeAllListeners("removeListener"),this._events={},this}if(c=this._events[a],e(c))this.removeListener(a,c);else for(;c.length;)this.removeListener(a,c[c.length-1]);return delete this._events[a],this},d.prototype.listeners=function(a){var b;return b=this._events&&this._events[a]?e(this._events[a])?[this._events[a]]:this._events[a].slice():[]},d.listenerCount=function(a,b){var c;return c=a._events&&a._events[b]?e(a._events[b])?1:a._events[b].length:0}},{}],174:[function(a,b,c){var d=a("./lib/request"),e=a("xtend"),f=a("builtin-status-codes"),g=a("url"),h=c;h.request=function(a,b){a="string"==typeof a?g.parse(a):e(a);var c=a.protocol||"",f=a.hostname||a.host,h=a.port,i=a.path||"/";f&&-1!==f.indexOf(":")&&(f="["+f+"]"),a.url=(f?c+"//"+f:"")+(h?":"+h:"")+i,a.method=(a.method||"GET").toUpperCase(),a.headers=a.headers||{};var j=new d(a);return b&&j.on("response",b),j},h.get=function(a,b){var c=h.request(a,b);return c.end(),c},h.Agent=function(){},h.Agent.defaultMaxSockets=4,h.STATUS_CODES=f,h.METHODS=["CHECKOUT","CONNECT","COPY","DELETE","GET","HEAD","LOCK","M-SEARCH","MERGE","MKACTIVITY","MKCOL","MOVE","NOTIFY","OPTIONS","PATCH","POST","PROPFIND","PROPPATCH","PURGE","PUT","REPORT","SEARCH","SUBSCRIBE","TRACE","UNLOCK","UNSUBSCRIBE"]},{"./lib/request":176,"builtin-status-codes":172,url:178,xtend:259}],175:[function(a,b,c){(function(a){function b(a){try{return f.responseType=a,f.responseType===a}catch(b){}return!1}function d(a){return"function"==typeof a}c.fetch=d(a.fetch)&&d(a.ReadableByteStream),c.blobConstructor=!1;try{new Blob([new ArrayBuffer(1)]),c.blobConstructor=!0}catch(e){}var f=new a.XMLHttpRequest;f.open("GET",a.location.host?"/":"https://example.com");var g="undefined"!=typeof a.ArrayBuffer,h=g&&d(a.ArrayBuffer.prototype.slice);c.arraybuffer=g&&b("arraybuffer"),c.msstream=!c.fetch&&h&&b("ms-stream"),c.mozchunkedarraybuffer=!c.fetch&&g&&b("moz-chunked-arraybuffer"),c.overrideMimeType=d(f.overrideMimeType),c.vbArray=d(a.VBArray),f=null}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],176:[function(a,b,c){(function(c,d,e){function f(a){return h.fetch?"fetch":h.mozchunkedarraybuffer?"moz-chunked-arraybuffer":h.msstream?"ms-stream":h.arraybuffer&&a?"arraybuffer":h.vbArray&&a?"text:vbarray":"text"}function g(a){try{return null!==a.status}catch(b){return!1}}var h=a("./capability"),i=a("foreach"),j=a("indexof"),k=a("inherits"),l=a("object-keys"),m=a("./response"),n=a("stream"),o=m.IncomingMessage,p=m.readyStates,q=b.exports=function(a){var b=this;n.Writable.call(b),b._opts=a,b._body=[],b._headers={},a.auth&&b.setHeader("Authorization","Basic "+new e(a.auth).toString("base64")),i(l(a.headers),function(c){b.setHeader(c,a.headers[c])});var c;if("prefer-streaming"===a.mode)c=!1;else if("allow-wrong-content-type"===a.mode)c=!h.overrideMimeType;else{if(a.mode&&"default"!==a.mode&&"prefer-fast"!==a.mode)throw new Error("Invalid value for opts.mode");c=!0}b._mode=f(c),b.on("finish",function(){b._onFinish()})};k(q,n.Writable),q.prototype.setHeader=function(a,b){var c=this,d=a.toLowerCase();-1===j(r,d)&&(c._headers[d]={name:a,value:b})},q.prototype.getHeader=function(a){var b=this;return b._headers[a.toLowerCase()].value},q.prototype.removeHeader=function(a){var b=this;delete b._headers[a.toLowerCase()]},q.prototype._onFinish=function(){var a=this;if(!a._destroyed){var b,f=a._opts,g=a._headers;if(("POST"===f.method||"PUT"===f.method)&&(b=h.blobConstructor?new d.Blob(a._body.map(function(a){return a.toArrayBuffer()}),{type:(g["content-type"]||{}).value||""}):e.concat(a._body).toString()),"fetch"===a._mode){var j=l(g).map(function(a){return[g[a].name,g[a].value]});d.fetch(a._opts.url,{method:a._opts.method,headers:j,body:b,mode:"cors",credentials:f.withCredentials?"include":"same-origin"}).then(function(b){a._fetchResponse=b,a._connect()}).then(void 0,function(b){a.emit("error",b)})}else{var k=a._xhr=new d.XMLHttpRequest;try{k.open(a._opts.method,a._opts.url,!0)}catch(m){return void c.nextTick(function(){a.emit("error",m)})}"responseType"in k&&(k.responseType=a._mode.split(":")[0]),"withCredentials"in k&&(k.withCredentials=!!f.withCredentials),"text"===a._mode&&"overrideMimeType"in k&&k.overrideMimeType("text/plain; charset=x-user-defined"),i(l(g),function(a){k.setRequestHeader(g[a].name,g[a].value)}),a._response=null,k.onreadystatechange=function(){switch(k.readyState){case p.LOADING:case p.DONE:a._onXHRProgress()}},"moz-chunked-arraybuffer"===a._mode&&(k.onprogress=function(){a._onXHRProgress()}),k.onerror=function(){a._destroyed||a.emit("error",new Error("XHR error"))};try{k.send(b)}catch(m){return void c.nextTick(function(){a.emit("error",m)})}}}},q.prototype._onXHRProgress=function(){var a=this;g(a._xhr)&&!a._destroyed&&(a._response||a._connect(),a._response._onXHRProgress())},q.prototype._connect=function(){var a=this;a._destroyed||(a._response=new o(a._xhr,a._fetchResponse,a._mode),a.emit("response",a._response))},q.prototype._write=function(a,b,c){var d=this;d._body.push(a),c()},q.prototype.abort=q.prototype.destroy=function(){var a=this;a._destroyed=!0,a._response&&(a._response._destroyed=!0),a._xhr&&a._xhr.abort()},q.prototype.end=function(a,b,c){var d=this;"function"==typeof a&&(c=a,a=void 0),n.Writable.prototype.end.call(d,a,b,c)},q.prototype.flushHeaders=function(){},q.prototype.setTimeout=function(){},q.prototype.setNoDelay=function(){},q.prototype.setSocketKeepAlive=function(){};var r=["accept-charset","accept-encoding","access-control-request-headers","access-control-request-method","connection","content-length","cookie","cookie2","date","dnt","expect","host","keep-alive","origin","referer","te","trailer","transfer-encoding","upgrade","user-agent","via"]}).call(this,a("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},a("buffer").Buffer)},{"./capability":175,"./response":177,_process:215,buffer:130,foreach:171,indexof:195,inherits:196,"object-keys":202,stream:254}],177:[function(a,b,c){(function(b,d,e){var f=a("./capability"),g=a("foreach"),h=a("inherits"),i=a("stream"),j=c.readyStates={UNSENT:0,OPENED:1,HEADERS_RECEIVED:2,LOADING:3,DONE:4},k=c.IncomingMessage=function(a,c,d){function h(){n.read().then(function(a){if(!j._destroyed){if(a.done)return void j.push(null);j.push(new e(a.value)),h()}})}var j=this;if(i.Readable.call(j),j._mode=d,j.headers={},j.rawHeaders=[],j.trailers={},j.rawTrailers=[],j.on("end",function(){b.nextTick(function(){j.emit("close")})}),"fetch"===d){j._fetchResponse=c,j.statusCode=c.status,j.statusMessage=c.statusText;for(var k,l,m=c.headers[Symbol.iterator]();k=(l=m.next()).value,!l.done;)j.headers[k[0].toLowerCase()]=k[1],j.rawHeaders.push(k[0],k[1]);var n=c.body.getReader();h()}else{j._xhr=a,j._pos=0,j.statusCode=a.status,j.statusMessage=a.statusText;var o=a.getAllResponseHeaders().split(/\r?\n/);if(g(o,function(a){var b=a.match(/^([^:]+):\s*(.*)/);if(b){var c=b[1].toLowerCase();void 0!==j.headers[c]?j.headers[c]+=", "+b[2]:j.headers[c]=b[2],j.rawHeaders.push(b[1],b[2])}}),j._charset="x-user-defined",!f.overrideMimeType){var p=j.rawHeaders["mime-type"];if(p){var q=p.match(/;\s*charset=([^;])(;|$)/);q&&(j._charset=q[1].toLowerCase())}j._charset||(j._charset="utf-8")}}};h(k,i.Readable),k.prototype._read=function(){},k.prototype._onXHRProgress=function(){var a=this,b=a._xhr,c=null;switch(a._mode){case"text:vbarray":if(b.readyState!==j.DONE)break;try{c=new d.VBArray(b.responseBody).toArray()}catch(f){}if(null!==c){a.push(new e(c));break}case"text":try{c=b.responseText}catch(f){a._mode="text:vbarray";break}if(c.length>a._pos){var g=c.substr(a._pos);if("x-user-defined"===a._charset){for(var h=new e(g.length),i=0;i<g.length;i++)h[i]=255&g.charCodeAt(i);a.push(h)}else a.push(g,a._charset);a._pos=c.length}break;case"arraybuffer":if(b.readyState!==j.DONE)break;c=b.response,a.push(new e(new Uint8Array(c)));break;case"moz-chunked-arraybuffer":if(c=b.response,b.readyState!==j.LOADING||!c)break;a.push(new e(new Uint8Array(c)));break;case"ms-stream":if(c=b.response,b.readyState!==j.LOADING)break;var k=new d.MSStreamReader;k.onprogress=function(){k.result.byteLength>a._pos&&(a.push(new e(new Uint8Array(k.result.slice(a._pos)))),a._pos=k.result.byteLength)},k.onload=function(){a.push(null)},k.readAsArrayBuffer(c)}a._xhr.readyState===j.DONE&&"ms-stream"!==a._mode&&a.push(null)}}).call(this,a("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},a("buffer").Buffer)},{"./capability":175,_process:215,buffer:130,foreach:171,inherits:196,stream:254}],178:[function(a,b,c){function d(){this.protocol=null,this.slashes=null,this.auth=null,this.host=null,this.port=null,this.hostname=null,this.hash=null,this.search=null,this.query=null,this.pathname=null,this.path=null,this.href=null}function e(a,b,c){if(a&&j(a)&&a instanceof d)return a;var e=new d;return e.parse(a,b,c),e}function f(a){return i(a)&&(a=e(a)),a instanceof d?a.format():d.prototype.format.call(a)}function g(a,b){return e(a,!1,!0).resolve(b)}function h(a,b){return a?e(a,!1,!0).resolveObject(b):b}function i(a){return"string"==typeof a}function j(a){return"object"==typeof a&&null!==a}function k(a){return null===a}function l(a){return null==a}var m=a("punycode");c.parse=e,c.resolve=g,c.resolveObject=h,c.format=f,c.Url=d;var n=/^([a-z0-9.+-]+:)/i,o=/:[0-9]*$/,p=["<",">",'"',"`"," ","\r","\n","	"],q=["{","}","|","\\","^","`"].concat(p),r=["'"].concat(q),s=["%","/","?",";","#"].concat(r),t=["/","?","#"],u=255,v=/^[a-z0-9A-Z_-]{0,63}$/,w=/^([a-z0-9A-Z_-]{0,63})(.*)$/,x={javascript:!0,"javascript:":!0},y={javascript:!0,"javascript:":!0},z={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0},A=a("querystring");d.prototype.parse=function(a,b,c){if(!i(a))throw new TypeError("Parameter 'url' must be a string, not "+typeof a);var d=a;d=d.trim();var e=n.exec(d);if(e){e=e[0];var f=e.toLowerCase();this.protocol=f,d=d.substr(e.length)}if(c||e||d.match(/^\/\/[^@\/]+@[^@\/]+/)){var g="//"===d.substr(0,2);!g||e&&y[e]||(d=d.substr(2),this.slashes=!0)}if(!y[e]&&(g||e&&!z[e])){for(var h=-1,j=0;j<t.length;j++){var k=d.indexOf(t[j]);-1!==k&&(-1===h||h>k)&&(h=k)}var l,o;o=-1===h?d.lastIndexOf("@"):d.lastIndexOf("@",h),-1!==o&&(l=d.slice(0,o),d=d.slice(o+1),this.auth=decodeURIComponent(l)),h=-1;for(var j=0;j<s.length;j++){var k=d.indexOf(s[j]);-1!==k&&(-1===h||h>k)&&(h=k)}-1===h&&(h=d.length),this.host=d.slice(0,h),d=d.slice(h),this.parseHost(),this.hostname=this.hostname||"";var p="["===this.hostname[0]&&"]"===this.hostname[this.hostname.length-1];if(!p)for(var q=this.hostname.split(/\./),j=0,B=q.length;B>j;j++){var C=q[j];if(C&&!C.match(v)){for(var D="",E=0,F=C.length;F>E;E++)D+=C.charCodeAt(E)>127?"x":C[E];if(!D.match(v)){var G=q.slice(0,j),H=q.slice(j+1),I=C.match(w);I&&(G.push(I[1]),H.unshift(I[2])),H.length&&(d="/"+H.join(".")+d),this.hostname=G.join(".");break}}}if(this.hostname.length>u?this.hostname="":this.hostname=this.hostname.toLowerCase(),!p){for(var J=this.hostname.split("."),K=[],j=0;j<J.length;++j){var L=J[j];K.push(L.match(/[^A-Za-z0-9_-]/)?"xn--"+m.encode(L):L)}this.hostname=K.join(".")}var M=this.port?":"+this.port:"",N=this.hostname||"";this.host=N+M,this.href+=this.host,p&&(this.hostname=this.hostname.substr(1,this.hostname.length-2),"/"!==d[0]&&(d="/"+d))}if(!x[f])for(var j=0,B=r.length;B>j;j++){var O=r[j],P=encodeURIComponent(O);P===O&&(P=escape(O)),d=d.split(O).join(P)}var Q=d.indexOf("#");-1!==Q&&(this.hash=d.substr(Q),d=d.slice(0,Q));var R=d.indexOf("?");if(-1!==R?(this.search=d.substr(R),this.query=d.substr(R+1),b&&(this.query=A.parse(this.query)),d=d.slice(0,R)):b&&(this.search="",this.query={}),d&&(this.pathname=d),z[f]&&this.hostname&&!this.pathname&&(this.pathname="/"),this.pathname||this.search){var M=this.pathname||"",L=this.search||"";this.path=M+L}return this.href=this.format(),this},d.prototype.format=function(){var a=this.auth||"";a&&(a=encodeURIComponent(a),a=a.replace(/%3A/i,":"),a+="@");var b=this.protocol||"",c=this.pathname||"",d=this.hash||"",e=!1,f="";this.host?e=a+this.host:this.hostname&&(e=a+(-1===this.hostname.indexOf(":")?this.hostname:"["+this.hostname+"]"),this.port&&(e+=":"+this.port)),this.query&&j(this.query)&&Object.keys(this.query).length&&(f=A.stringify(this.query));var g=this.search||f&&"?"+f||"";return b&&":"!==b.substr(-1)&&(b+=":"),this.slashes||(!b||z[b])&&e!==!1?(e="//"+(e||""),c&&"/"!==c.charAt(0)&&(c="/"+c)):e||(e=""),d&&"#"!==d.charAt(0)&&(d="#"+d),g&&"?"!==g.charAt(0)&&(g="?"+g),c=c.replace(/[?#]/g,function(a){return encodeURIComponent(a)}),g=g.replace("#","%23"),b+e+c+g+d},d.prototype.resolve=function(a){return this.resolveObject(e(a,!1,!0)).format()},d.prototype.resolveObject=function(a){if(i(a)){var b=new d;b.parse(a,!1,!0),a=b}var c=new d;if(Object.keys(this).forEach(function(a){c[a]=this[a]},this),c.hash=a.hash,""===a.href)return c.href=c.format(),c;if(a.slashes&&!a.protocol)return Object.keys(a).forEach(function(b){"protocol"!==b&&(c[b]=a[b])}),z[c.protocol]&&c.hostname&&!c.pathname&&(c.path=c.pathname="/"),c.href=c.format(),c;if(a.protocol&&a.protocol!==c.protocol){if(!z[a.protocol])return Object.keys(a).forEach(function(b){c[b]=a[b]}),c.href=c.format(),c;if(c.protocol=a.protocol,a.host||y[a.protocol])c.pathname=a.pathname;else{for(var e=(a.pathname||"").split("/");e.length&&!(a.host=e.shift()););a.host||(a.host=""),a.hostname||(a.hostname=""),""!==e[0]&&e.unshift(""),e.length<2&&e.unshift(""),c.pathname=e.join("/")}if(c.search=a.search,c.query=a.query,c.host=a.host||"",c.auth=a.auth,c.hostname=a.hostname||a.host,c.port=a.port,c.pathname||c.search){var f=c.pathname||"",g=c.search||"";c.path=f+g}return c.slashes=c.slashes||a.slashes,c.href=c.format(),c}var h=c.pathname&&"/"===c.pathname.charAt(0),j=a.host||a.pathname&&"/"===a.pathname.charAt(0),m=j||h||c.host&&a.pathname,n=m,o=c.pathname&&c.pathname.split("/")||[],e=a.pathname&&a.pathname.split("/")||[],p=c.protocol&&!z[c.protocol];if(p&&(c.hostname="",c.port=null,c.host&&(""===o[0]?o[0]=c.host:o.unshift(c.host)),c.host="",a.protocol&&(a.hostname=null,a.port=null,a.host&&(""===e[0]?e[0]=a.host:e.unshift(a.host)),a.host=null),m=m&&(""===e[0]||""===o[0])),j)c.host=a.host||""===a.host?a.host:c.host,c.hostname=a.hostname||""===a.hostname?a.hostname:c.hostname,c.search=a.search,c.query=a.query,o=e;else if(e.length)o||(o=[]),o.pop(),o=o.concat(e),c.search=a.search,c.query=a.query;else if(!l(a.search)){if(p){c.hostname=c.host=o.shift();var q=c.host&&c.host.indexOf("@")>0?c.host.split("@"):!1;q&&(c.auth=q.shift(),c.host=c.hostname=q.shift())}return c.search=a.search,c.query=a.query,k(c.pathname)&&k(c.search)||(c.path=(c.pathname?c.pathname:"")+(c.search?c.search:"")),c.href=c.format(),c}if(!o.length)return c.pathname=null,c.search?c.path="/"+c.search:c.path=null,c.href=c.format(),c;for(var r=o.slice(-1)[0],s=(c.host||a.host)&&("."===r||".."===r)||""===r,t=0,u=o.length;u>=0;u--)r=o[u],"."==r?o.splice(u,1):".."===r?(o.splice(u,1),t++):t&&(o.splice(u,1),t--);if(!m&&!n)for(;t--;t)o.unshift("..");!m||""===o[0]||o[0]&&"/"===o[0].charAt(0)||o.unshift(""),s&&"/"!==o.join("/").substr(-1)&&o.push("");var v=""===o[0]||o[0]&&"/"===o[0].charAt(0);if(p){c.hostname=c.host=v?"":o.length?o.shift():"";var q=c.host&&c.host.indexOf("@")>0?c.host.split("@"):!1;q&&(c.auth=q.shift(),c.host=c.hostname=q.shift())}return m=m||c.host&&o.length,m&&!v&&o.unshift(""),o.length?c.pathname=o.join("/"):(c.pathname=null,c.path=null),k(c.pathname)&&k(c.search)||(c.path=(c.pathname?c.pathname:"")+(c.search?c.search:"")),c.auth=a.auth||c.auth,c.slashes=c.slashes||a.slashes,c.href=c.format(),c},d.prototype.parseHost=function(){var a=this.host,b=o.exec(a);b&&(b=b[0],":"!==b&&(this.port=b.substr(1)),a=a.substr(0,a.length-b.length)),a&&(this.hostname=a)}},{punycode:222,querystring:226}],179:[function(a,b,c){(function(c){"use strict";function d(a){e.call(this),this._block=new c(a),this._blockSize=a,this._blockOffset=0,this._length=[0,0,0,0],this._finalized=!1}var e=a("stream").Transform,f=a("inherits");f(d,e),d.prototype._transform=function(a,b,d){var e=null;try{"buffer"!==b&&(a=new c(a,b)),this.update(a)}catch(f){e=f}d(e)},d.prototype._flush=function(a){var b=null;try{this.push(this._digest())}catch(c){b=c}a(b)},d.prototype.update=function(a,b){if(!c.isBuffer(a)&&"string"!=typeof a)throw new TypeError("Data must be a string or a buffer");if(this._finalized)throw new Error("Digest already called");c.isBuffer(a)||(a=new c(a,b||"binary"));for(var d=this._block,e=0;this._blockOffset+a.length-e>=this._blockSize;){for(var f=this._blockOffset;f<this._blockSize;)d[f++]=a[e++];this._update(),this._blockOffset=0}for(;e<a.length;)d[this._blockOffset++]=a[e++];for(var g=0,h=8*a.length;h>0;++g)this._length[g]+=h,h=this._length[g]/4294967296|0,h>0&&(this._length[g]-=4294967296*h);return this},d.prototype._update=function(a){throw new Error("_update is not implemented")},d.prototype.digest=function(a){if(this._finalized)throw new Error("Digest already called");this._finalized=!0;var b=this._digest();return void 0!==a&&(b=b.toString(a)),b},d.prototype._digest=function(){throw new Error("_digest is not implemented")},b.exports=d}).call(this,a("buffer").Buffer)},{buffer:130,inherits:196,stream:254}],180:[function(a,b,c){var d=c;d.utils=a("./hash/utils"),d.common=a("./hash/common"),d.sha=a("./hash/sha"),d.ripemd=a("./hash/ripemd"),d.hmac=a("./hash/hmac"),d.sha1=d.sha.sha1,d.sha256=d.sha.sha256,d.sha224=d.sha.sha224,d.sha384=d.sha.sha384,d.sha512=d.sha.sha512,d.ripemd160=d.ripemd.ripemd160},{"./hash/common":181,"./hash/hmac":182,"./hash/ripemd":183,"./hash/sha":184,"./hash/utils":191}],181:[function(a,b,c){"use strict";function d(){this.pending=null,this.pendingTotal=0,this.blockSize=this.constructor.blockSize,this.outSize=this.constructor.outSize,this.hmacStrength=this.constructor.hmacStrength,this.padLength=this.constructor.padLength/8,this.endian="big",this._delta8=this.blockSize/8,this._delta32=this.blockSize/32}var e=a("./utils"),f=a("minimalistic-assert");c.BlockHash=d,d.prototype.update=function(a,b){if(a=e.toArray(a,b),this.pending?this.pending=this.pending.concat(a):this.pending=a,this.pendingTotal+=a.length,this.pending.length>=this._delta8){a=this.pending;var c=a.length%this._delta8;this.pending=a.slice(a.length-c,a.length),0===this.pending.length&&(this.pending=null),a=e.join32(a,0,a.length-c,this.endian);for(var d=0;d<a.length;d+=this._delta32)this._update(a,d,d+this._delta32)}return this},d.prototype.digest=function(a){return this.update(this._pad()),f(null===this.pending),this._digest(a)},d.prototype._pad=function(){var a=this.pendingTotal,b=this._delta8,c=b-(a+this.padLength)%b,d=new Array(c+this.padLength);d[0]=128;for(var e=1;c>e;e++)d[e]=0;if(a<<=3,"big"===this.endian){for(var f=8;f<this.padLength;f++)d[e++]=0;d[e++]=0,d[e++]=0,d[e++]=0,d[e++]=0,d[e++]=a>>>24&255,d[e++]=a>>>16&255,d[e++]=a>>>8&255,d[e++]=255&a}else for(d[e++]=255&a,d[e++]=a>>>8&255,d[e++]=a>>>16&255,d[e++]=a>>>24&255,d[e++]=0,d[e++]=0,d[e++]=0,d[e++]=0,f=8;f<this.padLength;f++)d[e++]=0;return d}},{"./utils":191,"minimalistic-assert":200}],182:[function(a,b,c){"use strict";function d(a,b,c){return this instanceof d?(this.Hash=a,this.blockSize=a.blockSize/8,this.outSize=a.outSize/8,this.inner=null,this.outer=null,void this._init(e.toArray(b,c))):new d(a,b,c)}var e=a("./utils"),f=a("minimalistic-assert");b.exports=d,d.prototype._init=function(a){a.length>this.blockSize&&(a=(new this.Hash).update(a).digest()),f(a.length<=this.blockSize);for(var b=a.length;b<this.blockSize;b++)a.push(0);for(b=0;b<a.length;b++)a[b]^=54;for(this.inner=(new this.Hash).update(a),b=0;b<a.length;b++)a[b]^=106;this.outer=(new this.Hash).update(a)},d.prototype.update=function(a,b){return this.inner.update(a,b),this},d.prototype.digest=function(a){return this.outer.update(this.inner.digest()),this.outer.digest(a)}},{"./utils":191,"minimalistic-assert":200}],183:[function(a,b,c){"use strict";function d(){return this instanceof d?(n.call(this),this.h=[1732584193,4023233417,2562383102,271733878,3285377520],void(this.endian="little")):new d}function e(a,b,c,d){return 15>=a?b^c^d:31>=a?b&c|~b&d:47>=a?(b|~c)^d:63>=a?b&d|c&~d:b^(c|~d)}function f(a){return 15>=a?0:31>=a?1518500249:47>=a?1859775393:63>=a?2400959708:2840853838}function g(a){return 15>=a?1352829926:31>=a?1548603684:47>=a?1836072691:63>=a?2053994217:0}var h=a("./utils"),i=a("./common"),j=h.rotl32,k=h.sum32,l=h.sum32_3,m=h.sum32_4,n=i.BlockHash;h.inherits(d,n),c.ripemd160=d,d.blockSize=512,d.outSize=160,d.hmacStrength=192,d.padLength=64,d.prototype._update=function(a,b){for(var c=this.h[0],d=this.h[1],h=this.h[2],i=this.h[3],n=this.h[4],s=c,t=d,u=h,v=i,w=n,x=0;80>x;x++){var y=k(j(m(c,e(x,d,h,i),a[o[x]+b],f(x)),q[x]),n);c=n,n=i,i=j(h,10),h=d,d=y,y=k(j(m(s,e(79-x,t,u,v),a[p[x]+b],g(x)),r[x]),w),s=w,w=v,v=j(u,10),u=t,t=y}y=l(this.h[1],h,v),this.h[1]=l(this.h[2],i,w),this.h[2]=l(this.h[3],n,s),this.h[3]=l(this.h[4],c,t),this.h[4]=l(this.h[0],d,u),this.h[0]=y},d.prototype._digest=function(a){return"hex"===a?h.toHex32(this.h,"little"):h.split32(this.h,"little")};var o=[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8,3,10,14,4,9,15,8,1,2,7,0,6,13,11,5,12,1,9,11,10,0,8,12,4,13,3,7,15,14,5,6,2,4,0,5,9,7,12,2,10,14,1,3,8,11,6,15,13],p=[5,14,7,0,9,2,11,4,13,6,15,8,1,10,3,12,6,11,3,7,0,13,5,10,14,15,8,12,4,9,1,2,15,5,1,3,7,14,6,9,11,8,12,2,10,0,4,13,8,6,4,1,3,11,15,0,5,12,2,13,9,7,10,14,12,15,10,4,1,5,8,7,6,2,13,14,0,3,9,11],q=[11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8,7,6,8,13,11,9,7,15,7,12,15,9,11,7,13,12,11,13,6,7,14,9,13,15,14,8,13,6,5,12,7,5,11,12,14,15,14,15,9,8,9,14,5,6,8,6,5,12,9,15,5,11,6,8,13,12,5,12,13,14,11,8,5,6],r=[8,9,9,11,13,15,15,5,7,7,8,11,14,14,12,6,9,13,15,7,12,8,9,11,7,7,12,7,6,15,13,11,9,7,15,11,8,6,6,14,12,13,5,14,13,13,7,5,15,5,8,11,14,14,6,14,6,9,12,9,12,5,15,8,8,5,12,9,12,5,14,6,8,13,6,5,15,13,11,11]},{"./common":181,"./utils":191}],184:[function(a,b,c){"use strict";c.sha1=a("./sha/1"),c.sha224=a("./sha/224"),c.sha256=a("./sha/256"),c.sha384=a("./sha/384"),c.sha512=a("./sha/512")},{"./sha/1":185,"./sha/224":186,"./sha/256":187,"./sha/384":188,"./sha/512":189}],185:[function(a,b,c){"use strict";function d(){return this instanceof d?(l.call(this),this.h=[1732584193,4023233417,2562383102,271733878,3285377520],void(this.W=new Array(80))):new d}var e=a("../utils"),f=a("../common"),g=a("./common"),h=e.rotl32,i=e.sum32,j=e.sum32_5,k=g.ft_1,l=f.BlockHash,m=[1518500249,1859775393,2400959708,3395469782];e.inherits(d,l),b.exports=d,d.blockSize=512,d.outSize=160,d.hmacStrength=80,d.padLength=64,d.prototype._update=function(a,b){for(var c=this.W,d=0;16>d;d++)c[d]=a[b+d];for(;d<c.length;d++)c[d]=h(c[d-3]^c[d-8]^c[d-14]^c[d-16],1);var e=this.h[0],f=this.h[1],g=this.h[2],l=this.h[3],n=this.h[4];for(d=0;d<c.length;d++){var o=~~(d/20),p=j(h(e,5),k(o,f,g,l),n,c[d],m[o]);n=l,l=g,g=h(f,30),f=e,e=p}this.h[0]=i(this.h[0],e),this.h[1]=i(this.h[1],f),this.h[2]=i(this.h[2],g),this.h[3]=i(this.h[3],l),this.h[4]=i(this.h[4],n)},d.prototype._digest=function(a){return"hex"===a?e.toHex32(this.h,"big"):e.split32(this.h,"big")}},{"../common":181,"../utils":191,"./common":190}],186:[function(a,b,c){"use strict";function d(){return this instanceof d?(f.call(this),void(this.h=[3238371032,914150663,812702999,4144912697,4290775857,1750603025,1694076839,3204075428])):new d}var e=a("../utils"),f=a("./256");e.inherits(d,f),b.exports=d,d.blockSize=512,d.outSize=224,d.hmacStrength=192,d.padLength=64,d.prototype._digest=function(a){return"hex"===a?e.toHex32(this.h.slice(0,7),"big"):e.split32(this.h.slice(0,7),"big")}},{"../utils":191,"./256":187}],187:[function(a,b,c){"use strict";function d(){return this instanceof d?(r.call(this),this.h=[1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225],this.k=s,void(this.W=new Array(64))):new d}var e=a("../utils"),f=a("../common"),g=a("./common"),h=a("minimalistic-assert"),i=e.sum32,j=e.sum32_4,k=e.sum32_5,l=g.ch32,m=g.maj32,n=g.s0_256,o=g.s1_256,p=g.g0_256,q=g.g1_256,r=f.BlockHash,s=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298];e.inherits(d,r),b.exports=d,d.blockSize=512,d.outSize=256,d.hmacStrength=192,d.padLength=64,d.prototype._update=function(a,b){for(var c=this.W,d=0;16>d;d++)c[d]=a[b+d];for(;d<c.length;d++)c[d]=j(q(c[d-2]),c[d-7],p(c[d-15]),c[d-16]);var e=this.h[0],f=this.h[1],g=this.h[2],r=this.h[3],s=this.h[4],t=this.h[5],u=this.h[6],v=this.h[7];for(h(this.k.length===c.length),d=0;d<c.length;d++){var w=k(v,o(s),l(s,t,u),this.k[d],c[d]),x=i(n(e),m(e,f,g));v=u,u=t,t=s,s=i(r,w),r=g,g=f,f=e,e=i(w,x)}this.h[0]=i(this.h[0],e),this.h[1]=i(this.h[1],f),this.h[2]=i(this.h[2],g),this.h[3]=i(this.h[3],r),this.h[4]=i(this.h[4],s),this.h[5]=i(this.h[5],t),this.h[6]=i(this.h[6],u),this.h[7]=i(this.h[7],v)},d.prototype._digest=function(a){return"hex"===a?e.toHex32(this.h,"big"):e.split32(this.h,"big")}},{"../common":181,"../utils":191,"./common":190,"minimalistic-assert":200}],188:[function(a,b,c){"use strict";function d(){return this instanceof d?(f.call(this),void(this.h=[3418070365,3238371032,1654270250,914150663,2438529370,812702999,355462360,4144912697,1731405415,4290775857,2394180231,1750603025,3675008525,1694076839,1203062813,3204075428])):new d}var e=a("../utils"),f=a("./512");e.inherits(d,f),b.exports=d,d.blockSize=1024,d.outSize=384,d.hmacStrength=192,d.padLength=128,d.prototype._digest=function(a){return"hex"===a?e.toHex32(this.h.slice(0,12),"big"):e.split32(this.h.slice(0,12),"big")}},{"../utils":191,"./512":189}],189:[function(a,b,c){"use strict";function d(){return this instanceof d?(E.call(this),this.h=[1779033703,4089235720,3144134277,2227873595,1013904242,4271175723,2773480762,1595750129,1359893119,2917565137,2600822924,725511199,528734635,4215389547,1541459225,327033209],this.k=F,void(this.W=new Array(160))):new d}function e(a,b,c,d,e){var f=a&c^~a&e;return 0>f&&(f+=4294967296),f}function f(a,b,c,d,e,f){var g=b&d^~b&f;return 0>g&&(g+=4294967296),g}function g(a,b,c,d,e){var f=a&c^a&e^c&e;return 0>f&&(f+=4294967296),f}function h(a,b,c,d,e,f){var g=b&d^b&f^d&f;return 0>g&&(g+=4294967296),
g}function i(a,b){var c=t(a,b,28),d=t(b,a,2),e=t(b,a,7),f=c^d^e;return 0>f&&(f+=4294967296),f}function j(a,b){var c=u(a,b,28),d=u(b,a,2),e=u(b,a,7),f=c^d^e;return 0>f&&(f+=4294967296),f}function k(a,b){var c=t(a,b,14),d=t(a,b,18),e=t(b,a,9),f=c^d^e;return 0>f&&(f+=4294967296),f}function l(a,b){var c=u(a,b,14),d=u(a,b,18),e=u(b,a,9),f=c^d^e;return 0>f&&(f+=4294967296),f}function m(a,b){var c=t(a,b,1),d=t(a,b,8),e=v(a,b,7),f=c^d^e;return 0>f&&(f+=4294967296),f}function n(a,b){var c=u(a,b,1),d=u(a,b,8),e=w(a,b,7),f=c^d^e;return 0>f&&(f+=4294967296),f}function o(a,b){var c=t(a,b,19),d=t(b,a,29),e=v(a,b,6),f=c^d^e;return 0>f&&(f+=4294967296),f}function p(a,b){var c=u(a,b,19),d=u(b,a,29),e=w(a,b,6),f=c^d^e;return 0>f&&(f+=4294967296),f}var q=a("../utils"),r=a("../common"),s=a("minimalistic-assert"),t=q.rotr64_hi,u=q.rotr64_lo,v=q.shr64_hi,w=q.shr64_lo,x=q.sum64,y=q.sum64_hi,z=q.sum64_lo,A=q.sum64_4_hi,B=q.sum64_4_lo,C=q.sum64_5_hi,D=q.sum64_5_lo,E=r.BlockHash,F=[1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591];q.inherits(d,E),b.exports=d,d.blockSize=1024,d.outSize=512,d.hmacStrength=192,d.padLength=128,d.prototype._prepareBlock=function(a,b){for(var c=this.W,d=0;32>d;d++)c[d]=a[b+d];for(;d<c.length;d+=2){var e=o(c[d-4],c[d-3]),f=p(c[d-4],c[d-3]),g=c[d-14],h=c[d-13],i=m(c[d-30],c[d-29]),j=n(c[d-30],c[d-29]),k=c[d-32],l=c[d-31];c[d]=A(e,f,g,h,i,j,k,l),c[d+1]=B(e,f,g,h,i,j,k,l)}},d.prototype._update=function(a,b){this._prepareBlock(a,b);var c=this.W,d=this.h[0],m=this.h[1],n=this.h[2],o=this.h[3],p=this.h[4],q=this.h[5],r=this.h[6],t=this.h[7],u=this.h[8],v=this.h[9],w=this.h[10],A=this.h[11],B=this.h[12],E=this.h[13],F=this.h[14],G=this.h[15];s(this.k.length===c.length);for(var H=0;H<c.length;H+=2){var I=F,J=G,K=k(u,v),L=l(u,v),M=e(u,v,w,A,B,E),N=f(u,v,w,A,B,E),O=this.k[H],P=this.k[H+1],Q=c[H],R=c[H+1],S=C(I,J,K,L,M,N,O,P,Q,R),T=D(I,J,K,L,M,N,O,P,Q,R);I=i(d,m),J=j(d,m),K=g(d,m,n,o,p,q),L=h(d,m,n,o,p,q);var U=y(I,J,K,L),V=z(I,J,K,L);F=B,G=E,B=w,E=A,w=u,A=v,u=y(r,t,S,T),v=z(t,t,S,T),r=p,t=q,p=n,q=o,n=d,o=m,d=y(S,T,U,V),m=z(S,T,U,V)}x(this.h,0,d,m),x(this.h,2,n,o),x(this.h,4,p,q),x(this.h,6,r,t),x(this.h,8,u,v),x(this.h,10,w,A),x(this.h,12,B,E),x(this.h,14,F,G)},d.prototype._digest=function(a){return"hex"===a?q.toHex32(this.h,"big"):q.split32(this.h,"big")}},{"../common":181,"../utils":191,"minimalistic-assert":200}],190:[function(a,b,c){"use strict";function d(a,b,c,d){return 0===a?e(b,c,d):1===a||3===a?g(b,c,d):2===a?f(b,c,d):void 0}function e(a,b,c){return a&b^~a&c}function f(a,b,c){return a&b^a&c^b&c}function g(a,b,c){return a^b^c}function h(a){return m(a,2)^m(a,13)^m(a,22)}function i(a){return m(a,6)^m(a,11)^m(a,25)}function j(a){return m(a,7)^m(a,18)^a>>>3}function k(a){return m(a,17)^m(a,19)^a>>>10}var l=a("../utils"),m=l.rotr32;c.ft_1=d,c.ch32=e,c.maj32=f,c.p32=g,c.s0_256=h,c.s1_256=i,c.g0_256=j,c.g1_256=k},{"../utils":191}],191:[function(a,b,c){"use strict";function d(a,b){if(Array.isArray(a))return a.slice();if(!a)return[];var c=[];if("string"==typeof a)if(b){if("hex"===b)for(a=a.replace(/[^a-z0-9]+/gi,""),a.length%2!==0&&(a="0"+a),d=0;d<a.length;d+=2)c.push(parseInt(a[d]+a[d+1],16))}else for(var d=0;d<a.length;d++){var e=a.charCodeAt(d),f=e>>8,g=255&e;f?c.push(f,g):c.push(g)}else for(d=0;d<a.length;d++)c[d]=0|a[d];return c}function e(a){for(var b="",c=0;c<a.length;c++)b+=h(a[c].toString(16));return b}function f(a){var b=a>>>24|a>>>8&65280|a<<8&16711680|(255&a)<<24;return b>>>0}function g(a,b){for(var c="",d=0;d<a.length;d++){var e=a[d];"little"===b&&(e=f(e)),c+=i(e.toString(16))}return c}function h(a){return 1===a.length?"0"+a:a}function i(a){return 7===a.length?"0"+a:6===a.length?"00"+a:5===a.length?"000"+a:4===a.length?"0000"+a:3===a.length?"00000"+a:2===a.length?"000000"+a:1===a.length?"0000000"+a:a}function j(a,b,c,d){var e=c-b;C(e%4===0);for(var f=new Array(e/4),g=0,h=b;g<f.length;g++,h+=4){var i;i="big"===d?a[h]<<24|a[h+1]<<16|a[h+2]<<8|a[h+3]:a[h+3]<<24|a[h+2]<<16|a[h+1]<<8|a[h],f[g]=i>>>0}return f}function k(a,b){for(var c=new Array(4*a.length),d=0,e=0;d<a.length;d++,e+=4){var f=a[d];"big"===b?(c[e]=f>>>24,c[e+1]=f>>>16&255,c[e+2]=f>>>8&255,c[e+3]=255&f):(c[e+3]=f>>>24,c[e+2]=f>>>16&255,c[e+1]=f>>>8&255,c[e]=255&f)}return c}function l(a,b){return a>>>b|a<<32-b}function m(a,b){return a<<b|a>>>32-b}function n(a,b){return a+b>>>0}function o(a,b,c){return a+b+c>>>0}function p(a,b,c,d){return a+b+c+d>>>0}function q(a,b,c,d,e){return a+b+c+d+e>>>0}function r(a,b,c,d){var e=a[b],f=a[b+1],g=d+f>>>0,h=(d>g?1:0)+c+e;a[b]=h>>>0,a[b+1]=g}function s(a,b,c,d){var e=b+d>>>0,f=(b>e?1:0)+a+c;return f>>>0}function t(a,b,c,d){var e=b+d;return e>>>0}function u(a,b,c,d,e,f,g,h){var i=0,j=b;j=j+d>>>0,i+=b>j?1:0,j=j+f>>>0,i+=f>j?1:0,j=j+h>>>0,i+=h>j?1:0;var k=a+c+e+g+i;return k>>>0}function v(a,b,c,d,e,f,g,h){var i=b+d+f+h;return i>>>0}function w(a,b,c,d,e,f,g,h,i,j){var k=0,l=b;l=l+d>>>0,k+=b>l?1:0,l=l+f>>>0,k+=f>l?1:0,l=l+h>>>0,k+=h>l?1:0,l=l+j>>>0,k+=j>l?1:0;var m=a+c+e+g+i+k;return m>>>0}function x(a,b,c,d,e,f,g,h,i,j){var k=b+d+f+h+j;return k>>>0}function y(a,b,c){var d=b<<32-c|a>>>c;return d>>>0}function z(a,b,c){var d=a<<32-c|b>>>c;return d>>>0}function A(a,b,c){return a>>>c}function B(a,b,c){var d=a<<32-c|b>>>c;return d>>>0}var C=a("minimalistic-assert"),D=a("inherits");c.inherits=D,c.toArray=d,c.toHex=e,c.htonl=f,c.toHex32=g,c.zero2=h,c.zero8=i,c.join32=j,c.split32=k,c.rotr32=l,c.rotl32=m,c.sum32=n,c.sum32_3=o,c.sum32_4=p,c.sum32_5=q,c.sum64=r,c.sum64_hi=s,c.sum64_lo=t,c.sum64_4_hi=u,c.sum64_4_lo=v,c.sum64_5_hi=w,c.sum64_5_lo=x,c.rotr64_hi=y,c.rotr64_lo=z,c.shr64_hi=A,c.shr64_lo=B},{inherits:196,"minimalistic-assert":200}],192:[function(a,b,c){"use strict";function d(a){if(!(this instanceof d))return new d(a);this.hash=a.hash,this.predResist=!!a.predResist,this.outLen=this.hash.outSize,this.minEntropy=a.minEntropy||this.hash.hmacStrength,this._reseed=null,this.reseedInterval=null,this.K=null,this.V=null;var b=f.toArray(a.entropy,a.entropyEnc||"hex"),c=f.toArray(a.nonce,a.nonceEnc||"hex"),e=f.toArray(a.pers,a.persEnc||"hex");g(b.length>=this.minEntropy/8,"Not enough entropy. Minimum is: "+this.minEntropy+" bits"),this._init(b,c,e)}var e=a("hash.js"),f=a("minimalistic-crypto-utils"),g=a("minimalistic-assert");b.exports=d,d.prototype._init=function(a,b,c){var d=a.concat(b).concat(c);this.K=new Array(this.outLen/8),this.V=new Array(this.outLen/8);for(var e=0;e<this.V.length;e++)this.K[e]=0,this.V[e]=1;this._update(d),this._reseed=1,this.reseedInterval=281474976710656},d.prototype._hmac=function(){return new e.hmac(this.hash,this.K)},d.prototype._update=function(a){var b=this._hmac().update(this.V).update([0]);a&&(b=b.update(a)),this.K=b.digest(),this.V=this._hmac().update(this.V).digest(),a&&(this.K=this._hmac().update(this.V).update([1]).update(a).digest(),this.V=this._hmac().update(this.V).digest())},d.prototype.reseed=function(a,b,c,d){"string"!=typeof b&&(d=c,c=b,b=null),a=f.toArray(a,b),c=f.toArray(c,d),g(a.length>=this.minEntropy/8,"Not enough entropy. Minimum is: "+this.minEntropy+" bits"),this._update(a.concat(c||[])),this._reseed=1},d.prototype.generate=function(a,b,c,d){if(this._reseed>this.reseedInterval)throw new Error("Reseed is required");"string"!=typeof b&&(d=c,c=b,b=null),c&&(c=f.toArray(c,d||"hex"),this._update(c));for(var e=[];e.length<a;)this.V=this._hmac().update(this.V).digest(),e=e.concat(this.V);var g=e.slice(0,a);return this._update(c),this._reseed++,f.encode(g,b)}},{"hash.js":180,"minimalistic-assert":200,"minimalistic-crypto-utils":201}],193:[function(a,b,c){var d=a("http"),e=b.exports;for(var f in d)d.hasOwnProperty(f)&&(e[f]=d[f]);e.request=function(a,b){return a||(a={}),a.scheme="https",a.protocol="https:",d.request.call(this,a,b)}},{http:174}],194:[function(a,b,c){c.read=function(a,b,c,d,e){var f,g,h=8*e-d-1,i=(1<<h)-1,j=i>>1,k=-7,l=c?e-1:0,m=c?-1:1,n=a[b+l];for(l+=m,f=n&(1<<-k)-1,n>>=-k,k+=h;k>0;f=256*f+a[b+l],l+=m,k-=8);for(g=f&(1<<-k)-1,f>>=-k,k+=d;k>0;g=256*g+a[b+l],l+=m,k-=8);if(0===f)f=1-j;else{if(f===i)return g?NaN:(n?-1:1)*(1/0);g+=Math.pow(2,d),f-=j}return(n?-1:1)*g*Math.pow(2,f-d)},c.write=function(a,b,c,d,e,f){var g,h,i,j=8*f-e-1,k=(1<<j)-1,l=k>>1,m=23===e?Math.pow(2,-24)-Math.pow(2,-77):0,n=d?0:f-1,o=d?1:-1,p=0>b||0===b&&0>1/b?1:0;for(b=Math.abs(b),isNaN(b)||b===1/0?(h=isNaN(b)?1:0,g=k):(g=Math.floor(Math.log(b)/Math.LN2),b*(i=Math.pow(2,-g))<1&&(g--,i*=2),b+=g+l>=1?m/i:m*Math.pow(2,1-l),b*i>=2&&(g++,i/=2),g+l>=k?(h=0,g=k):g+l>=1?(h=(b*i-1)*Math.pow(2,e),g+=l):(h=b*Math.pow(2,l-1)*Math.pow(2,e),g=0));e>=8;a[c+n]=255&h,n+=o,h/=256,e-=8);for(g=g<<e|h,j+=e;j>0;a[c+n]=255&g,n+=o,g/=256,j-=8);a[c+n-o]|=128*p}},{}],195:[function(a,b,c){var d=[].indexOf;b.exports=function(a,b){if(d)return a.indexOf(b);for(var c=0;c<a.length;++c)if(a[c]===b)return c;return-1}},{}],196:[function(a,b,c){"function"==typeof Object.create?b.exports=function(a,b){a.super_=b,a.prototype=Object.create(b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}})}:b.exports=function(a,b){a.super_=b;var c=function(){};c.prototype=b.prototype,a.prototype=new c,a.prototype.constructor=a}},{}],197:[function(a,b,c){function d(a){return!!a.constructor&&"function"==typeof a.constructor.isBuffer&&a.constructor.isBuffer(a)}function e(a){return"function"==typeof a.readFloatLE&&"function"==typeof a.slice&&d(a.slice(0,0))}b.exports=function(a){return null!=a&&(d(a)||e(a)||!!a._isBuffer)}},{}],198:[function(a,b,c){!function(){var c=a("crypt"),d=a("charenc").utf8,e=a("is-buffer"),f=a("charenc").bin,g=function(a,b){a.constructor==String?a=b&&"binary"===b.encoding?f.stringToBytes(a):d.stringToBytes(a):e(a)?a=Array.prototype.slice.call(a,0):Array.isArray(a)||(a=a.toString());for(var h=c.bytesToWords(a),i=8*a.length,j=1732584193,k=-271733879,l=-1732584194,m=271733878,n=0;n<h.length;n++)h[n]=16711935&(h[n]<<8|h[n]>>>24)|4278255360&(h[n]<<24|h[n]>>>8);h[i>>>5]|=128<<i%32,h[(i+64>>>9<<4)+14]=i;for(var o=g._ff,p=g._gg,q=g._hh,r=g._ii,n=0;n<h.length;n+=16){var s=j,t=k,u=l,v=m;j=o(j,k,l,m,h[n+0],7,-680876936),m=o(m,j,k,l,h[n+1],12,-389564586),l=o(l,m,j,k,h[n+2],17,606105819),k=o(k,l,m,j,h[n+3],22,-1044525330),j=o(j,k,l,m,h[n+4],7,-176418897),m=o(m,j,k,l,h[n+5],12,1200080426),l=o(l,m,j,k,h[n+6],17,-1473231341),k=o(k,l,m,j,h[n+7],22,-45705983),j=o(j,k,l,m,h[n+8],7,1770035416),m=o(m,j,k,l,h[n+9],12,-1958414417),l=o(l,m,j,k,h[n+10],17,-42063),k=o(k,l,m,j,h[n+11],22,-1990404162),j=o(j,k,l,m,h[n+12],7,1804603682),m=o(m,j,k,l,h[n+13],12,-40341101),l=o(l,m,j,k,h[n+14],17,-1502002290),k=o(k,l,m,j,h[n+15],22,1236535329),j=p(j,k,l,m,h[n+1],5,-165796510),m=p(m,j,k,l,h[n+6],9,-1069501632),l=p(l,m,j,k,h[n+11],14,643717713),k=p(k,l,m,j,h[n+0],20,-373897302),j=p(j,k,l,m,h[n+5],5,-701558691),m=p(m,j,k,l,h[n+10],9,38016083),l=p(l,m,j,k,h[n+15],14,-660478335),k=p(k,l,m,j,h[n+4],20,-405537848),j=p(j,k,l,m,h[n+9],5,568446438),m=p(m,j,k,l,h[n+14],9,-1019803690),l=p(l,m,j,k,h[n+3],14,-187363961),k=p(k,l,m,j,h[n+8],20,1163531501),j=p(j,k,l,m,h[n+13],5,-1444681467),m=p(m,j,k,l,h[n+2],9,-51403784),l=p(l,m,j,k,h[n+7],14,1735328473),k=p(k,l,m,j,h[n+12],20,-1926607734),j=q(j,k,l,m,h[n+5],4,-378558),m=q(m,j,k,l,h[n+8],11,-2022574463),l=q(l,m,j,k,h[n+11],16,1839030562),k=q(k,l,m,j,h[n+14],23,-35309556),j=q(j,k,l,m,h[n+1],4,-1530992060),m=q(m,j,k,l,h[n+4],11,1272893353),l=q(l,m,j,k,h[n+7],16,-155497632),k=q(k,l,m,j,h[n+10],23,-1094730640),j=q(j,k,l,m,h[n+13],4,681279174),m=q(m,j,k,l,h[n+0],11,-358537222),l=q(l,m,j,k,h[n+3],16,-722521979),k=q(k,l,m,j,h[n+6],23,76029189),j=q(j,k,l,m,h[n+9],4,-640364487),m=q(m,j,k,l,h[n+12],11,-421815835),l=q(l,m,j,k,h[n+15],16,530742520),k=q(k,l,m,j,h[n+2],23,-995338651),j=r(j,k,l,m,h[n+0],6,-198630844),m=r(m,j,k,l,h[n+7],10,1126891415),l=r(l,m,j,k,h[n+14],15,-1416354905),k=r(k,l,m,j,h[n+5],21,-57434055),j=r(j,k,l,m,h[n+12],6,1700485571),m=r(m,j,k,l,h[n+3],10,-1894986606),l=r(l,m,j,k,h[n+10],15,-1051523),k=r(k,l,m,j,h[n+1],21,-2054922799),j=r(j,k,l,m,h[n+8],6,1873313359),m=r(m,j,k,l,h[n+15],10,-30611744),l=r(l,m,j,k,h[n+6],15,-1560198380),k=r(k,l,m,j,h[n+13],21,1309151649),j=r(j,k,l,m,h[n+4],6,-145523070),m=r(m,j,k,l,h[n+11],10,-1120210379),l=r(l,m,j,k,h[n+2],15,718787259),k=r(k,l,m,j,h[n+9],21,-343485551),j=j+s>>>0,k=k+t>>>0,l=l+u>>>0,m=m+v>>>0}return c.endian([j,k,l,m])};g._ff=function(a,b,c,d,e,f,g){var h=a+(b&c|~b&d)+(e>>>0)+g;return(h<<f|h>>>32-f)+b},g._gg=function(a,b,c,d,e,f,g){var h=a+(b&d|c&~d)+(e>>>0)+g;return(h<<f|h>>>32-f)+b},g._hh=function(a,b,c,d,e,f,g){var h=a+(b^c^d)+(e>>>0)+g;return(h<<f|h>>>32-f)+b},g._ii=function(a,b,c,d,e,f,g){var h=a+(c^(b|~d))+(e>>>0)+g;return(h<<f|h>>>32-f)+b},g._blocksize=16,g._digestsize=16,b.exports=function(a,b){if(void 0===a||null===a)throw new Error("Illegal argument "+a);var d=c.wordsToBytes(g(a,b));return b&&b.asBytes?d:b&&b.asString?f.bytesToString(d):c.bytesToHex(d)}}()},{charenc:132,crypt:141,"is-buffer":197}],199:[function(a,b,c){function d(a){this.rand=a||new f.Rand}var e=a("bn.js"),f=a("brorand");b.exports=d,d.create=function(a){return new d(a)},d.prototype._rand=function(a){var b=a.bitLength(),c=this.rand.generate(Math.ceil(b/8));c[0]|=3;var d=7&b;return 0!==d&&(c[c.length-1]>>=7-d),new e(c)},d.prototype.test=function(a,b,c){var d=a.bitLength(),f=e.mont(a),g=new e(1).toRed(f);b||(b=Math.max(1,d/48|0));for(var h=a.subn(1),i=h.subn(1),j=0;!h.testn(j);j++);for(var k=a.shrn(j),l=h.toRed(f),m=!0;b>0;b--){var n=this._rand(i);c&&c(n);var o=n.toRed(f).redPow(k);if(0!==o.cmp(g)&&0!==o.cmp(l)){for(var p=1;j>p;p++){if(o=o.redSqr(),0===o.cmp(g))return!1;if(0===o.cmp(l))break}if(p===j)return!1}}return m},d.prototype.getDivisor=function(a,b){var c=a.bitLength(),d=e.mont(a),f=new e(1).toRed(d);b||(b=Math.max(1,c/48|0));for(var g=a.subn(1),h=g.subn(1),i=0;!g.testn(i);i++);for(var j=a.shrn(i),k=g.toRed(d);b>0;b--){var l=this._rand(h),m=a.gcd(l);if(0!==m.cmpn(1))return m;var n=l.toRed(d).redPow(j);if(0!==n.cmp(f)&&0!==n.cmp(k)){for(var o=1;i>o;o++){if(n=n.redSqr(),0===n.cmp(f))return n.fromRed().subn(1).gcd(a);if(0===n.cmp(k))break}if(o===i)return n=n.redSqr(),n.fromRed().subn(1).gcd(a)}}return!1}},{"bn.js":99,brorand:100}],200:[function(a,b,c){function d(a,b){if(!a)throw new Error(b||"Assertion failed")}b.exports=d,d.equal=function(a,b,c){if(a!=b)throw new Error(c||"Assertion failed: "+a+" != "+b)}},{}],201:[function(a,b,c){"use strict";function d(a,b){if(Array.isArray(a))return a.slice();if(!a)return[];var c=[];if("string"!=typeof a){for(var d=0;d<a.length;d++)c[d]=0|a[d];return c}if("hex"===b){a=a.replace(/[^a-z0-9]+/gi,""),a.length%2!==0&&(a="0"+a);for(var d=0;d<a.length;d+=2)c.push(parseInt(a[d]+a[d+1],16))}else for(var d=0;d<a.length;d++){var e=a.charCodeAt(d),f=e>>8,g=255&e;f?c.push(f,g):c.push(g)}return c}function e(a){return 1===a.length?"0"+a:a}function f(a){for(var b="",c=0;c<a.length;c++)b+=e(a[c].toString(16));return b}var g=c;g.toArray=d,g.zero2=e,g.toHex=f,g.encode=function(a,b){return"hex"===b?f(a):a}},{}],202:[function(a,b,c){"use strict";var d=Object.prototype.hasOwnProperty,e=Object.prototype.toString,f=Array.prototype.slice,g=a("./isArguments"),h=Object.prototype.propertyIsEnumerable,i=!h.call({toString:null},"toString"),j=h.call(function(){},"prototype"),k=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"],l=function(a){var b=a.constructor;return b&&b.prototype===a},m={$console:!0,$external:!0,$frame:!0,$frameElement:!0,$frames:!0,$innerHeight:!0,$innerWidth:!0,$outerHeight:!0,$outerWidth:!0,$pageXOffset:!0,$pageYOffset:!0,$parent:!0,$scrollLeft:!0,$scrollTop:!0,$scrollX:!0,$scrollY:!0,$self:!0,$webkitIndexedDB:!0,$webkitStorageInfo:!0,$window:!0},n=function(){if("undefined"==typeof window)return!1;for(var a in window)try{if(!m["$"+a]&&d.call(window,a)&&null!==window[a]&&"object"==typeof window[a])try{l(window[a])}catch(b){return!0}}catch(b){return!0}return!1}(),o=function(a){if("undefined"==typeof window||!n)return l(a);try{return l(a)}catch(b){return!1}},p=function(a){var b=null!==a&&"object"==typeof a,c="[object Function]"===e.call(a),f=g(a),h=b&&"[object String]"===e.call(a),l=[];if(!b&&!c&&!f)throw new TypeError("Object.keys called on a non-object");var m=j&&c;if(h&&a.length>0&&!d.call(a,0))for(var n=0;n<a.length;++n)l.push(String(n));if(f&&a.length>0)for(var p=0;p<a.length;++p)l.push(String(p));else for(var q in a)m&&"prototype"===q||!d.call(a,q)||l.push(String(q));if(i)for(var r=o(a),s=0;s<k.length;++s)r&&"constructor"===k[s]||!d.call(a,k[s])||l.push(k[s]);return l};p.shim=function(){if(Object.keys){var a=function(){return 2===(Object.keys(arguments)||"").length}(1,2);if(!a){var b=Object.keys;Object.keys=function(a){return b(g(a)?f.call(a):a)}}}else Object.keys=p;return Object.keys||p},b.exports=p},{"./isArguments":203}],203:[function(a,b,c){"use strict";var d=Object.prototype.toString;b.exports=function(a){var b=d.call(a),c="[object Arguments]"===b;return c||(c="[object Array]"!==b&&null!==a&&"object"==typeof a&&"number"==typeof a.length&&a.length>=0&&"[object Function]"===d.call(a.callee)),c}},{}],204:[function(a,b,c){b.exports={"2.16.840.1.101.3.4.1.1":"aes-128-ecb","2.16.840.1.101.3.4.1.2":"aes-128-cbc","2.16.840.1.101.3.4.1.3":"aes-128-ofb","2.16.840.1.101.3.4.1.4":"aes-128-cfb","2.16.840.1.101.3.4.1.21":"aes-192-ecb","2.16.840.1.101.3.4.1.22":"aes-192-cbc","2.16.840.1.101.3.4.1.23":"aes-192-ofb","2.16.840.1.101.3.4.1.24":"aes-192-cfb","2.16.840.1.101.3.4.1.41":"aes-256-ecb","2.16.840.1.101.3.4.1.42":"aes-256-cbc","2.16.840.1.101.3.4.1.43":"aes-256-ofb","2.16.840.1.101.3.4.1.44":"aes-256-cfb"}},{}],205:[function(a,b,c){"use strict";var d=a("asn1.js");c.certificate=a("./certificate");var e=d.define("RSAPrivateKey",function(){this.seq().obj(this.key("version")["int"](),this.key("modulus")["int"](),this.key("publicExponent")["int"](),this.key("privateExponent")["int"](),this.key("prime1")["int"](),this.key("prime2")["int"](),this.key("exponent1")["int"](),this.key("exponent2")["int"](),this.key("coefficient")["int"]())});c.RSAPrivateKey=e;var f=d.define("RSAPublicKey",function(){this.seq().obj(this.key("modulus")["int"](),this.key("publicExponent")["int"]())});c.RSAPublicKey=f;var g=d.define("SubjectPublicKeyInfo",function(){this.seq().obj(this.key("algorithm").use(h),this.key("subjectPublicKey").bitstr())});c.PublicKey=g;var h=d.define("AlgorithmIdentifier",function(){this.seq().obj(this.key("algorithm").objid(),this.key("none").null_().optional(),this.key("curve").objid().optional(),this.key("params").seq().obj(this.key("p")["int"](),this.key("q")["int"](),this.key("g")["int"]()).optional())}),i=d.define("PrivateKeyInfo",function(){this.seq().obj(this.key("version")["int"](),this.key("algorithm").use(h),this.key("subjectPrivateKey").octstr())});c.PrivateKey=i;var j=d.define("EncryptedPrivateKeyInfo",function(){this.seq().obj(this.key("algorithm").seq().obj(this.key("id").objid(),this.key("decrypt").seq().obj(this.key("kde").seq().obj(this.key("id").objid(),this.key("kdeparams").seq().obj(this.key("salt").octstr(),this.key("iters")["int"]())),this.key("cipher").seq().obj(this.key("algo").objid(),this.key("iv").octstr()))),this.key("subjectPrivateKey").octstr())});c.EncryptedPrivateKey=j;var k=d.define("DSAPrivateKey",function(){this.seq().obj(this.key("version")["int"](),this.key("p")["int"](),this.key("q")["int"](),this.key("g")["int"](),this.key("pub_key")["int"](),this.key("priv_key")["int"]())});c.DSAPrivateKey=k,c.DSAparam=d.define("DSAparam",function(){this["int"]()});var l=d.define("ECPrivateKey",function(){this.seq().obj(this.key("version")["int"](),this.key("privateKey").octstr(),this.key("parameters").optional().explicit(0).use(m),this.key("publicKey").optional().explicit(1).bitstr())});c.ECPrivateKey=l;var m=d.define("ECParameters",function(){this.choice({namedCurve:this.objid()})});c.signature=d.define("signature",function(){this.seq().obj(this.key("r")["int"](),this.key("s")["int"]())})},{"./certificate":206,"asn1.js":82}],206:[function(a,b,c){"use strict";var d=a("asn1.js"),e=d.define("Time",function(){this.choice({utcTime:this.utctime(),generalTime:this.gentime()})}),f=d.define("AttributeTypeValue",function(){this.seq().obj(this.key("type").objid(),this.key("value").any())}),g=d.define("AlgorithmIdentifier",function(){this.seq().obj(this.key("algorithm").objid(),this.key("parameters").optional())}),h=d.define("SubjectPublicKeyInfo",function(){this.seq().obj(this.key("algorithm").use(g),this.key("subjectPublicKey").bitstr())}),i=d.define("RelativeDistinguishedName",function(){this.setof(f)}),j=d.define("RDNSequence",function(){this.seqof(i)}),k=d.define("Name",function(){this.choice({rdnSequence:this.use(j)})}),l=d.define("Validity",function(){this.seq().obj(this.key("notBefore").use(e),this.key("notAfter").use(e))}),m=d.define("Extension",function(){this.seq().obj(this.key("extnID").objid(),this.key("critical").bool().def(!1),this.key("extnValue").octstr())}),n=d.define("TBSCertificate",function(){this.seq().obj(this.key("version").explicit(0)["int"](),this.key("serialNumber")["int"](),this.key("signature").use(g),this.key("issuer").use(k),this.key("validity").use(l),this.key("subject").use(k),this.key("subjectPublicKeyInfo").use(h),this.key("issuerUniqueID").implicit(1).bitstr().optional(),this.key("subjectUniqueID").implicit(2).bitstr().optional(),this.key("extensions").explicit(3).seqof(m).optional())}),o=d.define("X509Certificate",function(){this.seq().obj(this.key("tbsCertificate").use(n),this.key("signatureAlgorithm").use(g),this.key("signatureValue").bitstr())});b.exports=o},{"asn1.js":82}],207:[function(a,b,c){(function(c){var d=/Proc-Type: 4,ENCRYPTED\n\r?DEK-Info: AES-((?:128)|(?:192)|(?:256))-CBC,([0-9A-H]+)\n\r?\n\r?([0-9A-z\n\r\+\/\=]+)\n\r?/m,e=/^-----BEGIN ((?:.* KEY)|CERTIFICATE)-----\n/m,f=/^-----BEGIN ((?:.* KEY)|CERTIFICATE)-----\n\r?([0-9A-z\n\r\+\/\=]+)\n\r?-----END \1-----$/m,g=a("evp_bytestokey"),h=a("browserify-aes");b.exports=function(a,b){var i,j=a.toString(),k=j.match(d);if(k){var l="aes"+k[1],m=new c(k[2],"hex"),n=new c(k[3].replace(/\r?\n/g,""),"base64"),o=g(b,m.slice(0,8),parseInt(k[1],10)).key,p=[],q=h.createDecipheriv(l,o,m);p.push(q.update(n)),p.push(q["final"]()),i=c.concat(p)}else{var r=j.match(f);i=new c(r[2].replace(/\r?\n/g,""),"base64")}var s=j.match(e)[1];return{tag:s,data:i}}}).call(this,a("buffer").Buffer)},{"browserify-aes":104,buffer:130,evp_bytestokey:170}],208:[function(a,b,c){(function(c){function d(a){var b;"object"!=typeof a||c.isBuffer(a)||(b=a.passphrase,a=a.key),"string"==typeof a&&(a=new c(a));var d,g,i=h(a,b),j=i.tag,k=i.data;switch(j){case"CERTIFICATE":g=f.certificate.decode(k,"der").tbsCertificate.subjectPublicKeyInfo;case"PUBLIC KEY":switch(g||(g=f.PublicKey.decode(k,"der")),d=g.algorithm.algorithm.join(".")){case"1.2.840.113549.1.1.1":return f.RSAPublicKey.decode(g.subjectPublicKey.data,"der");case"1.2.840.10045.2.1":return g.subjectPrivateKey=g.subjectPublicKey,{type:"ec",data:g};case"1.2.840.10040.4.1":return g.algorithm.params.pub_key=f.DSAparam.decode(g.subjectPublicKey.data,"der"),{type:"dsa",data:g.algorithm.params};default:throw new Error("unknown key id "+d)}throw new Error("unknown key type "+j);case"ENCRYPTED PRIVATE KEY":k=f.EncryptedPrivateKey.decode(k,"der"),k=e(k,b);case"PRIVATE KEY":switch(g=f.PrivateKey.decode(k,"der"),d=g.algorithm.algorithm.join(".")){case"1.2.840.113549.1.1.1":return f.RSAPrivateKey.decode(g.subjectPrivateKey,"der");case"1.2.840.10045.2.1":return{curve:g.algorithm.curve,privateKey:f.ECPrivateKey.decode(g.subjectPrivateKey,"der").privateKey};case"1.2.840.10040.4.1":return g.algorithm.params.priv_key=f.DSAparam.decode(g.subjectPrivateKey,"der"),{type:"dsa",params:g.algorithm.params};default:throw new Error("unknown key id "+d)}throw new Error("unknown key type "+j);case"RSA PUBLIC KEY":return f.RSAPublicKey.decode(k,"der");case"RSA PRIVATE KEY":return f.RSAPrivateKey.decode(k,"der");case"DSA PRIVATE KEY":return{type:"dsa",params:f.DSAPrivateKey.decode(k,"der")};case"EC PRIVATE KEY":return k=f.ECPrivateKey.decode(k,"der"),{curve:k.parameters.value,privateKey:k.privateKey};default:throw new Error("unknown key type "+j)}}function e(a,b){var d=a.algorithm.decrypt.kde.kdeparams.salt,e=parseInt(a.algorithm.decrypt.kde.kdeparams.iters.toString(),10),f=g[a.algorithm.decrypt.cipher.algo.join(".")],h=a.algorithm.decrypt.cipher.iv,k=a.subjectPrivateKey,l=parseInt(f.split("-")[1],10)/8,m=j.pbkdf2Sync(b,d,e,l),n=i.createDecipheriv(f,m,h),o=[];return o.push(n.update(k)),o.push(n["final"]()),c.concat(o)}var f=a("./asn1"),g=a("./aesid.json"),h=a("./fixProc"),i=a("browserify-aes"),j=a("pbkdf2");b.exports=d,d.signature=f.signature}).call(this,a("buffer").Buffer)},{"./aesid.json":204,"./asn1":205,"./fixProc":207,"browserify-aes":104,buffer:130,pbkdf2:209}],209:[function(a,b,c){c.pbkdf2=a("./lib/async"),c.pbkdf2Sync=a("./lib/sync")},{"./lib/async":210,"./lib/sync":213}],210:[function(a,b,c){(function(c,d){function e(a){if(d.process&&!d.process.browser)return Promise.resolve(!1);if(!m||!m.importKey||!m.deriveBits)return Promise.resolve(!1);if(void 0!==o[a])return o[a];h=h||l.alloc(8);var b=f(h,h,10,128,a).then(function(){return!0})["catch"](function(){return!1});return o[a]=b,b}function f(a,b,c,d,e){return m.importKey("raw",a,{name:"PBKDF2"},!1,["deriveBits"]).then(function(a){return m.deriveBits({name:"PBKDF2",salt:b,iterations:c,hash:{name:e}},a,d<<3)}).then(function(a){return l.from(a)})}function g(a,b){a.then(function(a){c.nextTick(function(){b(null,a)})},function(a){c.nextTick(function(){b(a)})})}var h,i=a("./precondition"),j=a("./default-encoding"),k=a("./sync"),l=a("safe-buffer").Buffer,m=d.crypto&&d.crypto.subtle,n={sha:"SHA-1","sha-1":"SHA-1",sha1:"SHA-1",sha256:"SHA-256","sha-256":"SHA-256",sha384:"SHA-384","sha-384":"SHA-384","sha-512":"SHA-512",sha512:"SHA-512"},o=[];b.exports=function(a,b,h,m,o,p){if(l.isBuffer(a)||(a=l.from(a,j)),l.isBuffer(b)||(b=l.from(b,j)),i(h,m),"function"==typeof o&&(p=o,o=void 0),"function"!=typeof p)throw new Error("No callback provided to pbkdf2");o=o||"sha1";var q=n[o.toLowerCase()];return q&&"function"==typeof d.Promise?void g(e(q).then(function(c){return c?f(a,b,h,m,q):k(a,b,h,m,o)}),p):c.nextTick(function(){var c;try{c=k(a,b,h,m,o)}catch(d){return p(d)}p(null,c)})}}).call(this,a("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./default-encoding":211,"./precondition":212,"./sync":213,_process:215,"safe-buffer":245}],211:[function(a,b,c){(function(a){var c;if(a.browser)c="utf-8";else{var d=parseInt(a.version.split(".")[0].slice(1),10);c=d>=6?"utf-8":"binary"}b.exports=c}).call(this,a("_process"))},{_process:215}],212:[function(a,b,c){var d=Math.pow(2,30)-1;b.exports=function(a,b){if("number"!=typeof a)throw new TypeError("Iterations not a number");if(0>a)throw new TypeError("Bad iterations");if("number"!=typeof b)throw new TypeError("Key length not a number");if(0>b||b>d||b!==b)throw new TypeError("Bad key length")}},{}],213:[function(a,b,c){function d(a,b,c){var d=e(a),f="sha512"===a||"sha384"===a?128:64;b.length>f?b=d(b):b.length<f&&(b=k.concat([b,l],f));for(var g=k.allocUnsafe(f+m[a]),h=k.allocUnsafe(f+m[a]),i=0;f>i;i++)g[i]=54^b[i],h[i]=92^b[i];var j=k.allocUnsafe(f+c+4);g.copy(j,0,0,f),this.ipad1=j,this.ipad2=g,this.opad=h,this.alg=a,this.blocksize=f,this.hash=d,this.size=m[a]}function e(a){function b(b){return h(a).update(b).digest()}return"rmd160"===a||"ripemd160"===a?g:"md5"===a?f:b}var f=a("create-hash/md5"),g=a("ripemd160"),h=a("sha.js"),i=a("./precondition"),j=a("./default-encoding"),k=a("safe-buffer").Buffer,l=k.alloc(128),m={md5:16,sha1:20,sha224:28,sha256:32,sha384:48,sha512:64,rmd160:20,ripemd160:20};d.prototype.run=function(a,b){a.copy(b,this.blocksize);var c=this.hash(b);return c.copy(this.opad,this.blocksize),this.hash(this.opad)},b.exports=function(a,b,c,e,f){k.isBuffer(a)||(a=k.from(a,j)),k.isBuffer(b)||(b=k.from(b,j)),i(c,e),f=f||"sha1";var g=new d(f,a,b.length),h=k.allocUnsafe(e),l=k.allocUnsafe(b.length+4);b.copy(l,0,0,b.length);for(var m,n,o,p,q=g.size,r=k.allocUnsafe(q),s=Math.ceil(e/q),t=e-(s-1)*q,u=1;s>=u;u++){for(l.writeUInt32BE(u,b.length),m=g.run(l,g.ipad1),m.copy(r,0,0,q),n=1;c>n;n++){m=g.run(m,g.ipad2);for(var v=0;q>v;v++)r[v]^=m[v]}o=(u-1)*q,p=u===s?t:q,r.copy(h,o,0,p)}return h}},{"./default-encoding":211,"./precondition":212,"create-hash/md5":138,ripemd160:244,"safe-buffer":245,"sha.js":247}],214:[function(a,b,c){(function(a){"use strict";function c(b,c,d,e){if("function"!=typeof b)throw new TypeError('"callback" argument must be a function');var f,g,h=arguments.length;switch(h){case 0:case 1:return a.nextTick(b);case 2:return a.nextTick(function(){b.call(null,c)});case 3:return a.nextTick(function(){b.call(null,c,d)});case 4:return a.nextTick(function(){b.call(null,c,d,e)});default:for(f=new Array(h-1),g=0;g<f.length;)f[g++]=arguments[g];return a.nextTick(function(){b.apply(null,f)})}}!a.version||0===a.version.indexOf("v0.")||0===a.version.indexOf("v1.")&&0!==a.version.indexOf("v1.8.")?b.exports=c:b.exports=a.nextTick}).call(this,a("_process"))},{_process:215}],215:[function(a,b,c){function d(){throw new Error("setTimeout has not been defined")}function e(){throw new Error("clearTimeout has not been defined")}function f(a){if(l===setTimeout)return setTimeout(a,0);if((l===d||!l)&&setTimeout)return l=setTimeout,setTimeout(a,0);try{return l(a,0)}catch(b){try{return l.call(null,a,0)}catch(b){return l.call(this,a,0)}}}function g(a){if(m===clearTimeout)return clearTimeout(a);if((m===e||!m)&&clearTimeout)return m=clearTimeout,clearTimeout(a);try{return m(a)}catch(b){try{return m.call(null,a)}catch(b){return m.call(this,a)}}}function h(){q&&o&&(q=!1,o.length?p=o.concat(p):r=-1,p.length&&i())}function i(){if(!q){var a=f(h);q=!0;for(var b=p.length;b;){for(o=p,p=[];++r<b;)o&&o[r].run();r=-1,b=p.length}o=null,q=!1,g(a)}}function j(a,b){this.fun=a,this.array=b}function k(){}var l,m,n=b.exports={};!function(){try{l="function"==typeof setTimeout?setTimeout:d}catch(a){l=d}try{m="function"==typeof clearTimeout?clearTimeout:e}catch(a){m=e}}();var o,p=[],q=!1,r=-1;n.nextTick=function(a){var b=new Array(arguments.length-1);if(arguments.length>1)for(var c=1;c<arguments.length;c++)b[c-1]=arguments[c];p.push(new j(a,b)),1!==p.length||q||f(i)},j.prototype.run=function(){this.fun.apply(null,this.array)},n.title="browser",n.browser=!0,n.env={},n.argv=[],n.version="",n.versions={},n.on=k,n.addListener=k,n.once=k,n.off=k,
n.removeListener=k,n.removeAllListeners=k,n.emit=k,n.prependListener=k,n.prependOnceListener=k,n.listeners=function(a){return[]},n.binding=function(a){throw new Error("process.binding is not supported")},n.cwd=function(){return"/"},n.chdir=function(a){throw new Error("process.chdir is not supported")},n.umask=function(){return 0}},{}],216:[function(a,b,c){c.publicEncrypt=a("./publicEncrypt"),c.privateDecrypt=a("./privateDecrypt"),c.privateEncrypt=function(a,b){return c.publicEncrypt(a,b,!0)},c.publicDecrypt=function(a,b){return c.privateDecrypt(a,b,!0)}},{"./privateDecrypt":218,"./publicEncrypt":219}],217:[function(a,b,c){(function(c){function d(a){var b=new c(4);return b.writeUInt32BE(a,0),b}var e=a("create-hash");b.exports=function(a,b){for(var f,g=new c(""),h=0;g.length<b;)f=d(h++),g=c.concat([g,e("sha1").update(a).update(f).digest()]);return g.slice(0,b)}}).call(this,a("buffer").Buffer)},{buffer:130,"create-hash":136}],218:[function(a,b,c){(function(c){function d(a,b){var d=(a.modulus,a.modulus.byteLength()),e=(b.length,l("sha1").update(new c("")).digest()),g=e.length;if(0!==b[0])throw new Error("decryption error");var j=b.slice(1,g+1),k=b.slice(g+1),m=i(j,h(k,g)),n=i(k,h(m,d-g-1));if(f(e,n.slice(0,g)))throw new Error("decryption error");for(var o=g;0===n[o];)o++;if(1!==n[o++])throw new Error("decryption error");return n.slice(o)}function e(a,b,c){for(var d=b.slice(0,2),e=2,f=0;0!==b[e++];)if(e>=b.length){f++;break}var g=b.slice(2,e-1);b.slice(e-1,e);if(("0002"!==d.toString("hex")&&!c||"0001"!==d.toString("hex")&&c)&&f++,g.length<8&&f++,f)throw new Error("decryption error");return b.slice(e)}function f(a,b){a=new c(a),b=new c(b);var d=0,e=a.length;a.length!==b.length&&(d++,e=Math.min(a.length,b.length));for(var f=-1;++f<e;)d+=a[f]^b[f];return d}var g=a("parse-asn1"),h=a("./mgf"),i=a("./xor"),j=a("bn.js"),k=a("browserify-rsa"),l=a("create-hash"),m=a("./withPublic");b.exports=function(a,b,f){var h;h=a.padding?a.padding:f?1:4;var i=g(a),l=i.modulus.byteLength();if(b.length>l||new j(b).cmp(i.modulus)>=0)throw new Error("decryption error");var n;n=f?m(new j(b),i):k(b,i);var o=new c(l-n.length);if(o.fill(0),n=c.concat([o,n],l),4===h)return d(i,n);if(1===h)return e(i,n,f);if(3===h)return n;throw new Error("unknown padding")}}).call(this,a("buffer").Buffer)},{"./mgf":217,"./withPublic":220,"./xor":221,"bn.js":99,"browserify-rsa":121,buffer:130,"create-hash":136,"parse-asn1":208}],219:[function(a,b,c){(function(c){function d(a,b){var d=a.modulus.byteLength(),e=b.length,f=i("sha1").update(new c("")).digest(),g=f.length,m=2*g;if(e>d-m-2)throw new Error("message too long");var n=new c(d-e-m-2);n.fill(0);var o=d-g-1,p=h(g),q=k(c.concat([f,n,new c([1]),b],o),j(p,o)),r=k(p,j(q,g));return new l(c.concat([new c([0]),r,q],d))}function e(a,b,d){var e=b.length,g=a.modulus.byteLength();if(e>g-11)throw new Error("message too long");var h;return d?(h=new c(g-e-3),h.fill(255)):h=f(g-e-3),new l(c.concat([new c([0,d?1:2]),h,new c([0]),b],g))}function f(a,b){for(var d,e=new c(a),f=0,g=h(2*a),i=0;a>f;)i===g.length&&(g=h(2*a),i=0),d=g[i++],d&&(e[f++]=d);return e}var g=a("parse-asn1"),h=a("randombytes"),i=a("create-hash"),j=a("./mgf"),k=a("./xor"),l=a("bn.js"),m=a("./withPublic"),n=a("browserify-rsa");b.exports=function(a,b,c){var f;f=a.padding?a.padding:c?1:4;var h,i=g(a);if(4===f)h=d(i,b);else if(1===f)h=e(i,b,c);else{if(3!==f)throw new Error("unknown padding");if(h=new l(b),h.cmp(i.modulus)>=0)throw new Error("data too long for modulus")}return c?n(h,i):m(h,i)}}).call(this,a("buffer").Buffer)},{"./mgf":217,"./withPublic":220,"./xor":221,"bn.js":99,"browserify-rsa":121,buffer:130,"create-hash":136,"parse-asn1":208,randombytes:227}],220:[function(a,b,c){(function(c){function d(a,b){return new c(a.toRed(e.mont(b.modulus)).redPow(new e(b.publicExponent)).fromRed().toArray())}var e=a("bn.js");b.exports=d}).call(this,a("buffer").Buffer)},{"bn.js":99,buffer:130}],221:[function(a,b,c){b.exports=function(a,b){for(var c=a.length,d=-1;++d<c;)a[d]^=b[d];return a}},{}],222:[function(a,b,c){(function(a){!function(d){function e(a){throw new RangeError(H[a])}function f(a,b){for(var c=a.length,d=[];c--;)d[c]=b(a[c]);return d}function g(a,b){var c=a.split("@"),d="";c.length>1&&(d=c[0]+"@",a=c[1]),a=a.replace(G,".");var e=a.split("."),g=f(e,b).join(".");return d+g}function h(a){for(var b,c,d=[],e=0,f=a.length;f>e;)b=a.charCodeAt(e++),b>=55296&&56319>=b&&f>e?(c=a.charCodeAt(e++),56320==(64512&c)?d.push(((1023&b)<<10)+(1023&c)+65536):(d.push(b),e--)):d.push(b);return d}function i(a){return f(a,function(a){var b="";return a>65535&&(a-=65536,b+=K(a>>>10&1023|55296),a=56320|1023&a),b+=K(a)}).join("")}function j(a){return 10>a-48?a-22:26>a-65?a-65:26>a-97?a-97:w}function k(a,b){return a+22+75*(26>a)-((0!=b)<<5)}function l(a,b,c){var d=0;for(a=c?J(a/A):a>>1,a+=J(a/b);a>I*y>>1;d+=w)a=J(a/I);return J(d+(I+1)*a/(a+z))}function m(a){var b,c,d,f,g,h,k,m,n,o,p=[],q=a.length,r=0,s=C,t=B;for(c=a.lastIndexOf(D),0>c&&(c=0),d=0;c>d;++d)a.charCodeAt(d)>=128&&e("not-basic"),p.push(a.charCodeAt(d));for(f=c>0?c+1:0;q>f;){for(g=r,h=1,k=w;f>=q&&e("invalid-input"),m=j(a.charCodeAt(f++)),(m>=w||m>J((v-r)/h))&&e("overflow"),r+=m*h,n=t>=k?x:k>=t+y?y:k-t,!(n>m);k+=w)o=w-n,h>J(v/o)&&e("overflow"),h*=o;b=p.length+1,t=l(r-g,b,0==g),J(r/b)>v-s&&e("overflow"),s+=J(r/b),r%=b,p.splice(r++,0,s)}return i(p)}function n(a){var b,c,d,f,g,i,j,m,n,o,p,q,r,s,t,u=[];for(a=h(a),q=a.length,b=C,c=0,g=B,i=0;q>i;++i)p=a[i],128>p&&u.push(K(p));for(d=f=u.length,f&&u.push(D);q>d;){for(j=v,i=0;q>i;++i)p=a[i],p>=b&&j>p&&(j=p);for(r=d+1,j-b>J((v-c)/r)&&e("overflow"),c+=(j-b)*r,b=j,i=0;q>i;++i)if(p=a[i],b>p&&++c>v&&e("overflow"),p==b){for(m=c,n=w;o=g>=n?x:n>=g+y?y:n-g,!(o>m);n+=w)t=m-o,s=w-o,u.push(K(k(o+t%s,0))),m=J(t/s);u.push(K(k(m,0))),g=l(c,r,d==f),c=0,++d}++c,++b}return u.join("")}function o(a){return g(a,function(a){return E.test(a)?m(a.slice(4).toLowerCase()):a})}function p(a){return g(a,function(a){return F.test(a)?"xn--"+n(a):a})}var q="object"==typeof c&&c&&!c.nodeType&&c,r="object"==typeof b&&b&&!b.nodeType&&b,s="object"==typeof a&&a;(s.global===s||s.window===s||s.self===s)&&(d=s);var t,u,v=2147483647,w=36,x=1,y=26,z=38,A=700,B=72,C=128,D="-",E=/^xn--/,F=/[^\x20-\x7E]/,G=/[\x2E\u3002\uFF0E\uFF61]/g,H={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},I=w-x,J=Math.floor,K=String.fromCharCode;if(t={version:"1.4.1",ucs2:{decode:h,encode:i},decode:m,encode:n,toASCII:p,toUnicode:o},"function"==typeof define&&"object"==typeof define.amd&&define.amd)define("punycode",function(){return t});else if(q&&r)if(b.exports==q)r.exports=t;else for(u in t)t.hasOwnProperty(u)&&(q[u]=t[u]);else d.punycode=t}(this)}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],223:[function(a,b,c){(function(a){!function(a){"use strict";if("function"==typeof bootstrap)bootstrap("promise",a);else if("object"==typeof c&&"object"==typeof b)b.exports=a();else if("function"==typeof define&&define.amd)define(a);else if("undefined"!=typeof ses){if(!ses.ok())return;ses.makeQ=a}else{if("undefined"==typeof window&&"undefined"==typeof self)throw new Error("This environment was not anticipated by Q. Please file a bug.");var d="undefined"!=typeof window?window:self,e=d.Q;d.Q=a(),d.Q.noConflict=function(){return d.Q=e,this}}}(function(){"use strict";function b(a){return function(){return X.apply(a,arguments)}}function c(a){return a===Object(a)}function d(a){return"[object StopIteration]"===ea(a)||a instanceof T}function e(a,b){if(Q&&b.stack&&"object"==typeof a&&null!==a&&a.stack){for(var c=[],d=b;d;d=d.source)d.stack&&(!a.__minimumStackCounter__||a.__minimumStackCounter__>d.stackCounter)&&(ba(a,"__minimumStackCounter__",{value:d.stackCounter,configurable:!0}),c.unshift(d.stack));c.unshift(a.stack);var e=c.join("\n"+fa+"\n"),g=f(e);ba(a,"stack",{value:g,configurable:!0})}}function f(a){for(var b=a.split("\n"),c=[],d=0;d<b.length;++d){var e=b[d];i(e)||g(e)||!e||c.push(e)}return c.join("\n")}function g(a){return-1!==a.indexOf("(module.js:")||-1!==a.indexOf("(node.js:")}function h(a){var b=/at .+ \((.+):(\d+):(?:\d+)\)$/.exec(a);if(b)return[b[1],Number(b[2])];var c=/at ([^ ]+):(\d+):(?:\d+)$/.exec(a);if(c)return[c[1],Number(c[2])];var d=/.*@(.+):(\d+)$/.exec(a);return d?[d[1],Number(d[2])]:void 0}function i(a){var b=h(a);if(!b)return!1;var c=b[0],d=b[1];return c===S&&d>=U&&la>=d}function j(){if(Q)try{throw new Error}catch(a){var b=a.stack.split("\n"),c=b[0].indexOf("@")>0?b[1]:b[2],d=h(c);if(!d)return;return S=d[0],d[1]}}function k(a,b,c){return function(){return"undefined"!=typeof console&&"function"==typeof console.warn&&console.warn(b+" is deprecated, use "+c+" instead.",new Error("").stack),a.apply(a,arguments)}}function l(a){return a instanceof p?a:t(a)?C(a):B(a)}function m(){function a(a){b=a,l.longStackSupport&&Q&&(f.source=a),Z(c,function(b,c){l.nextTick(function(){a.promiseDispatch.apply(a,c)})},void 0),c=void 0,d=void 0}var b,c=[],d=[],e=aa(m.prototype),f=aa(p.prototype);if(f.promiseDispatch=function(a,e,f){var g=Y(arguments);c?(c.push(g),"when"===e&&f[1]&&d.push(f[1])):l.nextTick(function(){b.promiseDispatch.apply(b,g)})},f.valueOf=function(){if(c)return f;var a=r(b);return s(a)&&(b=a),a},f.inspect=function(){return b?b.inspect():{state:"pending"}},l.longStackSupport&&Q)try{throw new Error}catch(g){f.stack=g.stack.substring(g.stack.indexOf("\n")+1),f.stackCounter=ga++}return e.promise=f,e.resolve=function(c){b||a(l(c))},e.fulfill=function(c){b||a(B(c))},e.reject=function(c){b||a(A(c))},e.notify=function(a){b||Z(d,function(b,c){l.nextTick(function(){c(a)})},void 0)},e}function n(a){if("function"!=typeof a)throw new TypeError("resolver must be a function.");var b=m();try{a(b.resolve,b.reject,b.notify)}catch(c){b.reject(c)}return b.promise}function o(a){return n(function(b,c){for(var d=0,e=a.length;e>d;d++)l(a[d]).then(b,c)})}function p(a,b,c){void 0===b&&(b=function(a){return A(new Error("Promise does not support operation: "+a))}),void 0===c&&(c=function(){return{state:"unknown"}});var d=aa(p.prototype);if(d.promiseDispatch=function(c,e,f){var g;try{g=a[e]?a[e].apply(d,f):b.call(d,e,f)}catch(h){g=A(h)}c&&c(g)},d.inspect=c,c){var e=c();"rejected"===e.state&&(d.exception=e.reason),d.valueOf=function(){var a=c();return"pending"===a.state||"rejected"===a.state?d:a.value}}return d}function q(a,b,c,d){return l(a).then(b,c,d)}function r(a){if(s(a)){var b=a.inspect();if("fulfilled"===b.state)return b.value}return a}function s(a){return a instanceof p}function t(a){return c(a)&&"function"==typeof a.then}function u(a){return s(a)&&"pending"===a.inspect().state}function v(a){return!s(a)||"fulfilled"===a.inspect().state}function w(a){return s(a)&&"rejected"===a.inspect().state}function x(){ha.length=0,ia.length=0,ka||(ka=!0)}function y(b,c){ka&&("object"==typeof a&&"function"==typeof a.emit&&l.nextTick.runAfter(function(){-1!==$(ia,b)&&(a.emit("unhandledRejection",c,b),ja.push(b))}),ia.push(b),c&&"undefined"!=typeof c.stack?ha.push(c.stack):ha.push("(no stack) "+c))}function z(b){if(ka){var c=$(ia,b);-1!==c&&("object"==typeof a&&"function"==typeof a.emit&&l.nextTick.runAfter(function(){var d=$(ja,b);-1!==d&&(a.emit("rejectionHandled",ha[c],b),ja.splice(d,1))}),ia.splice(c,1),ha.splice(c,1))}}function A(a){var b=p({when:function(b){return b&&z(this),b?b(a):this}},function(){return this},function(){return{state:"rejected",reason:a}});return y(b,a),b}function B(a){return p({when:function(){return a},get:function(b){return a[b]},set:function(b,c){a[b]=c},"delete":function(b){delete a[b]},post:function(b,c){return null===b||void 0===b?a.apply(void 0,c):a[b].apply(a,c)},apply:function(b,c){return a.apply(b,c)},keys:function(){return da(a)}},void 0,function(){return{state:"fulfilled",value:a}})}function C(a){var b=m();return l.nextTick(function(){try{a.then(b.resolve,b.reject,b.notify)}catch(c){b.reject(c)}}),b.promise}function D(a){return p({isDef:function(){}},function(b,c){return J(a,b,c)},function(){return l(a).inspect()})}function E(a,b,c){return l(a).spread(b,c)}function F(a){return function(){function b(a,b){var g;if("undefined"==typeof StopIteration){try{g=c[a](b)}catch(h){return A(h)}return g.done?l(g.value):q(g.value,e,f)}try{g=c[a](b)}catch(h){return d(h)?l(h.value):A(h)}return q(g,e,f)}var c=a.apply(this,arguments),e=b.bind(b,"next"),f=b.bind(b,"throw");return e()}}function G(a){l.done(l.async(a)())}function H(a){throw new T(a)}function I(a){return function(){return E([this,K(arguments)],function(b,c){return a.apply(b,c)})}}function J(a,b,c){return l(a).dispatch(b,c)}function K(a){return q(a,function(a){var b=0,c=m();return Z(a,function(d,e,f){var g;s(e)&&"fulfilled"===(g=e.inspect()).state?a[f]=g.value:(++b,q(e,function(d){a[f]=d,0===--b&&c.resolve(a)},c.reject,function(a){c.notify({index:f,value:a})}))},void 0),0===b&&c.resolve(a),c.promise})}function L(a){if(0===a.length)return l.resolve();var b=l.defer(),c=0;return Z(a,function(d,e,f){function g(a){b.resolve(a)}function h(a){c--,0===c&&(a.message="Q can't get fulfillment value from any promise, all promises were rejected. Last error message: "+a.message,b.reject(a))}function i(a){b.notify({index:f,value:a})}var j=a[f];c++,q(j,g,h,i)},void 0),b.promise}function M(a){return q(a,function(a){return a=_(a,l),q(K(_(a,function(a){return q(a,V,V)})),function(){return a})})}function N(a){return l(a).allSettled()}function O(a,b){return l(a).then(void 0,void 0,b)}function P(a,b){return l(a).nodeify(b)}var Q=!1;try{throw new Error}catch(R){Q=!!R.stack}var S,T,U=j(),V=function(){},W=function(){function b(){for(var a,b;d.next;)d=d.next,a=d.task,d.task=void 0,b=d.domain,b&&(d.domain=void 0,b.enter()),c(a,b);for(;i.length;)a=i.pop(),c(a);f=!1}function c(a,c){try{a()}catch(d){if(h)throw c&&c.exit(),setTimeout(b,0),c&&c.enter(),d;setTimeout(function(){throw d},0)}c&&c.exit()}var d={task:void 0,next:null},e=d,f=!1,g=void 0,h=!1,i=[];if(W=function(b){e=e.next={task:b,domain:h&&a.domain,next:null},f||(f=!0,g())},"object"==typeof a&&"[object process]"===a.toString()&&a.nextTick)h=!0,g=function(){a.nextTick(b)};else if("function"==typeof setImmediate)g="undefined"!=typeof window?setImmediate.bind(window,b):function(){setImmediate(b)};else if("undefined"!=typeof MessageChannel){var j=new MessageChannel;j.port1.onmessage=function(){g=k,j.port1.onmessage=b,b()};var k=function(){j.port2.postMessage(0)};g=function(){setTimeout(b,0),k()}}else g=function(){setTimeout(b,0)};return W.runAfter=function(a){i.push(a),f||(f=!0,g())},W}(),X=Function.call,Y=b(Array.prototype.slice),Z=b(Array.prototype.reduce||function(a,b){var c=0,d=this.length;if(1===arguments.length)for(;;){if(c in this){b=this[c++];break}if(++c>=d)throw new TypeError}for(;d>c;c++)c in this&&(b=a(b,this[c],c));return b}),$=b(Array.prototype.indexOf||function(a){for(var b=0;b<this.length;b++)if(this[b]===a)return b;return-1}),_=b(Array.prototype.map||function(a,b){var c=this,d=[];return Z(c,function(e,f,g){d.push(a.call(b,f,g,c))},void 0),d}),aa=Object.create||function(a){function b(){}return b.prototype=a,new b},ba=Object.defineProperty||function(a,b,c){return a[b]=c.value,a},ca=b(Object.prototype.hasOwnProperty),da=Object.keys||function(a){var b=[];for(var c in a)ca(a,c)&&b.push(c);return b},ea=b(Object.prototype.toString);T="undefined"!=typeof ReturnValue?ReturnValue:function(a){this.value=a};var fa="From previous event:";l.resolve=l,l.nextTick=W,l.longStackSupport=!1;var ga=1;"object"==typeof a&&a&&a.env&&a.env.Q_DEBUG&&(l.longStackSupport=!0),l.defer=m,m.prototype.makeNodeResolver=function(){var a=this;return function(b,c){b?a.reject(b):arguments.length>2?a.resolve(Y(arguments,1)):a.resolve(c)}},l.Promise=n,l.promise=n,n.race=o,n.all=K,n.reject=A,n.resolve=l,l.passByCopy=function(a){return a},p.prototype.passByCopy=function(){return this},l.join=function(a,b){return l(a).join(b)},p.prototype.join=function(a){return l([this,a]).spread(function(a,b){if(a===b)return a;throw new Error("Q can't join: not the same: "+a+" "+b)})},l.race=o,p.prototype.race=function(){return this.then(l.race)},l.makePromise=p,p.prototype.toString=function(){return"[object Promise]"},p.prototype.then=function(a,b,c){function d(b){try{return"function"==typeof a?a(b):b}catch(c){return A(c)}}function f(a){if("function"==typeof b){e(a,h);try{return b(a)}catch(c){return A(c)}}return A(a)}function g(a){return"function"==typeof c?c(a):a}var h=this,i=m(),j=!1;return l.nextTick(function(){h.promiseDispatch(function(a){j||(j=!0,i.resolve(d(a)))},"when",[function(a){j||(j=!0,i.resolve(f(a)))}])}),h.promiseDispatch(void 0,"when",[void 0,function(a){var b,c=!1;try{b=g(a)}catch(d){if(c=!0,!l.onerror)throw d;l.onerror(d)}c||i.notify(b)}]),i.promise},l.tap=function(a,b){return l(a).tap(b)},p.prototype.tap=function(a){return a=l(a),this.then(function(b){return a.fcall(b).thenResolve(b)})},l.when=q,p.prototype.thenResolve=function(a){return this.then(function(){return a})},l.thenResolve=function(a,b){return l(a).thenResolve(b)},p.prototype.thenReject=function(a){return this.then(function(){throw a})},l.thenReject=function(a,b){return l(a).thenReject(b)},l.nearer=r,l.isPromise=s,l.isPromiseAlike=t,l.isPending=u,p.prototype.isPending=function(){return"pending"===this.inspect().state},l.isFulfilled=v,p.prototype.isFulfilled=function(){return"fulfilled"===this.inspect().state},l.isRejected=w,p.prototype.isRejected=function(){return"rejected"===this.inspect().state};var ha=[],ia=[],ja=[],ka=!0;l.resetUnhandledRejections=x,l.getUnhandledReasons=function(){return ha.slice()},l.stopUnhandledRejectionTracking=function(){x(),ka=!1},x(),l.reject=A,l.fulfill=B,l.master=D,l.spread=E,p.prototype.spread=function(a,b){return this.all().then(function(b){return a.apply(void 0,b)},b)},l.async=F,l.spawn=G,l["return"]=H,l.promised=I,l.dispatch=J,p.prototype.dispatch=function(a,b){var c=this,d=m();return l.nextTick(function(){c.promiseDispatch(d.resolve,a,b)}),d.promise},l.get=function(a,b){return l(a).dispatch("get",[b])},p.prototype.get=function(a){return this.dispatch("get",[a])},l.set=function(a,b,c){return l(a).dispatch("set",[b,c])},p.prototype.set=function(a,b){return this.dispatch("set",[a,b])},l.del=l["delete"]=function(a,b){return l(a).dispatch("delete",[b])},p.prototype.del=p.prototype["delete"]=function(a){return this.dispatch("delete",[a])},l.mapply=l.post=function(a,b,c){return l(a).dispatch("post",[b,c])},p.prototype.mapply=p.prototype.post=function(a,b){return this.dispatch("post",[a,b])},l.send=l.mcall=l.invoke=function(a,b){return l(a).dispatch("post",[b,Y(arguments,2)])},p.prototype.send=p.prototype.mcall=p.prototype.invoke=function(a){return this.dispatch("post",[a,Y(arguments,1)])},l.fapply=function(a,b){return l(a).dispatch("apply",[void 0,b])},p.prototype.fapply=function(a){return this.dispatch("apply",[void 0,a])},l["try"]=l.fcall=function(a){return l(a).dispatch("apply",[void 0,Y(arguments,1)])},p.prototype.fcall=function(){return this.dispatch("apply",[void 0,Y(arguments)])},l.fbind=function(a){var b=l(a),c=Y(arguments,1);return function(){return b.dispatch("apply",[this,c.concat(Y(arguments))])}},p.prototype.fbind=function(){var a=this,b=Y(arguments);return function(){return a.dispatch("apply",[this,b.concat(Y(arguments))])}},l.keys=function(a){return l(a).dispatch("keys",[])},p.prototype.keys=function(){return this.dispatch("keys",[])},l.all=K,p.prototype.all=function(){return K(this)},l.any=L,p.prototype.any=function(){return L(this)},l.allResolved=k(M,"allResolved","allSettled"),p.prototype.allResolved=function(){return M(this)},l.allSettled=N,p.prototype.allSettled=function(){return this.then(function(a){return K(_(a,function(a){function b(){return a.inspect()}return a=l(a),a.then(b,b)}))})},l.fail=l["catch"]=function(a,b){return l(a).then(void 0,b)},p.prototype.fail=p.prototype["catch"]=function(a){return this.then(void 0,a)},l.progress=O,p.prototype.progress=function(a){return this.then(void 0,void 0,a)},l.fin=l["finally"]=function(a,b){return l(a)["finally"](b)},p.prototype.fin=p.prototype["finally"]=function(a){if(!a||"function"!=typeof a.apply)throw new Error("Q can't apply finally callback");return a=l(a),this.then(function(b){return a.fcall().then(function(){return b})},function(b){return a.fcall().then(function(){throw b})})},l.done=function(a,b,c,d){return l(a).done(b,c,d)},p.prototype.done=function(b,c,d){var f=function(a){l.nextTick(function(){if(e(a,g),!l.onerror)throw a;l.onerror(a)})},g=b||c||d?this.then(b,c,d):this;"object"==typeof a&&a&&a.domain&&(f=a.domain.bind(f)),g.then(void 0,f)},l.timeout=function(a,b,c){return l(a).timeout(b,c)},p.prototype.timeout=function(a,b){var c=m(),d=setTimeout(function(){b&&"string"!=typeof b||(b=new Error(b||"Timed out after "+a+" ms"),b.code="ETIMEDOUT"),c.reject(b)},a);return this.then(function(a){clearTimeout(d),c.resolve(a)},function(a){clearTimeout(d),c.reject(a)},c.notify),c.promise},l.delay=function(a,b){return void 0===b&&(b=a,a=void 0),l(a).delay(b)},p.prototype.delay=function(a){return this.then(function(b){var c=m();return setTimeout(function(){c.resolve(b)},a),c.promise})},l.nfapply=function(a,b){return l(a).nfapply(b)},p.prototype.nfapply=function(a){var b=m(),c=Y(a);return c.push(b.makeNodeResolver()),this.fapply(c).fail(b.reject),b.promise},l.nfcall=function(a){var b=Y(arguments,1);return l(a).nfapply(b)},p.prototype.nfcall=function(){var a=Y(arguments),b=m();return a.push(b.makeNodeResolver()),this.fapply(a).fail(b.reject),b.promise},l.nfbind=l.denodeify=function(a){if(void 0===a)throw new Error("Q can't wrap an undefined function");var b=Y(arguments,1);return function(){var c=b.concat(Y(arguments)),d=m();return c.push(d.makeNodeResolver()),l(a).fapply(c).fail(d.reject),d.promise}},p.prototype.nfbind=p.prototype.denodeify=function(){var a=Y(arguments);return a.unshift(this),l.denodeify.apply(void 0,a)},l.nbind=function(a,b){var c=Y(arguments,2);return function(){function d(){return a.apply(b,arguments)}var e=c.concat(Y(arguments)),f=m();return e.push(f.makeNodeResolver()),l(d).fapply(e).fail(f.reject),f.promise}},p.prototype.nbind=function(){var a=Y(arguments,0);return a.unshift(this),l.nbind.apply(void 0,a)},l.nmapply=l.npost=function(a,b,c){return l(a).npost(b,c)},p.prototype.nmapply=p.prototype.npost=function(a,b){var c=Y(b||[]),d=m();return c.push(d.makeNodeResolver()),this.dispatch("post",[a,c]).fail(d.reject),d.promise},l.nsend=l.nmcall=l.ninvoke=function(a,b){var c=Y(arguments,2),d=m();return c.push(d.makeNodeResolver()),l(a).dispatch("post",[b,c]).fail(d.reject),d.promise},p.prototype.nsend=p.prototype.nmcall=p.prototype.ninvoke=function(a){var b=Y(arguments,1),c=m();return b.push(c.makeNodeResolver()),this.dispatch("post",[a,b]).fail(c.reject),c.promise},l.nodeify=P,p.prototype.nodeify=function(a){return a?void this.then(function(b){l.nextTick(function(){a(null,b)})},function(b){l.nextTick(function(){a(b)})}):this},l.noConflict=function(){throw new Error("Q.noConflict only works when Q is used as a global")};var la=j();return l})}).call(this,a("_process"))},{_process:215}],224:[function(a,b,c){"use strict";function d(a,b){return Object.prototype.hasOwnProperty.call(a,b)}b.exports=function(a,b,c,f){b=b||"&",c=c||"=";var g={};if("string"!=typeof a||0===a.length)return g;var h=/\+/g;a=a.split(b);var i=1e3;f&&"number"==typeof f.maxKeys&&(i=f.maxKeys);var j=a.length;i>0&&j>i&&(j=i);for(var k=0;j>k;++k){var l,m,n,o,p=a[k].replace(h,"%20"),q=p.indexOf(c);q>=0?(l=p.substr(0,q),m=p.substr(q+1)):(l=p,m=""),n=decodeURIComponent(l),o=decodeURIComponent(m),d(g,n)?e(g[n])?g[n].push(o):g[n]=[g[n],o]:g[n]=o}return g};var e=Array.isArray||function(a){return"[object Array]"===Object.prototype.toString.call(a)}},{}],225:[function(a,b,c){"use strict";function d(a,b){if(a.map)return a.map(b);for(var c=[],d=0;d<a.length;d++)c.push(b(a[d],d));return c}var e=function(a){switch(typeof a){case"string":return a;case"boolean":return a?"true":"false";case"number":return isFinite(a)?a:"";default:return""}};b.exports=function(a,b,c,h){return b=b||"&",c=c||"=",null===a&&(a=void 0),"object"==typeof a?d(g(a),function(g){var h=encodeURIComponent(e(g))+c;return f(a[g])?d(a[g],function(a){return h+encodeURIComponent(e(a))}).join(b):h+encodeURIComponent(e(a[g]))}).join(b):h?encodeURIComponent(e(h))+c+encodeURIComponent(e(a)):""};var f=Array.isArray||function(a){return"[object Array]"===Object.prototype.toString.call(a)},g=Object.keys||function(a){var b=[];for(var c in a)Object.prototype.hasOwnProperty.call(a,c)&&b.push(c);return b}},{}],226:[function(a,b,c){"use strict";c.decode=c.parse=a("./decode"),c.encode=c.stringify=a("./encode")},{"./decode":224,"./encode":225}],227:[function(a,b,c){(function(c,d){"use strict";function e(){throw new Error("secure random number generation not supported by this browser\nuse chrome, FireFox or Internet Explorer 11")}function f(a,b){if(a>65536)throw new Error("requested too many random bytes");var e=new d.Uint8Array(a);a>0&&h.getRandomValues(e);var f=g.from(e.buffer);return"function"==typeof b?c.nextTick(function(){b(null,f)}):f}var g=a("safe-buffer").Buffer,h=d.crypto||d.msCrypto;h&&h.getRandomValues?b.exports=f:b.exports=e}).call(this,a("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{_process:215,"safe-buffer":245}],228:[function(a,b,c){b.exports=a("./lib/_stream_duplex.js")},{"./lib/_stream_duplex.js":229}],229:[function(a,b,c){"use strict";function d(a){return this instanceof d?(j.call(this,a),k.call(this,a),a&&a.readable===!1&&(this.readable=!1),a&&a.writable===!1&&(this.writable=!1),this.allowHalfOpen=!0,a&&a.allowHalfOpen===!1&&(this.allowHalfOpen=!1),void this.once("end",e)):new d(a)}function e(){this.allowHalfOpen||this._writableState.ended||g(f,this)}function f(a){a.end()}var g=a("process-nextick-args"),h=Object.keys||function(a){var b=[];for(var c in a)b.push(c);return b};b.exports=d;var i=a("core-util-is");i.inherits=a("inherits");var j=a("./_stream_readable"),k=a("./_stream_writable");i.inherits(d,j);for(var l=h(k.prototype),m=0;m<l.length;m++){var n=l[m];d.prototype[n]||(d.prototype[n]=k.prototype[n])}Object.defineProperty(d.prototype,"destroyed",{get:function(){return void 0===this._readableState||void 0===this._writableState?!1:this._readableState.destroyed&&this._writableState.destroyed},set:function(a){void 0!==this._readableState&&void 0!==this._writableState&&(this._readableState.destroyed=a,this._writableState.destroyed=a)}}),d.prototype._destroy=function(a,b){this.push(null),this.end(),g(b,a)}},{"./_stream_readable":231,"./_stream_writable":233,"core-util-is":134,inherits:196,"process-nextick-args":214}],230:[function(a,b,c){"use strict";function d(a){return this instanceof d?void e.call(this,a):new d(a)}b.exports=d;var e=a("./_stream_transform"),f=a("core-util-is");f.inherits=a("inherits"),f.inherits(d,e),d.prototype._transform=function(a,b,c){c(null,a)}},{"./_stream_transform":232,"core-util-is":134,inherits:196}],231:[function(a,b,c){(function(c,d){"use strict";function e(a){return L.from(a)}function f(a){return L.isBuffer(a)||a instanceof M}function g(a,b,c){return"function"==typeof a.prependListener?a.prependListener(b,c):void(a._events&&a._events[b]?I(a._events[b])?a._events[b].unshift(c):a._events[b]=[c,a._events[b]]:a.on(b,c))}function h(b,c){H=H||a("./_stream_duplex"),b=b||{},this.objectMode=!!b.objectMode,c instanceof H&&(this.objectMode=this.objectMode||!!b.readableObjectMode);var d=b.highWaterMark,e=this.objectMode?16:16384;this.highWaterMark=d||0===d?d:e,this.highWaterMark=Math.floor(this.highWaterMark),this.buffer=new R,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.destroyed=!1,this.defaultEncoding=b.defaultEncoding||"utf8",this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,b.encoding&&(Q||(Q=a("string_decoder/").StringDecoder),this.decoder=new Q(b.encoding),this.encoding=b.encoding)}function i(b){return H=H||a("./_stream_duplex"),this instanceof i?(this._readableState=new h(b,this),this.readable=!0,b&&("function"==typeof b.read&&(this._read=b.read),"function"==typeof b.destroy&&(this._destroy=b.destroy)),void K.call(this)):new i(b)}function j(a,b,c,d,f){var g=a._readableState;if(null===b)g.reading=!1,p(a,g);else{var h;f||(h=l(g,b)),h?a.emit("error",h):g.objectMode||b&&b.length>0?("string"==typeof b||g.objectMode||Object.getPrototypeOf(b)===L.prototype||(b=e(b)),d?g.endEmitted?a.emit("error",new Error("stream.unshift() after end event")):k(a,g,b,!0):g.ended?a.emit("error",new Error("stream.push() after EOF")):(g.reading=!1,g.decoder&&!c?(b=g.decoder.write(b),g.objectMode||0!==b.length?k(a,g,b,!1):s(a,g)):k(a,g,b,!1))):d||(g.reading=!1)}return m(g)}function k(a,b,c,d){b.flowing&&0===b.length&&!b.sync?(a.emit("data",c),a.read(0)):(b.length+=b.objectMode?1:c.length,d?b.buffer.unshift(c):b.buffer.push(c),b.needReadable&&q(a)),s(a,b)}function l(a,b){var c;return f(b)||"string"==typeof b||void 0===b||a.objectMode||(c=new TypeError("Invalid non-string/buffer chunk")),c}function m(a){return!a.ended&&(a.needReadable||a.length<a.highWaterMark||0===a.length)}function n(a){return a>=U?a=U:(a--,a|=a>>>1,a|=a>>>2,a|=a>>>4,a|=a>>>8,a|=a>>>16,a++),a}function o(a,b){return 0>=a||0===b.length&&b.ended?0:b.objectMode?1:a!==a?b.flowing&&b.length?b.buffer.head.data.length:b.length:(a>b.highWaterMark&&(b.highWaterMark=n(a)),a<=b.length?a:b.ended?b.length:(b.needReadable=!0,0))}function p(a,b){if(!b.ended){if(b.decoder){var c=b.decoder.end();c&&c.length&&(b.buffer.push(c),b.length+=b.objectMode?1:c.length)}b.ended=!0,q(a)}}function q(a){var b=a._readableState;b.needReadable=!1,b.emittedReadable||(P("emitReadable",b.flowing),b.emittedReadable=!0,b.sync?G(r,a):r(a))}function r(a){P("emit readable"),a.emit("readable"),y(a)}function s(a,b){b.readingMore||(b.readingMore=!0,G(t,a,b))}function t(a,b){for(var c=b.length;!b.reading&&!b.flowing&&!b.ended&&b.length<b.highWaterMark&&(P("maybeReadMore read 0"),a.read(0),c!==b.length);)c=b.length;b.readingMore=!1}function u(a){return function(){var b=a._readableState;P("pipeOnDrain",b.awaitDrain),b.awaitDrain&&b.awaitDrain--,0===b.awaitDrain&&J(a,"data")&&(b.flowing=!0,y(a))}}function v(a){P("readable nexttick read 0"),a.read(0)}function w(a,b){b.resumeScheduled||(b.resumeScheduled=!0,G(x,a,b))}function x(a,b){b.reading||(P("resume read 0"),a.read(0)),b.resumeScheduled=!1,b.awaitDrain=0,a.emit("resume"),y(a),b.flowing&&!b.reading&&a.read(0)}function y(a){var b=a._readableState;for(P("flow",b.flowing);b.flowing&&null!==a.read(););}function z(a,b){if(0===b.length)return null;var c;return b.objectMode?c=b.buffer.shift():!a||a>=b.length?(c=b.decoder?b.buffer.join(""):1===b.buffer.length?b.buffer.head.data:b.buffer.concat(b.length),b.buffer.clear()):c=A(a,b.buffer,b.decoder),c}function A(a,b,c){var d;return a<b.head.data.length?(d=b.head.data.slice(0,a),b.head.data=b.head.data.slice(a)):d=a===b.head.data.length?b.shift():c?B(a,b):C(a,b),d}function B(a,b){var c=b.head,d=1,e=c.data;for(a-=e.length;c=c.next;){var f=c.data,g=a>f.length?f.length:a;if(e+=g===f.length?f:f.slice(0,a),a-=g,0===a){g===f.length?(++d,c.next?b.head=c.next:b.head=b.tail=null):(b.head=c,c.data=f.slice(g));break}++d}return b.length-=d,e}function C(a,b){var c=L.allocUnsafe(a),d=b.head,e=1;for(d.data.copy(c),a-=d.data.length;d=d.next;){var f=d.data,g=a>f.length?f.length:a;if(f.copy(c,c.length-a,0,g),a-=g,0===a){g===f.length?(++e,d.next?b.head=d.next:b.head=b.tail=null):(b.head=d,d.data=f.slice(g));break}++e}return b.length-=e,c}function D(a){var b=a._readableState;if(b.length>0)throw new Error('"endReadable()" called on non-empty stream');b.endEmitted||(b.ended=!0,G(E,b,a))}function E(a,b){a.endEmitted||0!==a.length||(a.endEmitted=!0,b.readable=!1,b.emit("end"))}function F(a,b){for(var c=0,d=a.length;d>c;c++)if(a[c]===b)return c;return-1}var G=a("process-nextick-args");
b.exports=i;var H,I=a("isarray");i.ReadableState=h;var J=(a("events").EventEmitter,function(a,b){return a.listeners(b).length}),K=a("./internal/streams/stream"),L=a("safe-buffer").Buffer,M=d.Uint8Array||function(){},N=a("core-util-is");N.inherits=a("inherits");var O=a("util"),P=void 0;P=O&&O.debuglog?O.debuglog("stream"):function(){};var Q,R=a("./internal/streams/BufferList"),S=a("./internal/streams/destroy");N.inherits(i,K);var T=["error","close","destroy","pause","resume"];Object.defineProperty(i.prototype,"destroyed",{get:function(){return void 0===this._readableState?!1:this._readableState.destroyed},set:function(a){this._readableState&&(this._readableState.destroyed=a)}}),i.prototype.destroy=S.destroy,i.prototype._undestroy=S.undestroy,i.prototype._destroy=function(a,b){this.push(null),b(a)},i.prototype.push=function(a,b){var c,d=this._readableState;return d.objectMode?c=!0:"string"==typeof a&&(b=b||d.defaultEncoding,b!==d.encoding&&(a=L.from(a,b),b=""),c=!0),j(this,a,b,!1,c)},i.prototype.unshift=function(a){return j(this,a,null,!0,!1)},i.prototype.isPaused=function(){return this._readableState.flowing===!1},i.prototype.setEncoding=function(b){return Q||(Q=a("string_decoder/").StringDecoder),this._readableState.decoder=new Q(b),this._readableState.encoding=b,this};var U=8388608;i.prototype.read=function(a){P("read",a),a=parseInt(a,10);var b=this._readableState,c=a;if(0!==a&&(b.emittedReadable=!1),0===a&&b.needReadable&&(b.length>=b.highWaterMark||b.ended))return P("read: emitReadable",b.length,b.ended),0===b.length&&b.ended?D(this):q(this),null;if(a=o(a,b),0===a&&b.ended)return 0===b.length&&D(this),null;var d=b.needReadable;P("need readable",d),(0===b.length||b.length-a<b.highWaterMark)&&(d=!0,P("length less than watermark",d)),b.ended||b.reading?(d=!1,P("reading or ended",d)):d&&(P("do read"),b.reading=!0,b.sync=!0,0===b.length&&(b.needReadable=!0),this._read(b.highWaterMark),b.sync=!1,b.reading||(a=o(c,b)));var e;return e=a>0?z(a,b):null,null===e?(b.needReadable=!0,a=0):b.length-=a,0===b.length&&(b.ended||(b.needReadable=!0),c!==a&&b.ended&&D(this)),null!==e&&this.emit("data",e),e},i.prototype._read=function(a){this.emit("error",new Error("_read() is not implemented"))},i.prototype.pipe=function(a,b){function d(a,b){P("onunpipe"),a===m&&b&&b.hasUnpiped===!1&&(b.hasUnpiped=!0,f())}function e(){P("onend"),a.end()}function f(){P("cleanup"),a.removeListener("close",j),a.removeListener("finish",k),a.removeListener("drain",q),a.removeListener("error",i),a.removeListener("unpipe",d),m.removeListener("end",e),m.removeListener("end",l),m.removeListener("data",h),r=!0,!n.awaitDrain||a._writableState&&!a._writableState.needDrain||q()}function h(b){P("ondata"),s=!1;var c=a.write(b);!1!==c||s||((1===n.pipesCount&&n.pipes===a||n.pipesCount>1&&-1!==F(n.pipes,a))&&!r&&(P("false write response, pause",m._readableState.awaitDrain),m._readableState.awaitDrain++,s=!0),m.pause())}function i(b){P("onerror",b),l(),a.removeListener("error",i),0===J(a,"error")&&a.emit("error",b)}function j(){a.removeListener("finish",k),l()}function k(){P("onfinish"),a.removeListener("close",j),l()}function l(){P("unpipe"),m.unpipe(a)}var m=this,n=this._readableState;switch(n.pipesCount){case 0:n.pipes=a;break;case 1:n.pipes=[n.pipes,a];break;default:n.pipes.push(a)}n.pipesCount+=1,P("pipe count=%d opts=%j",n.pipesCount,b);var o=(!b||b.end!==!1)&&a!==c.stdout&&a!==c.stderr,p=o?e:l;n.endEmitted?G(p):m.once("end",p),a.on("unpipe",d);var q=u(m);a.on("drain",q);var r=!1,s=!1;return m.on("data",h),g(a,"error",i),a.once("close",j),a.once("finish",k),a.emit("pipe",m),n.flowing||(P("pipe resume"),m.resume()),a},i.prototype.unpipe=function(a){var b=this._readableState,c={hasUnpiped:!1};if(0===b.pipesCount)return this;if(1===b.pipesCount)return a&&a!==b.pipes?this:(a||(a=b.pipes),b.pipes=null,b.pipesCount=0,b.flowing=!1,a&&a.emit("unpipe",this,c),this);if(!a){var d=b.pipes,e=b.pipesCount;b.pipes=null,b.pipesCount=0,b.flowing=!1;for(var f=0;e>f;f++)d[f].emit("unpipe",this,c);return this}var g=F(b.pipes,a);return-1===g?this:(b.pipes.splice(g,1),b.pipesCount-=1,1===b.pipesCount&&(b.pipes=b.pipes[0]),a.emit("unpipe",this,c),this)},i.prototype.on=function(a,b){var c=K.prototype.on.call(this,a,b);if("data"===a)this._readableState.flowing!==!1&&this.resume();else if("readable"===a){var d=this._readableState;d.endEmitted||d.readableListening||(d.readableListening=d.needReadable=!0,d.emittedReadable=!1,d.reading?d.length&&q(this):G(v,this))}return c},i.prototype.addListener=i.prototype.on,i.prototype.resume=function(){var a=this._readableState;return a.flowing||(P("resume"),a.flowing=!0,w(this,a)),this},i.prototype.pause=function(){return P("call pause flowing=%j",this._readableState.flowing),!1!==this._readableState.flowing&&(P("pause"),this._readableState.flowing=!1,this.emit("pause")),this},i.prototype.wrap=function(a){var b=this._readableState,c=!1,d=this;a.on("end",function(){if(P("wrapped end"),b.decoder&&!b.ended){var a=b.decoder.end();a&&a.length&&d.push(a)}d.push(null)}),a.on("data",function(e){if(P("wrapped data"),b.decoder&&(e=b.decoder.write(e)),(!b.objectMode||null!==e&&void 0!==e)&&(b.objectMode||e&&e.length)){var f=d.push(e);f||(c=!0,a.pause())}});for(var e in a)void 0===this[e]&&"function"==typeof a[e]&&(this[e]=function(b){return function(){return a[b].apply(a,arguments)}}(e));for(var f=0;f<T.length;f++)a.on(T[f],d.emit.bind(d,T[f]));return d._read=function(b){P("wrapped _read",b),c&&(c=!1,a.resume())},d},i._fromList=z}).call(this,a("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./_stream_duplex":229,"./internal/streams/BufferList":234,"./internal/streams/destroy":235,"./internal/streams/stream":236,_process:215,"core-util-is":134,events:173,inherits:196,isarray:237,"process-nextick-args":214,"safe-buffer":245,"string_decoder/":238,util:101}],232:[function(a,b,c){"use strict";function d(a){this.afterTransform=function(b,c){return e(a,b,c)},this.needTransform=!1,this.transforming=!1,this.writecb=null,this.writechunk=null,this.writeencoding=null}function e(a,b,c){var d=a._transformState;d.transforming=!1;var e=d.writecb;if(!e)return a.emit("error",new Error("write callback called multiple times"));d.writechunk=null,d.writecb=null,null!==c&&void 0!==c&&a.push(c),e(b);var f=a._readableState;f.reading=!1,(f.needReadable||f.length<f.highWaterMark)&&a._read(f.highWaterMark)}function f(a){if(!(this instanceof f))return new f(a);h.call(this,a),this._transformState=new d(this);var b=this;this._readableState.needReadable=!0,this._readableState.sync=!1,a&&("function"==typeof a.transform&&(this._transform=a.transform),"function"==typeof a.flush&&(this._flush=a.flush)),this.once("prefinish",function(){"function"==typeof this._flush?this._flush(function(a,c){g(b,a,c)}):g(b)})}function g(a,b,c){if(b)return a.emit("error",b);null!==c&&void 0!==c&&a.push(c);var d=a._writableState,e=a._transformState;if(d.length)throw new Error("Calling transform done when ws.length != 0");if(e.transforming)throw new Error("Calling transform done when still transforming");return a.push(null)}b.exports=f;var h=a("./_stream_duplex"),i=a("core-util-is");i.inherits=a("inherits"),i.inherits(f,h),f.prototype.push=function(a,b){return this._transformState.needTransform=!1,h.prototype.push.call(this,a,b)},f.prototype._transform=function(a,b,c){throw new Error("_transform() is not implemented")},f.prototype._write=function(a,b,c){var d=this._transformState;if(d.writecb=c,d.writechunk=a,d.writeencoding=b,!d.transforming){var e=this._readableState;(d.needTransform||e.needReadable||e.length<e.highWaterMark)&&this._read(e.highWaterMark)}},f.prototype._read=function(a){var b=this._transformState;null!==b.writechunk&&b.writecb&&!b.transforming?(b.transforming=!0,this._transform(b.writechunk,b.writeencoding,b.afterTransform)):b.needTransform=!0},f.prototype._destroy=function(a,b){var c=this;h.prototype._destroy.call(this,a,function(a){b(a),c.emit("close")})}},{"./_stream_duplex":229,"core-util-is":134,inherits:196}],233:[function(a,b,c){(function(c,d){"use strict";function e(a){var b=this;this.next=null,this.entry=null,this.finish=function(){A(b,a)}}function f(a){return H.from(a)}function g(a){return H.isBuffer(a)||a instanceof I}function h(){}function i(b,c){C=C||a("./_stream_duplex"),b=b||{},this.objectMode=!!b.objectMode,c instanceof C&&(this.objectMode=this.objectMode||!!b.writableObjectMode);var d=b.highWaterMark,f=this.objectMode?16:16384;this.highWaterMark=d||0===d?d:f,this.highWaterMark=Math.floor(this.highWaterMark),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1;var g=b.decodeStrings===!1;this.decodeStrings=!g,this.defaultEncoding=b.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(a){r(c,a)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.bufferedRequestCount=0,this.corkedRequestsFree=new e(this)}function j(b){return C=C||a("./_stream_duplex"),K.call(j,this)||this instanceof C?(this._writableState=new i(b,this),this.writable=!0,b&&("function"==typeof b.write&&(this._write=b.write),"function"==typeof b.writev&&(this._writev=b.writev),"function"==typeof b.destroy&&(this._destroy=b.destroy),"function"==typeof b["final"]&&(this._final=b["final"])),void G.call(this)):new j(b)}function k(a,b){var c=new Error("write after end");a.emit("error",c),B(b,c)}function l(a,b,c,d){var e=!0,f=!1;return null===c?f=new TypeError("May not write null values to stream"):"string"==typeof c||void 0===c||b.objectMode||(f=new TypeError("Invalid non-string/buffer chunk")),f&&(a.emit("error",f),B(d,f),e=!1),e}function m(a,b,c){return a.objectMode||a.decodeStrings===!1||"string"!=typeof b||(b=H.from(b,c)),b}function n(a,b,c,d,e,f){if(!c){var g=m(b,d,e);d!==g&&(c=!0,e="buffer",d=g)}var h=b.objectMode?1:d.length;b.length+=h;var i=b.length<b.highWaterMark;if(i||(b.needDrain=!0),b.writing||b.corked){var j=b.lastBufferedRequest;b.lastBufferedRequest={chunk:d,encoding:e,isBuf:c,callback:f,next:null},j?j.next=b.lastBufferedRequest:b.bufferedRequest=b.lastBufferedRequest,b.bufferedRequestCount+=1}else o(a,b,!1,h,d,e,f);return i}function o(a,b,c,d,e,f,g){b.writelen=d,b.writecb=g,b.writing=!0,b.sync=!0,c?a._writev(e,b.onwrite):a._write(e,f,b.onwrite),b.sync=!1}function p(a,b,c,d,e){--b.pendingcb,c?(B(e,d),B(y,a,b),a._writableState.errorEmitted=!0,a.emit("error",d)):(e(d),a._writableState.errorEmitted=!0,a.emit("error",d),y(a,b))}function q(a){a.writing=!1,a.writecb=null,a.length-=a.writelen,a.writelen=0}function r(a,b){var c=a._writableState,d=c.sync,e=c.writecb;if(q(c),b)p(a,c,d,b,e);else{var f=v(c);f||c.corked||c.bufferProcessing||!c.bufferedRequest||u(a,c),d?D(s,a,c,f,e):s(a,c,f,e)}}function s(a,b,c,d){c||t(a,b),b.pendingcb--,d(),y(a,b)}function t(a,b){0===b.length&&b.needDrain&&(b.needDrain=!1,a.emit("drain"))}function u(a,b){b.bufferProcessing=!0;var c=b.bufferedRequest;if(a._writev&&c&&c.next){var d=b.bufferedRequestCount,f=new Array(d),g=b.corkedRequestsFree;g.entry=c;for(var h=0,i=!0;c;)f[h]=c,c.isBuf||(i=!1),c=c.next,h+=1;f.allBuffers=i,o(a,b,!0,b.length,f,"",g.finish),b.pendingcb++,b.lastBufferedRequest=null,g.next?(b.corkedRequestsFree=g.next,g.next=null):b.corkedRequestsFree=new e(b)}else{for(;c;){var j=c.chunk,k=c.encoding,l=c.callback,m=b.objectMode?1:j.length;if(o(a,b,!1,m,j,k,l),c=c.next,b.writing)break}null===c&&(b.lastBufferedRequest=null)}b.bufferedRequestCount=0,b.bufferedRequest=c,b.bufferProcessing=!1}function v(a){return a.ending&&0===a.length&&null===a.bufferedRequest&&!a.finished&&!a.writing}function w(a,b){a._final(function(c){b.pendingcb--,c&&a.emit("error",c),b.prefinished=!0,a.emit("prefinish"),y(a,b)})}function x(a,b){b.prefinished||b.finalCalled||("function"==typeof a._final?(b.pendingcb++,b.finalCalled=!0,B(w,a,b)):(b.prefinished=!0,a.emit("prefinish")))}function y(a,b){var c=v(b);return c&&(x(a,b),0===b.pendingcb&&(b.finished=!0,a.emit("finish"))),c}function z(a,b,c){b.ending=!0,y(a,b),c&&(b.finished?B(c):a.once("finish",c)),b.ended=!0,a.writable=!1}function A(a,b,c){var d=a.entry;for(a.entry=null;d;){var e=d.callback;b.pendingcb--,e(c),d=d.next}b.corkedRequestsFree?b.corkedRequestsFree.next=a:b.corkedRequestsFree=a}var B=a("process-nextick-args");b.exports=j;var C,D=!c.browser&&["v0.10","v0.9."].indexOf(c.version.slice(0,5))>-1?setImmediate:B;j.WritableState=i;var E=a("core-util-is");E.inherits=a("inherits");var F={deprecate:a("util-deprecate")},G=a("./internal/streams/stream"),H=a("safe-buffer").Buffer,I=d.Uint8Array||function(){},J=a("./internal/streams/destroy");E.inherits(j,G),i.prototype.getBuffer=function(){for(var a=this.bufferedRequest,b=[];a;)b.push(a),a=a.next;return b},function(){try{Object.defineProperty(i.prototype,"buffer",{get:F.deprecate(function(){return this.getBuffer()},"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.","DEP0003")})}catch(a){}}();var K;"function"==typeof Symbol&&Symbol.hasInstance&&"function"==typeof Function.prototype[Symbol.hasInstance]?(K=Function.prototype[Symbol.hasInstance],Object.defineProperty(j,Symbol.hasInstance,{value:function(a){return K.call(this,a)?!0:a&&a._writableState instanceof i}})):K=function(a){return a instanceof this},j.prototype.pipe=function(){this.emit("error",new Error("Cannot pipe, not readable"))},j.prototype.write=function(a,b,c){var d=this._writableState,e=!1,i=g(a)&&!d.objectMode;return i&&!H.isBuffer(a)&&(a=f(a)),"function"==typeof b&&(c=b,b=null),i?b="buffer":b||(b=d.defaultEncoding),"function"!=typeof c&&(c=h),d.ended?k(this,c):(i||l(this,d,a,c))&&(d.pendingcb++,e=n(this,d,i,a,b,c)),e},j.prototype.cork=function(){var a=this._writableState;a.corked++},j.prototype.uncork=function(){var a=this._writableState;a.corked&&(a.corked--,a.writing||a.corked||a.finished||a.bufferProcessing||!a.bufferedRequest||u(this,a))},j.prototype.setDefaultEncoding=function(a){if("string"==typeof a&&(a=a.toLowerCase()),!(["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((a+"").toLowerCase())>-1))throw new TypeError("Unknown encoding: "+a);return this._writableState.defaultEncoding=a,this},j.prototype._write=function(a,b,c){c(new Error("_write() is not implemented"))},j.prototype._writev=null,j.prototype.end=function(a,b,c){var d=this._writableState;"function"==typeof a?(c=a,a=null,b=null):"function"==typeof b&&(c=b,b=null),null!==a&&void 0!==a&&this.write(a,b),d.corked&&(d.corked=1,this.uncork()),d.ending||d.finished||z(this,d,c)},Object.defineProperty(j.prototype,"destroyed",{get:function(){return void 0===this._writableState?!1:this._writableState.destroyed},set:function(a){this._writableState&&(this._writableState.destroyed=a)}}),j.prototype.destroy=J.destroy,j.prototype._undestroy=J.undestroy,j.prototype._destroy=function(a,b){this.end(),b(a)}}).call(this,a("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./_stream_duplex":229,"./internal/streams/destroy":235,"./internal/streams/stream":236,_process:215,"core-util-is":134,inherits:196,"process-nextick-args":214,"safe-buffer":245,"util-deprecate":257}],234:[function(a,b,c){"use strict";function d(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function e(a,b,c){a.copy(b,c)}var f=a("safe-buffer").Buffer;b.exports=function(){function a(){d(this,a),this.head=null,this.tail=null,this.length=0}return a.prototype.push=function(a){var b={data:a,next:null};this.length>0?this.tail.next=b:this.head=b,this.tail=b,++this.length},a.prototype.unshift=function(a){var b={data:a,next:this.head};0===this.length&&(this.tail=b),this.head=b,++this.length},a.prototype.shift=function(){if(0!==this.length){var a=this.head.data;return 1===this.length?this.head=this.tail=null:this.head=this.head.next,--this.length,a}},a.prototype.clear=function(){this.head=this.tail=null,this.length=0},a.prototype.join=function(a){if(0===this.length)return"";for(var b=this.head,c=""+b.data;b=b.next;)c+=a+b.data;return c},a.prototype.concat=function(a){if(0===this.length)return f.alloc(0);if(1===this.length)return this.head.data;for(var b=f.allocUnsafe(a>>>0),c=this.head,d=0;c;)e(c.data,b,d),d+=c.data.length,c=c.next;return b},a}()},{"safe-buffer":245}],235:[function(a,b,c){"use strict";function d(a,b){var c=this,d=this._readableState&&this._readableState.destroyed,e=this._writableState&&this._writableState.destroyed;return d||e?void(b?b(a):!a||this._writableState&&this._writableState.errorEmitted||g(f,this,a)):(this._readableState&&(this._readableState.destroyed=!0),this._writableState&&(this._writableState.destroyed=!0),void this._destroy(a||null,function(a){!b&&a?(g(f,c,a),c._writableState&&(c._writableState.errorEmitted=!0)):b&&b(a)}))}function e(){this._readableState&&(this._readableState.destroyed=!1,this._readableState.reading=!1,this._readableState.ended=!1,this._readableState.endEmitted=!1),this._writableState&&(this._writableState.destroyed=!1,this._writableState.ended=!1,this._writableState.ending=!1,this._writableState.finished=!1,this._writableState.errorEmitted=!1)}function f(a,b){a.emit("error",b)}var g=a("process-nextick-args");b.exports={destroy:d,undestroy:e}},{"process-nextick-args":214}],236:[function(a,b,c){b.exports=a("events").EventEmitter},{events:173}],237:[function(a,b,c){arguments[4][131][0].apply(c,arguments)},{dup:131}],238:[function(a,b,c){"use strict";function d(a){if(!a)return"utf8";for(var b;;)switch(a){case"utf8":case"utf-8":return"utf8";case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return"utf16le";case"latin1":case"binary":return"latin1";case"base64":case"ascii":case"hex":return a;default:if(b)return;a=(""+a).toLowerCase(),b=!0}}function e(a){var b=d(a);if("string"!=typeof b&&(s.isEncoding===t||!t(a)))throw new Error("Unknown encoding: "+a);return b||a}function f(a){this.encoding=e(a);var b;switch(this.encoding){case"utf16le":this.text=m,this.end=n,b=4;break;case"utf8":this.fillLast=j,b=4;break;case"base64":this.text=o,this.end=p,b=3;break;default:return this.write=q,void(this.end=r)}this.lastNeed=0,this.lastTotal=0,this.lastChar=s.allocUnsafe(b)}function g(a){return 127>=a?0:a>>5===6?2:a>>4===14?3:a>>3===30?4:-1}function h(a,b,c){var d=b.length-1;if(c>d)return 0;var e=g(b[d]);return e>=0?(e>0&&(a.lastNeed=e-1),e):--d<c?0:(e=g(b[d]),e>=0?(e>0&&(a.lastNeed=e-2),e):--d<c?0:(e=g(b[d]),e>=0?(e>0&&(2===e?e=0:a.lastNeed=e-3),e):0))}function i(a,b,c){if(128!==(192&b[0]))return a.lastNeed=0,"".repeat(c);if(a.lastNeed>1&&b.length>1){if(128!==(192&b[1]))return a.lastNeed=1,"".repeat(c+1);if(a.lastNeed>2&&b.length>2&&128!==(192&b[2]))return a.lastNeed=2,"".repeat(c+2)}}function j(a){var b=this.lastTotal-this.lastNeed,c=i(this,a,b);return void 0!==c?c:this.lastNeed<=a.length?(a.copy(this.lastChar,b,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal)):(a.copy(this.lastChar,b,0,a.length),void(this.lastNeed-=a.length))}function k(a,b){var c=h(this,a,b);if(!this.lastNeed)return a.toString("utf8",b);this.lastTotal=c;var d=a.length-(c-this.lastNeed);return a.copy(this.lastChar,0,d),a.toString("utf8",b,d)}function l(a){var b=a&&a.length?this.write(a):"";return this.lastNeed?b+"".repeat(this.lastTotal-this.lastNeed):b}function m(a,b){if((a.length-b)%2===0){var c=a.toString("utf16le",b);if(c){var d=c.charCodeAt(c.length-1);if(d>=55296&&56319>=d)return this.lastNeed=2,this.lastTotal=4,this.lastChar[0]=a[a.length-2],this.lastChar[1]=a[a.length-1],c.slice(0,-1)}return c}return this.lastNeed=1,this.lastTotal=2,this.lastChar[0]=a[a.length-1],a.toString("utf16le",b,a.length-1)}function n(a){var b=a&&a.length?this.write(a):"";if(this.lastNeed){var c=this.lastTotal-this.lastNeed;return b+this.lastChar.toString("utf16le",0,c)}return b}function o(a,b){var c=(a.length-b)%3;return 0===c?a.toString("base64",b):(this.lastNeed=3-c,this.lastTotal=3,1===c?this.lastChar[0]=a[a.length-1]:(this.lastChar[0]=a[a.length-2],this.lastChar[1]=a[a.length-1]),a.toString("base64",b,a.length-c))}function p(a){var b=a&&a.length?this.write(a):"";return this.lastNeed?b+this.lastChar.toString("base64",0,3-this.lastNeed):b}function q(a){return a.toString(this.encoding)}function r(a){return a&&a.length?this.write(a):""}var s=a("safe-buffer").Buffer,t=s.isEncoding||function(a){switch(a=""+a,a&&a.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};c.StringDecoder=f,f.prototype.write=function(a){if(0===a.length)return"";var b,c;if(this.lastNeed){if(b=this.fillLast(a),void 0===b)return"";c=this.lastNeed,this.lastNeed=0}else c=0;return c<a.length?b?b+this.text(a,c):this.text(a,c):b||""},f.prototype.end=l,f.prototype.text=k,f.prototype.fillLast=function(a){return this.lastNeed<=a.length?(a.copy(this.lastChar,this.lastTotal-this.lastNeed,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal)):(a.copy(this.lastChar,this.lastTotal-this.lastNeed,0,a.length),void(this.lastNeed-=a.length))}},{"safe-buffer":245}],239:[function(a,b,c){b.exports=a("./readable").PassThrough},{"./readable":240}],240:[function(a,b,c){c=b.exports=a("./lib/_stream_readable.js"),c.Stream=c,c.Readable=c,c.Writable=a("./lib/_stream_writable.js"),c.Duplex=a("./lib/_stream_duplex.js"),c.Transform=a("./lib/_stream_transform.js"),c.PassThrough=a("./lib/_stream_passthrough.js")},{"./lib/_stream_duplex.js":229,"./lib/_stream_passthrough.js":230,"./lib/_stream_readable.js":231,"./lib/_stream_transform.js":232,"./lib/_stream_writable.js":233}],241:[function(a,b,c){b.exports=a("./readable").Transform},{"./readable":240}],242:[function(a,b,c){b.exports=a("./lib/_stream_writable.js")},{"./lib/_stream_writable.js":233}],243:[function(a,b,c){!function(a){var b,c,d,e,f=function(){b=b||a.workerPath+"js/recorderWorker.js";try{c=c||new Worker(a.workerPath+"js/mp3Worker.js")}catch(d){console.warn("Web workers are not defined, recording will not work.",d)}},g=function(a,b){var c=document.querySelector("#log");c&&c.length>0?(c=c[0],c.innerHTML+="\n"+a+" "+(b||"")):console.log(a,b)},h=function(h){f();var i=h||{},j=i.bufferLen||4096,k=this,l=document.createElement("button"),m=document.createElement("button"),n=document.createElement("button"),o=document.createElement("button");if(!i.element)return void g("No element specified.  Cannot initialise recorder.");this.element=i.element,this.vumeter=null,this.outputFormat=i.format||i.element.getAttribute("data-format")||"wav",this.callback=i.callback||i.element.getAttribute("data-callback")||"console.log",this.audioData=null,d=a.audio_context,e=a.audio_source,this.context=e.context,this.node=(this.context.createScriptProcessor||this.context.createJavaScriptNode).call(this.context,j,2,2),this.analyser=this.context.createAnalyser(),this.analyser.smoothingTimeConstant=.3,this.analyser.fftSize=1024,this.audio=null,this.playing=!1;var p=new Worker(i.workerPath||b);p.postMessage({command:"init",config:{sampleRate:this.context.sampleRate}});var q,r=!1;this.node.onaudioprocess=function(a){if(r){p.postMessage({command:"record",buffer:[a.inputBuffer.getChannelData(0)]});var b=new Uint8Array(k.analyser.frequencyBinCount);k.analyser.getByteFrequencyData(b);for(var c=0,d=b.length,e=0;d>e;e++)c+=b[e];var f=c/d;k.vumeter.style.width=Math.min(parseInt(2*f),100)+"%"}},this.configure=function(a){for(var b in a)a.hasOwnProperty(b)&&(i[b]=a[b])},this.toggleRecording=function(){return r?k.stop():(k.record(),n.disabled=!1,l.disabled=!0,i.element.className+=" recording",k.audio=null,void g("Recording..."))},this.record=function(){r=!0},this.stop=function(){k.playing?(k.audio.pause(),k.audio.currentTime=0,k.playing=!1,l.className="btn-play",l.innerHTML='<span class="recorder-icon-play"></span>'):(k.stopRecording(),u(i.element,"recording"),g("Stopped recording."),k.exportWAV(),k.clear()),n.disabled=!0,m.disabled=!1,o.disabled=!1},this.stopRecording=function(){r=!1},this.play=function(){if(k.playing)k.audio.pause(),k.playing=!1,n.disabled=!0,m.disabled=!1,l.className="btn-play",l.innerHTML='<span class="recorder-icon-play"></span>';else if(null===k.audio){var a=new FileReader;a.onload=function(a){k.audio=new Audio(a.target.result),k.play()},a.readAsDataURL(k.audioData)}else k.audio.play(),k.playing=!0,n.disabled=!1,m.disabled=!0,l.className="btn-pause",l.innerHTML='<span class="recorder-icon-pause"></span>'},this.save=function(){l.disabled=!0,n.disabled=!0,m.disabled=!0,o.disabled=!0,i.element.className+=" processing","mp3"===k.outputFormat?k.convertToMP3():a[k.callback](k,k.audioData,i.element)},this.clear=function(){p.postMessage({command:"clear"}),w(),u(i.element,"recording"),u(i.element,"processing")},this.getBuffer=function(a){q=a||i.callback,p.postMessage({command:"getBuffer"})},this.exportWAV=function(a){a=a||i.type||"audio/wav",p.postMessage({command:"exportWAV",type:a})},p.onmessage=function(a){var b=a.data;k.audioData=b,l.disabled=!1},this.convertToMP3=function(){var b,d=new FileReader;d.onload=function(){b=this.result;var d=new Uint8Array(b),e=s(d);g("Converting to Mp3"),c.postMessage({cmd:"init",config:{mode:3,channels:1,samplerate:e.sampleRate,bitrate:e.bitsPerSample}}),c.postMessage({cmd:"encode",buf:t(e.samples)}),c.postMessage({cmd:"finish"}),c.onmessage=function(b){if("data"==b.data.cmd){g("Done converting to Mp3");var c=new Blob([new Uint8Array(b.data.buf)],{type:"audio/mp3"});a[k.callback](k,c,i.element)}}},d.readAsArrayBuffer(this.audioData)};var s=function(a){var b=function(b,c){for(var d=0,e=0;c;)d+=a[b]<<e,e+=8,b++,c--;return d};if(1!=b(20,2))throw"Invalid compression code, not PCM";if(1!=b(22,2))throw"Invalid number of channels, not 1";return{sampleRate:b(24,4),bitsPerSample:b(34,2),samples:a.subarray(44)}},t=function(a){for(var b=new Float32Array(a.length),c=0;c<a.length;c++){var d=a[c<<1]+(a[(c<<1)+1]<<8);d>=32768&&(d|=-32768),b[c]=d/32768}return b},u=function(a,b){a.className=a.className.replace(" "+b,"")},v=function(){g("Building interface..."),w(),i.element.appendChild(l),i.element.appendChild(m),i.element.appendChild(n),i.element.appendChild(o),k.vumeter=i.element.querySelector(".btn-record .vumeter"),g("Interface built.")},w=function(){m.onclick=k.toggleRecording,m.className="btn-record",m.innerHTML='<span class="vumeter"></span><span class="recorder-icon-record"></span>',m.disabled=!1,n.onclick=k.stop,n.className="btn-stop",n.innerHTML='<span class="recorder-icon-stop"></span>',n.disabled=!0,l.onclick=k.play,l.className="btn-play",l.innerHTML='<span class="recorder-icon-play"></span>',l.disabled=!0,o.onclick=k.save,o.className="btn-save",o.innerHTML='<span class="recorder-icon-upload"></span>',o.disabled=!0};return e.connect(this.analyser),this.analyser.connect(this.node),this.node.connect(this.context.destination),v(),this};a.Recorder=h;var i=function(){if(a.audio_context)return void console.log("audio_context already ready");try{a.AudioContext=a.AudioContext||a.webkitAudioContext,navigator.getUserMedia=navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia||navigator.msGetUserMedia,a.URL=a.URL||a.webkitURL,d=a.audio_context=new a.AudioContext,g("Audio context set up."),g("navigator.getUserMedia "+(navigator.getUserMedia?"available.":"not present!"))}catch(b){alert("No web audio support in this browser!")}navigator.getUserMedia({audio:!0},j,function(a){g("No live audio input: "+a)})},j=function(b){if(a.audio_source)return void console.log("source already ready");e=a.audio_source=d.createMediaStreamSource(b),g("Media stream created."),g("input sample rate "+e.context.sampleRate);for(var c=document.querySelectorAll(".RecordMP3js-recorder"),f=0;f<c.length;f++)c[f].recorder=new h({element:c[f]})};a.addEventListener?a.addEventListener("load",i,!1):a.attachEvent?a.attachEvent("onload",i):a.initRecorder=i}(c||window)},{}],244:[function(a,b,c){(function(c){"use strict";function d(){l.call(this,64),this._a=1732584193,this._b=4023233417,this._c=2562383102,this._d=271733878,this._e=3285377520}function e(a,b){return a<<b|a>>>32-b}function f(a,b,c,d,f,g,h,i){return e(a+(b^c^d)+g+h|0,i)+f|0}function g(a,b,c,d,f,g,h,i){return e(a+(b&c|~b&d)+g+h|0,i)+f|0}function h(a,b,c,d,f,g,h,i){return e(a+((b|~c)^d)+g+h|0,i)+f|0}function i(a,b,c,d,f,g,h,i){return e(a+(b&d|c&~d)+g+h|0,i)+f|0}function j(a,b,c,d,f,g,h,i){return e(a+(b^(c|~d))+g+h|0,i)+f|0}var k=a("inherits"),l=a("hash-base");k(d,l),d.prototype._update=function(){for(var a=new Array(16),b=0;16>b;++b)a[b]=this._block.readInt32LE(4*b);var c=this._a,d=this._b,k=this._c,l=this._d,m=this._e;c=f(c,d,k,l,m,a[0],0,11),k=e(k,10),m=f(m,c,d,k,l,a[1],0,14),d=e(d,10),l=f(l,m,c,d,k,a[2],0,15),c=e(c,10),k=f(k,l,m,c,d,a[3],0,12),m=e(m,10),d=f(d,k,l,m,c,a[4],0,5),l=e(l,10),c=f(c,d,k,l,m,a[5],0,8),k=e(k,10),m=f(m,c,d,k,l,a[6],0,7),d=e(d,10),l=f(l,m,c,d,k,a[7],0,9),c=e(c,10),k=f(k,l,m,c,d,a[8],0,11),m=e(m,10),d=f(d,k,l,m,c,a[9],0,13),l=e(l,10),c=f(c,d,k,l,m,a[10],0,14),k=e(k,10),m=f(m,c,d,k,l,a[11],0,15),d=e(d,10),l=f(l,m,c,d,k,a[12],0,6),c=e(c,10),k=f(k,l,m,c,d,a[13],0,7),m=e(m,10),d=f(d,k,l,m,c,a[14],0,9),l=e(l,10),c=f(c,d,k,l,m,a[15],0,8),k=e(k,10),m=g(m,c,d,k,l,a[7],1518500249,7),d=e(d,10),l=g(l,m,c,d,k,a[4],1518500249,6),c=e(c,10),k=g(k,l,m,c,d,a[13],1518500249,8),m=e(m,10),d=g(d,k,l,m,c,a[1],1518500249,13),l=e(l,10),c=g(c,d,k,l,m,a[10],1518500249,11),k=e(k,10),m=g(m,c,d,k,l,a[6],1518500249,9),d=e(d,10),l=g(l,m,c,d,k,a[15],1518500249,7),c=e(c,10),k=g(k,l,m,c,d,a[3],1518500249,15),m=e(m,10),d=g(d,k,l,m,c,a[12],1518500249,7),l=e(l,10),c=g(c,d,k,l,m,a[0],1518500249,12),k=e(k,10),m=g(m,c,d,k,l,a[9],1518500249,15),d=e(d,10),l=g(l,m,c,d,k,a[5],1518500249,9),c=e(c,10),k=g(k,l,m,c,d,a[2],1518500249,11),m=e(m,10),d=g(d,k,l,m,c,a[14],1518500249,7),l=e(l,10),c=g(c,d,k,l,m,a[11],1518500249,13),k=e(k,10),m=g(m,c,d,k,l,a[8],1518500249,12),d=e(d,10),l=h(l,m,c,d,k,a[3],1859775393,11),c=e(c,10),k=h(k,l,m,c,d,a[10],1859775393,13),m=e(m,10),d=h(d,k,l,m,c,a[14],1859775393,6),l=e(l,10),c=h(c,d,k,l,m,a[4],1859775393,7),k=e(k,10),m=h(m,c,d,k,l,a[9],1859775393,14),d=e(d,10),l=h(l,m,c,d,k,a[15],1859775393,9),c=e(c,10),k=h(k,l,m,c,d,a[8],1859775393,13),m=e(m,10),d=h(d,k,l,m,c,a[1],1859775393,15),l=e(l,10),c=h(c,d,k,l,m,a[2],1859775393,14),k=e(k,10),m=h(m,c,d,k,l,a[7],1859775393,8),d=e(d,10),l=h(l,m,c,d,k,a[0],1859775393,13),c=e(c,10),k=h(k,l,m,c,d,a[6],1859775393,6),m=e(m,10),d=h(d,k,l,m,c,a[13],1859775393,5),l=e(l,10),c=h(c,d,k,l,m,a[11],1859775393,12),k=e(k,10),m=h(m,c,d,k,l,a[5],1859775393,7),d=e(d,10),l=h(l,m,c,d,k,a[12],1859775393,5),c=e(c,10),k=i(k,l,m,c,d,a[1],2400959708,11),m=e(m,10),d=i(d,k,l,m,c,a[9],2400959708,12),l=e(l,10),c=i(c,d,k,l,m,a[11],2400959708,14),k=e(k,10),m=i(m,c,d,k,l,a[10],2400959708,15),d=e(d,10),l=i(l,m,c,d,k,a[0],2400959708,14),c=e(c,10),k=i(k,l,m,c,d,a[8],2400959708,15),m=e(m,10),d=i(d,k,l,m,c,a[12],2400959708,9),l=e(l,10),c=i(c,d,k,l,m,a[4],2400959708,8),k=e(k,10),m=i(m,c,d,k,l,a[13],2400959708,9),d=e(d,10),l=i(l,m,c,d,k,a[3],2400959708,14),c=e(c,10),k=i(k,l,m,c,d,a[7],2400959708,5),m=e(m,10),d=i(d,k,l,m,c,a[15],2400959708,6),l=e(l,10),c=i(c,d,k,l,m,a[14],2400959708,8),k=e(k,10),m=i(m,c,d,k,l,a[5],2400959708,6),d=e(d,10),l=i(l,m,c,d,k,a[6],2400959708,5),c=e(c,10),k=i(k,l,m,c,d,a[2],2400959708,12),m=e(m,10),d=j(d,k,l,m,c,a[4],2840853838,9),l=e(l,10),c=j(c,d,k,l,m,a[0],2840853838,15),k=e(k,10),m=j(m,c,d,k,l,a[5],2840853838,5),d=e(d,10),l=j(l,m,c,d,k,a[9],2840853838,11),c=e(c,10),k=j(k,l,m,c,d,a[7],2840853838,6),m=e(m,10),d=j(d,k,l,m,c,a[12],2840853838,8),l=e(l,10),c=j(c,d,k,l,m,a[2],2840853838,13),k=e(k,10),m=j(m,c,d,k,l,a[10],2840853838,12),d=e(d,10),l=j(l,m,c,d,k,a[14],2840853838,5),c=e(c,10),k=j(k,l,m,c,d,a[1],2840853838,12),m=e(m,10),d=j(d,k,l,m,c,a[3],2840853838,13),l=e(l,10),c=j(c,d,k,l,m,a[8],2840853838,14),k=e(k,10),m=j(m,c,d,k,l,a[11],2840853838,11),d=e(d,10),l=j(l,m,c,d,k,a[6],2840853838,8),c=e(c,10),k=j(k,l,m,c,d,a[15],2840853838,5),m=e(m,10),
d=j(d,k,l,m,c,a[13],2840853838,6),l=e(l,10);var n=this._a,o=this._b,p=this._c,q=this._d,r=this._e;n=j(n,o,p,q,r,a[5],1352829926,8),p=e(p,10),r=j(r,n,o,p,q,a[14],1352829926,9),o=e(o,10),q=j(q,r,n,o,p,a[7],1352829926,9),n=e(n,10),p=j(p,q,r,n,o,a[0],1352829926,11),r=e(r,10),o=j(o,p,q,r,n,a[9],1352829926,13),q=e(q,10),n=j(n,o,p,q,r,a[2],1352829926,15),p=e(p,10),r=j(r,n,o,p,q,a[11],1352829926,15),o=e(o,10),q=j(q,r,n,o,p,a[4],1352829926,5),n=e(n,10),p=j(p,q,r,n,o,a[13],1352829926,7),r=e(r,10),o=j(o,p,q,r,n,a[6],1352829926,7),q=e(q,10),n=j(n,o,p,q,r,a[15],1352829926,8),p=e(p,10),r=j(r,n,o,p,q,a[8],1352829926,11),o=e(o,10),q=j(q,r,n,o,p,a[1],1352829926,14),n=e(n,10),p=j(p,q,r,n,o,a[10],1352829926,14),r=e(r,10),o=j(o,p,q,r,n,a[3],1352829926,12),q=e(q,10),n=j(n,o,p,q,r,a[12],1352829926,6),p=e(p,10),r=i(r,n,o,p,q,a[6],1548603684,9),o=e(o,10),q=i(q,r,n,o,p,a[11],1548603684,13),n=e(n,10),p=i(p,q,r,n,o,a[3],1548603684,15),r=e(r,10),o=i(o,p,q,r,n,a[7],1548603684,7),q=e(q,10),n=i(n,o,p,q,r,a[0],1548603684,12),p=e(p,10),r=i(r,n,o,p,q,a[13],1548603684,8),o=e(o,10),q=i(q,r,n,o,p,a[5],1548603684,9),n=e(n,10),p=i(p,q,r,n,o,a[10],1548603684,11),r=e(r,10),o=i(o,p,q,r,n,a[14],1548603684,7),q=e(q,10),n=i(n,o,p,q,r,a[15],1548603684,7),p=e(p,10),r=i(r,n,o,p,q,a[8],1548603684,12),o=e(o,10),q=i(q,r,n,o,p,a[12],1548603684,7),n=e(n,10),p=i(p,q,r,n,o,a[4],1548603684,6),r=e(r,10),o=i(o,p,q,r,n,a[9],1548603684,15),q=e(q,10),n=i(n,o,p,q,r,a[1],1548603684,13),p=e(p,10),r=i(r,n,o,p,q,a[2],1548603684,11),o=e(o,10),q=h(q,r,n,o,p,a[15],1836072691,9),n=e(n,10),p=h(p,q,r,n,o,a[5],1836072691,7),r=e(r,10),o=h(o,p,q,r,n,a[1],1836072691,15),q=e(q,10),n=h(n,o,p,q,r,a[3],1836072691,11),p=e(p,10),r=h(r,n,o,p,q,a[7],1836072691,8),o=e(o,10),q=h(q,r,n,o,p,a[14],1836072691,6),n=e(n,10),p=h(p,q,r,n,o,a[6],1836072691,6),r=e(r,10),o=h(o,p,q,r,n,a[9],1836072691,14),q=e(q,10),n=h(n,o,p,q,r,a[11],1836072691,12),p=e(p,10),r=h(r,n,o,p,q,a[8],1836072691,13),o=e(o,10),q=h(q,r,n,o,p,a[12],1836072691,5),n=e(n,10),p=h(p,q,r,n,o,a[2],1836072691,14),r=e(r,10),o=h(o,p,q,r,n,a[10],1836072691,13),q=e(q,10),n=h(n,o,p,q,r,a[0],1836072691,13),p=e(p,10),r=h(r,n,o,p,q,a[4],1836072691,7),o=e(o,10),q=h(q,r,n,o,p,a[13],1836072691,5),n=e(n,10),p=g(p,q,r,n,o,a[8],2053994217,15),r=e(r,10),o=g(o,p,q,r,n,a[6],2053994217,5),q=e(q,10),n=g(n,o,p,q,r,a[4],2053994217,8),p=e(p,10),r=g(r,n,o,p,q,a[1],2053994217,11),o=e(o,10),q=g(q,r,n,o,p,a[3],2053994217,14),n=e(n,10),p=g(p,q,r,n,o,a[11],2053994217,14),r=e(r,10),o=g(o,p,q,r,n,a[15],2053994217,6),q=e(q,10),n=g(n,o,p,q,r,a[0],2053994217,14),p=e(p,10),r=g(r,n,o,p,q,a[5],2053994217,6),o=e(o,10),q=g(q,r,n,o,p,a[12],2053994217,9),n=e(n,10),p=g(p,q,r,n,o,a[2],2053994217,12),r=e(r,10),o=g(o,p,q,r,n,a[13],2053994217,9),q=e(q,10),n=g(n,o,p,q,r,a[9],2053994217,12),p=e(p,10),r=g(r,n,o,p,q,a[7],2053994217,5),o=e(o,10),q=g(q,r,n,o,p,a[10],2053994217,15),n=e(n,10),p=g(p,q,r,n,o,a[14],2053994217,8),r=e(r,10),o=f(o,p,q,r,n,a[12],0,8),q=e(q,10),n=f(n,o,p,q,r,a[15],0,5),p=e(p,10),r=f(r,n,o,p,q,a[10],0,12),o=e(o,10),q=f(q,r,n,o,p,a[4],0,9),n=e(n,10),p=f(p,q,r,n,o,a[1],0,12),r=e(r,10),o=f(o,p,q,r,n,a[5],0,5),q=e(q,10),n=f(n,o,p,q,r,a[8],0,14),p=e(p,10),r=f(r,n,o,p,q,a[7],0,6),o=e(o,10),q=f(q,r,n,o,p,a[6],0,8),n=e(n,10),p=f(p,q,r,n,o,a[2],0,13),r=e(r,10),o=f(o,p,q,r,n,a[13],0,6),q=e(q,10),n=f(n,o,p,q,r,a[14],0,5),p=e(p,10),r=f(r,n,o,p,q,a[0],0,15),o=e(o,10),q=f(q,r,n,o,p,a[3],0,13),n=e(n,10),p=f(p,q,r,n,o,a[9],0,11),r=e(r,10),o=f(o,p,q,r,n,a[11],0,11),q=e(q,10);var s=this._b+k+q|0;this._b=this._c+l+r|0,this._c=this._d+m+n|0,this._d=this._e+c+o|0,this._e=this._a+d+p|0,this._a=s},d.prototype._digest=function(){this._block[this._blockOffset++]=128,this._blockOffset>56&&(this._block.fill(0,this._blockOffset,64),this._update(),this._blockOffset=0),this._block.fill(0,this._blockOffset,56),this._block.writeUInt32LE(this._length[0],56),this._block.writeUInt32LE(this._length[1],60),this._update();var a=new c(20);return a.writeInt32LE(this._a,0),a.writeInt32LE(this._b,4),a.writeInt32LE(this._c,8),a.writeInt32LE(this._d,12),a.writeInt32LE(this._e,16),a},b.exports=d}).call(this,a("buffer").Buffer)},{buffer:130,"hash-base":179,inherits:196}],245:[function(a,b,c){function d(a,b){for(var c in a)b[c]=a[c]}function e(a,b,c){return g(a,b,c)}var f=a("buffer"),g=f.Buffer;g.from&&g.alloc&&g.allocUnsafe&&g.allocUnsafeSlow?b.exports=f:(d(f,c),c.Buffer=e),d(g,e),e.from=function(a,b,c){if("number"==typeof a)throw new TypeError("Argument must not be a number");return g(a,b,c)},e.alloc=function(a,b,c){if("number"!=typeof a)throw new TypeError("Argument must be a number");var d=g(a);return void 0!==b?"string"==typeof c?d.fill(b,c):d.fill(b):d.fill(0),d},e.allocUnsafe=function(a){if("number"!=typeof a)throw new TypeError("Argument must be a number");return g(a)},e.allocUnsafeSlow=function(a){if("number"!=typeof a)throw new TypeError("Argument must be a number");return f.SlowBuffer(a)}},{buffer:130}],246:[function(a,b,c){(function(a){function c(b,c){this._block=new a(b),this._finalSize=c,this._blockSize=b,this._len=0,this._s=0}c.prototype.update=function(b,c){"string"==typeof b&&(c=c||"utf8",b=new a(b,c));for(var d=this._len+=b.length,e=this._s||0,f=0,g=this._block;d>e;){for(var h=Math.min(b.length,f+this._blockSize-e%this._blockSize),i=h-f,j=0;i>j;j++)g[e%this._blockSize+j]=b[j+f];e+=i,f+=i,e%this._blockSize===0&&this._update(g)}return this._s=e,this},c.prototype.digest=function(a){var b=8*this._len;this._block[this._len%this._blockSize]=128,this._block.fill(0,this._len%this._blockSize+1),b%(8*this._blockSize)>=8*this._finalSize&&(this._update(this._block),this._block.fill(0)),this._block.writeInt32BE(b,this._blockSize-4);var c=this._update(this._block)||this._hash();return a?c.toString(a):c},c.prototype._update=function(){throw new Error("_update must be implemented by subclass")},b.exports=c}).call(this,a("buffer").Buffer)},{buffer:130}],247:[function(a,b,c){var c=b.exports=function(a){a=a.toLowerCase();var b=c[a];if(!b)throw new Error(a+" is not supported (we accept pull requests)");return new b};c.sha=a("./sha"),c.sha1=a("./sha1"),c.sha224=a("./sha224"),c.sha256=a("./sha256"),c.sha384=a("./sha384"),c.sha512=a("./sha512")},{"./sha":248,"./sha1":249,"./sha224":250,"./sha256":251,"./sha384":252,"./sha512":253}],248:[function(a,b,c){(function(c){function d(){this.init(),this._w=k,i.call(this,64,56)}function e(a){return a<<5|a>>>27}function f(a){return a<<30|a>>>2}function g(a,b,c,d){return 0===a?b&c|~b&d:2===a?b&c|b&d|c&d:b^c^d}var h=a("inherits"),i=a("./hash"),j=[1518500249,1859775393,-1894007588,-899497514],k=new Array(80);h(d,i),d.prototype.init=function(){return this._a=1732584193,this._b=4023233417,this._c=2562383102,this._d=271733878,this._e=3285377520,this},d.prototype._update=function(a){for(var b=this._w,c=0|this._a,d=0|this._b,h=0|this._c,i=0|this._d,k=0|this._e,l=0;16>l;++l)b[l]=a.readInt32BE(4*l);for(;80>l;++l)b[l]=b[l-3]^b[l-8]^b[l-14]^b[l-16];for(var m=0;80>m;++m){var n=~~(m/20),o=e(c)+g(n,d,h,i)+k+b[m]+j[n]|0;k=i,i=h,h=f(d),d=c,c=o}this._a=c+this._a|0,this._b=d+this._b|0,this._c=h+this._c|0,this._d=i+this._d|0,this._e=k+this._e|0},d.prototype._hash=function(){var a=new c(20);return a.writeInt32BE(0|this._a,0),a.writeInt32BE(0|this._b,4),a.writeInt32BE(0|this._c,8),a.writeInt32BE(0|this._d,12),a.writeInt32BE(0|this._e,16),a},b.exports=d}).call(this,a("buffer").Buffer)},{"./hash":246,buffer:130,inherits:196}],249:[function(a,b,c){(function(c){function d(){this.init(),this._w=l,j.call(this,64,56)}function e(a){return a<<1|a>>>31}function f(a){return a<<5|a>>>27}function g(a){return a<<30|a>>>2}function h(a,b,c,d){return 0===a?b&c|~b&d:2===a?b&c|b&d|c&d:b^c^d}var i=a("inherits"),j=a("./hash"),k=[1518500249,1859775393,-1894007588,-899497514],l=new Array(80);i(d,j),d.prototype.init=function(){return this._a=1732584193,this._b=4023233417,this._c=2562383102,this._d=271733878,this._e=3285377520,this},d.prototype._update=function(a){for(var b=this._w,c=0|this._a,d=0|this._b,i=0|this._c,j=0|this._d,l=0|this._e,m=0;16>m;++m)b[m]=a.readInt32BE(4*m);for(;80>m;++m)b[m]=e(b[m-3]^b[m-8]^b[m-14]^b[m-16]);for(var n=0;80>n;++n){var o=~~(n/20),p=f(c)+h(o,d,i,j)+l+b[n]+k[o]|0;l=j,j=i,i=g(d),d=c,c=p}this._a=c+this._a|0,this._b=d+this._b|0,this._c=i+this._c|0,this._d=j+this._d|0,this._e=l+this._e|0},d.prototype._hash=function(){var a=new c(20);return a.writeInt32BE(0|this._a,0),a.writeInt32BE(0|this._b,4),a.writeInt32BE(0|this._c,8),a.writeInt32BE(0|this._d,12),a.writeInt32BE(0|this._e,16),a},b.exports=d}).call(this,a("buffer").Buffer)},{"./hash":246,buffer:130,inherits:196}],250:[function(a,b,c){(function(c){function d(){this.init(),this._w=h,g.call(this,64,56)}var e=a("inherits"),f=a("./sha256"),g=a("./hash"),h=new Array(64);e(d,f),d.prototype.init=function(){return this._a=3238371032,this._b=914150663,this._c=812702999,this._d=4144912697,this._e=4290775857,this._f=1750603025,this._g=1694076839,this._h=3204075428,this},d.prototype._hash=function(){var a=new c(28);return a.writeInt32BE(this._a,0),a.writeInt32BE(this._b,4),a.writeInt32BE(this._c,8),a.writeInt32BE(this._d,12),a.writeInt32BE(this._e,16),a.writeInt32BE(this._f,20),a.writeInt32BE(this._g,24),a},b.exports=d}).call(this,a("buffer").Buffer)},{"./hash":246,"./sha256":251,buffer:130,inherits:196}],251:[function(a,b,c){(function(c){function d(){this.init(),this._w=n,l.call(this,64,56)}function e(a,b,c){return c^a&(b^c)}function f(a,b,c){return a&b|c&(a|b)}function g(a){return(a>>>2|a<<30)^(a>>>13|a<<19)^(a>>>22|a<<10)}function h(a){return(a>>>6|a<<26)^(a>>>11|a<<21)^(a>>>25|a<<7)}function i(a){return(a>>>7|a<<25)^(a>>>18|a<<14)^a>>>3}function j(a){return(a>>>17|a<<15)^(a>>>19|a<<13)^a>>>10}var k=a("inherits"),l=a("./hash"),m=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],n=new Array(64);k(d,l),d.prototype.init=function(){return this._a=1779033703,this._b=3144134277,this._c=1013904242,this._d=2773480762,this._e=1359893119,this._f=2600822924,this._g=528734635,this._h=1541459225,this},d.prototype._update=function(a){for(var b=this._w,c=0|this._a,d=0|this._b,k=0|this._c,l=0|this._d,n=0|this._e,o=0|this._f,p=0|this._g,q=0|this._h,r=0;16>r;++r)b[r]=a.readInt32BE(4*r);for(;64>r;++r)b[r]=j(b[r-2])+b[r-7]+i(b[r-15])+b[r-16]|0;for(var s=0;64>s;++s){var t=q+h(n)+e(n,o,p)+m[s]+b[s]|0,u=g(c)+f(c,d,k)|0;q=p,p=o,o=n,n=l+t|0,l=k,k=d,d=c,c=t+u|0}this._a=c+this._a|0,this._b=d+this._b|0,this._c=k+this._c|0,this._d=l+this._d|0,this._e=n+this._e|0,this._f=o+this._f|0,this._g=p+this._g|0,this._h=q+this._h|0},d.prototype._hash=function(){var a=new c(32);return a.writeInt32BE(this._a,0),a.writeInt32BE(this._b,4),a.writeInt32BE(this._c,8),a.writeInt32BE(this._d,12),a.writeInt32BE(this._e,16),a.writeInt32BE(this._f,20),a.writeInt32BE(this._g,24),a.writeInt32BE(this._h,28),a},b.exports=d}).call(this,a("buffer").Buffer)},{"./hash":246,buffer:130,inherits:196}],252:[function(a,b,c){(function(c){function d(){this.init(),this._w=h,g.call(this,128,112)}var e=a("inherits"),f=a("./sha512"),g=a("./hash"),h=new Array(160);e(d,f),d.prototype.init=function(){return this._ah=3418070365,this._bh=1654270250,this._ch=2438529370,this._dh=355462360,this._eh=1731405415,this._fh=2394180231,this._gh=3675008525,this._hh=1203062813,this._al=3238371032,this._bl=914150663,this._cl=812702999,this._dl=4144912697,this._el=4290775857,this._fl=1750603025,this._gl=1694076839,this._hl=3204075428,this},d.prototype._hash=function(){function a(a,c,d){b.writeInt32BE(a,d),b.writeInt32BE(c,d+4)}var b=new c(48);return a(this._ah,this._al,0),a(this._bh,this._bl,8),a(this._ch,this._cl,16),a(this._dh,this._dl,24),a(this._eh,this._el,32),a(this._fh,this._fl,40),b},b.exports=d}).call(this,a("buffer").Buffer)},{"./hash":246,"./sha512":253,buffer:130,inherits:196}],253:[function(a,b,c){(function(c){function d(){this.init(),this._w=q,o.call(this,128,112)}function e(a,b,c){return c^a&(b^c)}function f(a,b,c){return a&b|c&(a|b)}function g(a,b){return(a>>>28|b<<4)^(b>>>2|a<<30)^(b>>>7|a<<25)}function h(a,b){return(a>>>14|b<<18)^(a>>>18|b<<14)^(b>>>9|a<<23)}function i(a,b){return(a>>>1|b<<31)^(a>>>8|b<<24)^a>>>7}function j(a,b){return(a>>>1|b<<31)^(a>>>8|b<<24)^(a>>>7|b<<25)}function k(a,b){return(a>>>19|b<<13)^(b>>>29|a<<3)^a>>>6}function l(a,b){return(a>>>19|b<<13)^(b>>>29|a<<3)^(a>>>6|b<<26)}function m(a,b){return b>>>0>a>>>0?1:0}var n=a("inherits"),o=a("./hash"),p=[1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591],q=new Array(160);n(d,o),d.prototype.init=function(){return this._ah=1779033703,this._bh=3144134277,this._ch=1013904242,this._dh=2773480762,this._eh=1359893119,this._fh=2600822924,this._gh=528734635,this._hh=1541459225,this._al=4089235720,this._bl=2227873595,this._cl=4271175723,this._dl=1595750129,this._el=2917565137,this._fl=725511199,this._gl=4215389547,this._hl=327033209,this},d.prototype._update=function(a){for(var b=this._w,c=0|this._ah,d=0|this._bh,n=0|this._ch,o=0|this._dh,q=0|this._eh,r=0|this._fh,s=0|this._gh,t=0|this._hh,u=0|this._al,v=0|this._bl,w=0|this._cl,x=0|this._dl,y=0|this._el,z=0|this._fl,A=0|this._gl,B=0|this._hl,C=0;32>C;C+=2)b[C]=a.readInt32BE(4*C),b[C+1]=a.readInt32BE(4*C+4);for(;160>C;C+=2){var D=b[C-30],E=b[C-30+1],F=i(D,E),G=j(E,D);D=b[C-4],E=b[C-4+1];var H=k(D,E),I=l(E,D),J=b[C-14],K=b[C-14+1],L=b[C-32],M=b[C-32+1],N=G+K|0,O=F+J+m(N,G)|0;N=N+I|0,O=O+H+m(N,I)|0,N=N+M|0,O=O+L+m(N,M)|0,b[C]=O,b[C+1]=N}for(var P=0;160>P;P+=2){O=b[P],N=b[P+1];var Q=f(c,d,n),R=f(u,v,w),S=g(c,u),T=g(u,c),U=h(q,y),V=h(y,q),W=p[P],X=p[P+1],Y=e(q,r,s),Z=e(y,z,A),$=B+V|0,_=t+U+m($,B)|0;$=$+Z|0,_=_+Y+m($,Z)|0,$=$+X|0,_=_+W+m($,X)|0,$=$+N|0,_=_+O+m($,N)|0;var aa=T+R|0,ba=S+Q+m(aa,T)|0;t=s,B=A,s=r,A=z,r=q,z=y,y=x+$|0,q=o+_+m(y,x)|0,o=n,x=w,n=d,w=v,d=c,v=u,u=$+aa|0,c=_+ba+m(u,$)|0}this._al=this._al+u|0,this._bl=this._bl+v|0,this._cl=this._cl+w|0,this._dl=this._dl+x|0,this._el=this._el+y|0,this._fl=this._fl+z|0,this._gl=this._gl+A|0,this._hl=this._hl+B|0,this._ah=this._ah+c+m(this._al,u)|0,this._bh=this._bh+d+m(this._bl,v)|0,this._ch=this._ch+n+m(this._cl,w)|0,this._dh=this._dh+o+m(this._dl,x)|0,this._eh=this._eh+q+m(this._el,y)|0,this._fh=this._fh+r+m(this._fl,z)|0,this._gh=this._gh+s+m(this._gl,A)|0,this._hh=this._hh+t+m(this._hl,B)|0},d.prototype._hash=function(){function a(a,c,d){b.writeInt32BE(a,d),b.writeInt32BE(c,d+4)}var b=new c(64);return a(this._ah,this._al,0),a(this._bh,this._bl,8),a(this._ch,this._cl,16),a(this._dh,this._dl,24),a(this._eh,this._el,32),a(this._fh,this._fl,40),a(this._gh,this._gl,48),a(this._hh,this._hl,56),b},b.exports=d}).call(this,a("buffer").Buffer)},{"./hash":246,buffer:130,inherits:196}],254:[function(a,b,c){function d(){e.call(this)}b.exports=d;var e=a("events").EventEmitter,f=a("inherits");f(d,e),d.Readable=a("readable-stream/readable.js"),d.Writable=a("readable-stream/writable.js"),d.Duplex=a("readable-stream/duplex.js"),d.Transform=a("readable-stream/transform.js"),d.PassThrough=a("readable-stream/passthrough.js"),d.Stream=d,d.prototype.pipe=function(a,b){function c(b){a.writable&&!1===a.write(b)&&j.pause&&j.pause()}function d(){j.readable&&j.resume&&j.resume()}function f(){k||(k=!0,a.end())}function g(){k||(k=!0,"function"==typeof a.destroy&&a.destroy())}function h(a){if(i(),0===e.listenerCount(this,"error"))throw a}function i(){j.removeListener("data",c),a.removeListener("drain",d),j.removeListener("end",f),j.removeListener("close",g),j.removeListener("error",h),a.removeListener("error",h),j.removeListener("end",i),j.removeListener("close",i),a.removeListener("close",i)}var j=this;j.on("data",c),a.on("drain",d),a._isStdio||b&&b.end===!1||(j.on("end",f),j.on("close",g));var k=!1;return j.on("error",h),a.on("error",h),j.on("end",i),j.on("close",i),a.on("close",i),a.emit("pipe",j),a}},{events:173,inherits:196,"readable-stream/duplex.js":228,"readable-stream/passthrough.js":239,"readable-stream/readable.js":240,"readable-stream/transform.js":241,"readable-stream/writable.js":242}],255:[function(a,b,c){function d(a){if(a&&!i(a))throw new Error("Unknown encoding: "+a)}function e(a){return a.toString(this.encoding)}function f(a){this.charReceived=a.length%2,this.charLength=this.charReceived?2:0}function g(a){this.charReceived=a.length%3,this.charLength=this.charReceived?3:0}var h=a("buffer").Buffer,i=h.isEncoding||function(a){switch(a&&a.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}},j=c.StringDecoder=function(a){switch(this.encoding=(a||"utf8").toLowerCase().replace(/[-_]/,""),d(a),this.encoding){case"utf8":this.surrogateSize=3;break;case"ucs2":case"utf16le":this.surrogateSize=2,this.detectIncompleteChar=f;break;case"base64":this.surrogateSize=3,this.detectIncompleteChar=g;break;default:return void(this.write=e)}this.charBuffer=new h(6),this.charReceived=0,this.charLength=0};j.prototype.write=function(a){for(var b="";this.charLength;){var c=a.length>=this.charLength-this.charReceived?this.charLength-this.charReceived:a.length;if(a.copy(this.charBuffer,this.charReceived,0,c),this.charReceived+=c,this.charReceived<this.charLength)return"";a=a.slice(c,a.length),b=this.charBuffer.slice(0,this.charLength).toString(this.encoding);var d=b.charCodeAt(b.length-1);if(!(d>=55296&&56319>=d)){if(this.charReceived=this.charLength=0,0===a.length)return b;break}this.charLength+=this.surrogateSize,b=""}this.detectIncompleteChar(a);var e=a.length;this.charLength&&(a.copy(this.charBuffer,0,a.length-this.charReceived,e),e-=this.charReceived),b+=a.toString(this.encoding,0,e);var e=b.length-1,d=b.charCodeAt(e);if(d>=55296&&56319>=d){var f=this.surrogateSize;return this.charLength+=f,this.charReceived+=f,this.charBuffer.copy(this.charBuffer,f,0,f),a.copy(this.charBuffer,0,0,f),b.substring(0,e)}return b},j.prototype.detectIncompleteChar=function(a){for(var b=a.length>=3?3:a.length;b>0;b--){var c=a[a.length-b];if(1==b&&c>>5==6){this.charLength=2;break}if(2>=b&&c>>4==14){this.charLength=3;break}if(3>=b&&c>>3==30){this.charLength=4;break}}this.charReceived=b},j.prototype.end=function(a){var b="";if(a&&a.length&&(b=this.write(a)),this.charReceived){var c=this.charReceived,d=this.charBuffer,e=this.encoding;b+=d.slice(0,c).toString(e)}return b}},{buffer:130}],256:[function(a,b,c){!function(a){"use strict";var b={};b.init=function(){return"init"};var c=function(a){for(var b,c,d,e={},f=0;f<a.length;f++)b=a[f].split(" = "),c=b[0].trim().replace(/ /g,"_"),d=b[1].trim().replace(/"/g,""),e[c]=d;return e};b.textgridToJSON=function(a,b){for(var d,e,f,g,h,i=a.split("\n"),j={items:[]},k=null,l="Unknown",m=[];i.length>0;)if(d=i.shift())if(0!==d.search(/ /))e=d.split(" = "),2===e.length&&(g=e[0].trim().replace(/ /g,"_"),h=e[1].trim().replace(/"/g,""),j[g]=h,"File_name"===g&&(l=h+"",console.log(" Found a file name "+l),m.push(l)));else if(-1!==d.search(/\[[\0-9]+\]/)){if(e=d.split("["),f=e[0].trim(),"item"===f)console.log("  Found an item for "+l),k&&(k.fileName=l,j.items.push(k)),k={};else if("points"===f){var n=c([i.shift(),i.shift()]);k[f]=k[f]||[],k[f].push(n)}else if("intervals"===f){var o=c([i.shift(),i.shift(),i.shift()]);k[f]=k[f]||[],k[f].push(o)}}else e=d.split(" = "),2===e.length&&(g=e[0].trim().replace(/ /g,"_"),h=e[1].trim().replace(/"/g,""),g.indexOf(":_size")>-1&&(g=g.replace(":_","_"),h=parseInt(h,10)),k[g]=h);else d=i.shift(),d||(k&&(k.fileName=l,j.items.push(k)),k=null,l="Unknown",console.log("Reset filename if there is are two empty lines"));return k&&(k.fileName=l,j.items.push(k)),j.fileNames=m,j},b.textgridToIGT=function(a,b){return this.jsonToIGT(this.textgridToJSON(a,b),b)},b.jsonToIGT=function(a,b){var c={};a.intervalsByXmin={},a.intervalsByText={};var d,e,f,g,h,i,j,k,l=!1,m=0,n=/[ #?!'".,\/\(\)\*\#0-9-]/g,o=a.items.map(function(a){return a.name.indexOf("@")>-1&&(a.speaker=a.name.substring(a.name.indexOf("@")+1).trim(),a.name=a.name.substring(0,a.name.indexOf("@")).trim(),m++),b&&(a.speaker=a.name),"silences"===a.name&&(a.name="utterances"),a.name});if(o.length-m==0&&(l=!0),!a||!a.items)return a;for(d=0;d<a.items.length;d++)if(c[a.items[d].name]=a.items[d].intervals_size||a.items[d].points_size,a.items[d].intervals)for(e=0;e<a.items[d].intervals.length;e++)f=this.marginForConsideringIntervalsMatching(a.items[d].intervals[e].xmin),g=this.marginForConsideringIntervalsMatching(a.items[d].intervals[e].xmax),i=a.items[d].intervals[e],i.fileName=a.items[d].fileName,i.tierName=a.items[d].name,i.speaker=a.items[d].speaker,h=f+":"+g,a.intervalsByXmin[h]=a.intervalsByXmin[h]||[],a.intervalsByXmin[h].push(i),j=i.text?i.text.trim().toLocaleLowerCase().replace(n,""):"",j&&("utterance"===j&&a.items[d].intervals.length<3&&(j=i.fileName,j.indexOf(".")>-1&&(j=j.substring(0,i.fileName.lastIndexOf("."))),j=j.trim().replace(/_/g," "),i.text=j),a.intervalsByText[j]=a.intervalsByText[j]||[],k=a.intervalsByText[j].length,a.intervalsByText[j][k]=i);return a.probablyFromElanWithSpeakerEncodedInTierName=l,a.isIGTNestedOrAlignedOrBySpeaker=this.isIGTNestedOrAlignedOrBySpeaker(a),a},b.isIGTNestedOrAlignedOrBySpeaker=function(a){var b,c,d=a.intervalsByXmin,e={},f=0,g=!1,h=!1;for(var i in a.items)a.items.hasOwnProperty(i)&&a.items[i].speaker&&(g=!0);for(c in d)e[d[c].length]=e[d[c].length]?e[d[c].length]+1:1,f++;for(b in e)e[b]=e[b]/f,b>1&&e[b]>.1&&(h=!0);return a.fileNames&&a.fileNames.length>4&&(h=!1),{histogram:e,probablyAligned:h,probablyBySpeaker:g}},b.marginForConsideringIntervalsMatching=function(a,b){return b=b?100/b:5,(Math.round(a*b)/b).toFixed(2)},b.printIGT=function(a){for(var b in a)console.log(b),a.hasOwnProperty(b)&&console.log(a[b].map(function(a){return a.xmin+","+a.xmax+","+a.text}))},a.TextGrid=b}("object"==typeof c&&c||this)},{}],257:[function(a,b,c){(function(a){function c(a,b){function c(){if(!e){if(d("throwDeprecation"))throw new Error(b);d("traceDeprecation")?console.trace(b):console.warn(b),e=!0}return a.apply(this,arguments)}if(d("noDeprecation"))return a;var e=!1;return c}function d(b){try{if(!a.localStorage)return!1}catch(c){return!1}var d=a.localStorage[b];return null==d?!1:"true"===String(d).toLowerCase()}b.exports=c}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],258:[function(require,module,exports){function Context(){}var indexOf=require("indexof"),Object_keys=function(a){if(Object.keys)return Object.keys(a);var b=[];for(var c in a)b.push(c);return b},forEach=function(a,b){if(a.forEach)return a.forEach(b);for(var c=0;c<a.length;c++)b(a[c],c,a)},defineProp=function(){try{return Object.defineProperty({},"_",{}),function(a,b,c){Object.defineProperty(a,b,{writable:!0,enumerable:!1,configurable:!0,value:c})}}catch(a){return function(a,b,c){a[b]=c}}}(),globals=["Array","Boolean","Date","Error","EvalError","Function","Infinity","JSON","Math","NaN","Number","Object","RangeError","ReferenceError","RegExp","String","SyntaxError","TypeError","URIError","decodeURI","decodeURIComponent","encodeURI","encodeURIComponent","escape","eval","isFinite","isNaN","parseFloat","parseInt","undefined","unescape"];Context.prototype={};var Script=exports.Script=function(a){return this instanceof Script?void(this.code=a):new Script(a)};Script.prototype.runInContext=function(a){if(!(a instanceof Context))throw new TypeError("needs a 'context' argument.");var b=document.createElement("iframe");b.style||(b.style={}),b.style.display="none",document.body.appendChild(b);var c=b.contentWindow,d=c.eval,e=c.execScript;!d&&e&&(e.call(c,"null"),d=c.eval),forEach(Object_keys(a),function(b){c[b]=a[b]}),forEach(globals,function(b){a[b]&&(c[b]=a[b])});var f=Object_keys(c),g=d.call(c,this.code);return forEach(Object_keys(c),function(b){(b in a||-1===indexOf(f,b))&&(a[b]=c[b])}),forEach(globals,function(b){b in a||defineProp(a,b,c[b])}),document.body.removeChild(b),g},Script.prototype.runInThisContext=function(){return eval(this.code)},Script.prototype.runInNewContext=function(a){var b=Script.createContext(a),c=this.runInContext(b);return forEach(Object_keys(b),function(c){a[c]=b[c]}),c},forEach(Object_keys(Script.prototype),function(a){exports[a]=Script[a]=function(b){var c=Script(b);return c[a].apply(c,[].slice.call(arguments,1))}}),exports.createScript=function(a){return exports.Script(a)},exports.createContext=Script.createContext=function(a){var b=new Context;return"object"==typeof a&&forEach(Object_keys(a),function(c){b[c]=a[c]}),b}},{indexof:195}],259:[function(a,b,c){function d(){for(var a={},b=0;b<arguments.length;b++){var c=arguments[b];for(var d in c)e.call(c,d)&&(a[d]=c[d])}return a}b.exports=d;var e=Object.prototype.hasOwnProperty},{}],260:[function(a,b,c){b.exports={name:"fielddb",version:"5.5.29",description:"An offline/online field database which adapts to its user's terminology and I-Language",homepage:"https://github.com/FieldDB/FieldDB/issues/milestones?state=closed",repository:{type:"git",url:"git://github.com/FieldDB/FieldDB.git"},bugs:{url:"https://github.com/FieldDB/FieldDB/issues"},keywords:["fielddb","client"],contributors:["cesine <cesine@yahoo.com>","trisapeace <trisapeace@gmail.com>","hisakonog <hisakonog@gmail.com>","Emmy Cathcart <maryellencathcart@gmail.com>","Tobin Skinner <tobin.skinner@gmail.com>","Yuliya Manyakina <yulia.manyakina@gmail.com>","Elise <elise.mcclay@gmail.com>","Josh Horner <josh.horner@gmail.com>","gretchenmcc <gretchen.mcculloch@gmail.com>","jrwdunham <jrwdunham@gmail.com>","ghazan <gay.hazan@gmail.com>","Fieldlinguist <info@fieldlinguist.com>","zazoo <kimdan.ng@gmail.com>","louisa-bielig <louisa.bielig@gmail.com>","lingllama <lingllama@lingsync.org>","geekrax <rakshit@thetechtime.com>","Yogurt1206 <sunx4@miamioh.edu>","Pablo Duboue <pablo.duboue@gmail.com>","Oriana <oriana.kilbourn-ceron@mail.mcgill.ca>"],engines:{node:">4.2.2"},dependencies:{atob:"^1.1.2",bcryptjs:"^2.4.3","browserify-mime":"^1.2.9",btoa:"^1.1.2",d3:"^4.9.1",diacritics:"^1.2.3","directory-tree":"^1.1.0",frb:"git://github.com/cesine/frb.git#contenteditable",md5:"^2.0.0",q:"^1.4.1",recordmp3js:"^0.5.0",textgrid:"^2.2.0"},optionalDependancies:{d3:"^3.5.8",jsdom:"^7.0.2",memory:"0.0.3"},devDependencies:{browserify:"^12.0.1",docdash:"^0.4.0",grunt:"^0.4.5","grunt-browserify":"^4.0.1","grunt-contrib-concat":"^0.5.1","grunt-contrib-jasmine":"^0.9.2","grunt-contrib-jshint":"^0.11.3","grunt-contrib-uglify":"^0.10.1","grunt-contrib-watch":"^0.6.1","grunt-exec":"^0.4.6","grunt-jasmine-node-coverage":"^0.4.1","grunt-jsdoc":"^1.0.0","grunt-newer":"^1.1.1",jasmine:"^2.6.0",mkdirp:"^0.5.1",sinon:"^2.3.2"},main:"api/fielddb.js",scripts:{test:"jasmine tests/**/**-spec.js",lint:"grunt jshint","lint:api":"jslint api/**/*.js","lint:test":"jslint api/**/*.js",build:"grunt",optionalPostinstall:"bower link || exit 0"},license:"Apache-2.0"}},{}]},{},[47]);